[{"id":"8025","submission_id":"8021","filename":"3.cpp","source":"I2luY2x1ZGU8Yml0cy9zdGRjKysuaD4NCiNkZWZpbmUgc3luY19mbG93IGlvczo6c3luY193aXRoX3N0ZGlvKGZhbHNlKTtjaW4udGllKDApDQojZGVmaW5lIHpmKGksbCxyKSBmb3IoaW50IGk9bDtpPD1yO2krKykNCiNkZWZpbmUgZGYoaSxyLGwpIGZvcihpbnQgaT1yO2k+PWw7aS0tKQ0KI2RlZmluZSBsb3diaXQoeCkgKHgmKC14KSkNCiNkZWZpbmUgbm8gY291dDw8Im5vIHNvbHV0aW9uIg0KdXNpbmcgbmFtZXNwYWNlIHN0ZDsNCnR5cGVkZWYgbG9uZyBsb25nIGxsOw0KY29uc3QgbGwgbWF4bj01NTsNCnR5cGVkZWYgc3RydWN0IE5PREV7DQoJbGwgeCx5Ow0KfWlkOw0KdHlwZWRlZiBzdHJ1Y3QgTk9ERTJ7DQoJaWQgYWEsYmI7DQoJbGwgY250Ow0KfW5vZGU7DQpub2RlIHRtcDsNCmxsIGFucz0wLG47DQppZCBhLGI7DQppbnQgdmlzW21heG5dW21heG5dPXswfTsNCmNoYXIgbXBbbWF4bl1bbWF4bl07DQpxdWV1ZTxub2RlPnE7DQoNCmlubGluZSBib29sIGp1ZGdlKGNvbnN0IGlkIGwsY29uc3QgaWQgcil7DQoJaWYobC54PT1yLngmJmwueT09ci55KXJldHVybiB0cnVlOw0KCXJldHVybiBmYWxzZTsNCn0NCmlubGluZSBib29sIGVxdWFsKGNvbnN0IG5vZGUgbCxjb25zdCBub2RlIHIpew0KCWlmKGp1ZGdlKGwuYWEsci5hYSkmJmp1ZGdlKGwuYmIsci5iYikmJmwuY250PT1yLmNudClyZXR1cm4gdHJ1ZTsNCglyZXR1cm4gZmFsc2U7DQp9DQp2b2lkIHB1c2hyKGNvbnN0IG5vZGUgbmQpew0KCXRtcC5hYT1uZC5hYTsNCglsbCB0YWc9MDsNCglpZihuZC5hYS55PG4pew0KCQlpZihtcFtuZC5hYS54XVtuZC5hYS55KzFdIT0nKicpew0KCQkJdG1wLmFhLnkrKzsNCgkJCXRtcC5jbnQ9bmQuY250KzE7DQoJCQl0YWc9MTsNCgkJfQ0KCX0NCgl0bXAuYmI9bmQuYmI7DQoJaWYobmQuYmIueTxuKXsNCgkJaWYobXBbbmQuYmIueF1bbmQuYmIueSsxXSE9JyonKXsNCgkJCXRtcC5iYi55Kys7DQoJCQlpZighdGFnKXRtcC5jbnQ9bmQuY250KzE7Ow0KCQl9DQoJfQ0KCWlmKCFlcXVhbChuZCx0bXApKXsNCgkJcS5wdXNoKHRtcCk7DQoJCXZpc1t0bXAuYWEueF1bdG1wLmFhLnldPTE7DQoJfQ0KCXJldHVybiA7DQp9DQp2b2lkIHB1c2hsKGNvbnN0IG5vZGUgbmQpew0KCXRtcC5hYT1uZC5hYTsNCglsbCB0YWc9MDsNCglpZihuZC5hYS55PjEpew0KCQlpZihtcFtuZC5hYS54XVtuZC5hYS55LTFdIT0nKicpew0KCQkJdG1wLmFhLnktLTsNCgkJCXRtcC5jbnQ9bmQuY250KzE7Ow0KCQkJdGFnPTE7DQoJCX0NCgl9DQoJdG1wLmJiPW5kLmJiOw0KCWlmKG5kLmJiLnk+MSl7DQoJCWlmKG1wW25kLmJiLnhdW25kLmJiLnktMV0hPScqJyl7DQoJCQl0bXAuYmIueS0tOw0KCQkJaWYoIXRhZyl0bXAuY250PW5kLmNudCsxOzsNCgkJfQ0KCX0NCglpZighZXF1YWwobmQsdG1wKSl7DQoJCXEucHVzaCh0bXApOw0KCQl2aXNbdG1wLmFhLnhdW3RtcC5hYS55XT0xOw0KCX0gDQoJcmV0dXJuIDsNCn0NCnZvaWQgcHVzaHQoY29uc3Qgbm9kZSBuZCl7DQoJdG1wLmFhPW5kLmFhOw0KCWxsIHRhZz0wOw0KCWlmKG5kLmFhLng+MSl7DQoJCWlmKG1wW25kLmFhLngtMV1bbmQuYWEueV0hPScqJyl7DQoJCQl0bXAuYWEueC0tOw0KCQkJdG1wLmNudD1uZC5jbnQrMTs7DQoJCQl0YWc9MTsNCgkJfQ0KCX0NCgl0bXAuYmI9bmQuYmI7DQoJaWYobmQuYmIueD4xKXsNCgkJaWYobXBbbmQuYmIueC0xXVtuZC5iYi55XSE9JyonKXsNCgkJCXRtcC5iYi54LS07DQoJCQlpZighdGFnKXRtcC5jbnQ9bmQuY250KzE7Ow0KCQl9DQoJfQ0KCWlmKCFlcXVhbChuZCx0bXApKXsNCgkJcS5wdXNoKHRtcCk7DQoJCXZpc1t0bXAuYWEueF1bdG1wLmFhLnldPTE7DQoJfQ0KCXJldHVybiA7DQp9DQp2b2lkIHB1c2hiKGNvbnN0IG5vZGUgbmQpew0KCXRtcC5hYT1uZC5hYTsNCglsbCB0YWc9MDsNCglpZihuZC5hYS54PG4pew0KCQlpZihtcFtuZC5hYS54KzFdW25kLmFhLnldIT0nKicpew0KCQkJdG1wLmFhLngrKzsNCgkJCXRtcC5jbnQ9bmQuY250KzE7Ow0KCQkJdGFnPTE7DQoJCX0NCgl9DQoJdG1wLmJiPW5kLmJiOw0KCWlmKG5kLmJiLng8bil7DQoJCWlmKG1wW25kLmJiLngrMV1bbmQuYmIueV0hPScqJyl7DQoJCQl0bXAuYmIueCsrOw0KCQkJaWYoIXRhZyl0bXAuY250PW5kLmNudCsxOzsNCgkJfQ0KCX0NCglpZighZXF1YWwobmQsdG1wKSl7DQoJCXEucHVzaCh0bXApOw0KCQl2aXNbdG1wLmFhLnhdW3RtcC5hYS55XT0xOw0KCX0NCglyZXR1cm4gOw0KfQ0KaW50IG1haW4oKQ0Kew0KCXN5bmNfZmxvdzsNCgljaW4+Pm47DQoJemYoaSwxLG4pew0KCQl6ZihqLDEsbil7DQoJCQljaW4+Pm1wW2ldW2pdOw0KCQkJaWYobXBbaV1bal09PSdhJyl7DQoJCQkJYS54PWksYS55PWo7DQoJCQl9ZWxzZSBpZihtcFtpXVtqXT09J2InKXsNCgkJCQliLng9aSxiLnk9ajsNCgkJCX0NCgkJfQ0KCX0NCgl0bXAuYWE9YSx0bXAuYmI9Yix0bXAuY250PTA7DQoJcS5wdXNoKHRtcCk7DQoJdmlzW3RtcC5hYS54XVt0bXAuYWEueV09MTsNCgl3aGlsZSghcS5lbXB0eSgpKXsNCgkJbm9kZSBzdD1xLmZyb250KCk7DQoJCWlmKHZpc1tzdC5hYS54XVtzdC5hYS55XSl7DQoJCQlubzsNCgkJCXJldHVybiAwOw0KCQl9DQoJCWlmKGp1ZGdlKHN0LmFhLHN0LmJiKSl7DQoJCQlhbnM9c3QuY250Ow0KCQkJYnJlYWs7DQoJCX0NCgkJcS5wb3AoKTsgDQoJCXZpc1tzdC5hYS54XVtzdC5hYS55XT0wOw0KCQlwdXNocihzdCk7DQoJCXB1c2hsKHN0KTsNCgkJcHVzaHQoc3QpOw0KCQlwdXNoYihzdCk7DQoJfQ0KCWlmKHEuZW1wdHkoKSlubzsNCgllbHNlIGNvdXQ8PGFuczsNCglyZXR1cm4gMDsNCn0NCi8vRQ0K"}]