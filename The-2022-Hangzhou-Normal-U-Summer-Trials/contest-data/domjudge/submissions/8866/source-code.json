[{"id":"8870","submission_id":"8866","filename":"k.cpp","source":"I2luY2x1ZGU8aW9zdHJlYW0+DQojaW5jbHVkZTxhbGdvcml0aG0+DQojaW5jbHVkZTxjc3RyaW5nPg0KI2luY2x1ZGU8dmVjdG9yPg0KI2luY2x1ZGU8cXVldWU+DQojaW5jbHVkZTxyYW5kb20+DQojaW5jbHVkZTxiaXRzZXQ+DQojaW5jbHVkZTxtYXA+DQojaW5jbHVkZTxzZXQ+DQojaW5jbHVkZTxjbWF0aD4NCiNkZWZpbmUgbGwgbG9uZyBsb25nDQojZGVmaW5lIGxvd2JpdCh4KSAoKHgpJigtKHgpKSkNCiNkZWZpbmUgcGIgcHVzaF9iYWNrDQojZGVmaW5lIHZpIHZlY3RvcjxpbnQ+DQojZGVmaW5lIHBpaSBwYWlyPGludCwgaW50Pg0KI2RlZmluZSBhbGx2KHgpICh4KS5iZWdpbigpLCAoeCkuZW5kKCkgDQojZGVmaW5lIGJpdDMyKHgpIChfX2J1aWx0aW5fcG9wY291bnQoKHVuc2lnbmVkIGludCkoeCkpKQ0KI2RlZmluZSBiaXQ2NCh4KSAoYml0MzIoeD4+MzIpK2JpdDMyKHgpKQ0KI2RlZmluZSBJT1MgaW9zOjpzeW5jX3dpdGhfc3RkaW8oMCk7Y2luLnRpZSgwKTtjb3V0LnRpZSgwKTsNCiNkZWZpbmUgcmVwKGksIHN0LCBlZCkgZm9yKGludCBpID0gc3Q7IGkgPD0gZWQ7IGkrKykNCiNkZWZpbmUgcmV2cChpLCBzdCwgZWQpIGZvcihpbnQgaSA9IHN0OyBpIDw9IGVkOyBpLS0pDQojZGVmaW5lIHJhbmQoKSBybmcoKQ0KDQp1c2luZyBuYW1lc3BhY2Ugc3RkOw0KbXQxOTkzNyBybmcoKTsNCmNvbnN0IGludCBOID0gM2UzICsgMTA7DQppbnQga2RbTl07DQpkb3VibGUgc3F1YXJlKGRvdWJsZSB4KXtyZXR1cm4geCAqIHg7fQ0KZG91YmxlIHNwZWVkWzVdOw0Kc3RydWN0IG5vZGUNCnsNCiAgICBpbnQgeCwgeTsNCn1wW05dOw0KYm9vbCB2aXNbTl07DQppbnQgbjsNCmRvdWJsZSBkaXN0W05dOw0KaW5saW5lIGRvdWJsZSBnbyhub2RlIGEsIG5vZGUgYiwgaW50IHNwZCl7DQogICAgcmV0dXJuIHNxcnQoc3F1YXJlKGEueCAtIGIueCkgKyBzcXVhcmUoYS55IC0gYi55KSkgLyBzcGQ7DQp9DQp2b2lkIHNwZmEoaW50IHN0KXsNCiAgICBtZW1zZXQoZGlzdCwgMHg1Ziwgc2l6ZW9mIGRpc3QpOw0KICAgIHF1ZXVlPGludD4gcTsNCiAgICBxLnB1c2goc3QpOw0KICAgIHZpc1tzdF0gPSB0cnVlOw0KICAgIGRpc3Rbc3RdID0gMDsNCiAgICB3aGlsZShxLnNpemUoKSl7DQogICAgICAgIGludCBjdXIgPSBxLmZyb250KCk7cS5wb3AoKTsNCiAgICAgICAgdmlzW2N1cl0gPSBmYWxzZTsNCiAgICAgICAgZm9yKGludCBpID0gMTsgaSA8PSBuOyBpKyspew0KICAgICAgICAgICAgaWYoaSA9PSBjdXIpIGNvbnRpbnVlOw0KICAgICAgICAgICAgaW50IHYgPSBzcGVlZFtrZFtjdXJdXTsNCiAgICAgICAgICAgIGlmKGtkW2N1cl0gIT0ga2RbaV0pIHYgPSBzcGVlZFswXTsgDQogICAgICAgICAgICBkb3VibGUgZCA9IGdvKHBbaV0sIHBbY3VyXSwgdik7DQogICAgICAgICAgICBpZihkaXN0W2ldID4gZGlzdFtjdXJdICsgZCl7DQogICAgICAgICAgICAgICAgZGlzdFtpXSA9IGRpc3RbY3VyXSArIGQ7DQogICAgICAgICAgICAgICAgaWYoIXZpc1tpXSl7DQogICAgICAgICAgICAgICAgICAgIHEucHVzaChpKTsNCiAgICAgICAgICAgICAgICAgICAgdmlzW2ldID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQp9DQppbnQgbWFpbigpDQp7DQogICAgc2NhbmYoIiVkIiwgJm4pOw0KICAgIHJlcChpLCAxLCA0KQ0KICAgICAgICBzY2FuZigiJWxmIiwgc3BlZWQgKyBpKTsNCiAgICBzY2FuZigiJWxmIiwgc3BlZWQpOw0KICAgIGludCBzdCwgZWQ7DQogICAgc2NhbmYoIiVkJWQiLCAmc3QsICZlZCk7DQogICAgcmVwKGksIDEsIG4pew0KICAgICAgICBpbnQgeCwgeTsNCiAgICAgICAgc2NhbmYoIiVkJWQiLCAmeCwgJnkpOw0KICAgICAgICBwW2ldID0ge3gsIHl9Ow0KICAgICAgICBpbnQgayA9IDA7DQogICAgICAgIGlmKHggPj0gMSAmJiB5ID49IDEpIGsgPSAxOw0KICAgICAgICBlbHNlIGlmKHggPD0gLTEgJiYgeSA+PSAxKSBrID0gMjsNCiAgICAgICAgZWxzZSBpZih4IDw9IC0xICYmIHkgPD0gLTEpIGsgPSAzOw0KICAgICAgICBlbHNlIGlmKHggPj0gMSAmJiB5IDw9IC0xKSBrID0gNDsNCiAgICAgICAga2RbaV0gPSBrOw0KICAgIH0NCiAgICBzcGZhKHN0KTsNCiAgICBwcmludGYoIiUuMTBsZiIsIGRpc3RbZWRdKTsNCn0="}]