[{"id":"8572","submission_id":"8568","filename":"0514C.cpp","source":"I2luY2x1ZGU8Yml0cy9zdGRjKysuaD4NCiNkZWZpbmUgaW8gaW9zOjpzeW5jX3dpdGhfc3RkaW8oZmFsc2UpO2Npbi50aWUoMCksY291dC50aWUoMCk7DQp1c2luZyBuYW1lc3BhY2Ugc3RkOw0KDQp0eXBlZGVmIHVuc2lnbmVkIGxvbmcgbG9uZyBsbDsNCg0KbGwgbiwgbSwgaywgdCwgbWF4bjsNCmxsIGFbNTAwMDEwXTsNCmxsIGNoYVs1MDAwMTBdOw0Kc3RyaW5nIGFuczsNCmlubGluZSBzdHJpbmcgZ2V0c3RyKGxsIG51bSkgew0KCXN0cmluZyBzID0gIiI7DQoJd2hpbGUgKG51bSkgew0KCQlzID0gY2hhcihudW0gJSAxMCArICcwJykgKyBzOw0KCQludW0gLz0gMTA7DQoJfQ0KCXJldHVybiBzOw0KfQ0KDQpzdHJpbmcgYWRkIChzdHJpbmcgc3RyMSwgc3RyaW5nIHN0cjIpIHsNCglzdHJpbmcgYW5zX3N0cjsNCglpbnQgbGVuMSA9IHN0cjEubGVuZ3RoKCksbGVuMiA9IHN0cjIubGVuZ3RoKCk7DQoJaWYgKGxlbjEgPCBsZW4yKSB7DQoJCWZvciAoaW50IGkgPSAxOyBpIDw9IGxlbjIgLSBsZW4xOyBpKyspIHsNCgkJCXN0cjEgPSAiMCIgKyBzdHIxOw0KCQl9DQoJfSBlbHNlIHsNCgkJZm9yIChpbnQgaSA9IDE7IGkgPD0gbGVuMSAtIGxlbjI7IGkrKykgew0KCQkJc3RyMiA9ICIwIiArIHN0cjI7DQoJCX0NCgl9DQoJbGVuMSA9IGxlbjEgPiBsZW4yID8gbGVuMTogbGVuMjsNCglpbnQgZmxhZyA9IDAsIHRlbXA7DQoJZm9yIChpbnQgaSA9IGxlbjEgLSAxOyBpID49IDA7IGktLSkgew0KCQl0ZW1wID0gc3RyMVtpXSAtICcwJyArIHN0cjJbaV0gLSAnMCcgKyBmbGFnOw0KCQlmbGFnID0gdGVtcCAvIDEwOw0KCQl0ZW1wICU9IDEwOw0KCQlhbnNfc3RyID0gY2hhcih0ZW1wICsgJzAnKSArIGFuc19zdHI7DQoJfQ0KCWlmIChmbGFnKSBhbnNfc3RyID0gY2hhcihmbGFnICsgJzAnKSArIGFuc19zdHI7DQoJcmV0dXJuIGFuc19zdHI7DQp9DQpzdHJpbmcgc3ViIChzdHJpbmcgc3RyMSwgc3RyaW5nIHN0cjIpIHsNCglzdHJpbmcgc3RyOw0KCWludCB0bXAgPSBzdHIxLmxlbmd0aCgpIC0gc3RyMi5sZW5ndGgoKTsNCglpbnQgY2YgPSAwOw0KCWZvciAoaW50IGkgPSBzdHIyLmxlbmd0aCgpIC0gMTsgaSA+PSAwOyBpLS0pIHsNCgkJaWYgKHN0cjFbdG1wICsgaV0gPCBzdHIyW2ldICsgY2YpIHsNCgkJCXN0ciA9IGNoYXIoc3RyMVt0bXAgKyBpXSAtIHN0cjJbaV0gLSBjZiArICcwJyArIDEwKSArIHN0cjsNCgkJCWNmID0gMTsNCgkJfSBlbHNlIHsNCgkJCXN0ciA9IGNoYXIoc3RyMVt0bXAgKyBpXSAtIHN0cjJbaV0gLSBjZiArICcwJykgKyBzdHI7DQoJCQljZiA9IDA7DQoJCX0NCgl9DQoJZm9yIChpbnQgaSA9IHRtcCAtIDE7IGkgPj0gMDsgaS0tKSB7DQoJCWlmIChzdHIxW2ldIC0gY2YgPj0gJzAnKSB7DQoJCQlzdHIgPSBjaGFyKHN0cjFbaV0gLSBjZikgKyBzdHI7DQoJCQljZiA9IDA7DQoJCX0gZWxzZSB7DQoJCQlzdHIgPSBjaGFyKHN0cjFbaV0gLSBjZiArIDEwKSArIHN0cjsNCgkJCWNmID0gMTsNCgkJfQ0KCX0NCglzdHIuZXJhc2UoMCwgc3RyLmZpbmRfZmlyc3Rfbm90X29mKCcwJykpOw0KCXJldHVybiBzdHI7DQp9DQpzdHJpbmcgbXVsKHN0cmluZyBzdHIxLCBzdHJpbmcgc3RyMikgew0KCXN0cmluZyBzdHI7DQoJaW50IGxlbjEgPSBzdHIxLmxlbmd0aCgpLGxlbjIgPSBzdHIyLmxlbmd0aCgpOw0KCXN0cmluZyB0ZW1wc3RyOw0KCWZvciAoaW50IGkgPSBsZW4yIC0gMTsgaSA+PSAwOyBpLS0pIHsNCgkJdGVtcHN0ciA9ICIiOw0KCQlpbnQgdGVtcCA9IHN0cjJbaV0gLSAnMCc7DQoJCWludCB0ID0gMDsNCgkJaW50IGNmID0gMDsNCgkJaWYgKHRlbXAgIT0gMCkgew0KCQkJZm9yIChpbnQgaiA9IDE7IGogPD0gbGVuMiAtIDEgLSBpOyBqKyspIHsNCgkJCQl0ZW1wc3RyICs9ICIwIjsNCgkJCX0NCgkJCWZvciAoaW50IGogPSBsZW4xIC0gMTsgaiA+PSAwOyBqLS0pIHsNCgkJCQl0ID0gKHRlbXAgKiAoc3RyMVtqXSAtICcwJykgKyBjZikgJSAxMDsNCgkJCQljZiA9ICh0ZW1wICogKHN0cjFbal0gLSAnMCcpICsgY2YpIC8gMTA7DQoJCQkJdGVtcHN0ciA9IGNoYXIodCArICcwJykgKyB0ZW1wc3RyOw0KCQkJfQ0KCQkJaWYgKGNmICE9IDApIHsNCgkJCQl0ZW1wc3RyID0gY2hhcihjZiArICcwJykgKyB0ZW1wc3RyOw0KCQkJfQ0KCQl9DQoJCXN0cj1hZGQoc3RyLHRlbXBzdHIpOw0KCX0NCglzdHIuZXJhc2UoMCwgc3RyLmZpbmRfZmlyc3Rfbm90X29mKCcwJykpOw0KCXJldHVybiBzdHI7DQp9DQppbnQgbWFpbiAoKSB7DQoJaW87DQoJY2luID4+IG47DQoJZm9yIChpbnQgaSA9IDE7IGkgPD0gbjsgaSsrKSB7DQoJCWNpbiA+PiBhW2ldOw0KCQlpZiAoaSAhPSAxKSBjaGFbaV0gPSBhW2ldIC0gYVtpIC0gMV07DQoJCW1heG4gPSBtYXgobWF4biwgY2hhW2ldKTsNCgl9DQoJY2hhWzFdID0gMDsNCgljaW4gPj4gazsNCgl3aGlsZSAoay0tKSB7DQoJCWFucyA9ICIwIjsNCgkJY2luID4+IHQ7DQoJCWlmICh0ID09IDApIHsNCgkJCWNvdXQgPDwgIjBcbiI7DQoJCQljb250aW51ZTsNCgkJfQ0KCQlpbnQgbnVtID0gdXBwZXJfYm91bmQoY2hhICsgMSwgY2hhICsgbiArIDEsIG1pbihtYXhuLCB0KSkgLSBjaGEgLSAxOw0KCQlpZiAoYVtudW1dICE9IDApDQoJCQlhbnMgPSBhZGQoYW5zLCBnZXRzdHIoYVtudW1dIC0gYVsxXSkpOw0KCQlhbnMgPSBhZGQoYW5zLCBtdWwoZ2V0c3RyKG4gLSBudW0gKyAxKSwgZ2V0c3RyKHQpKSk7DQoJCWNvdXQgPDwgYW5zIDw8ICdcbic7DQoJfQ0KCXJldHVybiAwOw0KfQ0K"}]