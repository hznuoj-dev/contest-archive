[{"id":"8054","submission_id":"8050","filename":"3.cpp","source":"I2luY2x1ZGU8Yml0cy9zdGRjKysuaD4NCiNkZWZpbmUgc3luY19mbG93IGlvczo6c3luY193aXRoX3N0ZGlvKGZhbHNlKTtjaW4udGllKDApDQojZGVmaW5lIHpmKGksbCxyKSBmb3IoaW50IGk9bDtpPD1yO2krKykNCiNkZWZpbmUgZGYoaSxyLGwpIGZvcihpbnQgaT1yO2k+PWw7aS0tKQ0KI2RlZmluZSBsb3diaXQoeCkgKHgmKC14KSkNCiNkZWZpbmUgbm8gY291dDw8Im5vIHNvbHV0aW9uIg0KdXNpbmcgbmFtZXNwYWNlIHN0ZDsNCnR5cGVkZWYgbG9uZyBsb25nIGxsOw0KY29uc3QgbGwgbWF4bj01NTsNCnR5cGVkZWYgc3RydWN0IE5PREV7DQoJbGwgeCx5Ow0KfWlkOw0KdHlwZWRlZiBzdHJ1Y3QgTk9ERTJ7DQoJaWQgYWEsYmI7DQoJbGwgY250Ow0KfW5vZGU7DQpub2RlIHRtcDsNCmxsIGFucz0wLG47DQppZCBhLGI7DQppbnQgdmlzW21heG5dW21heG5dPXswfTsNCmNoYXIgbXBbbWF4bl1bbWF4bl07DQpxdWV1ZTxub2RlPnE7DQoNCmlubGluZSBib29sIGp1ZGdlKGNvbnN0IGlkIGwsY29uc3QgaWQgcil7DQoJaWYobC54PT1yLngmJmwueT09ci55KXJldHVybiB0cnVlOw0KCXJldHVybiBmYWxzZTsNCn0NCmlubGluZSBib29sIGVxdWFsKGNvbnN0IG5vZGUgbCxjb25zdCBub2RlIHIpew0KCWlmKGp1ZGdlKGwuYWEsci5hYSkmJmp1ZGdlKGwuYmIsci5iYikmJmwuY250PT1yLmNudClyZXR1cm4gdHJ1ZTsNCglyZXR1cm4gZmFsc2U7DQp9DQp2b2lkIHB1c2hyKGNvbnN0IG5vZGUgbmQpew0KCXRtcC5hYT1uZC5hYTsNCglsbCB0YWc9MDsNCglpZihuZC5hYS55PG4pew0KCQlpZihtcFtuZC5hYS54XVtuZC5hYS55KzFdIT0nKicpew0KCQkJdG1wLmFhLnkrKzsNCgkJCXRtcC5jbnQ9bmQuY250KzE7DQoJCQl0YWc9MTsNCgkJfQ0KCX0NCgl0bXAuYmI9bmQuYmI7DQoJaWYobmQuYmIueTxuKXsNCgkJaWYobXBbbmQuYmIueF1bbmQuYmIueSsxXSE9JyonKXsNCgkJCXRtcC5iYi55Kys7DQoJCQlpZighdGFnKXRtcC5jbnQ9bmQuY250KzE7Ow0KCQl9DQoJfQ0KCWlmKCFlcXVhbChuZCx0bXApKXsNCgkJaWYoIXZpc1t0bXAuYWEueF1bdG1wLmFhLnldKXEucHVzaCh0bXApOw0KCQl2aXNbdG1wLmFhLnhdW3RtcC5hYS55XT0xOw0KCX0NCglyZXR1cm4gOw0KfQ0Kdm9pZCBwdXNobChjb25zdCBub2RlIG5kKXsNCgl0bXAuYWE9bmQuYWE7DQoJbGwgdGFnPTA7DQoJaWYobmQuYWEueT4xKXsNCgkJaWYobXBbbmQuYWEueF1bbmQuYWEueS0xXSE9JyonKXsNCgkJCXRtcC5hYS55LS07DQoJCQl0bXAuY250PW5kLmNudCsxOzsNCgkJCXRhZz0xOw0KCQl9DQoJfQ0KCXRtcC5iYj1uZC5iYjsNCglpZihuZC5iYi55PjEpew0KCQlpZihtcFtuZC5iYi54XVtuZC5iYi55LTFdIT0nKicpew0KCQkJdG1wLmJiLnktLTsNCgkJCWlmKCF0YWcpdG1wLmNudD1uZC5jbnQrMTs7DQoJCX0NCgl9DQoJaWYoIWVxdWFsKG5kLHRtcCkpew0KCQlpZighdmlzW3RtcC5hYS54XVt0bXAuYWEueV0pcS5wdXNoKHRtcCk7DQoJCXZpc1t0bXAuYWEueF1bdG1wLmFhLnldPTE7DQoJfSANCglyZXR1cm4gOw0KfQ0Kdm9pZCBwdXNodChjb25zdCBub2RlIG5kKXsNCgl0bXAuYWE9bmQuYWE7DQoJbGwgdGFnPTA7DQoJaWYobmQuYWEueD4xKXsNCgkJaWYobXBbbmQuYWEueC0xXVtuZC5hYS55XSE9JyonKXsNCgkJCXRtcC5hYS54LS07DQoJCQl0bXAuY250PW5kLmNudCsxOzsNCgkJCXRhZz0xOw0KCQl9DQoJfQ0KCXRtcC5iYj1uZC5iYjsNCglpZihuZC5iYi54PjEpew0KCQlpZihtcFtuZC5iYi54LTFdW25kLmJiLnldIT0nKicpew0KCQkJdG1wLmJiLngtLTsNCgkJCWlmKCF0YWcpdG1wLmNudD1uZC5jbnQrMTs7DQoJCX0NCgl9DQoJaWYoIWVxdWFsKG5kLHRtcCkpew0KCQlpZighdmlzW3RtcC5hYS54XVt0bXAuYWEueV0pcS5wdXNoKHRtcCk7DQoJCXZpc1t0bXAuYWEueF1bdG1wLmFhLnldPTE7DQoJfQ0KCXJldHVybiA7DQp9DQp2b2lkIHB1c2hiKGNvbnN0IG5vZGUgbmQpew0KCXRtcC5hYT1uZC5hYTsNCglsbCB0YWc9MDsNCglpZihuZC5hYS54PG4pew0KCQlpZihtcFtuZC5hYS54KzFdW25kLmFhLnldIT0nKicpew0KCQkJdG1wLmFhLngrKzsNCgkJCXRtcC5jbnQ9bmQuY250KzE7Ow0KCQkJdGFnPTE7DQoJCX0NCgl9DQoJdG1wLmJiPW5kLmJiOw0KCWlmKG5kLmJiLng8bil7DQoJCWlmKG1wW25kLmJiLngrMV1bbmQuYmIueV0hPScqJyl7DQoJCQl0bXAuYmIueCsrOw0KCQkJaWYoIXRhZyl0bXAuY250PW5kLmNudCsxOzsNCgkJfQ0KCX0NCglpZighZXF1YWwobmQsdG1wKSl7DQoJCWlmKCF2aXNbdG1wLmFhLnhdW3RtcC5hYS55XSlxLnB1c2godG1wKTsNCgkJdmlzW3RtcC5hYS54XVt0bXAuYWEueV09MTsNCgl9DQoJcmV0dXJuIDsNCn0NCmludCBtYWluKCkNCnsNCglzeW5jX2Zsb3c7DQoJY2luPj5uOw0KCXpmKGksMSxuKXsNCgkJemYoaiwxLG4pew0KCQkJY2luPj5tcFtpXVtqXTsNCgkJCWlmKG1wW2ldW2pdPT0nYScpew0KCQkJCWEueD1pLGEueT1qOw0KCQkJfWVsc2UgaWYobXBbaV1bal09PSdiJyl7DQoJCQkJYi54PWksYi55PWo7DQoJCQl9DQoJCX0NCgl9DQoJdG1wLmFhPWEsdG1wLmJiPWIsdG1wLmNudD0wOw0KCXEucHVzaCh0bXApOw0KCXZpc1t0bXAuYWEueF1bdG1wLmFhLnldPTE7DQoJd2hpbGUoIXEuZW1wdHkoKSl7DQoJCW5vZGUgc3Q9cS5mcm9udCgpOw0KCQlpZihqdWRnZShzdC5hYSxzdC5iYikpew0KCQkJYW5zPXN0LmNudDsNCgkJCWJyZWFrOw0KCQl9DQoJCXEucG9wKCk7IA0KCQlwdXNocihzdCk7DQoJCXB1c2hsKHN0KTsNCgkJcHVzaHQoc3QpOw0KCQlwdXNoYihzdCk7DQoJfQ0KCWlmKHEuZW1wdHkoKSlubzsNCgllbHNlIGNvdXQ8PGFuczsNCglyZXR1cm4gMDsNCn0NCi8vRQ0K"}]