[{"id":"7909","submission_id":"7905","filename":"G.cpp","source":"I2luY2x1ZGU8Yml0cy9zdGRjKysuaD4NCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQpjb25zdCBpbnQgTUFYTj0xZTUrNTsNCmNvbnN0IGludCBwcmltZVsxMF09ezIsMyw1LDcsMTEsMTMsMTcsMTksMjMsMjl9Ow0Kc3RydWN0IFRyZWV7DQoJaW50IHVsWzEwXSxsZFsxMF07Ym9vbCB1bHQsbGR0Ow0KCVRyZWUoKXttZW1zZXQodWwsMCxzaXplb2YodWwpKTttZW1zZXQobGQsMCxzaXplb2YobGQpKTt9DQoJVHJlZSBvcGVyYXRvciArKFRyZWUgeSl7DQoJCVRyZWUgejsNCgkJZm9yKGludCBpPTA7aTwxMDtpKyspew0KCQkJei51bFtpXT11bFtpXSt5LnVsW2ldOw0KCQkJei5sZFtpXT1sZFtpXTsNCgkJfQ0KCQl6LnVsdD11bHQ7DQoJCXoubGR0PWxkdDsNCgkJcmV0dXJuIHo7DQoJfQ0KCVRyZWUgb3BlcmF0b3IgLShUcmVlIHkpew0KCQlUcmVlIHo7DQoJCWZvcihpbnQgaT0wO2k8MTA7aSsrKXsNCgkJCXoudWxbaV09dWxbaV0teS51bFtpXTsNCgkJCXoubGRbaV09bGRbaV07DQoJCX0NCgkJei51bHQ9dWx0Ow0KCQl6LmxkdD1sZHQ7DQoJCXJldHVybiB6Ow0KCX0NCn1UcmVbTUFYTjw8Ml0sQWRkW01BWE48PDJdOw0KVHJlZSBfbWluKFRyZWUgeCxUcmVlIHkpew0KCVRyZWUgejsNCglmb3IoaW50IGk9MDtpPDEwO2krKyl7DQoJCWlmKHgudWx0JiZ5LnVsdCkgei51bFtpXT1taW4oeC51bFtpXSx5LnVsW2ldKTsNCgkJZWxzZSB6LnVsW2ldPSh4LnVsdD94LnVsW2ldOnkudWxbaV0pOw0KCQlpZih4LmxkdCYmeS5sZHQpIHoubGRbaV09bWluKHgubGRbaV0seS5sZFtpXSk7DQoJCWVsc2Ugei5sZFtpXT0oeC5sZHQ/eC5sZFtpXTp5LmxkW2ldKTsNCgl9DQoJei51bHQ9eC51bHR8eS51bHQ7DQoJei5sZHQ9eC5sZHR8eS5sZHQ7DQoJcmV0dXJuIHo7DQp9DQp2b2lkIFB1c2hVcChpbnQgcnQpe1RyZVtydF09X21pbihUcmVbcnQ8PDFdLFRyZVtydDw8MXwxXSk7fQ0Kdm9pZCBQdXNoRG93bihpbnQgcnQpew0KCWlmKFRyZVtydDw8MV0udWx0PT0xKSBUcmVbcnQ8PDFdPVRyZVtydDw8MV0rQWRkW3J0XSxBZGRbcnQ8PDFdPUFkZFtydDw8MV0rQWRkW3J0XTsNCglpZihUcmVbcnQ8PDF8MV0udWx0PT0xKSBUcmVbcnQ8PDF8MV09VHJlW3J0PDwxfDFdK0FkZFtydF0sQWRkW3J0PDwxfDFdPUFkZFtydDw8MXwxXStBZGRbcnRdOw0KCW1lbXNldChBZGRbcnRdLnVsLDAsc2l6ZW9mKEFkZFtydF0udWwpKTsNCn0NCnZvaWQgTXVsKGludCBydCxpbnQgTCxpbnQgUixpbnQgbCxpbnQgcixpbnQgeCxpbnQgZil7DQoJaWYobDw9TCYmUjw9cil7DQoJCWZvcihpbnQgaT0wO2k8MTA7aSsrKXsNCgkJCXdoaWxlKHglcHJpbWVbaV09PTApew0KCQkJCVRyZVtydF0udWxbaV0rPWY7DQoJCQkJQWRkW3J0XS51bFtpXSs9ZjsNCgkJCQl4Lz1wcmltZVtpXTsNCgkJCX0NCgkJfQ0KCQlyZXR1cm47DQoJfQ0KCVB1c2hEb3duKHJ0KTsNCglpbnQgbWlkPShSK0wpPj4xOw0KCWlmKGw8PW1pZCkgTXVsKHJ0PDwxLEwsbWlkLGwscix4LGYpOw0KCWlmKHI+bWlkKSBNdWwocnQ8PDF8MSxtaWQrMSxSLGwscix4LGYpOw0KCVB1c2hVcChydCk7DQp9DQp2b2lkIGZsaXAoaW50IHJ0LGludCBMLGludCBSLGludCBwKXsNCglpZihMPT1SKXsNCgkJaWYoVHJlW3J0XS51bHQ9PTEpew0KCQkJZm9yKGludCBpPTA7aTwxMDtpKyspew0KCQkJCVRyZVtydF0ubGRbaV09VHJlW3J0XS51bFtpXTsNCgkJCQlUcmVbcnRdLnVsW2ldPTA7DQoJCQl9DQoJCX1lbHNlew0KCQkJZm9yKGludCBpPTA7aTwxMDtpKyspew0KCQkJCVRyZVtydF0udWxbaV09VHJlW3J0XS5sZFtpXTsNCgkJCQlUcmVbcnRdLmxkW2ldPTA7DQoJCQl9DQoJCX0NCgkJVHJlW3J0XS51bHRePTE7DQoJCVRyZVtydF0ubGR0Xj0xOw0KCQlyZXR1cm4gOw0KCX0NCglpbnQgbWlkPShSK0wpPj4xO1B1c2hEb3duKHJ0KTsNCglpZihwPD1taWQpIGZsaXAocnQ8PDEsTCxtaWQscCk7DQoJZWxzZSBmbGlwKHJ0PDwxfDEsbWlkKzEsUixwKTsNCglQdXNoVXAocnQpOw0KfQ0KVHJlZSBRdWVyeShpbnQgcnQsaW50IEwsaW50IFIsaW50IGwsaW50IHIpew0KCWlmKGw8PUwmJlI8PXIpIHJldHVybiBUcmVbcnRdOw0KCWludCBtaWQ9KFIrTCk+PjE7UHVzaERvd24ocnQpOw0KCWlmKHI8PW1pZCkgcmV0dXJuIFF1ZXJ5KHJ0PDwxLEwsbWlkLGwscik7ZWxzZQ0KCWlmKGw+bWlkKSByZXR1cm4gUXVlcnkocnQ8PDF8MSxtaWQrMSxSLGwscik7ZWxzZQ0KCXJldHVybiBfbWluKFF1ZXJ5KHJ0PDwxLEwsbWlkLGwsciksUXVlcnkocnQ8PDF8MSxtaWQrMSxSLGwscikpOw0KfQ0Kdm9pZCBCdWlsZChpbnQgcnQsaW50IEwsaW50IFIpew0KCWlmKEw9PVIpew0KCQlUcmVbcnRdLnVsdD0xOw0KCQlUcmVbcnRdLmxkdD0wOw0KCQlyZXR1cm47DQoJfQ0KCWludCBtaWQ9KFIrTCk+PjE7DQoJQnVpbGQocnQ8PDEsTCxtaWQpO0J1aWxkKHJ0PDwxfDEsbWlkKzEsUik7DQoJUHVzaFVwKHJ0KTsNCn0NCmludCBtYWluKCl7DQoJaW9zOjpzeW5jX3dpdGhfc3RkaW8oZmFsc2UpOw0KCWNpbi50aWUobnVsbHB0cik7Y291dC50aWUobnVsbHB0cik7DQoJDQoJaW50IG4sbTtjaW4+Pm4+Pm07DQoJQnVpbGQoMSwxLG4pOw0KCWZvcihpbnQgaT0xO2k8PW07aSsrKXsNCgkJc3RyaW5nIHM7Y2luPj5zOw0KCQlpZihzPT0ibXVsIil7DQoJCQlpbnQgTCxSLHg7Y2luPj5MPj5SPj54Ow0KCQkJTXVsKDEsMSxuLEwsUix4LDEpOw0KCQl9ZWxzZQ0KCQlpZihzPT0iZGl2Iil7DQoJCQlpbnQgTCxSLHg7Y2luPj5MPj5SPj54Ow0KCQkJVHJlZSBjPVF1ZXJ5KDEsMSxuLEwsUik7DQoJCQlib29sIGZsZz0wOw0KCQkJZm9yKGludCBpPTAseT14O2k8MTA7aSsrKXsNCgkJCQlpbnQgY250PTA7DQoJCQkJd2hpbGUoeSVwcmltZVtpXT09MCkgeS89cHJpbWVbaV0sY250Kys7DQoJCQkJaWYoKGMubGR0JiZjLmxkW2ldPGNudCl8fChjLnVsdCYmYy51bFtpXTxjbnQpKXtmbGc9MTticmVhazt9DQoJCQl9DQoJCQlpZihmbGcpe2NvdXQ8PCJOT1xuIjtjb250aW51ZTt9DQoJCQljb3V0PDwiWUVTXG4iOw0KCQkJTXVsKDEsMSxuLEwsUix4LC0xKTsNCgkJfWVsc2UNCgkJaWYocz09ImZsaXAiKXsNCgkJCWludCB4O2Npbj4+eDsNCgkJCWZsaXAoMSwxLG4seCk7DQoJCX0NCgl9DQoJcmV0dXJuIDA7DQp9"}]