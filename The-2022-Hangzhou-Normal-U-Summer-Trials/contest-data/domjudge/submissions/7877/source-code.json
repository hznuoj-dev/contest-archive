[{"id":"7881","submission_id":"7877","filename":"G.cpp","source":"I2luY2x1ZGU8Yml0cy9zdGRjKysuaD4NCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQpjb25zdCBpbnQgTUFYTj0xZTUrNTsNCmNvbnN0IGludCBwcmltZVsxMF09ezIsMyw1LDcsMTEsMTMsMTcsMTksMjMsMjl9Ow0Kc3RydWN0IFRyZWV7DQoJaW50IHVsWzEwXSxsZFsxMF07Ym9vbCB1bHQsbGR0Ow0KCVRyZWUoKXttZW1zZXQodWwsMCxzaXplb2YodWwpKTttZW1zZXQobGQsMCxzaXplb2YobGQpKTt9DQoJVHJlZSBvcGVyYXRvciArKFRyZWUgeSl7DQoJCVRyZWUgejsNCgkJZm9yKGludCBpPTA7aTwxMDtpKyspew0KCQkJei51bFtpXT11bFtpXSt5LnVsW2ldOw0KCQkJei5sZFtpXT1sZFtpXTsNCgkJfQ0KCQl6LnVsdD11bHQ7DQoJCXoubGR0PWxkdDsNCgkJcmV0dXJuIHo7DQoJfQ0KCVRyZWUgb3BlcmF0b3IgLShUcmVlIHkpew0KCQlUcmVlIHo7DQoJCWZvcihpbnQgaT0wO2k8MTA7aSsrKXsNCgkJCXoudWxbaV09dWxbaV0teS51bFtpXTsNCgkJCXoubGRbaV09bGRbaV07DQoJCX0NCgkJei51bHQ9dWx0Ow0KCQl6LmxkdD1sZHQ7DQoJCXJldHVybiB6Ow0KCX0NCn1UcmVbTUFYTjw8Ml0sQWRkW01BWE48PDJdOw0KVHJlZSBfbWluKFRyZWUgeCxUcmVlIHkpew0KCVRyZWUgejsNCglmb3IoaW50IGk9MDtpPDEwO2krKyl7DQoJCXoudWxbaV09bWluKHgudWxbaV0seS51bFtpXSk7DQoJCXoubGRbaV09bWluKHgubGRbaV0seS5sZFtpXSk7DQoJfQ0KCXoudWx0PXgudWx0fHkudWx0Ow0KCXoubGR0PXgubGR0fHkubGR0Ow0KCXJldHVybiB6Ow0KfQ0Kdm9pZCBQdXNoVXAoaW50IHJ0KXtUcmVbcnRdPV9taW4oVHJlW3J0PDwxXSxUcmVbcnQ8PDF8MV0pO30NCnZvaWQgUHVzaERvd24oaW50IHJ0KXsNCglpZihUcmVbcnQ8PDFdLnVsdD09MSkgVHJlW3J0PDwxXT1UcmVbcnQ8PDFdK0FkZFtydF0sQWRkW3J0PDwxXT1BZGRbcnQ8PDFdK0FkZFtydF07DQoJaWYoVHJlW3J0PDwxfDFdLnVsdD09MSkgVHJlW3J0PDwxfDFdPVRyZVtydDw8MXwxXStBZGRbcnRdLEFkZFtydDw8MXwxXT1BZGRbcnQ8PDF8MV0rQWRkW3J0XTsNCgltZW1zZXQoQWRkW3J0XS51bCwwLHNpemVvZihBZGRbcnRdLnVsKSk7DQp9DQp2b2lkIE11bChpbnQgcnQsaW50IEwsaW50IFIsaW50IGwsaW50IHIsaW50IHgsaW50IGYpew0KCWlmKGw8PUwmJlI8PXIpew0KCQlmb3IoaW50IGk9MDtpPDEwO2krKyl7DQoJCQl3aGlsZSh4JXByaW1lW2ldPT0wKXsNCgkJCQlUcmVbcnRdLnVsW2ldKz1mOw0KCQkJCUFkZFtydF0udWxbaV0rPWY7DQoJCQkJeC89cHJpbWVbaV07DQoJCQl9DQoJCX0NCgkJcmV0dXJuOw0KCX0NCglQdXNoRG93bihydCk7DQoJaW50IG1pZD0oUitMKT4+MTsNCglpZihsPD1taWQpIE11bChydDw8MSxMLG1pZCxsLHIseCxmKTsNCglpZihyPm1pZCkgTXVsKHJ0PDwxfDEsbWlkKzEsUixsLHIseCxmKTsNCglQdXNoVXAocnQpOw0KfQ0Kdm9pZCBmbGlwKGludCBydCxpbnQgTCxpbnQgUixpbnQgcCl7DQoJaWYoTD09Uil7DQoJCWlmKFRyZVtydF0udWx0PT0xKXsNCgkJCWZvcihpbnQgaT0wO2k8MTA7aSsrKXsNCgkJCQlUcmVbcnRdLmxkW2ldPVRyZVtydF0udWxbaV07DQoJCQkJVHJlW3J0XS51bFtpXT0wOw0KCQkJfQ0KCQl9ZWxzZXsNCgkJCWZvcihpbnQgaT0wO2k8MTA7aSsrKXsNCgkJCQlUcmVbcnRdLnVsW2ldPVRyZVtydF0ubGRbaV07DQoJCQkJVHJlW3J0XS5sZFtpXT0wOw0KCQkJfQ0KCQl9DQoJCVRyZVtydF0udWx0Xj0xOw0KCQlUcmVbcnRdLmxkdF49MTsNCgkJcmV0dXJuIDsNCgl9DQoJaW50IG1pZD0oUitMKT4+MTtQdXNoRG93bihydCk7DQoJaWYocDw9bWlkKSBmbGlwKHJ0PDwxLEwsbWlkLHApOw0KCWVsc2UgZmxpcChydDw8MXwxLG1pZCsxLFIscCk7DQoJUHVzaFVwKHJ0KTsNCn0NClRyZWUgUXVlcnkoaW50IHJ0LGludCBMLGludCBSLGludCBsLGludCByKXsNCglpZihsPD1MJiZSPD1yKSByZXR1cm4gVHJlW3J0XTsNCglpbnQgbWlkPShSK0wpPj4xO1B1c2hEb3duKHJ0KTsNCglpZihyPD1taWQpIHJldHVybiBRdWVyeShydDw8MSxMLG1pZCxsLHIpO2Vsc2UNCglpZihsPm1pZCkgcmV0dXJuIFF1ZXJ5KHJ0PDwxfDEsbWlkKzEsUixsLHIpO2Vsc2UNCglyZXR1cm4gUXVlcnkocnQ8PDEsTCxtaWQsbCxyKStRdWVyeShydDw8MXwxLG1pZCsxLFIsbCxyKTsNCn0NCnZvaWQgQnVpbGQoaW50IHJ0LGludCBMLGludCBSKXsNCglpZihMPT1SKXsNCgkJVHJlW3J0XS51bHQ9MTsNCgkJVHJlW3J0XS5sZHQ9MDsNCgkJcmV0dXJuOw0KCX0NCglpbnQgbWlkPShSK0wpPj4xOw0KCUJ1aWxkKHJ0PDwxLEwsbWlkKTtCdWlsZChydDw8MXwxLG1pZCsxLFIpOw0KCVB1c2hVcChydCk7DQp9DQppbnQgbWFpbigpew0KCWlvczo6c3luY193aXRoX3N0ZGlvKGZhbHNlKTsNCgljaW4udGllKG51bGxwdHIpO2NvdXQudGllKG51bGxwdHIpOw0KCQ0KCWludCBuLG07Y2luPj5uPj5tOw0KCUJ1aWxkKDEsMSxuKTsNCglmb3IoaW50IGk9MTtpPD1tO2krKyl7DQoJCXN0cmluZyBzO2Npbj4+czsNCgkJaWYocz09Im11bCIpew0KCQkJaW50IEwsUix4O2Npbj4+TD4+Uj4+eDsNCgkJCU11bCgxLDEsbixMLFIseCwxKTsNCgkJfWVsc2UNCgkJaWYocz09ImRpdiIpew0KCQkJaW50IEwsUix4O2Npbj4+TD4+Uj4+eDsNCgkJCVRyZWUgYz1RdWVyeSgxLDEsbixMLFIpOw0KCQkJYm9vbCBmbGc9MDsNCgkJCWZvcihpbnQgaT0wLHk9eDtpPDEwO2krKyl7DQoJCQkJaW50IGNudD0wOw0KCQkJCXdoaWxlKHklcHJpbWVbaV09PTApIHkvPXByaW1lW2ldLGNudCsrOw0KCQkJCWlmKChjLmxkdCYmYy5sZFtpXTxjbnQpfHwoYy51bHQmJmMudWxbaV08Y250KSl7ZmxnPTE7YnJlYWs7fQ0KCQkJfQ0KCQkJaWYoZmxnKXtjb3V0PDwiTk9cbiI7Y29udGludWU7fQ0KCQkJY291dDw8IllFU1xuIjsNCgkJCU11bCgxLDEsbixMLFIseCwtMSk7DQoJCX1lbHNlDQoJCWlmKHM9PSJmbGlwIil7DQoJCQlpbnQgeDtjaW4+Png7DQoJCQlmbGlwKDEsMSxuLHgpOw0KCQl9DQoJfQ0KCXJldHVybiAwOw0KfQ=="}]