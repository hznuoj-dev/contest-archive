[{"id":"8003","submission_id":"7999","filename":"K.cpp","source":"I2luY2x1ZGUgPGlvc3RyZWFtPg0KI2luY2x1ZGUgPGNzdGRpbz4NCiNpbmNsdWRlIDxjc3RkbGliPg0KI2luY2x1ZGUgPGFsZ29yaXRobT4NCiNpbmNsdWRlIDxjbWF0aD4NCiNpbmNsdWRlIDxjc3RyaW5nPg0KI2luY2x1ZGUgPHN0cmluZz4NCiNpbmNsdWRlIDx2ZWN0b3I+DQojaW5jbHVkZSA8c3RhY2s+DQojaW5jbHVkZSA8cXVldWU+DQojaW5jbHVkZSA8c2V0Pg0KI2luY2x1ZGUgPG1hcD4NCiNpbmNsdWRlIDxudW1lcmljPg0KI2luY2x1ZGUgPGJpdHNldD4NCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQojZGVmaW5lIElORiAweDNjM2MzYzNjIC8vIDEwMTA1ODA1NDAsIDdmN2Y3ZjdmOjIxMzkwNjIxNDMNCiNkZWZpbmUgbGxJTkYgOTIyMzM3MjAzNjg1NDc3NTgwNw0KY29uc3QgZG91YmxlIFBJID0gYWNvcygtMS4wKTsNCmNvbnN0IGRvdWJsZSBlcHMgPSAxZS02Ow0KdXNpbmcgbGwgPSBsb25nIGxvbmc7DQp1c2luZyB1bGwgPSB1bnNpZ25lZCBsb25nIGxvbmc7DQp1c2luZyBkYiA9IGRvdWJsZTsNCnVzaW5nIGxkID0gbG9uZyBkb3VibGU7DQp1c2luZyBwaWkgPSBwYWlyPGludCwgaW50PjsNCnVzaW5nIHBsbCA9IHBhaXI8bGwsIGxsPjsNCiNkZWZpbmUgZmkgZmlyc3QNCiNkZWZpbmUgc2Ugc2Vjb25kDQojZGVmaW5lIHBiIHB1c2hfYmFjaw0KI2RlZmluZSBlbmRsICdcbicNCiNkZWZpbmUgZGJnKGEpIGNvdXQgPDwgI2EgPDwgIiA9ICIgPDwgKGEpIDw8ICdcbic7DQojZGVmaW5lIGFsbChjKSAoYykuYmVnaW4oKSwgKGMpLmVuZCgpDQojZGVmaW5lIElPUyBpb3M6OnN5bmNfd2l0aF9zdGRpbygwKTsgY2luLnRpZSgwKTsgY291dC50aWUoMCk7DQoNCnR5cGVkZWYgcGFpcjxkb3VibGUsIGludD4gcGRpOw0KDQpjb25zdCBpbnQgTiA9IDNlMyArIDEwOw0KDQppbnQgdls2XTsNCg0KZG91YmxlIGRpc1tOXTsNCmJvb2wgdmlzW05dOw0Kc3RydWN0IHBvaW50ew0KICAgIGludCB4LCB5LCB0Ow0KfXBbTl07DQoNCmRvdWJsZSBnZXRkaXMocG9pbnQmIGEsIHBvaW50ICZiKXsNCiAgICByZXR1cm4gc3FydChkb3VibGUoYS54IC0gYi54KSAqIChhLnggLSBiLngpICsgKGEueSAtIGIueSkgKiAoYS55IC0gYi55KSk7DQp9DQoNCmludCBtYWluKCl7DQogICAgSU9TDQogICAgaW50IG47DQogICAgY2luID4+IG47DQogICAgZm9yKGludCBpID0gMTsgaSA8PSA0OyBpKyspIGNpbiA+PiB2W2ldOw0KICAgIGNpbiA+PiB2WzBdOw0KICAgIGludCBzLCB0Ow0KICAgIGNpbiA+PiBzID4+IHQ7DQogICAgZm9yKGludCBpID0gMTsgaSA8PSBuOyBpKyspew0KICAgICAgICBjaW4gPj4gcFtpXS54ID4+IHBbaV0ueTsNCiAgICAgICAgaWYocFtpXS54ID4gMCAmJiBwW2ldLnkgPiAwKSBwW2ldLnQgPSAxOw0KICAgICAgICBlbHNlIGlmKHBbaV0ueCA8IDAgJiYgcFtpXS55ID4gMCkgcFtpXS50ID0gMjsNCiAgICAgICAgZWxzZSBpZihwW2ldLnggPCAwICYmIHBbaV0ueSA8IDApIHBbaV0udCA9IDM7DQogICAgICAgIGVsc2UgaWYocFtpXS54ID4gMCAmJiBwW2ldLnkgPCAwKSBwW2ldLnQgPSA0Ow0KICAgICAgICBkaXNbaV0gPSBJTkY7DQogICAgfQ0KICAgIHByaW9yaXR5X3F1ZXVlPHBkaSwgdmVjdG9yPHBkaT4sIGdyZWF0ZXI8cGRpPj4gcTsNCiAgICBxLnB1c2goezAsIHN9KTsNCiAgICB3aGlsZSghcS5lbXB0eSgpKXsNCiAgICAgICAgZG91YmxlIGQgPSBxLnRvcCgpLmZpcnN0Ow0KICAgICAgICBpbnQgdSA9IHEudG9wKCkuc2Vjb25kOw0KICAgICAgICBxLnBvcCgpOw0KICAgICAgICBpZih2aXNbdV0pIGNvbnRpbnVlOw0KICAgICAgICB2aXNbdV0gPSAxOw0KICAgICAgICBmb3IoaW50IGkgPSAxOyBpIDw9IG47IGkrKyl7DQogICAgICAgICAgICBpZighdmlzW2ldKXsNCiAgICAgICAgICAgICAgICBkb3VibGUgZGlzdCA9IGdldGRpcyhwW3VdLCBwW2ldKTsNCiAgICAgICAgICAgICAgICBpZihwW3VdLnQgPT0gcFtpXS50KXsNCiAgICAgICAgICAgICAgICAgICAgaWYoZGlzW2ldID4gZCArIChkaXN0IC8gKGRvdWJsZSl2W3BbaV0udF0pKXsNCiAgICAgICAgICAgICAgICAgICAgICAgIGRpc1tpXSA9IGQgKyAoZGlzdCAvIChkb3VibGUpdltwW2ldLnRdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHEucHVzaCh7ZGlzW2ldLCBpfSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZWxzZXsNCiAgICAgICAgICAgICAgICAgICAgaWYoZGlzW2ldID4gZCArIChkaXN0IC8gKGRvdWJsZSl2WzBdKSl7DQogICAgICAgICAgICAgICAgICAgICAgICBkaXNbaV0gPSBkICsgKGRpc3QgLyAoZG91YmxlKXZbMF0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgcS5wdXNoKHtkaXNbaV0sIGl9KTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCiAgICBwcmludGYoIiUuMTBsZlxuIiwgZGlzW3RdKTsNCiAgICByZXR1cm4gMDsNCn0="}]