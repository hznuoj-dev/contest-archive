[{"id":"8857","submission_id":"8853","filename":"grs2.cpp","source":"I2luY2x1ZGU8Yml0cy9zdGRjKysuaD4NCiNkZWZpbmUgcnNvbiBydDw8MXwxDQojZGVmaW5lIGxzb24gcnQ8PDENCiNkZWZpbmUgcGIgcHVzaF9iYWNrDQojZGVmaW5lIGVuZGwgJ1xuJw0KI2RlZmluZSB4IGZpcnN0DQojZGVmaW5lIHkgc2Vjb25kDQojZGVmaW5lIExMSU5GIDkyMjMzNzIwMzY4NTQ3NzU4MDcNCiNkZWZpbmUgSU9TIGlvczo6c3luY193aXRoX3N0ZGlvKDApOyBjaW4udGllKDApOyBjb3V0LnRpZSgwKTsNCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQp0eXBlZGVmIGxvbmcgbG9uZyBsbDsNCnR5cGVkZWYgdW5zaWduZWQgbG9uZyBsb25nIHVsbDsNCnR5cGVkZWYgcGFpcjxpbnQsaW50PiBwaWk7DQp0eXBlZGVmIHBhaXI8ZG91YmxlLGRvdWJsZT4gcGRkOw0KDQpjb25zdCBpbnQgTj0zMDMwOw0KDQp2ZWN0b3I8cGRkPmdbTl07DQpkb3VibGUgZGlzdFtOXTsNCmRvdWJsZSB2W05dOw0KYm9vbCBzdFtOXTsNCmRvdWJsZSB4W05dLHlbTl07DQppbnQgbjsNCg0KaW50IGZyKGludCB4LGludCB5KXsNCiAgICBpZih4Pj0xJiZ5Pj0xKXJldHVybiAxOw0KICAgIGlmKHg8PS0xJiZ5Pj0xKXJldHVybiAyOw0KICAgIGlmKHg8PS0xJiZ5PD0tMSlyZXR1cm4gMzsNCiAgICBpZih4Pj0xJiZ5PD0tMSlyZXR1cm4gNDsNCiAgICByZXR1cm4gMDsNCn0NCg0Kdm9pZCBkaWooaW50IHMpew0KICAgIGZvcihpbnQgaT0xO2k8PW47aSsrKXsNCiAgICAgICAgZGlzdFtpXT0xZTE1Ow0KICAgIH0NCiAgICBkaXN0W3NdPTA7DQogICAgcHJpb3JpdHlfcXVldWU8cGRkLHZlY3RvcjxwZGQ+LGdyZWF0ZXI8cGRkPj5xOw0KICAgIHEucHVzaCh7MCxzfSk7DQogICAgd2hpbGUocS5zaXplKCkpew0KICAgICAgICBhdXRvIHc9cS50b3AoKTsNCiAgICAgICAgcS5wb3AoKTsNCiAgICAgICAgaW50IGk9dy55Ow0KICAgICAgICBpZihzdFtpXSljb250aW51ZTsNCiAgICAgICAgc3RbaV09MTsNCiAgICAgICAgZm9yKGF1dG8gbm93OmdbaV0pew0KICAgICAgICAgICAgZG91YmxlIHc9bm93Lnk7DQogICAgICAgICAgICBpbnQgaj1ub3cueDsNCiAgICAgICAgICAgIGlmKGRpc3Rbal0+ZGlzdFtpXSt3KXsNCiAgICAgICAgICAgICAgICBkaXN0W2pdPWRpc3RbaV0rdzsNCiAgICAgICAgICAgICAgICBxLnB1c2goe2Rpc3Rbal0san0pOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KfQ0KDQppbnQgbWFpbigpDQp7ICANCiAgICBJT1MNCiAgICBjaW4+Pm47DQogICAgZm9yKGludCBpPTE7aTw9NDtpKyspew0KICAgICAgICBjaW4+PnZbaV07DQogICAgfQ0KICAgIGNpbj4+dlswXTsNCiAgICBpbnQgcyx0Ow0KICAgIGNpbj4+cz4+dDsNCiAgICBmb3IoaW50IGk9MTtpPD1uO2krKyl7DQogICAgICAgIGNpbj4+eFtpXT4+eVtpXTsNCiAgICB9DQogICAgZm9yKGludCBpPTE7aTw9bjtpKyspew0KICAgICAgICBmb3IoaW50IGo9aSsxO2o8PW47aisrKXsNCiAgICAgICAgICAgIGludCBhPWZyKHhbaV0seVtpXSk7DQogICAgICAgICAgICBpbnQgYj1mcih4W2pdLHlbal0pOw0KICAgICAgICAgICAgZG91YmxlIGRpcz1zcXJ0KCh4W2ldLXhbal0pKih4W2ldLXhbal0pKyh5W2ldLXlbal0pKih5W2ldLXlbal0pKTsNCiAgICAgICAgICAgIGlmKGE9PWIpew0KICAgICAgICAgICAgICAgIGdbaV0ucGIoe2osZGlzL3ZbYV19KTsNCiAgICAgICAgICAgICAgICBnW2pdLnBiKHtpLGRpcy92W2FdfSk7DQogICAgICAgICAgICB9ZWxzZSB7DQogICAgICAgICAgICAgICAgZ1tpXS5wYih7aixkaXMvdlswXX0pOw0KICAgICAgICAgICAgICAgIGdbal0ucGIoe2ksZGlzL3ZbMF19KTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCiAgICBkaWoocyk7DQogICAgY291dDw8ZGlzdFt0XTsNCiAgICByZXR1cm4gMDsNCn0="}]