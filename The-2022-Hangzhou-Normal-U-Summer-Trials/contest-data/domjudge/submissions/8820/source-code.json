[{"id":"8824","submission_id":"8820","filename":"a16.cpp","source":"I2luY2x1ZGU8aW9zdHJlYW0+DQojaW5jbHVkZTxhbGdvcml0aG0+DQojaW5jbHVkZTxjc3RkaW8+DQojaW5jbHVkZTxtYXRoLmg+DQojaW5jbHVkZTxzdHJpbmcuaD4NCiNpbmNsdWRlPHF1ZXVlPg0KdHlwZWRlZiBsb25nIGxvbmcgbGw7DQojZGVmaW5lIElORiAweDNmM2YzZjNmDQp1c2luZyBuYW1lc3BhY2Ugc3RkOw0KIA0KI2RlZmluZSBOIDIyMA0KIA0Kc3RydWN0IG5vZGUNCnsNCiAgICBpbnQgeCx5LHN0ZXA7DQp9Ow0KY2hhciBtYXBzW05dW05dOw0KaW50IGRpcls0XVsyXT17ey0xLDB9LHsxLDB9LHswLC0xfSx7MCwxfX07ICAgIC8vL7e9z/INCmludCB2aXNbTl1bTl07ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLy+x6rzH19+5/bXEDQppbnQgZGlzdDFbTl1bTl0sZGlzdDJbTl1bTl07ICAgICAgICAvLy9Zus1Ntb2497XjtcS+4MDro7sNCmludCBuLG0seXgseXksbXgsbXk7ICAgICAgICAgICAgICAgIC8vL1ksTbXExvDKvM671sMNCiANCnZvaWQgQkZTKGludCB4LGludCB5LGludCBkaXN0W11bTl0pICAvLy9CRlPU2tXiwO+1xNf308PKx6OssNGjqHgseaOptb2497XjtcTX7rbMvuDA67TmyOtkaXN0W11bXcr91+nW0KGjDQp7DQogICAgaW50IGk7DQogICAgbm9kZSBhLGI7DQogICAgcXVldWU8bm9kZT5ROw0KICAgIG1lbXNldCh2aXMsMCxzaXplb2YodmlzKSk7DQogICAgbWVtc2V0KGRpc3QsMCxzaXplb2YoZGlzdCkpOw0KICAgIGEueD14Ow0KICAgIGEueT15Ow0KICAgIGEuc3RlcD0wOw0KICAgIHZpc1t4XVt5XT0xOw0KICAgIFEucHVzaChhKTsNCiAgICB3aGlsZShRLnNpemUoKSkNCiAgICB7DQogICAgICAgIGEgPSBRLmZyb250KCk7DQogICAgICAgIGRpc3RbYS54XVthLnldPWEuc3RlcDsgIC8vL72rw7+0zrXEsr3K/bTmyOtkaXN0yv3X6Q0KICAgICAgICBRLnBvcCgpOw0KIA0KICAgICAgICBmb3IoaT0wOyBpPDQ7IGkrKykNCiAgICAgICAgew0KICAgICAgICAgICAgaW50IGR4LGR5Ow0KICAgICAgICAgICAgZHg9YS54K2RpcltpXVswXTsNCiAgICAgICAgICAgIGR5PWEueStkaXJbaV1bMV07DQogICAgICAgICAgICBpZihkeD49MCAmJiBkeT49MCAmJiBkeDxuICYmIGR5PG0gJiYgbWFwc1tkeF1bZHldIT0nKicgJiYgIXZpc1tkeF1bZHldKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGIueD1keDsNCiAgICAgICAgICAgICAgICBiLnk9ZHk7DQogICAgICAgICAgICAgICAgYi5zdGVwPWEuc3RlcCsxOw0KICAgICAgICAgICAgICAgIHZpc1tkeF1bZHldPTE7DQogICAgICAgICAgICAgICAgUS5wdXNoKGIpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KfQ0KIA0KaW50IG1haW4oKQ0Kew0KICAJY2luID4+IG47DQogICAgaW50IGksajsNCiAgICAgICAgZm9yKGk9MDtpPG47aSsrKQ0KICAgICAgICB7DQogICAgICAgICAgICBmb3Ioaj0wO2o8bjtqKyspDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgY2luPj5tYXBzW2ldW2pdOw0KICAgICAgICAgICAgICAgIGlmKG1hcHNbaV1bal09PSdhJykNCiAgICAgICAgICAgICAgICAgICAgeXg9aSx5eT1qOw0KICAgICAgICAgICAgICAgIGlmKG1hcHNbaV1bal09PSdiJykNCiAgICAgICAgICAgICAgICAgICAgbXg9aSxteT1qOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIEJGUyh5eCx5eSxkaXN0MSk7ICAgLy8vsNFZtb2497XjtcS+4MDrtObI62Rpc3QxW11bXdbQDQogICAgICAgIEJGUyhteCxteSxkaXN0Mik7ICAgLy8vsNFNtb2497XjtcS+4MDrtObI62Rpc3QyW11bXdbQDQogDQogICAgICAgIGludCBNaW49SU5GOw0KICAgICAgICBmb3IoaT0wO2k8bjtpKyspDQogICAgICAgIHsNCiAgICAgICAgICAgIGZvcihqPTA7ajxtO2orKykgICAgICAgICAgLy8vxdC2z8L61+PM9bz+tcRLRkOjrNfu0KHWtbTmyOtNaW4NCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBpZihkaXN0MVtpXVtqXSE9MCAmJiBkaXN0MltpXVtqXSE9MCAmJiBkaXN0MVtpXVtqXStkaXN0MltpXVtqXTxNaW4pICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgTWluPWRpc3QxW2ldW2pdK2Rpc3QyW2ldW2pdOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIHByaW50ZigiJWRcbiIsTWluKjExKTsNCiAgICByZXR1cm4gMDsNCn0NCi8qI2luY2x1ZGUgPGlvc3RyZWFtPg0KI2luY2x1ZGUgPHF1ZXVlPg0KdXNpbmcgbmFtZXNwYWNlIHN0ZDsNCnR5cGVkZWYgbG9uZyBsb25nIGxsOw0KaW50IHMxLGUxLHMyLGUyOw0Kc3RydWN0IE5vZGUgew0KCWludCB4LCB5Ow0KCU5vZGUoaW50IGE9MCwgaW50IGI9MCkgOngoYSksIHkoYikge30NCn07DQpOb2RlIG5vZGVbNTAwMV07DQogDQpjaGFyIEdbNTAwMV1bNTAwMV07DQpib29sIHZpc2l0ZWRbNTAwMV1bNTAwMV07DQogDQppbnQgZGlyWzRdWzJdID0ge3swLDF9LHsxLDB9LHswLC0xfSx7LTEsMH19Ow0KaW50IGRbNTAwMV1bNTAwMV07DQppbnQgZDJbNTAwMV1bNTAwMV07DQppbnQgbjsNCiANCmJvb2wgVmFsaWQoaW50IHgsIGludCB5KSB7DQoJaWYoeCA8IDEgfHwgeCA+IG4gfHwgeSA8IDEgfHwgeSA+IG4pIHJldHVybiBmYWxzZTsNCglpZihkW3hdW3ldICE9IC0xIHx8IEdbeF1beV0gPT0gJyonKSByZXR1cm4gZmFsc2U7DQoJcmV0dXJuIHRydWU7DQp9DQogYm9vbCBqdWRnZShpbnQgeCwgaW50IHkpIHsNCglpZih4IDwgMSB8fCB4ID4gbiB8fCB5IDwgMSB8fCB5ID4gbikgcmV0dXJuIGZhbHNlOw0KCWlmKGQyW3hdW3ldICE9IC0xIHx8IEdbeF1beV0gPT0gJyonKSByZXR1cm4gZmFsc2U7DQoJcmV0dXJuIHRydWU7DQp9DQp2b2lkIENsZWFyX0QoKSB7DQoJZm9yKGludCBpPTE7IGk8PW47IGkrKykNCgl7IAlmb3IoaW50IGo9MTsgajw9bjsgaisrKQ0KCQl7ICAJZFtpXVtqXSA9IC0xOw0KCQkgICAgZDJbaV1bal0gPSAtMTsNCgkJfQ0KCX0NCgkNCgkJDQoJcmV0dXJuOw0KfQ0KaW50IGFucz0wOw0Kdm9pZCBiZnMoKSB7DQoJcXVldWU8Tm9kZT4gUSxRMjsNCglRLnB1c2goTm9kZShzMSwgZTEpKTsNCglRMi5wdXNoKE5vZGUoczIsIGUyKSk7DQoJQ2xlYXJfRCgpOw0KCWRbczFdW2UxXSA9IDA7DQoJZDJbczJdW2UyXSA9IDA7DQoJd2hpbGUoIVEuZW1wdHkoKSkgew0KCQlOb2RlIGs9US5mcm9udCgpOw0KCQlRLnBvcCgpOw0KCQlOb2RlIHE9UTIuZnJvbnQoKTsNCgkJUTIucG9wKCk7DQoJCWZvcihpbnQgaT0wOyBpPDQ7IGkrKykgew0KCQkJaW50IG5leHRfeCA9IGsueCArIGRpcltpXVswXTsNCgkJCWludCBuZXh0X3kgPSBrLnkgKyBkaXJbaV1bMV07DQoJCQlpbnQgbng9cS54ICsgZGlyW2ldWzBdOw0KCQkJaW50IG55PXEueSArIGRpcltpXVsxXTsNCgkJIAkJaWYoR1tuZXh0X3hdW25leHRfeV09PScqJ3x8bmV4dF94IDwgMSB8fCBuZXh0X3ggPiBuIHx8IG5leHRfeSA8IDEgfHwgbmV4dF95ID4gbikNCgkJIAkJeyAgIGRbbmV4dF94XVtuZXh0X3ldPWRbay54XVtrLnldOw0KCQkgCQkgICAgbmV4dF94PWsueDsNCgkJIAkJICAgIG5leHRfeT1rLnk7DQoJCQkJfQ0KCQkJCWVsc2UgDQoJCQkJeyAgICAgZFtuZXh0X3hdW25leHRfeV09ZFtrLnhdW2sueV0rMTsNCgkJCQl9DQoJCSAJaWYoR1tueF1bbnldPT0nKid8fG54IDwgMSB8fCBueCA+IG4gfHwgbnkgPCAxIHx8IG55ID4gbikNCgkJIAl7ICAgCWQyW254XVtueV0gPSBkMltxLnhdW3EueV07DQoJCSAJICAgICAgICBueD1xLng7DQoJCSAJICAgICAgICBueT1xLnk7DQoJCQkgfQ0KCQkJIGVsc2UgDQoJCQkgeyAgCQlkMltueF1bbnldID0gZDJbcS54XVtxLnldICsgMTsNCgkJCSB9DQoJCQkJaWYobng9PW5leHRfeCYmbnk9PW5leHRfeSkNCgkJCQl7ICBhbnM9bWluKGFucyxkW25leHRfeF1bbmV4dF95XStkMltueF1bbnldKTsNCgkJCQl9DQoJCQkJUS5wdXNoKE5vZGUobmV4dF94LCBuZXh0X3kpKTsNCgkJCQlRMi5wdXNoKE5vZGUobngsIG55KSk7DQoJCX0NCgl9DQogDQp9DQogDQppbnQgbWFpbigpIHsNCgljaW4gPj4gbjsNCglmb3IoaW50IGk9MTsgaTw9bjsgaSsrKQ0KCXsgICANCgkJZm9yKGludCBqPTE7IGo8PW47IGorKykNCgkJIHsgIAljaW4gPj4gR1tpXVtqXTsNCgkJICAgaWYoR1tpXVtqXT09J2EnKQ0KCQkgICAgeyAgczE9aTsNCgkJICAgICAgIGUxPWo7DQoJCQl9DQoJCSBpZihHW2ldW2pdPT0nYicpDQoJCSAgICB7ICBzMj1pOw0KCQkgICAgICAgZTI9ajsNCgkJCX0NCgkJIH0NCgkJDQoJfQ0KCWJmcygpOw0KCWlmKGFucz09MCkNCgl7IGNvdXQ8PCJubyBzb2x1dGlvbiI8PGVuZGw7DQoJfQ0KCWVsc2UgDQogICAgY291dDw8YW5zPDxlbmRsOw0KCXJldHVybiAwOw0KfSovDQo="}]