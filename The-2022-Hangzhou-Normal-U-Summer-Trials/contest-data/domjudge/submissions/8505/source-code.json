[{"id":"8509","submission_id":"8505","filename":"c3.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+DQoNCiNkZWZpbmUgbGwgbG9uZyBsb25nDQojZGVmaW5lIFBJSSBwYWlyPGxsLCBpbnQ+DQojZGVmaW5lIGRiZyh4KSBjZXJyIDw8ICN4IDw8ICIgPSAiIDw8IHggPDwgZW5kbDsNCg0KdXNpbmcgbmFtZXNwYWNlIHN0ZDsgDQoNCmNvbnN0IGludCBOID0gMWU1ICsgMTA7DQpjb25zdCBpbnQgSU5GID0gMHgzZjNmM2YzZjsgICAgICAgICAvLyAxMDYxMTA5NTY3DQpjb25zdCBsbCBJTkZGID0gMHgzZjNmM2YzZjNmM2YzZjNmOyAvLyA0NTU3NDMwODg4Nzk4ODMwMzk5DQpjb25zdCBkb3VibGUgZXNwID0gMWUtOCwgcGkgPSBhY29zKC0xLjApOw0KY29uc3QgaW50IE1PRCA9IDk5ODI0NDM1MzsNCg0KbGwgcW1pKGludCBhLCBpbnQgYikNCnsNCiAgICBsbCByZXQgPSAxICUgTU9EOw0KICAgIHdoaWxlIChiKQ0KICAgIHsNCiAgICAgICAgaWYgKGIgJiAxKSByZXQgPSByZXQgKiAobGwpYSAlIE1PRDsNCg0KICAgICAgICBhID0gYSAqIChsbClhICUgTU9EOw0KICAgICAgICBiID4+PSAxOw0KICAgIH0NCiAgICANCiAgICByZXR1cm4gcmV0Ow0KfQ0KDQppbnQgZ2NkKGludCBhLCBpbnQgYikNCnsNCiAgICByZXR1cm4gYiA/IGdjZChiLCBhICUgYikgOiBhOw0KfQ0KDQppbnQgbG93Yml0KGludCB4KQ0Kew0KICAgIHJldHVybiB4ICYgLXg7DQp9DQoNCi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vIA0KDQppbnQgbiwgbTsNCmNoYXIgZ1s2MF1bNjBdOw0KYm9vbCBzdGFbNjBdWzYwXSwgc3RiWzYwXVs2MF0sIHN0WzYwXVs2MF07DQpib29sIHZpc1s2MF1bNjBdWzYwXVs2MF07DQpQSUkgc2EsIHNiOw0KaW50IHJldCA9IElORjsNCmludCBjbnRbNjBdWzYwXTsNCmludCBkeFtdID0gezEsIDAsIC0xLCAwfSwgZHlbXSA9IHswLCAtMSwgMCwgMX07DQoNCnZvaWQgYmZzKCkNCnsNCiAgICBxdWV1ZTxwYWlyPFBJSSwgaW50Pj4gcWEsIHFiOw0KICAgIHFhLnB1c2goe3NhLCAwfSk7DQogICAgcWIucHVzaCh7c2IsIDB9KTsNCiAgICB2aXNbc2EuZmlyc3RdW3NhLnNlY29uZF1bc2IuZmlyc3RdW3NiLnNlY29uZF0gPSB0cnVlOw0KDQogICAgZm9yIChpbnQgaiA9IDA7IGogPCAxMDAwMDAwICYmIHFhLnNpemUoKSAmJiBxYi5zaXplKCk7IGogKysgKQ0KICAgIHsNCiAgICAgICAgYXV0byB0YSA9IHFhLmZyb250KCk7IHFhLnBvcCgpOw0KICAgICAgICBhdXRvIHRiID0gcWIuZnJvbnQoKTsgcWIucG9wKCk7DQoNCiAgICAgICAgaW50IGF4ID0gdGEuZmlyc3QuZmlyc3QsIGF5ID0gdGEuZmlyc3Quc2Vjb25kOw0KICAgICAgICBpbnQgYnggPSB0Yi5maXJzdC5maXJzdCwgYnkgPSB0Yi5maXJzdC5zZWNvbmQ7DQoNCiAgICAgICAgaWYgKGF4ID09IGJ4ICYmIGF5ID09IGJ5KQ0KICAgICAgICB7DQogICAgICAgICAgICByZXQgPSBtaW4ocmV0LCB0YS5zZWNvbmQpOw0KICAgICAgICAgICAgLy9kYmcoaik7DQogICAgICAgICAgICAvL2RiZyhyZXQpOw0KICAgICAgICAgICAgY29udGludWU7DQogICAgICAgIH0NCg0KICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IDQ7IGkgKysgKQ0KICAgICAgICB7DQogICAgICAgICAgICBpbnQgdGF4ID0gYXggKyBkeFtpXSwgdGF5ID0gYXkgKyBkeVtpXTsNCiAgICAgICAgICAgIGludCB0YnggPSBieCArIGR4W2ldLCB0YnkgPSBieSArIGR5W2ldOw0KDQogICAgICAgICAgICBpZiAoIXRheCkgdGF4ID0gMTsNCiAgICAgICAgICAgIGlmICghdGF5KSB0YXkgPSAxOw0KICAgICAgICAgICAgaWYgKCF0YngpIHRieCA9IDE7DQogICAgICAgICAgICBpZiAoIXRieSkgdGJ5ID0gMTsNCg0KICAgICAgICAgICAgaWYgKHRheCA+IG4pIHRheCA9IG47DQogICAgICAgICAgICBpZiAodGF5ID4gbikgdGF5ID0gbjsNCiAgICAgICAgICAgIGlmICh0YnggPiBuKSB0YnggPSBuOw0KICAgICAgICAgICAgaWYgKHRieSA+IG4pIHRieSA9IG47ICAgICAgICAgICANCg0KICAgICAgICAgICAgaWYgKGdbdGF4XVt0YXldID09ICcqJykNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICB0YXggPSBheDsNCiAgICAgICAgICAgICAgICB0YXkgPSBheTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmIChnW3RieF1bdGJ5XSA9PSAnKicpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgdGJ4ID0gYng7DQogICAgICAgICAgICAgICAgdGJ5ID0gYnk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmICghdmlzW3RheF1bdGF5XVt0YnhdW3RieV0pDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgcWEucHVzaCh7e3RheCwgdGF5fSwgdGEuc2Vjb25kICsgMX0pOw0KICAgICAgICAgICAgICAgIHFiLnB1c2goe3t0YngsIHRieX0sIHRiLnNlY29uZCArIDF9KTsNCiAgICAgICAgICAgICAgICB2aXNbdGF4XVt0YXldW3RieF1bdGJ5XSA9IHRydWU7DQogICAgICAgICAgICAgICAgLy9kYmcodGF4KTtkYmcodGF5KTsNCiAgICAgICAgICAgICAgICAvL2RiZyh0YngpO2RiZyh0YnkpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICAvL3FhLnB1c2goe3t0YXgsIHRheX0sIHRhLnNlY29uZCArIDF9KTsNCiAgICAgICAgICAgIC8vcWIucHVzaCh7e3RieCwgdGJ5fSwgdGIuc2Vjb25kICsgMX0pOw0KICAgICAgICB9DQogICAgfQ0KDQp9DQoNCi8qYm9vbCBjaGVjaygpDQp7DQogICAgcXVldWU8UElJPiBxOw0KICAgIC8vcWEucHVzaChzYSk7DQogICAgLy9xYi5wdXNoKHNiKTsNCiAgICBzdFtzYi5maXJzdF1bc2Iuc2Vjb25kXSA9IHRydWU7DQogICAgcS5wdXNoKHNiKTsNCg0KICAgIHdoaWxlIChxLnNpemUoKSkNCiAgICB7DQogICAgICAgIGF1dG8gdCA9IHEuZnJvbnQoKTsgcS5wb3AoKTsNCiAgICAgICAgaW50IHggPSB0LmZpcnN0LCB5ID0gdC5zZWNvbmQ7DQoNCiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCA0OyBpICsrICkNCiAgICAgICAgew0KICAgICAgICAgICAgaW50IHR4ID0geCArIGR4W2ldLCB0eSA9IHkgKyBkeVtpXTsNCiAgICAgICAgICAgIGlmICh0eCA9PSBzYS5maXJzdCAmJiB0eSA9PSBzYS5zZWNvbmQpIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgaWYgKHR4ID49IDEgJiYgdHggPD0gbiAmJiB0eSA+PSAxICYmIHR5IDw9IG4gJiYgIXN0W3R4XVt0eV0gJiYgZ1t0eF1bdHldID09ICcuJykNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBzdFt0eF1bdHldID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICBxLnB1c2goe3R4LCB0eX0pOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KDQogICAgcmV0dXJuIGZhbHNlOw0KICAgIA0KfSovDQoNCnZvaWQgc29sdmUoKQ0Kew0KICAgIGNpbiA+PiBuOw0KICAgIGZvciAoaW50IGkgPSAxOyBpIDw9IG47IGkgKysgKQ0KICAgIHsNCiAgICAgICAgZm9yIChpbnQgaiA9IDE7IGogPD0gbjsgaiArKyApDQogICAgICAgIHsNCiAgICAgICAgICAgIGNpbiA+PiBnW2ldW2pdOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgZm9yIChpbnQgaSA9IDE7IGkgPD0gbjsgaSArKyApDQogICAgew0KICAgICAgICBmb3IgKGludCBqID0gMTsgaiA8PSBuOyBqICsrICkNCiAgICAgICAgew0KICAgICAgICAgICAgaWYgKGdbaV1bal0gPT0gJ2EnKSBzYSA9IHtpLCBqfTsNCiAgICAgICAgICAgIGlmIChnW2ldW2pdID09ICdiJykgc2IgPSB7aSwgan07DQogICAgICAgIH0NCiAgICB9DQogICAgDQogICAgYmZzKCk7DQoNCiAgICBpZiAocmV0ID09IElORikgY291dCA8PCAibm8gc29sdXRpb24iIDw8IGVuZGw7DQogICAgZWxzZSBjb3V0IDw8IHJldCA8PCBlbmRsOw0KfQ0KDQppbnQgbWFpbigpDQp7DQogICAgaW9zOjpzeW5jX3dpdGhfc3RkaW8oMCk7DQoNCiAgICBpbnQgVCA9IDE7DQogICAgLy9jaW4gPj4gVDsNCiAgICAvL3NjYW5mKCIlZCIsICZUKTsNCiAgICAvL2luaXQoKTsNCg0KICAgIHdoaWxlIChULS0pDQogICAgew0KICAgICAgICBzb2x2ZSgpOw0KICAgIH0NCg0KICAgIHJldHVybiAwOw0KfQ0K"}]