[{"id":"8585","submission_id":"8581","filename":"g.cpp","source":"I2luY2x1ZGU8Yml0cy9zdGRjKysuaD4NCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQojZGVmaW5lIGludCBsb25nIGxvbmcNCmNvbnN0IGludCBtYXhuID0gMWU1ICsgNTsNCg0KaW50IHNpZ25hW21heG4gPDwgMl0sIHNpZ25iW21heG4gPDwgMl0sIGVbbWF4biA8PCAyXSwgZWVbbWF4biA8PCAyXTsNCg0Kdm9pZCBoZW5zaGluKGludCBydCl7DQoJZVtydF0gPSBfX2djZChlW3J0IDw8IDFdLCBlW3J0IDw8IDEgfCAxXSk7DQoJZWVbcnRdID0gX19nY2QoZWVbcnQgPDwgMV0sIGVlW3J0IDw8IDEgfCAxXSk7DQp9DQoNCnZvaWQgYnVpbGQoaW50IGwsIGludCByLCBpbnQgcnQpew0KCXNpZ25hW3J0XSA9IDE7DQoJc2lnbmJbcnRdID0gMTsNCglpZihsID09IHIpew0KCQllW3J0XSA9IDE7DQoJCXJldHVybjsNCgl9DQoJaW50IG0gPSBsICsgciA+PiAxOw0KCWJ1aWxkKGwsIG0sIHJ0IDw8IDEpOw0KCWJ1aWxkKG0gKyAxLCByLCBydCA8PCAxIHwgMSk7DQoJaGVuc2hpbihydCk7DQp9DQoNCnZvaWQgZG93bihpbnQgcnQpew0KCWlmKHNpZ25hW3J0XSAhPSAxKXsNCgkJc2lnbmFbcnQgPDwgMV0gKj0gc2lnbmFbcnRdOw0KCQlzaWduYVtydCA8PCAxIHwgMV0gKj0gc2lnbmFbcnRdOw0KCQllW3J0IDw8IDFdICo9IHNpZ25hW3J0XTsNCgkJZVtydCA8PCAxIHwgMV0gKj0gc2lnbmFbcnRdOw0KCQlzaWduYVtydF0gPSAxOw0KCX0NCglpZihzaWduYltydF0gIT0gMSl7DQoJCXNpZ25iW3J0IDw8IDFdICo9IHNpZ25iW3J0XTsNCgkJc2lnbmJbcnQgPDwgMSB8IDFdICo9IHNpZ25iW3J0XTsNCgkJZVtydCA8PCAxXSAvPSBzaWduYltydF07DQoJCWVbcnQgPDwgMSB8IDFdIC89IHNpZ25iW3J0XTsNCgkJc2lnbmJbcnRdID0gMTsNCgl9DQp9DQoNCnZvaWQgZmxpcChpbnQgbCwgaW50IHIsIGludCBwLCBpbnQgcnQpew0KCWlmKGwgPT0gcil7DQoJCWlmKGVlW3J0XSl7DQoJCQllW3J0XSA9IGVlW3J0XTsNCgkJCWVlW3J0XSA9IDA7DQoJCX0gDQoJCWVsc2V7DQoJCQllZVtydF0gPSBlW3J0XTsNCgkJCWVbcnRdID0gMDsNCgkJfSANCgkJcmV0dXJuOw0KCX0NCglkb3duKHJ0KTsNCglpbnQgbSA9IGwgKyByID4+IDE7DQoJaWYocCA8PSBtKSBmbGlwKGwsIG0sIHAsIHJ0IDw8IDEpOw0KCWVsc2UgZmxpcChtICsgMSwgciwgcCwgcnQgPDwgMSB8IDEpOw0KCWhlbnNoaW4ocnQpOw0KfQ0KDQoNCg0Kdm9pZCBtdWwoaW50IGwsaW50IHIsIGludCBhbCwgaW50IGFyLCBpbnQgeCwgaW50IHJ0KXsNCglpZihhbCA8PSBsICYmIHIgPD0gYXIpew0KCQllW3J0XSAqPSB4Ow0KCQlzaWduYVtydF0gKj0geDsNCgkJcmV0dXJuOw0KCX0NCglpbnQgbSA9IGwgKyByID4+IDE7DQoJZG93bihydCk7DQoJaWYoYWwgPD0gbSkgbXVsKGwsIG0sIGFsLCBhciwgeCwgcnQgPDwgMSk7DQoJaWYoYXIgPiBtKSBtdWwobSArIDEsIHIsIGFsLCBhciwgeCwgcnQgPDwgMSB8IDEpOw0KCWhlbnNoaW4ocnQpOw0KfQ0KDQp2b2lkIGRpdihpbnQgbCwgaW50IHIsIGludCBhbCwgaW50IGFyLCBpbnQgeCwgaW50IHJ0KXsNCglpZihhbCA8PSBsICYmIHIgPD0gYXIpew0KCQllW3J0XSAvPSB4Ow0KCQlzaWduYltydF0gKj0geDsNCgkJcmV0dXJuOw0KCX0NCglpbnQgbSA9IGwgKyByID4+IDE7DQoJZG93bihydCk7DQoJaWYoYWwgPD0gbSkgZGl2KGwsIG0sIGFsLCBhciwgeCwgcnQgPDwgMSk7DQoJaWYoYXIgPiBtKSBkaXYobSArIDEsIHIsIGFsLCBhciwgeCwgcnQgPDwgMSB8IDEpOw0KCWhlbnNoaW4ocnQpOw0KfQ0KDQppbnQgYXNrKGludCBsLCBpbnQgciwgaW50IGFsLCBpbnQgYXIsIGludCBydCl7DQoJaWYoYWwgPD0gbCAmJiByIDw9IGFyKSByZXR1cm4gZVtydF07DQoJaW50IGFucyA9IDA7DQoJaW50IG0gPSBsICsgciA+PiAxOw0KCWRvd24ocnQpOw0KCWlmKGFsIDw9IG0pIGFucyA9IGFzayhsLCBtLCBhbCwgYXIsIHJ0IDw8IDEpOw0KCWlmKGFyID4gbSkgYW5zID0gX19nY2QoYW5zLCBhc2sobSArIDEsIHIsIGFsLCBhciwgcnQgPDwgMSB8IDEpKTsNCgloZW5zaGluKHJ0KTsNCglyZXR1cm4gYW5zOw0KfQ0KDQppbnQgYXNrayhpbnQgbCwgaW50IHIsIGludCBhbCwgaW50IGFyLCBpbnQgcnQpew0KCWlmKGFsIDw9IGwgJiYgciA8PSBhcikgcmV0dXJuIGVlW3J0XTsNCglpbnQgYW5zID0gMDsNCglpbnQgbSA9IGwgKyByID4+IDE7DQoJZG93bihydCk7DQoJaWYoYWwgPD0gbSkgYW5zID0gYXNrayhsLCBtLCBhbCwgYXIsIHJ0IDw8IDEpOw0KCWlmKGFyID4gbSkgYW5zID0gX19nY2QoYW5zLCBhc2trKG0gKyAxLCByLCBhbCwgYXIsIHJ0IDw8IDEgfCAxKSk7DQoJaGVuc2hpbihydCk7DQoJcmV0dXJuIGFuczsNCn0NCg0Kdm9pZCBzb2x2ZSgpew0KCWludCBuLCBtOyBjaW4gPj4gbiA+PiBtOw0KCWJ1aWxkKDEsIG4sIDEpOw0KCXdoaWxlKG0tLSl7DQoJCXN0cmluZyBlOyBjaW4gPj4gZTsNCgkJaWYoZVswXSA9PSAnbScpew0KCQkJaW50IGEsIGIsIGM7IGNpbiA+PiBhID4+IGIgPj4gYzsNCgkJCW11bCgxLCBuLCBhLCBiLCBjLCAxKTsNCgkJfQ0KCQllbHNlIGlmKGVbMF0gPT0gJ2QnKXsNCgkJCWludCBhLCBiLCBjOyBjaW4gPj4gYSA+PiBiID4+IGM7DQoJCQkNCgkJCWludCBzaWduID0gX19nY2QoYXNrKDEsIG4sIGEsIGIsIDEpLCBhc2trKDEsIG4sIGEsIGIsIDEpKTsNCgkJCWlmKHNpZ24gPj0gYyAmJiAoc2lnbiAlIGMpID09IDApew0KCQkJCWNvdXQgPDwgIllFUyIgPDwgZW5kbDsNCgkJCQlkaXYoMSwgbiwgYSwgYiwgYywgMSk7DQoJCQl9DQoJCQllbHNlIGNvdXQgPDwgIk5PIiA8PCBlbmRsOw0KIAkJfQ0KIAkJZWxzZXsNCiAJCQlpbnQgcDsgY2luID4+IHA7DQogCQkJZmxpcCgxLCBuLCBwLCAxKTsNCiAJCX0NCiAJCS8qZm9yKGludCBpID0gMTsgaSA8PSBuOyArK2kpIGNvdXQgPDwgYXNrKDEsIG4sIGksIGksIDEpIDw8ICIgIjsNCiAJCWNvdXQgPDwgZW5kbDsNCiAJCWZvcihpbnQgaSA9IDE7IGkgPD0gbjsgKytpKSBjb3V0IDw8IGFza2soMSwgbiwgaSwgaSwgMSkgPDwgIiAiOw0KIAkJY291dCA8PCBlbmRsOyovDQoJfQ0KfQ0KDQpzaWduZWQgbWFpbigpew0KCWlvczo6c3luY193aXRoX3N0ZGlvKGZhbHNlKTsNCglpbnQgdCA9IDE7DQoJLy9jaW4gPj4gdDsNCgl3aGlsZSh0LS0pew0KCQlzb2x2ZSgpOw0KCX0NCglyZXR1cm4gMDsNCn0NCg=="}]