[{"id":"8481","submission_id":"8477","filename":"0514C.cpp","source":"I2luY2x1ZGU8Yml0cy9zdGRjKysuaD4NCiNkZWZpbmUgaW8gaW9zOjpzeW5jX3dpdGhfc3RkaW8oZmFsc2UpO2Npbi50aWUoMCksY291dC50aWUoMCk7DQp1c2luZyBuYW1lc3BhY2Ugc3RkOw0KDQp0eXBlZGVmIGxvbmcgbG9uZyBsbDsNCg0KbGwgbiwgbSwgaywgdCwgbWF4bjsNCmxsIGFbNTAwMDEwXTsNCmxsIGNoYVs1MDAwMTBdOw0Kc3RyaW5nIGFuczsNCnN0cmluZyBnZXRzdHIobGwgbnVtKSB7DQoJc3RyaW5nIHMgPSAiIjsNCgl3aGlsZSAobnVtKSB7DQoJCXMgPSBjaGFyKG51bSAlIDEwICsgJzAnKSArIHM7DQoJCW51bSAvPSAxMDsNCgl9DQoJcmV0dXJuIHM7DQp9DQoNCnN0cmluZyBhZGQgKHN0cmluZyBzdHIxLCBzdHJpbmcgc3RyMikgew0KCXN0cmluZyBhbnNfc3RyOw0KCWludCBsZW4xID0gc3RyMS5sZW5ndGgoKSxsZW4yID0gc3RyMi5sZW5ndGgoKTsNCglpZiAobGVuMSA8IGxlbjIpIHsNCgkJZm9yIChpbnQgaSA9IDE7IGkgPD0gbGVuMiAtIGxlbjE7IGkrKykgew0KCQkJc3RyMSA9ICIwIiArIHN0cjE7DQoJCX0NCgl9IGVsc2Ugew0KCQlmb3IgKGludCBpID0gMTsgaSA8PSBsZW4xIC0gbGVuMjsgaSsrKSB7DQoJCQlzdHIyID0gIjAiICsgc3RyMjsNCgkJfQ0KCX0NCglsZW4xID0gbGVuMSA+IGxlbjIgPyBsZW4xOiBsZW4yOw0KCWludCBmbGFnID0gMCwgdGVtcDsNCglmb3IgKGludCBpID0gbGVuMSAtIDE7IGkgPj0gMDsgaS0tKSB7DQoJCXRlbXAgPSBzdHIxW2ldIC0gJzAnICsgc3RyMltpXSAtICcwJyArIGZsYWc7DQoJCWZsYWcgPSB0ZW1wIC8gMTA7DQoJCXRlbXAgJT0gMTA7DQoJCWFuc19zdHIgPSBjaGFyKHRlbXAgKyAnMCcpICsgYW5zX3N0cjsNCgl9DQoJaWYgKGZsYWcpIGFuc19zdHIgPSBjaGFyKGZsYWcgKyAnMCcpICsgYW5zX3N0cjsNCglyZXR1cm4gYW5zX3N0cjsNCn0NCnN0cmluZyBzdWIgKHN0cmluZyBzdHIxLCBzdHJpbmcgc3RyMikgew0KCXN0cmluZyBzdHI7DQoJaW50IHRtcCA9IHN0cjEubGVuZ3RoKCkgLSBzdHIyLmxlbmd0aCgpOw0KCWludCBjZiA9IDA7DQoJZm9yIChpbnQgaSA9IHN0cjIubGVuZ3RoKCkgLSAxOyBpID49IDA7IGktLSkgew0KCQlpZiAoc3RyMVt0bXAgKyBpXSA8IHN0cjJbaV0gKyBjZikgew0KCQkJc3RyID0gY2hhcihzdHIxW3RtcCArIGldIC0gc3RyMltpXSAtIGNmICsgJzAnICsgMTApICsgc3RyOw0KCQkJY2YgPSAxOw0KCQl9IGVsc2Ugew0KCQkJc3RyID0gY2hhcihzdHIxW3RtcCArIGldIC0gc3RyMltpXSAtIGNmICsgJzAnKSArIHN0cjsNCgkJCWNmID0gMDsNCgkJfQ0KCX0NCglmb3IgKGludCBpID0gdG1wIC0gMTsgaSA+PSAwOyBpLS0pIHsNCgkJaWYgKHN0cjFbaV0gLSBjZiA+PSAnMCcpIHsNCgkJCXN0ciA9IGNoYXIoc3RyMVtpXSAtIGNmKSArIHN0cjsNCgkJCWNmID0gMDsNCgkJfSBlbHNlIHsNCgkJCXN0ciA9IGNoYXIoc3RyMVtpXSAtIGNmICsgMTApICsgc3RyOw0KCQkJY2YgPSAxOw0KCQl9DQoJfQ0KCXN0ci5lcmFzZSgwLCBzdHIuZmluZF9maXJzdF9ub3Rfb2YoJzAnKSk7DQoJcmV0dXJuIHN0cjsNCn0NCnN0cmluZyBtdWwoc3RyaW5nIHN0cjEsIHN0cmluZyBzdHIyKSB7DQoJc3RyaW5nIHN0cjsNCglpbnQgbGVuMSA9IHN0cjEubGVuZ3RoKCksbGVuMiA9IHN0cjIubGVuZ3RoKCk7DQoJc3RyaW5nIHRlbXBzdHI7DQoJZm9yIChpbnQgaSA9IGxlbjIgLSAxOyBpID49IDA7IGktLSkgew0KCQl0ZW1wc3RyID0gIiI7DQoJCWludCB0ZW1wID0gc3RyMltpXSAtICcwJzsNCgkJaW50IHQgPSAwOw0KCQlpbnQgY2YgPSAwOw0KCQlpZiAodGVtcCAhPSAwKSB7DQoJCQlmb3IgKGludCBqID0gMTsgaiA8PSBsZW4yIC0gMSAtIGk7IGorKykgew0KCQkJCXRlbXBzdHIgKz0gIjAiOw0KCQkJfQ0KCQkJZm9yIChpbnQgaiA9IGxlbjEgLSAxOyBqID49IDA7IGotLSkgew0KCQkJCXQgPSAodGVtcCAqIChzdHIxW2pdIC0gJzAnKSArIGNmKSAlIDEwOw0KCQkJCWNmID0gKHRlbXAgKiAoc3RyMVtqXSAtICcwJykgKyBjZikgLyAxMDsNCgkJCQl0ZW1wc3RyID0gY2hhcih0ICsgJzAnKSArIHRlbXBzdHI7DQoJCQl9DQoJCQlpZiAoY2YgIT0gMCkgew0KCQkJCXRlbXBzdHIgPSBjaGFyKGNmICsgJzAnKSArIHRlbXBzdHI7DQoJCQl9DQoJCX0NCgkJc3RyPWFkZChzdHIsdGVtcHN0cik7DQoJfQ0KCXN0ci5lcmFzZSgwLCBzdHIuZmluZF9maXJzdF9ub3Rfb2YoJzAnKSk7DQoJcmV0dXJuIHN0cjsNCn0NCmludCBtYWluICgpIHsNCgljaW4gPj4gbjsNCglmb3IgKGludCBpID0gMTsgaSA8PSBuOyBpKyspIHsNCgkJY2luID4+IGFbaV07DQoJCWlmIChpICE9IDEpIGNoYVtpXSA9IGFbaV0gLSBhW2kgLSAxXTsNCgkJbWF4biA9IG1heChtYXhuLCBjaGFbaV0pOw0KCX0NCgljaGFbMV0gPSAwOw0KCWNpbiA+PiBrOw0KCXdoaWxlIChrLS0pIHsNCgkJYW5zID0gIjAiOw0KCQljaW4gPj4gdDsNCgkJaWYgKHQgPT0gMCkgew0KCQkJY291dCA8PCAiMFxuIjsNCgkJCWNvbnRpbnVlOw0KCQl9DQoJCWludCBudW0gPSB1cHBlcl9ib3VuZChjaGEgKyAxLCBjaGEgKyBuICsgMSwgbWluKG1heG4sIHQpKSAtIGNoYSAtIDE7DQoJCWlmIChhW251bV0gIT0gMCkNCgkJCWFucyA9IGFkZChhbnMsIGdldHN0cihhW251bV0gLSAxKSk7DQoJCWFucyA9IGFkZChhbnMsIG11bChnZXRzdHIobiAtIG51bSArIDEpLCBnZXRzdHIodCkpKTsNCgkJY291dCA8PCBhbnMgPDwgJ1xuJzsNCgl9DQoJcmV0dXJuIDA7DQp9DQo="}]