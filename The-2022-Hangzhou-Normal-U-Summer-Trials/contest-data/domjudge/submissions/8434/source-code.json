[{"id":"8438","submission_id":"8434","filename":"3.cpp","source":"I2luY2x1ZGU8Yml0cy9zdGRjKysuaD4NCiNkZWZpbmUgc3luY19mbG93IGlvczo6c3luY193aXRoX3N0ZGlvKGZhbHNlKTtjaW4udGllKDApDQojZGVmaW5lIHpmKGksbCxyKSBmb3IoaW50IGk9bDtpPD1yO2krKykNCiNkZWZpbmUgZGYoaSxyLGwpIGZvcihpbnQgaT1yO2k+PWw7aS0tKQ0KI2RlZmluZSBsb3diaXQoeCkgKHgmKC14KSkNCiNkZWZpbmUgbm8gY291dDw8Im5vIHNvbHV0aW9uIg0KdXNpbmcgbmFtZXNwYWNlIHN0ZDsNCnR5cGVkZWYgbG9uZyBsb25nIGxsOw0KY29uc3QgbGwgbWF4bj01NTsNCnR5cGVkZWYgc3RydWN0IE5PREV7DQoJbGwgeCx5Ow0KfWlkOw0KdHlwZWRlZiBzdHJ1Y3QgTk9ERTJ7DQoJaWQgYWEsYmI7DQoJbGwgY250Ow0KfW5vZGU7DQpub2RlIHRtcDsNCmxsIGFucz0wLG47DQppZCBhLGI7DQppbnQgdmlzYVttYXhuXVttYXhuXT17MH0sdmlzYlttYXhuXVttYXhuXT17MH07DQpjaGFyIG1wW21heG5dW21heG5dOw0KcXVldWU8bm9kZT5xOw0KDQppbmxpbmUgYm9vbCBqdWRnZShjb25zdCBpZCBsLGNvbnN0IGlkIHIpew0KCWlmKGwueD09ci54JiZsLnk9PXIueSlyZXR1cm4gdHJ1ZTsNCglyZXR1cm4gZmFsc2U7DQp9DQppbmxpbmUgYm9vbCBlcXVhbChjb25zdCBub2RlIGwsY29uc3Qgbm9kZSByKXsNCglpZihqdWRnZShsLmFhLHIuYWEpJiZqdWRnZShsLmJiLHIuYmIpJiZsLmNudD09ci5jbnQpcmV0dXJuIHRydWU7DQoJcmV0dXJuIGZhbHNlOw0KfQ0Kdm9pZCBwdXNocihjb25zdCBub2RlIG5kKXsNCgl0bXAuYWE9bmQuYWE7DQoJbGwgdGFnPTA7DQoJaWYobmQuYWEueTxuKXsNCgkJaWYobXBbbmQuYWEueF1bbmQuYWEueSsxXSE9JyonKXsNCgkJCXRtcC5hYS55Kys7DQoJCQl0bXAuY250PW5kLmNudCsxOw0KCQkJdGFnPTE7DQoJCX0NCgl9DQoJdG1wLmJiPW5kLmJiOw0KCWlmKG5kLmJiLnk8bil7DQoJCWlmKG1wW25kLmJiLnhdW25kLmJiLnkrMV0hPScqJyl7DQoJCQl0bXAuYmIueSsrOw0KCQkJaWYoIXRhZyl0bXAuY250PW5kLmNudCsxOzsNCgkJfQ0KCX0NCglpZighZXF1YWwobmQsdG1wKSl7DQoJCWlmKCF2aXNhW3RtcC5hYS54XVt0bXAuYWEueV18fCF2aXNiW3RtcC5iYi54XVt0bXAuYmIueV0pcS5wdXNoKHRtcCk7DQoJCXZpc2FbdG1wLmFhLnhdW3RtcC5hYS55XT0xOw0KCQl2aXNiW3RtcC5iYi54XVt0bXAuYmIueV09MTsNCgl9DQoJcmV0dXJuIDsNCn0NCnZvaWQgcHVzaGwoY29uc3Qgbm9kZSBuZCl7DQoJdG1wLmFhPW5kLmFhOw0KCWxsIHRhZz0wOw0KCWlmKG5kLmFhLnk+MSl7DQoJCWlmKG1wW25kLmFhLnhdW25kLmFhLnktMV0hPScqJyl7DQoJCQl0bXAuYWEueS0tOw0KCQkJdG1wLmNudD1uZC5jbnQrMTs7DQoJCQl0YWc9MTsNCgkJfQ0KCX0NCgl0bXAuYmI9bmQuYmI7DQoJaWYobmQuYmIueT4xKXsNCgkJaWYobXBbbmQuYmIueF1bbmQuYmIueS0xXSE9JyonKXsNCgkJCXRtcC5iYi55LS07DQoJCQlpZighdGFnKXRtcC5jbnQ9bmQuY250KzE7Ow0KCQl9DQoJfQ0KCWlmKCFlcXVhbChuZCx0bXApKXsNCgkJaWYoIXZpc2FbdG1wLmFhLnhdW3RtcC5hYS55XXx8IXZpc2JbdG1wLmJiLnhdW3RtcC5iYi55XSlxLnB1c2godG1wKTsNCgkJdmlzYVt0bXAuYWEueF1bdG1wLmFhLnldPTE7DQoJCXZpc2JbdG1wLmJiLnhdW3RtcC5iYi55XT0xOw0KCX0gDQoJcmV0dXJuIDsNCn0NCnZvaWQgcHVzaHQoY29uc3Qgbm9kZSBuZCl7DQoJdG1wLmFhPW5kLmFhOw0KCWxsIHRhZz0wOw0KCWlmKG5kLmFhLng+MSl7DQoJCWlmKG1wW25kLmFhLngtMV1bbmQuYWEueV0hPScqJyl7DQoJCQl0bXAuYWEueC0tOw0KCQkJdG1wLmNudD1uZC5jbnQrMTs7DQoJCQl0YWc9MTsNCgkJfQ0KCX0NCgl0bXAuYmI9bmQuYmI7DQoJaWYobmQuYmIueD4xKXsNCgkJaWYobXBbbmQuYmIueC0xXVtuZC5iYi55XSE9JyonKXsNCgkJCXRtcC5iYi54LS07DQoJCQlpZighdGFnKXRtcC5jbnQ9bmQuY250KzE7Ow0KCQl9DQoJfQ0KCWlmKCFlcXVhbChuZCx0bXApKXsNCgkJaWYoIXZpc2FbdG1wLmFhLnhdW3RtcC5hYS55XXx8IXZpc2JbdG1wLmJiLnhdW3RtcC5iYi55XSlxLnB1c2godG1wKTsNCgkJdmlzYVt0bXAuYWEueF1bdG1wLmFhLnldPTE7DQoJCXZpc2JbdG1wLmJiLnhdW3RtcC5iYi55XT0xOw0KCX0NCglyZXR1cm4gOw0KfQ0Kdm9pZCBwdXNoYihjb25zdCBub2RlIG5kKXsNCgl0bXAuYWE9bmQuYWE7DQoJbGwgdGFnPTA7DQoJaWYobmQuYWEueDxuKXsNCgkJaWYobXBbbmQuYWEueCsxXVtuZC5hYS55XSE9JyonKXsNCgkJCXRtcC5hYS54Kys7DQoJCQl0bXAuY250PW5kLmNudCsxOzsNCgkJCXRhZz0xOw0KCQl9DQoJfQ0KCXRtcC5iYj1uZC5iYjsNCglpZihuZC5iYi54PG4pew0KCQlpZihtcFtuZC5iYi54KzFdW25kLmJiLnldIT0nKicpew0KCQkJdG1wLmJiLngrKzsNCgkJCWlmKCF0YWcpdG1wLmNudD1uZC5jbnQrMTs7DQoJCX0NCgl9DQoJaWYoIWVxdWFsKG5kLHRtcCkpew0KCQlpZighdmlzYVt0bXAuYWEueF1bdG1wLmFhLnldfHwhdmlzYlt0bXAuYmIueF1bdG1wLmJiLnldKXEucHVzaCh0bXApOw0KCQl2aXNhW3RtcC5hYS54XVt0bXAuYWEueV09MTsNCgkJdmlzYlt0bXAuYmIueF1bdG1wLmJiLnldPTE7DQoJfQ0KCXJldHVybiA7DQp9DQppbnQgbWFpbigpDQp7DQoJc3luY19mbG93Ow0KCWNpbj4+bjsNCgl6ZihpLDEsbil7DQoJCXpmKGosMSxuKXsNCgkJCWNpbj4+bXBbaV1bal07DQoJCQlpZihtcFtpXVtqXT09J2EnKXsNCgkJCQlhLng9aSxhLnk9ajsNCgkJCX1lbHNlIGlmKG1wW2ldW2pdPT0nYicpew0KCQkJCWIueD1pLGIueT1qOw0KCQkJfQ0KCQl9DQoJfQ0KCXRtcC5hYT1hLHRtcC5iYj1iLHRtcC5jbnQ9MDsNCglxLnB1c2godG1wKTsNCgl2aXNhW3RtcC5hYS54XVt0bXAuYWEueV09MTsNCgl2aXNiW3RtcC5iYi54XVt0bXAuYmIueV09MTsNCgl3aGlsZSghcS5lbXB0eSgpKXsNCgkJbm9kZSBzdD1xLmZyb250KCk7DQoJCWlmKGp1ZGdlKHN0LmFhLHN0LmJiKSl7DQoJCQlhbnM9c3QuY250Ow0KCQkJYnJlYWs7DQoJCX0NCgkJcS5wb3AoKTsgDQoJCXB1c2hyKHN0KTsNCgkJcHVzaGwoc3QpOw0KCQlwdXNodChzdCk7DQoJCXB1c2hiKHN0KTsNCgl9DQoJaWYocS5lbXB0eSgpKW5vOw0KCWVsc2UgY291dDw8YW5zOw0KCXJldHVybiAwOw0KfQ0K"}]