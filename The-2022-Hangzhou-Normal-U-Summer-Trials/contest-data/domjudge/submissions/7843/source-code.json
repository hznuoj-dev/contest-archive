[{"id":"7847","submission_id":"7843","filename":"G.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+DQoNCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQp0eXBlZGVmIGxvbmcgbG9uZyBsbDsNCmNvbnN0IGludCBOID0gMWU1ICsgMTAsIGluZiA9IDIwMDAwMDAwMDA7DQppbnQgaWRbMTBdID0gezIsIDMsIDUsIDcsIDExLCAxMywgMTcsIDE5LCAyMywgMjl9Ow0Kc3RydWN0IEluZm97DQoJaW50IGFbMTBdOw0KCXZvaWQgaW5pdChpbnQgayl7DQoJCWZvcihpbnQgaSA9IDA7IGkgPCAxMDsgaSsrKXsNCgkJCWFbaV0gPSBrOw0KCQl9DQoJfQ0KfXVuW04gPDwgMl0sIGxvW04gPDwgMl0sIGFucywgbHpbTiA8PCAxXTsNCg0KSW5mbyBtZXJnZShJbmZvIGEsIEluZm8gYil7DQoJSW5mbyByZXM7DQoJZm9yKGludCBpID0gMDsgaSA8IDEwOyBpKyspew0KCQlyZXMuYVtpXSA9IG1pbihhLmFbaV0sIGIuYVtpXSk7DQoJfQ0KCXJldHVybiByZXM7DQp9DQoNCnZvaWQgYXBwbHkoaW50IGssIEluZm8gcCl7DQoJZm9yKGludCBpID0gMDsgaSA8IDEwOyBpKyspew0KCQl1bltrXS5hW2ldICs9IHAuYVtpXTsNCgkJbHpba10uYVtpXSArPSBwLmFbaV07DQoJfQ0KfQ0KDQp2b2lkIHBkKGludCBrKXsNCglhcHBseShrIDw8IDEsIGx6W2tdKTsNCglhcHBseShrIDw8IDEgfCAxLCBseltrXSk7DQoJbHpba10uaW5pdCgwKTsNCn0NCg0Kdm9pZCBidWlsZChpbnQgaywgaW50IGwsIGludCByKXsNCgl1bltrXS5pbml0KDApOw0KCWxvW2tdLmluaXQoaW5mKTsNCglseltrXS5pbml0KDApOw0KCWlmKGwgPT0gcil7DQoJCXJldHVybjsNCgl9DQoJaW50IG1pZCA9IChsICsgcikgPj4gMTsNCglidWlsZChrIDw8IDEsIGwsIG1pZCk7DQoJYnVpbGQoayA8PCAxIHwgMSwgbWlkICsgMSwgcik7DQoJdW5ba10gPSBtZXJnZSh1bltrIDw8IDFdLCB1bltrIDw8IDEgfCAxXSk7DQoJbG9ba10gPSBtZXJnZShsb1trIDw8IDFdLCBsb1trIDw8IDEgfCAxXSk7DQp9DQoNCnZvaWQgdXBkKGludCBrLCBpbnQgbCwgaW50IHIsIGludCBxbCwgaW50IHFyLCBJbmZvIHgsIGludCBmKXsNCglpZihsID4gcXIgfHwgciA8IHFsKSByZXR1cm47DQoJaWYobCA+PSBxbCAmJiByIDw9IHFyKXsNCgkJZm9yKGludCBpID0gMDsgaSA8IDEwOyBpKyspew0KCQkJdW5ba10uYVtpXSArPSB4LmFbaV0gKiBmOw0KCQkJbHpba10uYVtpXSArPSB4LmFbaV0gKiBmOw0KCQl9DQoJCXJldHVybjsNCgl9DQoJcGQoayk7DQoJaW50IG1pZCA9IChsICsgcikgPj4gMTsNCgl1cGQoayA8PCAxLCBsLCBtaWQsIHFsLCBxciwgeCwgZik7DQoJdXBkKGsgPDwgMSB8IDEsIG1pZCArIDEsIHIsIHFsLCBxciwgeCwgZik7DQoJdW5ba10gPSBtZXJnZSh1bltrIDw8IDFdLCB1bltrIDw8IDEgfCAxXSk7DQp9DQoNCnZvaWQgY2hhbmdlKGludCBrLCBpbnQgbCwgaW50IHIsIGludCBwKXsNCglpZihsID4gcCB8fCByIDwgcCkgcmV0dXJuOw0KCWlmKGwgPT0gcCAmJiByID09IHApew0KCQlmb3IoaW50IGkgPSAwOyBpIDwgMTA7IGkrKyl7DQoJCQlpbnQgdG1wID0gdW5ba10uYVtpXTsNCgkJCXVuW2tdLmFbaV0gPSBsb1trXS5hW2ldOw0KCQkJbG9ba10uYVtpXSA9IHRtcDsNCgkJfQ0KCQlyZXR1cm47DQoJfQ0KCXBkKGspOw0KCWludCBtaWQgPSAobCArIHIpID4+IDE7DQoJY2hhbmdlKGsgPDwgMSwgbCwgbWlkLCBwKTsNCgljaGFuZ2UoayA8PCAxIHwgMSwgbWlkICsgMSwgciwgcCk7DQoJdW5ba10gPSBtZXJnZSh1bltrIDw8IDFdLCB1bltrIDw8IDEgfCAxXSk7DQoJbG9ba10gPSBtZXJnZShsb1trIDw8IDFdLCBsb1trIDw8IDEgfCAxXSk7DQp9DQoNCnZvaWQgcXJ5KGludCBrLCBpbnQgbCwgaW50IHIsIGludCBxbCwgaW50IHFyKXsNCglpZihsID4gcXIgfHwgciA8IHFsKSByZXR1cm47DQoJaWYobCA+PSBxbCAmJiByIDw9IHFyKXsNCgkJYW5zID0gbWVyZ2UoYW5zLCB1bltrXSk7DQoJCWFucyA9IG1lcmdlKGFucywgbG9ba10pOw0KCQlyZXR1cm47DQoJfQ0KCXBkKGspOw0KCWludCBtaWQgPSAobCArIHIpID4+IDE7DQoJcXJ5KGsgPDwgMSwgbCwgbWlkLCBxbCwgcXIpOw0KCXFyeShrIDw8IDEgfCAxLCBtaWQgKyAxLCByLCBxbCwgcXIpOw0KfQ0KDQpJbmZvIHZbMzFdOw0KY2hhciBrWzEwXTsNCg0Kdm9pZCBzb2x2ZSgpew0KCWludCBuLCBxOw0KCXNjYW5mKCIlZCVkIiwgJm4sICZxKTsNCglidWlsZCgxLCAxLCBuKTsNCgl3aGlsZShxLS0pew0KCQlzY2FuZigiJXMiLCBrKTsNCgkJaWYoa1swXSA9PSAnbScpew0KCQkJaW50IGwsIHIsIHg7DQoJCQlzY2FuZigiJWQlZCVkIiwgJmwsICZyLCAmeCk7DQoJCQl1cGQoMSwgMSwgbiwgbCwgciwgdlt4XSwgMSk7DQoJCX1lbHNlIGlmKGtbMF0gPT0gJ2QnKXsNCgkJCWludCBsLCByLCB4LCBvayA9IDE7DQoJCQlzY2FuZigiJWQlZCVkIiwgJmwsICZyLCAmeCk7DQoJCQlhbnMuaW5pdChpbmYpOw0KCQkJcXJ5KDEsIDEsIG4sIGwsIHIpOw0KCQkJZm9yKGludCBpID0gMDsgaSA8IDEwOyBpKyspew0KCQkJCWlmKGFucy5hW2ldIDwgdlt4XS5hW2ldKSBvayA9IDA7DQoJCQl9DQoJCQlpZighb2spew0KCQkJCXByaW50ZigiTk9cbiIpOw0KCQkJfWVsc2V7DQoJCQkJcHJpbnRmKCJZRVNcbiIpOw0KCQkJCXVwZCgxLCAxLCBuLCBsLCByLCB2W3hdLCAtMSk7DQoJCQl9DQoJCX1lbHNlew0KCQkJaW50IHA7DQoJCQlzY2FuZigiJWQiLCAmcCk7DQoJCQljaGFuZ2UoMSwgMSwgbiwgcCk7DQoJCX0NCgl9DQp9DQoNCmludCBtYWluKCl7DQoJaW50IFQgPSAxOw0KCWZvcihpbnQgaSA9IDE7IGkgPD0gMzA7IGkrKyl7DQoJCWludCB0ID0gaTsNCgkJZm9yKGludCBqID0gMDsgaiA8IDEwOyBqKyspew0KCQkJaW50IGMgPSAwOw0KCQkJd2hpbGUodCAlIGlkW2pdID09IDApIHQgLz0gaWRbal0sIGMrKzsNCgkJCXZbaV0uYVtqXSA9IGM7DQoJCX0NCi8vCQljb3V0IDw8IGkgPDwgIjo6ICI7DQovLwkJZm9yKGludCBqID0gMDsgaiA8IDEwOyBqKyspew0KLy8JCQljb3V0IDw8IHZbaV0uYVtqXSA8PCAnICc7DQovLwkJfQ0KLy8JCWNvdXQgPDwgJ1xuJzsNCgl9DQoJd2hpbGUoVC0tKSBzb2x2ZSgpOw0KCXJldHVybiAwOw0KfQ0K"}]