[{"id":"8764","submission_id":"8760","filename":"0514.cpp","source":"I2luY2x1ZGU8Yml0cy9zdGRjKysuaD4NCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQojZGVmaW5lIGxsIGxvbmcgbG9uZw0KLy8gI2RlZmluZSBkb3VibGUgbG9uZyBkb3VibGUNCi8vICNkZWZpbmUgaW5mIDB4M2YzZjNmM2YNCmNvbnN0IGRvdWJsZSBpbmY9MWU2Ow0KY29uc3QgaW50IG1heG49M2UzKzEwOw0KY29uc3QgaW50IG1heG09OWU2KzEwOw0KY29uc3QgaW50IG1vZD0xZTkrNzsNCmludCBuLG0sY250Ow0KZG91YmxlIHYxLHYyLHYzLHY0LHYwOw0KaW50IHN0LGVkOw0Kc3RydWN0IHBvaW50DQp7DQogICAgZG91YmxlIHgseTsNCn1wW21heG5dOw0Kc3RydWN0IGVkZ2UNCnsNCiAgICBpbnQgdG8sbmV4dDsNCiAgICBkb3VibGUgdzsNCn1lW21heG1dOw0Kc3RydWN0IG5vZGUNCnsNCiAgICBpbnQgaWQ7DQogICAgZG91YmxlIHM7DQogICAgbm9kZShpbnQgYSxkb3VibGUgYil7aWQ9YTtzPWI7fQ0KICAgIGJvb2wgb3BlcmF0b3IgPCAoY29uc3Qgbm9kZSBhKSBjb25zdHsNCiAgICAgICAgcmV0dXJuIGEuczxzOw0KICAgIH0NCn07DQppbnQgdmlzW21heG5dOw0KaW50IGhlYWRbbWF4bl07DQpkb3VibGUgZGlzdFttYXhuXTsNCnByaW9yaXR5X3F1ZXVlPG5vZGU+cTsNCg0Kdm9pZCBhZGQoaW50IHgsaW50IHksZG91YmxlIHcpDQp7DQogICAgZVtjbnRdLnRvPXk7DQogICAgZVtjbnRdLnc9dzsNCiAgICBlW2NudF0ubmV4dD1oZWFkW3hdOw0KICAgIGhlYWRbeF09Y250Kys7DQp9DQp2b2lkIGluaXQoKQ0Kew0KICAgIGNudD0wOw0KICAgIGZvcihpbnQgaT0xO2k8PW47aSsrKSAgDQogICAgew0KICAgICAgICBoZWFkW2ldPS0xOw0KICAgICAgICB2aXNbaV09MDsNCiAgICAgICAgZGlzdFtpXT1pbmY7DQogICAgfQ0KfQ0KDQp2b2lkIGRpaigpDQp7DQogICAgZGlzdFsxXT0wOw0KICAgIHEucHVzaChub2RlKDEsMCkpOw0KICAgIHdoaWxlKCFxLmVtcHR5KCkpDQogICAgew0KICAgICAgICBub2RlIHA9cS50b3AoKTsNCiAgICAgICAgcS5wb3AoKTsNCiAgICAgICAgaWYodmlzW3AuaWRdKSAgY29udGludWU7DQogICAgICAgIHZpc1twLmlkXT0xOw0KICAgICAgICBmb3IoaW50IGk9aGVhZFtwLmlkXTt+aTtpPWVbaV0ubmV4dCkNCiAgICAgICAgew0KICAgICAgICAgICAgZWRnZSB0PWVbaV07DQogICAgICAgICAgICBpZighdmlzW3QudG9dICYmIGRpc3RbdC50b10+ZGlzdFtwLmlkXSt0LncpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgZGlzdFt0LnRvXT1kaXN0W3AuaWRdK3QudzsNCiAgICAgICAgICAgICAgICBxLnB1c2gobm9kZSh0LnRvLGRpc3RbdC50b10pKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCiAgICByZXR1cm47DQp9DQppbnQgbWFpbigpDQp7DQogICAgLy8gaW9zOjpzeW5jX3dpdGhfc3RkaW8oZmFsc2UpOw0KICAgIC8vIGNpbi50aWUoMCk7DQogICAgLy8gY291dC50aWUoMCk7DQogICAgc2NhbmYoIiVkIiwmbik7DQogICAgDQogICAgc2NhbmYoIiVsZiVsZiVsZiVsZiVsZiIsJnYxLCZ2MiwmdjMsJnY0LCZ2MCk7DQogICAgc2NhbmYoIiVkJWQiLCZzdCwmZWQpOw0KICAgIGZvcihpbnQgaT0xO2k8PW47aSsrKQ0KICAgIHsNCiAgICAgICAgc2NhbmYoIiVsZiVsZiIsJnBbaV0ueCwmcFtpXS55KTsNCiAgICAgICAgLy8gcHJpbnRmKCIlbGYgICVsZi0tLVxuIixwW2ldLngscFtpXS55KTsNCiAgICB9DQogICAgc3dhcChwWzFdLngscFtzdF0ueCk7DQogICAgc3dhcChwWzFdLnkscFtzdF0ueSk7DQogICAgc3dhcChwW25dLngscFtlZF0ueCk7DQogICAgc3dhcChwW25dLnkscFtlZF0ueSk7DQogICAgaW5pdCgpOw0KICAgIGZvcihpbnQgaT0yO2k8PW4tMTtpKyspDQogICAgew0KICAgICAgICBmb3IoaW50IGo9aSsxO2o8PW4tMTtqKyspDQogICAgICAgIHsNCiAgICAgICAgICAgIGRvdWJsZSB3dyx2dixkPXNxcnQoMS4wKihwW2ldLngtcFtqXS54KSoocFtpXS54LXBbal0ueCkrKHBbaV0ueS1wW2pdLnkpKihwW2ldLnktcFtqXS55KSk7DQogICAgICAgICAgICBkb3VibGUgeHg9cFtpXS54KnBbal0ueCx5eT1wW2ldLnkqcFtqXS55Ow0KICAgICAgICAgICAgaWYoeHg8MCB8fCB5eTwwKSAgdnY9djA7DQogICAgICAgICAgICBlbHNlDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgaWYocFtpXS54Pj0wICYmIHBbaV0ueT49MCkgIHZ2PXYxOw0KICAgICAgICAgICAgICAgIGVsc2UgaWYocFtpXS54PD0wICYmIHBbaV0ueT49MCkgIHZ2PXYyOw0KICAgICAgICAgICAgICAgIGVsc2UgaWYocFtpXS54PD0wICYmIHBbaV0ueTw9MCkgIHZ2PXYzOw0KICAgICAgICAgICAgICAgIGVsc2UgaWYocFtpXS54Pj0wICYmIHBbaV0ueTw9MCkgIHZ2PXY0Ow0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgd3c9ZC92djsNCiAgICAgICAgICAgIGFkZChpLGosd3cpOw0KICAgICAgICAgICAgYWRkKGosaSx3dyk7DQogICAgICAgIH0NCiAgICB9DQogICAgZm9yKGludCBpPTI7aTw9bjtpKyspDQogICAgew0KICAgICAgICBkb3VibGUgZD1zcXJ0KChwW2ldLngtcFsxXS54KSoocFtpXS54LXBbMV0ueCkrKHBbaV0ueS1wWzFdLnkpKihwW2ldLnktcFsxXS55KSk7DQogICAgICAgIC8vIGRvdWJsZSBkPXNxcnQoKHBbaV0ueC1wW25dLngpKihwW2ldLngtcFtuXS54KSsocFtpXS55LXBbbl0ueSkqKHBbaV0ueS1wW25dLnkpKTsNCiAgICAgICAgZG91YmxlIHd3LHZ2Ow0KICAgICAgICBkb3VibGUgeHg9cFtpXS54KnBbMV0ueCx5eT1wW2ldLnkqcFsxXS55Ow0KICAgICAgICBpZih4eDwwIHx8IHl5PDApICB2dj12MDsNCiAgICAgICAgZWxzZQ0KICAgICAgICB7DQogICAgICAgICAgICBpZihwW2ldLng+PTAgJiYgcFtpXS55Pj0wKSAgdnY9djE7DQogICAgICAgICAgICBlbHNlIGlmKHBbaV0ueDw9MCAmJiBwW2ldLnk+PTApICB2dj12MjsNCiAgICAgICAgICAgIGVsc2UgaWYocFtpXS54PD0wICYmIHBbaV0ueTw9MCkgIHZ2PXYzOw0KICAgICAgICAgICAgZWxzZSBpZihwW2ldLng+PTAgJiYgcFtpXS55PD0wKSAgdnY9djQ7DQogICAgICAgIH0NCiAgICAgICAgd3c9ZC92djsNCiAgICAgICAgYWRkKGksMSx3dyk7DQogICAgICAgIGFkZCgxLGksd3cpOw0KICAgIH0NCiAgICBmb3IoaW50IGk9MjtpPD1uLTE7aSsrKQ0KICAgIHsNCiAgICAgICAgLy8gZG91YmxlIGQ9c3FydCgocFtpXS54LXBbMV0ueCkqKHBbaV0ueC1wWzFdLngpKyhwW2ldLnktcFsxXS55KSoocFtpXS55LXBbMV0ueSkpOw0KICAgICAgICBkb3VibGUgZD1zcXJ0KChwW2ldLngtcFtuXS54KSoocFtpXS54LXBbbl0ueCkrKHBbaV0ueS1wW25dLnkpKihwW2ldLnktcFtuXS55KSk7DQogICAgICAgIGRvdWJsZSB3dyx2djsNCiAgICAgICAgZG91YmxlIHh4PXBbaV0ueCpwW25dLngseXk9cFtpXS55KnBbbl0ueTsNCiAgICAgICAgaWYoeHg8MCB8fCB5eTwwKSAgdnY9djA7DQogICAgICAgIGVsc2UNCiAgICAgICAgew0KICAgICAgICAgICAgaWYocFtpXS54Pj0wICYmIHBbaV0ueT49MCkgIHZ2PXYxOw0KICAgICAgICAgICAgZWxzZSBpZihwW2ldLng8PTAgJiYgcFtpXS55Pj0wKSAgdnY9djI7DQogICAgICAgICAgICBlbHNlIGlmKHBbaV0ueDw9MCAmJiBwW2ldLnk8PTApICB2dj12MzsNCiAgICAgICAgICAgIGVsc2UgaWYocFtpXS54Pj0wICYmIHBbaV0ueTw9MCkgIHZ2PXY0Ow0KICAgICAgICB9DQogICAgICAgIHd3PWQvdnY7DQogICAgICAgIGFkZChpLG4sd3cpOw0KICAgICAgICBhZGQobixpLHd3KTsNCiAgICB9DQogICAgZGlqKCk7DQogICAgcHJpbnRmKCIlLjEwbGYiLGRpc3Rbbl0pOw0KfQ=="}]