[{"id":"8833","submission_id":"8829","filename":"main.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+CnVzaW5nIG5hbWVzcGFjZSBzdGQ7CiNkZWZpbmUgbGwgbG9uZyBsb25nCmNvbnN0IHNpZ25lZCBJTkYgPSAxZTk7CmNvbnN0IHNpZ25lZCBtYXhuID0gMTAwMDE5Owpjb25zdCBzaWduZWQgbW9kZSA9IDFlOSArIDc7CgppbnQgcHJpWzEwXSA9IHsyLCAzLCA1LCA3LCAxMSwgMTMsIDE3LCAxOSwgMjMsIDI5fTsKc3RydWN0IHZhbHsKICAgIGludCBjWzEwXSwgemVybzsKICAgIHZhbCBvcGVyYXRvciAqKGNvbnN0IHZhbCAmdCljb25zdHsKICAgICAgICB2YWwgcmVzID0gKnRoaXM7CiAgICAgICAgcmVzLnplcm8gPSB6ZXJvIHwgdC56ZXJvOwogICAgICAgIGlmKHJlcy56ZXJvKSByZXR1cm4gdmFsKDApOwogICAgICAgIGZvcihpbnQgaT0wO2k8MTA7aSsrKSByZXMuY1tpXSArPSB0LmNbaV07CiAgICAgICAgcmV0dXJuIHJlczsKICAgIH0KICAgIHZhbCBvcGVyYXRvciAvKGNvbnN0IHZhbCAmdCljb25zdHsKICAgICAgICBpZih6ZXJvKSByZXR1cm4gdmFsKDApOwogICAgICAgIHZhbCByZXMgPSAqdGhpczsKICAgICAgICBmb3IoaW50IGk9MDtpPDEwO2krKykgcmVzLmNbaV0gLT0gdC5jW2ldOwogICAgICAgIHJldHVybiByZXM7CiAgICB9CiAgICB2YWwoKXsKICAgICAgICBmb3IoaW50IGk9MDtpPDEwO2krKykgY1tpXSA9IDA7CiAgICAgICAgemVybyA9IDE7CiAgICB9CiAgICB2YWwoaW50IHgpewogICAgICAgIGZvcihpbnQgaT0wO2k8MTA7aSsrKSBjW2ldID0gMDsKICAgICAgICBpZih4ID09IDApewogICAgICAgICAgICB6ZXJvID0gMTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICB6ZXJvID0gMDsKICAgICAgICBmb3IoaW50IGk9MDtpPDEwICYmIHByaVtpXSA8PSB4O2krKyl7CiAgICAgICAgICAgIHdoaWxlKHggJSBwcmlbaV0gPT0gMCkgY1tpXSsrLCB4IC89IHByaVtpXTsKICAgICAgICB9CiAgICB9CiAgICBib29sIG1vZGVhYmxlKGNvbnN0IHZhbCAmdCl7CiAgICAgICAgZm9yKGludCBpPTA7aTwxMDtpKyspIGlmKGNbaV0gPCB0LmNbaV0pIHJldHVybiBmYWxzZTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICAgIGJvb2wgZW1wdHkoKXsKICAgICAgICBpZih6ZXJvKSByZXR1cm4gdHJ1ZTsKICAgICAgICBmb3IoaW50IGk9MDtpPDEwO2krKykgaWYoY1tpXSkgcmV0dXJuIGZhbHNlOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQp9Owp2YWwgZ2NkKGNvbnN0IHZhbCAmeCwgY29uc3QgdmFsICZ5KXsKICAgIGlmKHguemVybykgcmV0dXJuIHk7CiAgICBpZih5Lnplcm8pIHJldHVybiB4OwogICAgdmFsIHJlcygxKTsKICAgIGZvcihpbnQgaT0wO2k8MTA7aSsrKSByZXMuY1tpXSA9IG1pbih4LmNbaV0sIHkuY1tpXSk7CiAgICByZXR1cm4gcmVzOwp9CgpzdHJ1Y3Qgc2VnVHJlZXsKICAgIHZhbCBsZ2NkW21heG4gPDwgNF0sIHJnY2RbbWF4biA8PCA0XTsKICAgIHZhbCBtdWxbbWF4biA8PCA0XSwgZGl2W21heG4gPDwgNF07CiAgICB2b2lkIHB1c2hfdXAobGwgcCl7CiAgICAgICAgbGdjZFtwXSA9IGdjZChsZ2NkW3AgKiAyXSwgbGdjZFtwKjIrMV0pOwogICAgICAgIHJnY2RbcF0gPSBnY2QocmdjZFtwICogMl0sIHJnY2RbcCoyKzFdKTsKICAgIH0KICAgIHZvaWQgcHVzaF9tdWwobGwgcCwgdmFsIG0pewogICAgICAgIHJnY2RbcF0gPSByZ2NkW3BdICogbTsKICAgICAgICBtdWxbcF0gPSBtdWxbcF0gKiBtOwogICAgfQogICAgdm9pZCBwdXNoX2RpdihsbCBwLCB2YWwgbSl7CiAgICAgICAgcmdjZFtwXSA9IHJnY2RbcF0gLyBtOwogICAgICAgIGRpdltwXSA9IGRpdltwXSAqIG07CiAgICB9CiAgICB2b2lkIHB1c2hfZG93bihsbCBwKXsKICAgICAgICBpZighbXVsW3BdLmVtcHR5KCkpewogICAgICAgICAgICBwdXNoX211bChwKjIsIG11bFtwXSk7CiAgICAgICAgICAgIHB1c2hfbXVsKHAqMisxLCBtdWxbcF0pOwogICAgICAgICAgICBtdWxbcF0gPSAxOwogICAgICAgIH0KICAgICAgICBpZighZGl2W3BdLmVtcHR5KCkpewogICAgICAgICAgICBwdXNoX2RpdihwKjIsIGRpdltwXSk7CiAgICAgICAgICAgIHB1c2hfZGl2KHAqMisxLCBkaXZbcF0pOwogICAgICAgICAgICBkaXZbcF0gPSAxOwogICAgICAgIH0KICAgIH0KCiAgICB2b2lkIGJ1aWxkKGxsIHAsIGxsIGwsIGxsIHIpewogICAgICAgIGxnY2RbcF0gPSAwLCByZ2NkW3BdID0gMTsKICAgICAgICBtdWxbcF0gPSBkaXZbcF0gPSAxOwogICAgICAgIGlmKGwgPT0gcikgcmV0dXJuOwogICAgICAgIGxsIG1pZCA9IChsICsgcikgLyAyOwogICAgICAgIGJ1aWxkKHAqMiwgbCwgbWlkKTsKICAgICAgICBidWlsZChwKjIrMSwgbWlkKzEsIHIpOwogICAgfQogICAgdm9pZCBtdWx0aXB5KGxsIHAsIGxsIGwsIGxsIHIsIGxsIEwsIGxsIFIsIHZhbCBtLCBib29sIGQpewogICAgICAgIGlmKEwgPiByIHx8IGwgPiBSKSByZXR1cm47CiAgICAgICAgaWYoTCA8PSBsICYmIHIgPD0gUil7CiAgICAgICAgICAgIGlmKCFkKSBwdXNoX211bChwLCBtKTsKICAgICAgICAgICAgZWxzZSBwdXNoX2RpdihwLCBtKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBwdXNoX2Rvd24ocCk7CiAgICAgICAgbGwgbWlkID0gKGwgKyByKSAvIDI7CiAgICAgICAgbXVsdGlweShwKjIsIGwsIG1pZCwgTCwgUiwgbSwgZCk7CiAgICAgICAgbXVsdGlweShwKjIrMSwgbWlkKzEsIHIsIEwsIFIsIG0sIGQpOwogICAgICAgIHB1c2hfdXAocCk7CiAgICB9CiAgICB2YWwgcXVlcnkobGwgcCwgbGwgbCwgbGwgciwgbGwgTCwgbGwgUil7CiAgICAgICAgaWYoTCA+IHIgfHwgbCA+IFIpIHJldHVybiAwOwogICAgICAgIGlmKEwgPD0gbCAmJiByIDw9IFIpewogICAgICAgICAgICByZXR1cm4gZ2NkKGxnY2RbcF0sIHJnY2RbcF0pOwogICAgICAgIH0KICAgICAgICBwdXNoX2Rvd24ocCk7CiAgICAgICAgbGwgbWlkID0gKGwgKyByKSAvIDI7CiAgICAgICAgdmFsIHJlcyA9IGdjZChxdWVyeShwKjIsIGwsIG1pZCwgTCwgUiksCiAgICAgICAgICAgICAgICAgICAgICBxdWVyeShwKjIrMSwgbWlkKzEsIHIsIEwsIFIpKTsKICAgICAgICBwdXNoX3VwKHApOwogICAgICAgIHJldHVybiByZXM7CiAgICB9CiAgICB2b2lkIGZpbHAobGwgcCwgbGwgbCwgbGwgciwgbGwgeCl7CiAgICAgICAgaWYobCA9PSByKXsKICAgICAgICAgICAgc3dhcChsZ2NkW3BdLCByZ2NkW3BdKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBwdXNoX2Rvd24ocCk7CiAgICAgICAgbGwgbWlkID0gKGwgKyByKSAvIDI7CiAgICAgICAgaWYoeCA8PSBtaWQpIGZpbHAocCoyLCBsLCBtaWQsIHgpOwogICAgICAgIGVsc2UgZmlscChwKjIrMSwgbWlkKzEsIHIsIHgpOwogICAgICAgIHB1c2hfdXAocCk7CiAgICB9Cn07CnNlZ1RyZWUgc2VndDsKCnZvaWQgc29sdmUoKXsKICAgIGxsIG4sIG07CiAgICBjaW4gPj4gbiA+PiBtOwogICAgc2VndC5idWlsZCgxLCAxLCBuKTsKICAgIGZvcihsbCBpPTE7aTw9bTtpKyspewogICAgICAgIHN0cmluZyBvcHQ7CiAgICAgICAgbGwgeCwgeSwgejsKICAgICAgICBjaW4gPj4gb3B0OwogICAgICAgIGlmKG9wdCA9PSAibXVsIil7CiAgICAgICAgICAgIGNpbiA+PiB4ID4+IHkgPj4gejsKICAgICAgICAgICAgc2VndC5tdWx0aXB5KDEsIDEsIG4sIHgsIHksIHosIDApOwogICAgICAgIH1lbHNlIGlmKG9wdCA9PSAiZGl2Iil7CiAgICAgICAgICAgIGNpbiA+PiB4ID4+IHkgPj4gejsKICAgICAgICAgICAgdmFsIHJlcyA9IHNlZ3QucXVlcnkoMSwgMSwgbiwgeCwgeSk7CiAgICAgICAgICAgIGlmKHJlcy5tb2RlYWJsZSh6KSl7CiAgICAgICAgICAgICAgICBzZWd0Lm11bHRpcHkoMSwgMSwgbiwgeCwgeSwgeiwgMSk7CiAgICAgICAgICAgICAgICBjb3V0IDw8ICJZRVNcbiI7CiAgICAgICAgICAgIH1lbHNlIGNvdXQgPDwgIk5PXG4iOwogICAgICAgIH1lbHNlewogICAgICAgICAgICBjaW4gPj4geDsKICAgICAgICAgICAgc2VndC5maWxwKDEsIDEsIG4sIHgpOwogICAgICAgIH0KICAgIH0KfQoKc2lnbmVkIG1haW4oKSB7CiNpZmRlZiBMT0NBTAogICAgZnJlb3BlbigieC5pbiIsICJyIiwgc3RkaW4pOwojZW5kaWYKICAgIGlvczo6c3luY193aXRoX3N0ZGlvKGZhbHNlKTsKICAgIGNpbi50aWUobnVsbHB0cik7CiAgICBjb3V0LnRpZShudWxscHRyKTsKCiAgICBzaWduZWQgVCA9IDE7Ci8vICAgIGNpbiA+PiBUOwogICAgd2hpbGUoVC0tKSBzb2x2ZSgpOwogICAgcmV0dXJuIDA7Cn0="}]