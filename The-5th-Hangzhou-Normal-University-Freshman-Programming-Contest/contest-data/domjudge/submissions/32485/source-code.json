[{"id":"32485","submission_id":"32485","filename":"e.cpp","source":"I2luY2x1ZGU8Yml0cy9zdGRjKysuaD4NCiNkZWZpbmUgRm9yKGksIGEsIGIpIGZvcihpbnQgaSA9IChhKSwgZW4gPSAoYik7IGkgPD0gZW47ICsraSkNCiNkZWZpbmUgUm9mKGksIGEsIGIpIGZvcihpbnQgaSA9IChhKSwgZW4gPSAoYik7IGkgPj0gZW47IC0taSkNCiNkZWZpbmUgVHJhKHUsIGkpIGZvcihpbnQgaSA9IGhkW3VdOyB+aTsgaSA9IGVbaV0ubmV0KQ0KI2RlZmluZSBjc3QgY29uc3QNCiNkZWZpbmUgTEwgbG9uZyBsb25nDQojZGVmaW5lIEREIGRvdWJsZQ0KI2RlZmluZSBMRCBsb25nIGRvdWJsZQ0KI2RlZmluZSBwYiBwdXNoX2JhY2sNCiNkZWZpbmUgbXAgbWFrZV9wYWlyDQojZGVmaW5lIGZpciBmaXJzdA0KI2RlZmluZSBzZWMgc2Vjb25kDQojZGVmaW5lIGluZiAweDNmM2YzZjNmDQojZGVmaW5lIEluZiAweDNmM2YzZjNmM2YzZjNmM2YNCiNkZWZpbmUgZXBzIDFlLTEyDQojZGVmaW5lIG1heG4gMjAwMDAwDQojZGVmaW5lIG1vZCAxMDAwMDAwMDA3DQp1c2luZyBuYW1lc3BhY2Ugc3RkOw0KDQppbnQgbiwgcTsNCkxMIGFbbWF4biArIDVdOw0Kc3RydWN0IFBvaXsNCiAgICBpbnQgZmEsIGNoWzJdLCBzeiwgdnY7DQogICAgTEwgbHByWzJdLCB2YWxbMl07DQp9Ow0KY2xhc3MgVHJlZXsNCiAgICBwdWJsaWM6DQogICAgICAgIFBvaSBwb2lbbWF4biArIDVdOw0KICAgICAgICB2b2lkIG1zb24oaW50IHJ0LCBMTCB4MSwgTEwgeDIpew0KICAgICAgICAgICAgYVtydF0gKz0geDE7DQogICAgICAgICAgICBhW3J0XSAlPSBtb2Q7DQogICAgICAgICAgICBwb2lbcnRdLnZhbFswXSArPSB4MSAqIHBvaVtydF0uc3o7DQogICAgICAgICAgICBwb2lbcnRdLnZhbFswXSAlPSBtb2Q7DQogICAgICAgICAgICBwb2lbcnRdLmxwclswXSArPSB4MTsNCiAgICAgICAgICAgIHBvaVtydF0ubHByWzBdICU9IG1vZDsNCg0KICAgICAgICAgICAgcG9pW3J0XS52YWxbMV0gKz0geDI7DQogICAgICAgICAgICBwb2lbcnRdLnZhbFsxXSAlPSBtb2Q7DQogICAgICAgICAgICBwb2lbcnRdLmxwclsxXSArPSB4MjsNCiAgICAgICAgICAgIHBvaVtydF0ubHByWzFdICU9IG1vZDsNCiAgICAgICAgfQ0KICAgICAgICB2b2lkIHNwcihpbnQgcnQpew0KICAgICAgICAgICAgaWYocG9pW3J0XS5scHJbMF0gfHwgcG9pW3J0XS5scHJbMV0pew0KICAgICAgICAgICAgICAgIEZvcihvLCAwLCAxKSBpZihwb2lbcnRdLmNoW29dKSBtc29uKHBvaVtydF0uY2hbb10sIHBvaVtydF0ubHByWzBdLCBwb2lbcnRdLmxwclsxXSk7DQogICAgICAgICAgICAgICAgcG9pW3J0XS5scHJbMF0gPSBwb2lbcnRdLmxwclsxXSA9IDA7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgdm9pZCB1cGQoaW50IHJ0KXsNCiAgICAgICAgICAgIHBvaVtydF0udmFsWzBdID0gKHBvaVtwb2lbcnRdLmNoWzBdXS52YWxbMF0gKyBwb2lbcG9pW3J0XS5jaFsxXV0udmFsWzBdICsgYVtydF0pICUgbW9kOw0KICAgICAgICAgICAgcG9pW3J0XS5zeiA9IHBvaVtwb2lbcnRdLmNoWzBdXS5zeiArIHBvaVtwb2lbcnRdLmNoWzFdXS5zeiArIDE7DQogICAgICAgIH0NCiAgICAgICAgdm9pZCByb3QoaW50IHJ0KXsNCiAgICAgICAgICAgIGludCBmYSA9IHBvaVtydF0uZmEsIGZmYSA9IHBvaVtmYV0uZmEsIHRvID0gcG9pW2ZhXS5jaFsxXSA9PSBydDsNCiAgICAgICAgICAgIHNwcihmYSk7IHNwcihydCk7DQogICAgICAgICAgICBpZihmZmEpIHBvaVtwb2lbZmZhXS5jaFtwb2lbZmZhXS5jaFsxXSA9PSBmYV0gPSBydF0uZmEgPSBmZmE7DQogICAgICAgICAgICBlbHNlIHBvaVtydF0uZmEgPSAwOw0KICAgICAgICAgICAgaWYocG9pW3J0XS5jaFshdG9dKSBwb2lbcG9pW2ZhXS5jaFt0b10gPSBwb2lbcnRdLmNoWyF0b11dLmZhID0gZmE7DQogICAgICAgICAgICBlbHNlIHBvaVtmYV0uY2hbdG9dID0gMDsNCiAgICAgICAgICAgIHBvaVtwb2lbcnRdLmNoWyF0b10gPSBmYV0uZmEgPSBydDsNCiAgICAgICAgICAgIHVwZChmYSk7IHVwZChydCk7DQogICAgICAgIH0NCiAgICAgICAgdm9pZCBzcGxheShpbnQgcnQpe3doaWxlKHBvaVtydF0uZmEpIHJvdChydCksIHJ0ID0gcG9pW3J0XS5mYTt9DQogICAgICAgIHZvaWQgbWVyKGludCB0aW0sIGludCBydDEsIGludCBydDIpew0KICAgICAgICAgICAgc3BsYXkocnQxKTsgc3BsYXkocnQyKTsNCiAgICAgICAgICAgIG1zb24ocnQxLCAwLCB0aW0gKiBwb2lbcnQxXS52YWxbMF0gJSBtb2QpOw0KICAgICAgICAgICAgbXNvbihydDIsIDAsIHRpbSAqIHBvaVtydDJdLnZhbFswXSAlIG1vZCk7DQogICAgICAgICAgICBpbnQgbm93ID0gcnQxOw0KICAgICAgICAgICAgd2hpbGUocG9pW25vd10uY2hbMV0pIG5vdyA9IHBvaVtub3ddLmNoWzFdOw0KICAgICAgICAgICAgc3BsYXkobm93KTsNCiAgICAgICAgICAgIHNwcihub3cpOw0KICAgICAgICAgICAgcG9pW3BvaVtub3ddLmNoWzFdID0gcnQyXS5mYSA9IG5vdzsNCiAgICAgICAgICAgIHVwZChub3cpOw0KICAgICAgICAgICAgbXNvbihub3csIDAsIG1vZCAtIHRpbSAqIHBvaVtub3ddLnZhbFswXSAlIG1vZCk7DQogICAgICAgIH0NCiAgICAgICAgdm9pZCBtZHkoaW50IHRpbSwgaW50IHJ0LCBpbnQgeCl7DQogICAgICAgICAgICBzcGxheShydCk7DQogICAgICAgICAgICBtc29uKHJ0LCAwLCB0aW0gKiBwb2lbcnRdLnZhbFswXSAlIG1vZCk7DQogICAgICAgICAgICBtc29uKHJ0LCB4LCAwKTsNCiAgICAgICAgICAgIG1zb24ocnQsIDAsIG1vZCAtIHRpbSAqIHBvaVtydF0udmFsWzBdICUgbW9kKTsNCiAgICAgICAgfQ0KICAgICAgICBpbnQgcXVlKGludCB0aW0sIGludCBydCl7DQogICAgICAgICAgICBzcGxheShydCk7DQogICAgICAgICAgICByZXR1cm4gKHRpbSAqIHBvaVtydF0udmFsWzBdICUgbW9kICsgcG9pW3J0XS52YWxbMV0pICUgbW9kOw0KICAgICAgICB9DQp9IHRyOw0KDQp0ZW1wbGF0ZSA8Y2xhc3MgVD4NCnZvaWQgcmVhZChUICZ4KXsNCgljaGFyIGNoOw0KCWJvb2wgb2s7DQoJZm9yKG9rID0gMCwgY2ggPSBnZXRjaGFyKCk7ICFpc2RpZ2l0KGNoKTsgY2ggPSBnZXRjaGFyKCkpIGlmKGNoID09ICctJykgb2sgPSAxOw0KCWZvcih4ID0gMDsgaXNkaWdpdChjaCk7IHggPSB4ICogMTAgKyBjaCAtICcwJywgY2ggPSBnZXRjaGFyKCkpOw0KCWlmKG9rKSB4ID0gLXg7DQp9DQoNCmludCBtYWluKCl7DQoJLy8gZnJlb3BlbigiaW4udHh0IiwgInIiLCBzdGRpbik7DQogICAgcmVhZChuKTsgcmVhZChxKTsNCiAgICBGb3IoaSwgMSwgbil7DQogICAgICAgIHJlYWQoYVtpXSk7DQogICAgICAgIHRyLnBvaVtpXS52YWxbMF0gPSBhW2ldOw0KICAgICAgICB0ci5wb2lbaV0uc3ogPSAxOw0KICAgIH0NCiAgICBGb3IoaSwgMSwgcSl7DQogICAgICAgIGludCBvcDsgcmVhZChvcCk7DQogICAgICAgIGlmKG9wID09IDEpew0KICAgICAgICAgICAgaW50IHUsIHY7IHJlYWQodSk7IHJlYWQodik7DQogICAgICAgICAgICB0ci5tZXIoaSwgdSwgdik7DQogICAgICAgIH0NCiAgICAgICAgaWYob3AgPT0gMil7DQogICAgICAgICAgICBpbnQgdSwgdjsgcmVhZCh1KTsgcmVhZCh2KTsNCiAgICAgICAgICAgIHRyLm1keShpLCB1LCB2KTsNCiAgICAgICAgfQ0KICAgICAgICBpZihvcCA9PSAzKXsNCiAgICAgICAgICAgIGludCB1OyByZWFkKHUpOw0KICAgICAgICAgICAgcHJpbnRmKCIlZFxuIiwgdHIucXVlKGksIHUpKTsNCiAgICAgICAgfQ0KICAgIH0NCglyZXR1cm4gMDsNCn0NCg0K"}]