[{"id":"31070","submission_id":"31070","filename":"a.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+DQojZGVmaW5lIGZwKGksIGEsIGIpIGZvcihpbnQgaSA9IChhKSwgZWQgPSAoYik7IGkgPD0gZWQ7ICsraSkNCiNkZWZpbmUgZmIoaSwgYSwgYikgZm9yKGludCBpID0gKGEpLCBlZCA9IChiKTsgaSA+PSBlZDsgLS1pKQ0KI2RlZmluZSBnbyh1LCBpKSBmb3IoaW50IGkgPSBoZWFkW3VdOyBpOyBpID0gZVtpXS5ueHQpDQp1c2luZyBuYW1lc3BhY2Ugc3RkOw0KdHlwZWRlZiBsb25nIGxvbmcgTEw7DQp0eXBlZGVmIHBhaXI8aW50LCBpbnQ+IHBpaTsNCmlubGluZSBpbnQgcmQoKSB7DQoJcmVnaXN0ZXIgaW50IHgoMCksIGYoMSk7IHJlZ2lzdGVyIGNoYXIgYyhnZXRjaGFyKCkpOw0KCXdoaWxlIChjIDwgJzAnIHx8ICc5JyA8IGMpIHsgaWYgKGMgPT0gJy0nKWYgPSAtMTsgYyA9IGdldGNoYXIoKTsgfQ0KCXdoaWxlICgnMCcgPD0gYyAmJiBjIDw9ICc5Jyl4ID0geCoxMCArIGMtJzAnLCBjID0gZ2V0Y2hhcigpOw0KCXJldHVybiB4KmY7DQp9DQppbmxpbmUgTEwgUkQoKSB7DQoJcmVnaXN0ZXIgTEwgeCgwKTsgcmVnaXN0ZXIgaW50IGYoMSk7IHJlZ2lzdGVyIGNoYXIgYyhnZXRjaGFyKCkpOw0KCXdoaWxlIChjIDwgJzAnIHx8ICc5JyA8IGMpIHsgaWYgKGMgPT0gJy0nKWYgPSAtMTsgYyA9IGdldGNoYXIoKTsgfQ0KCXdoaWxlICgnMCcgPD0gYyAmJiBjIDw9ICc5Jyl4ID0geCoxMCArIGMtJzAnLCBjID0gZ2V0Y2hhcigpOw0KCXJldHVybiB4KmY7DQp9DQppbmxpbmUgaW50IGludF9yYW5kKGludCBsLCBpbnQgcil7DQoJaW50IHJlcyA9IDEuMGwqcmFuZCgpL1JBTkRfTUFYKihyLWwrMSk7DQoJaWYocmVzID09IHItbCsxKXJlcyA9IHItbDsNCglyZXR1cm4gbCtyZXM7DQp9DQppbmxpbmUgTEwgTExfcmFuZChMTCBsLCBMTCByKXsNCglMTCByZXMgPSAxLjBsKnJhbmQoKS9SQU5EX01BWCooci1sKzEpOw0KCWlmKHJlcyA9PSByLWwrMSlyZXMgPSByLWw7DQoJcmV0dXJuIGwrcmVzOw0KfQ0KY29uc3QgaW50IG1heG4gPSAyMDAwMTAsIGluZiA9IDB4M2YzZjNmM2Y7DQppbnQgbiwgbXgsIGFbbWF4bl0sIHRbbWF4bl0sIHNbbWF4bl07DQppbmxpbmUgYm9vbCBjaGsoaW50IHgpew0KCWZwKGksIDEsIG4pew0KCQlpZihhW2ldIDwgeClzW2ldID0gc1tpLTFdKzE7DQoJCWVsc2UgaWYoYVtpXSA9PSB4KXNbaV0gPSBzW2ktMV07DQoJCWVsc2Ugc1tpXSA9IHNbaS0xXS0xOw0KCX0NCglmcChpLCAxLCBuKWlmKHNbaV0gPCAwKXJldHVybiAwOw0KCWlmKHNbbl0gPiAwKXJldHVybiAwOw0KCXJldHVybiAxOw0KfQ0KaW50IG1haW4oKXsNCgluID0gcmQoKTsNCglmcChpLCAxLCBuKWFbaV0gPSByZCgpLCBteCA9IG1heChteCwgYVtpXSksICsrdFthW2ldXTsNCglmcChpLCAxLCBteCl0W2ldICs9IHRbaS0xXTsNCglpbnQgcmVzID0gMCwgcmVzMiA9IDA7DQoJZnAoaSwgMSwgbXgpaWYodFtpXS10W2ktMV0gJiYgdFtpLTFdID09IHRbbXhdLXRbaV0pcmVzID0gaTsNCglmcChpLCAxLCBuKWlmKHRbYVtpXV0gPT0gdFtteF0tdFthW2ldXSlyZXMyID0gYVtpXTsNCglpZighcmVzICYmICFyZXMyKXJldHVybiBwdXRzKCIwIiksIDA7DQoJZWxzZSBpZihyZXMpcHJpbnRmKCIlZFxuIiwgY2hrKHJlcykgPyAxIDogMCk7DQoJZWxzZXsNCgkJaWYoIWNoayhyZXMyKzEpKXB1dHMoIjAiKTsNCgkJZWxzZXsNCgkJCWludCBueHQgPSBpbmY7DQoJCQlmcChpLCAxLCBuKWlmKGFbaV0gPiByZXMyICYmIGFbaV0gPCBueHQpbnh0ID0gYVtpXTsNCgkJCXByaW50ZigiJWRcbiIsIG54dC1yZXMyLTEpOw0KCQl9DQoJfQ0KCXJldHVybiAwOw0KfQ0K"}]