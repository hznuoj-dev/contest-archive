[{"id":"31745","submission_id":"31745","filename":"27_2.cpp","source":"I2luY2x1ZGU8aW9zdHJlYW0+DQp1c2luZyBuYW1lc3BhY2Ugc3RkOw0KZG91YmxlIGFbMTBdLGJbMTBdOw0KaW50IGZbMTBdOw0KaW50IG0sZDsNCmludCBtYWluKCkNCnsNCiAgICBjaW4gPj4gbSA+PiBkOw0KICAgIGZvciAoaW50IGkgPSAxOyBpIDw9IDU7IGkgKysgKSBjaW4gPj4gYVtpXTsNCiAgICBmb3IgKGludCBpID0gMTsgaSA8PSA1OyBpICsrICkgY2luID4+IGJbaV07DQogICAgZG91YmxlIG1heDEgPSAtMTsNCiAgICBmb3IgKGludCBpID0gMTsgaSA8PSA1OyBpICsrICkNCiAgICB7DQogICAgICAgIGRvdWJsZSBhbnMgPSBhW2ldOw0KICAgICAgICBpZiAoYW5zID49IG0pIGFucyA9IGFucyAtIGQ7DQogICAgICAgIG1heDEgPSBtYXgobWF4MSxiW2ldL2FbaV0pOw0KICAgIH0NCiAgICBmb3IgKGludCBpID0gMTsgaSA8PSA1OyBpICsrICkNCiAgICB7DQogICAgICAgIGZvciAoaW50IGogPSBpICsgMTsgaiA8PSA1OyBqICsrICkNCiAgICAgICAgew0KICAgICAgICAgICAgZG91YmxlIGFucyA9IGFbaV0gKyBhW2pdOw0KICAgICAgICAgICAgZG91YmxlIGFuczEgPSBiW2ldICsgYltqXTsNCiAgICAgICAgICAgIGlmIChhbnMgPj0gbSkgYW5zID0gYW5zIC0gZDsNCiAgICAgICAgICAgIG1heDEgPSBtYXgobWF4MSxhbnMxL2Fucyk7DQogICAgICAgICAgICAvL2NvdXQgPDwgaSA8PCBqIDw8IGVuZGw7DQogICAgICAgIH0NCiAgICB9DQogICAgZm9yIChpbnQgaSA9IDE7IGkgPD0gNTsgaSArKyApDQogICAgew0KICAgICAgICBmb3IgKGludCBqID0gaSArIDE7IGogPD0gNTsgaiArKyApDQogICAgICAgIHsNCiAgICAgICAgICAgZm9yIChpbnQgayA9IGogKyAxOyBrIDw9IDU7IGsgKyspDQogICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBkb3VibGUgYW5zID0gYVtpXSArIGFbal0gKyBhW2tdOw0KICAgICAgICAgICAgICAgIGRvdWJsZSBhbnMxID0gYltpXSArIGJbal0gKyBiW2tdOw0KICAgICAgICAgICAgICAgIGlmIChhbnMgPj0gbSkgYW5zID0gYW5zIC0gZDsNCiAgICAgICAgICAgICAgICBtYXgxID0gbWF4KG1heDEsYW5zMS9hbnMpOw0KICAgICAgICAgICAgICAgIC8vY291dCA8PCBpIDw8IGogPDwgayA8PCBlbmRsOw0KICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQogICAgZm9yIChpbnQgaSA9IDE7IGkgPD0gNTsgaSArKyApDQogICAgew0KICAgICAgICBmb3IgKGludCBqID0gaSArIDE7IGogPD0gNTsgaiArKyApDQogICAgICAgIHsNCiAgICAgICAgICAgZm9yIChpbnQgayA9IGogKyAxOyBrIDw9IDU7IGsgKyspDQogICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBmb3IgKGludCBuID0gayArIDE7biA8PSA1IDtuICsrICkNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIC8vY291dCA8PCBpIDw8IGogPDwgayA8PCBuIDw8IGVuZGw7DQogICAgICAgICAgICAgICAgICAgIGRvdWJsZSBhbnMgPSBhW2ldICsgYVtqXSArIGFba10gKyBhW25dOw0KICAgICAgICAgICAgICAgICAgICBkb3VibGUgYW5zMSA9IGJbaV0gKyBiW2pdICsgYltrXSArIGJbbl07DQogICAgICAgICAgICAgICAgICAgIGlmIChhbnMgPj0gbSkgYW5zID0gYW5zIC0gZDsNCiAgICAgICAgICAgICAgICAgICAgbWF4MSA9IG1heChtYXgxLGFuczEvYW5zKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCiAgICBkb3VibGUgYW5zID0gYVsxXSArIGFbMl0gKyBhWzNdICsgYVs0XSArIGFbNV07DQogICAgZG91YmxlIGFuczEgPSBiWzFdICsgYlsyXSArIGJbM10gKyBiWzRdICsgYls1XTsgDQogICAgaWYgKGFucyA+PSBtKSBhbnMgPSBhbnMgLSBkOw0KICAgIG1heDEgPSBtYXgobWF4MSxhbnMxL2Fucyk7DQogICAgcHJpbnRmKCIlLjJsZiIsbWF4MSk7DQogICAgcmV0dXJuIDA7DQp9"}]