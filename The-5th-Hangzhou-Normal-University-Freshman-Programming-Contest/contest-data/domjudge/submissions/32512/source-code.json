[{"id":"32512","submission_id":"32512","filename":"I.cpp","source":"I2luY2x1ZGUgPGlvc3RyZWFtPg0KI2luY2x1ZGUgPHVub3JkZXJlZF9zZXQ+DQojaW5jbHVkZSA8dmVjdG9yPg0KdXNpbmcgbmFtZXNwYWNlIHN0ZDsNCmNvbnN0IGludCBOID0gMWUzICsgMTA7DQp1bm9yZGVyZWRfc2V0PGludD4gZWRnZXNbTl07DQppbnQgbWFya1tOXSwgZmxhZywgZltOXSwgZGVwW05dLCBHW05dW05dOw0KDQp2b2lkIGluaXQoaW50IHUsIGludCBmYSkgew0KICAgIGRlcFt1XSA9IGRlcFtmYV0gKyAxOw0KICAgIGZbdV0gPSBmYTsNCiAgICBlZGdlc1t1XS5lcmFzZShmYSk7DQogICAgZm9yKGludCBueHQ6IGVkZ2VzW3VdKSAgaW5pdChueHQsIHUpOw0KfQ0KDQp2ZWN0b3I8aW50PiBwYXRoMSwgcGF0aDI7DQoNCnZvaWQgZmluZFBhdGgoaW50IHUsIGludCB2KSB7DQogICAgcGF0aDEuY2xlYXIoKTsNCiAgICBwYXRoMi5jbGVhcigpOw0KICAgIHBhdGgxLnB1c2hfYmFjayh1KTsNCiAgICBwYXRoMi5wdXNoX2JhY2sodik7DQogICAgd2hpbGUodSAhPSB2KSB7DQogICAgICAgIGlmKGRlcFt1XSA+PSBkZXBbdl0pICAgIHsNCiAgICAgICAgICAgIHUgPSBmW3VdOw0KICAgICAgICAgICAgcGF0aDEucHVzaF9iYWNrKHUpOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgdiA9IGZbdl07DQogICAgICAgICAgICBwYXRoMi5wdXNoX2JhY2sodik7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBmb3IoaW50IGkgPSBwYXRoMi5zaXplKCkgLSAyOyBpID49IDA7IGktLSkgIHBhdGgxLnB1c2hfYmFjayhwYXRoMltpXSk7DQp9DQoNCnZvaWQgZmluZChpbnQgdSwgaW50IHYpIHsNCiAgICBmaW5kUGF0aCh1LCB2KTsNCiAgICBpbnQgbGggPSAwLCByaCA9IHBhdGgxLnNpemUoKSAtIDEsIHg7DQogICAgd2hpbGUobGggKyAxIDwgcmgpIHsNCiAgICAgICAgaW50IG1pZCA9IChsaCArIHJoKSAvIDI7DQogICAgICAgIHByaW50ZigiPyAlZCAlZFxuIiwgcGF0aDFbbWlkXSwgcGF0aDFbcmhdKTsNCiAgICAgICAgZmZsdXNoKHN0ZG91dCk7DQogICAgICAgIHNjYW5mKCIlZCIsICZ4KTsNCiAgICAgICAgaWYoeCA9PSAxKSB7DQogICAgICAgICAgICBsaCA9IG1pZDsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIHJoID0gbWlkOw0KICAgICAgICB9DQogICAgfQ0KICAgIHByaW50ZigiISAlZFxuIiwgR1twYXRoMVtsaF1dW3BhdGgxW2xoKzFdXSk7DQogICAgZmZsdXNoKHN0ZG91dCk7DQp9DQoNCnZvaWQgZGZzKGludCB1LCBpbnQgZmEpIHsNCiAgICAvLyBwcmludGYoIjo6JWRcbiIsIHUpOw0KICAgIGlmKGZsYWcpICAgIHJldHVybjsNCiAgICB2ZWN0b3I8aW50PiB2Ow0KICAgIGZvcihpbnQgbnh0OiBlZGdlc1t1XSkgew0KICAgICAgICBkZnMobnh0LCB1KTsNCiAgICAgICAgaWYoZmxhZykgICAgcmV0dXJuOw0KICAgICAgICB2LnB1c2hfYmFjayhueHQpOw0KICAgIH0NCiAgICAvLyBwcmludGYoIjolZFxuIiwgdi5zaXplKCkpOw0KICAgIGludCB4Ow0KICAgIGZvcihpbnQgaSA9IHYuc2l6ZSgpIC0gMTsgaSA+PSAxOyBpIC09IDIpIHsgICAgDQogICAgICAgIGlmKGZsYWcpICAgIHJldHVybjsNCiAgICAgICAgcHJpbnRmKCI/ICVkICVkXG4iLCBtYXJrW3ZbaS0xXV0sIG1hcmtbdltpXV0pOw0KICAgICAgICBmZmx1c2goc3Rkb3V0KTsNCiAgICAgICAgc2NhbmYoIiVkIiwgJngpOw0KICAgICAgICBpZih4KSAgIHsNCiAgICAgICAgICAgIGZpbmQobWFya1t2W2ktMV1dLCBtYXJrW3ZbaV1dKTsNCiAgICAgICAgICAgIGZsYWcgPSAxOw0KICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICB9DQogICAgICAgIHYucG9wX2JhY2soKTsNCiAgICAgICAgdi5wb3BfYmFjaygpOw0KICAgIH0NCiAgICBpZih2LmVtcHR5KCkpICAgIG1hcmtbdV0gPSB1Ow0KICAgIGVsc2UgICAgICAgICAgICAgICAgICAgIG1hcmtbdV0gPSBtYXJrW3YuYmFjaygpXTsNCiAgICBpZih1ID09IDEpICBmaW5kKDEsIG1hcmtbMV0pOyANCn0NCg0Kdm9pZCBzb2x2ZSgpDQp7DQogICAgaW50IG47DQogICAgc2NhbmYoIiVkIiwgJm4pOw0KICAgIGludCB1LCB2Ow0KICAgIGZvcihpbnQgaSA9IDE7IGkgPD0gbjsgaSsrKSBlZGdlc1tpXS5jbGVhcigpOw0KICAgIGZvcihpbnQgaSA9IDE7IGkgPCBuOyBpKyspIHsNCiAgICAgICAgc2NhbmYoIiVkICVkIiwgJnUsICZ2KTsNCiAgICAgICAgZWRnZXNbdV0uaW5zZXJ0KHYpOw0KICAgICAgICBlZGdlc1t2XS5pbnNlcnQodSk7DQogICAgICAgIEdbdV1bdl0gPSBHW3ZdW3VdID0gaTsNCiAgICB9DQoNCiAgICBpbml0KDEsIDApOw0KICAgIGZsYWcgPSAwOw0KICAgIGRmcygxLCAxKTsNCn0NCg0KDQppbnQgbWFpbigpDQp7DQogICAgaW50IFQ7DQogICAgc2NhbmYoIiVkIiwgJlQpOw0KICAgIHdoaWxlKFQtLSkgIHNvbHZlKCk7DQoNCiAgICByZXR1cm4gMDsNCn0="}]