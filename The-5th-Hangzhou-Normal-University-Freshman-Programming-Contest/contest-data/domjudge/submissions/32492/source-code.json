[{"id":"32492","submission_id":"32492","filename":"main.cpp","source":"LyoKI2luY2x1ZGUgPGlvc3RyZWFtPgojaW5jbHVkZSA8Yml0cy9zdGRjKysuaD4KdXNpbmcgbmFtZXNwYWNlIHN0ZDsKY29uc3QgaW50IE49MmU1KzEwOwpjb25zdCBpbnQgbW9kPTFlOSs3Owpsb25nIGxvbmcgYVtOXSxmYVtOXTsKaW50IHBbTl0sY250W05dOwppbnQgZmluZChpbnQgeCkKewogICAgaWYocFt4XSE9eCkKICAgIHsKICAgICAgICBwW3hdPSBmaW5kKHBbeF0pOwogICAgfQogICAgcmV0dXJuIHBbeF07Cn0KaW50IG1haW4oKXsKICAgIGlvczo6c3luY193aXRoX3N0ZGlvKGZhbHNlKTsKICAgIGNpbi50aWUoMCk7CiAgICBjb3V0LnRpZSgwKTsKICAgIGludCBuLHE7CiAgICBjaW4gPj4gbiA+PiBxOwogICAgZm9yIChpbnQgaT0xO2k8PW47aSsrKQogICAgewogICAgICAgIGNpbiA+PiBhW2ldOwogICAgICAgIHBbaV09aTsKICAgICAgICBmYVtpXT1hW2ldOwogICAgICAgIGNudFtpXT0xOwogICAgfQogICAgd2hpbGUgKHEtLSkKICAgIHsKICAgICAgICBpbnQgbnVtOwogICAgICAgIGNpbiA+PiBudW07CiAgICAgICAgaWYobnVtPT0xKQogICAgICAgIHsKICAgICAgICAgICAgaW50IGEsYjsKICAgICAgICAgICAgY2luID4+IGEgPj4gYjsKICAgICAgICAgICAgYT0gZmluZChhKTsKICAgICAgICAgICAgYj0gZmluZChiKTsKICAgICAgICAgICAgcFthXT1iOwogICAgICAgICAgICBmYVtiXSs9ZmFbYV07CiAgICAgICAgICAgIGNudFtiXSs9Y250W2FdOwogICAgICAgIH1lbHNlIGlmKG51bT09MikKICAgICAgICB7CiAgICAgICAgICAgIGludCBhLGI7CiAgICAgICAgICAgIGNpbiA+PiBhID4+IGI7CiAgICAgICAgICAgIGE9IGZpbmQoYSk7CiAgICAgICAgICAgIGZhW2FdKz1iKmNudFthXTsKICAgICAgICB9ZWxzZSB7CiAgICAgICAgICAgIGludCBiOwogICAgICAgICAgICBjaW4gPj4gYjsKICAgICAgICAgICAgY291dCA8PCBhW2JdJW1vZCA8PCBlbmRsOwogICAgICAgIH0KICAgICAgICBmb3IgKGludCBpPTE7aTw9bjtpKyspCiAgICAgICAgewogICAgICAgICAgICBpbnQgZmF0aGVyPSBmaW5kKGkpOwogICAgICAgICAgICBhW2ldKz1mYVtmYXRoZXJdOwogICAgICAgIH0KICAgIH0KfQoqLwoKI2luY2x1ZGUgPGlvc3RyZWFtPgojaW5jbHVkZSA8Yml0cy9zdGRjKysuaD4KdXNpbmcgbmFtZXNwYWNlIHN0ZDsKY29uc3QgaW50IE49MmU1KzEwOwppbnQgYVtOXTsKaW50IG47Cm1hcDxpbnQsaW50PiBtcDsKYm9vbCBmKGludCB4KQp7CiAgICBzdGFjazxpbnQ+IHN0OwogICAgZm9yIChpbnQgaT0xO2k8PW47aSsrKQogICAgewogICAgICAgIGlmKGFbaV08eCkgc3QucHVzaCgxKTsKICAgICAgICBlbHNlIGlmKGFbaV0+eCl7CiAgICAgICAgICAgIGlmKHN0LmVtcHR5KCkpIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgc3QucG9wKCk7CiAgICAgICAgfQogICAgfQogICAgaWYoc3QuZW1wdHkoKSkgcmV0dXJuIHRydWU7CiAgICBlbHNlIHJldHVybiBmYWxzZTsKfQppbnQgbWFpbigpewovLyAgICBpb3M6OnN5bmNfd2l0aF9zdGRpbyhmYWxzZSk7Ci8vICAgIGNpbi50aWUoMCk7Ci8vICAgIGNvdXQudGllKDApOwogICAgY2luID4+IG47CiAgICBmb3IgKGludCBpPTE7aTw9bjtpKyspIGNpbiA+PiBhW2ldLG1wW2FbaV1dKys7CiAgICBpbnQgc3VtPTAsYW5zPTAsbGFzdD0wOwogICAgZm9yIChhdXRvIHg6bXApCiAgICB7CiAgICAgICAgaWYobi14LnNlY29uZC1zdW09PXN1bSkKICAgICAgICB7CiAgICAgICAgICAgIGlmKGYoeC5maXJzdCkpIGFucysrOwogICAgICAgIH1lbHNlIGlmKG4tc3VtLXguc2Vjb25kPT1zdW0reC5zZWNvbmQgJiYgZih4LmZpcnN0KzEpKQogICAgICAgIHsKICAgICAgICAgICAgbGFzdD14LmZpcnN0KzE7CiAgICAgICAgfWVsc2UgaWYobi1zdW09PXN1bSAmJiBsYXN0IT0wICYmIGYoeC5maXJzdC0xKSkKICAgICAgICB7CiAgICAgICAgICAgIGFucyArPSB4LmZpcnN0LWxhc3Q7CiAgICAgICAgfQogICAgICAgIHN1bSArPSB4LnNlY29uZDsKICAgIH0KICAgIGNvdXQgPDwgYW5zOwogICAgcmV0dXJuIDA7Cn0KCi8qCiNpbmNsdWRlIDxpb3N0cmVhbT4KI2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+CnVzaW5nIG5hbWVzcGFjZSBzdGQ7CmNvbnN0IGludCBOPTJlNSsxMDsKbG9uZyBsb25nIGludCBhW05dOwpsb25nIGxvbmcgaW50IG5vd1tOXTsKaW50IG1haW4oKXsKICAgIGlvczo6c3luY193aXRoX3N0ZGlvKGZhbHNlKTsKICAgIGNpbi50aWUoMCk7CiAgICBjb3V0LnRpZSgwKTsKCiAgICByZXR1cm4gMDsKfQoqLwo="}]