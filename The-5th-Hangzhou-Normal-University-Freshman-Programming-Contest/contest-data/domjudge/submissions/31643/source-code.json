[{"id":"31643","submission_id":"31643","filename":"d.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+DQojZGVmaW5lIGZwKGksIGEsIGIpIGZvcihpbnQgaSA9IChhKSwgZWQgPSAoYik7IGkgPD0gZWQ7ICsraSkNCiNkZWZpbmUgZmIoaSwgYSwgYikgZm9yKGludCBpID0gKGEpLCBlZCA9IChiKTsgaSA+PSBlZDsgLS1pKQ0KI2RlZmluZSBnbyh1LCBpKSBmb3IoaW50IGkgPSBoZWFkW3VdOyBpOyBpID0gZVtpXS5ueHQpDQp1c2luZyBuYW1lc3BhY2Ugc3RkOw0KdHlwZWRlZiBsb25nIGxvbmcgTEw7DQp0eXBlZGVmIHBhaXI8aW50LCBpbnQ+IHBpaTsNCmlubGluZSBpbnQgcmQoKSB7DQoJcmVnaXN0ZXIgaW50IHgoMCksIGYoMSk7IHJlZ2lzdGVyIGNoYXIgYyhnZXRjaGFyKCkpOw0KCXdoaWxlIChjIDwgJzAnIHx8ICc5JyA8IGMpIHsgaWYgKGMgPT0gJy0nKWYgPSAtMTsgYyA9IGdldGNoYXIoKTsgfQ0KCXdoaWxlICgnMCcgPD0gYyAmJiBjIDw9ICc5Jyl4ID0geCoxMCArIGMtJzAnLCBjID0gZ2V0Y2hhcigpOw0KCXJldHVybiB4KmY7DQp9DQppbmxpbmUgTEwgUkQoKSB7DQoJcmVnaXN0ZXIgTEwgeCgwKTsgcmVnaXN0ZXIgaW50IGYoMSk7IHJlZ2lzdGVyIGNoYXIgYyhnZXRjaGFyKCkpOw0KCXdoaWxlIChjIDwgJzAnIHx8ICc5JyA8IGMpIHsgaWYgKGMgPT0gJy0nKWYgPSAtMTsgYyA9IGdldGNoYXIoKTsgfQ0KCXdoaWxlICgnMCcgPD0gYyAmJiBjIDw9ICc5Jyl4ID0geCoxMCArIGMtJzAnLCBjID0gZ2V0Y2hhcigpOw0KCXJldHVybiB4KmY7DQp9DQppbmxpbmUgaW50IGludF9yYW5kKGludCBsLCBpbnQgcil7DQoJaW50IHJlcyA9IDEuMGwqcmFuZCgpL1JBTkRfTUFYKihyLWwrMSk7DQoJaWYocmVzID09IHItbCsxKXJlcyA9IHItbDsNCglyZXR1cm4gbCtyZXM7DQp9DQppbmxpbmUgTEwgTExfcmFuZChMTCBsLCBMTCByKXsNCglMTCByZXMgPSAxLjBsKnJhbmQoKS9SQU5EX01BWCooci1sKzEpOw0KCWlmKHJlcyA9PSByLWwrMSlyZXMgPSByLWw7DQoJcmV0dXJuIGwrcmVzOw0KfQ0KY29uc3QgaW50IG1heG4gPSAyMDAwMTA7DQppbnQgbiwgaywgbSwgYVttYXhuXSwgZlttYXhuXTsNCmxvbmcgbG9uZyBhbnNbbWF4bl07DQpkZXF1ZTxpbnQ+IHExLCBxMjsNCnN0cnVjdCBub2Rlew0KCWxvbmcgbG9uZyBzdW07DQoJaW50IHRnOw0KfXRbbWF4bjw8Ml07DQpzdHJ1Y3QgcXVlcnl7aW50IGwsIHIsIGlkO31xW21heG5dOw0KaW5saW5lIHZvaWQgcHVzaGRvd24oaW50IGQsIGludCBsLCBpbnQgbWQsIGludCByKXsNCgl0W2Q8PDFdLnN1bSArPSAxbGwqKG1kLWwrMSkqdFtkXS50ZywgdFtkPDwxXS50ZyArPSB0W2RdLnRnOw0KCXRbZDw8MXwxXS5zdW0gKz0gMWxsKihyLW1kKSp0W2RdLnRnLCB0W2Q8PDF8MV0udGcgKz0gdFtkXS50ZzsNCgl0W2RdLnRnID0gMDsNCn0NCnZvaWQgbWRmKGludCBkLCBpbnQgbCwgaW50IHIsIGludCBkbCwgaW50IGRyKXsNCglpZihkbCA8PSBsICYmIHIgPD0gZHIpcmV0dXJuICsrdFtkXS50ZywgdFtkXS5zdW0gKz0gci1sKzEsIHZvaWQoKTsNCglpbnQgbWQgPSBsK3I+PjE7DQoJaWYodFtkXS50ZylwdXNoZG93bihkLCBsLCBtZCwgcik7DQoJaWYoZGwgPD0gbWQpbWRmKGQ8PDEsIGwsIG1kLCBkbCwgZHIpOw0KCWlmKGRyID4gbWQpbWRmKGQ8PDF8MSwgbWQrMSwgciwgZGwsIGRyKTsNCgl0W2RdLnN1bSA9IHRbZDw8MV0uc3VtK3RbZDw8MXwxXS5zdW07DQp9DQpsb25nIGxvbmcgcXJ5KGludCBkLCBpbnQgbCwgaW50IHIsIGludCBkbCwgaW50IGRyKXsNCglpZihkbCA8PSBsICYmIHIgPD0gZHIpcmV0dXJuIHRbZF0uc3VtOw0KCWludCBtZCA9IGwrcj4+MTsgbG9uZyBsb25nIGFucyA9IDA7DQoJaWYodFtkXS50ZylwdXNoZG93bihkLCBsLCBtZCwgcik7DQoJaWYoZGwgPD0gbWQpYW5zID0gcXJ5KGQ8PDEsIGwsIG1kLCBkbCwgZHIpOw0KCWlmKGRyID4gbWQpYW5zICs9IHFyeShkPDwxfDEsIG1kKzEsIHIsIGRsLCBkcik7DQoJcmV0dXJuIGFuczsNCn0NCmludCBtYWluKCl7DQoJbiA9IHJkKCksIGsgPSByZCgpLCBtID0gcmQoKTsNCglmcChpLCAxLCBuKWFbaV0gPSByZCgpOw0KCWludCBub3cgPSAxOw0KCWZwKGksIDEsIG4pew0KCQl3aGlsZShxMS5zaXplKCkgJiYgYVtxMS5iYWNrKCldIDw9IGFbaV0pcTEucG9wX2JhY2soKTsNCgkJd2hpbGUocTIuc2l6ZSgpICYmIGFbcTIuYmFjaygpXSA+PSBhW2ldKXEyLnBvcF9iYWNrKCk7DQoJCXExLnB1c2hfYmFjayhpKSwgcTIucHVzaF9iYWNrKGkpOw0KCQl3aGlsZShhW3ExLmZyb250KCldLWFbcTIuZnJvbnQoKV0gPiBrKXsNCgkJCWlmKHExLmZyb250KCkgPCBxMi5mcm9udCgpKW5vdyA9IHExLmZyb250KCkrMSwgcTEucG9wX2Zyb250KCk7DQoJCQllbHNlIG5vdyA9IHEyLmZyb250KCkrMSwgcTIucG9wX2Zyb250KCk7DQoJCX0NCgkJZltpXSA9IG5vdzsNCgl9DQovLwlmcChpLCAxLCBuKXByaW50ZigiJWQgIiwgZltpXSk7cHV0cygiIik7DQoJZnAoaSwgMSwgbSlxW2ldLmwgPSByZCgpLCBxW2ldLnIgPSByZCgpLCBxW2ldLmlkID0gaTsNCglzb3J0KHErMSwgcSsxK20sIFsmXShxdWVyeSAmeCwgcXVlcnkgJnkpe3JldHVybiB4LnIgPCB5LnI7fSksIG5vdyA9IDA7DQoJZnAoaSwgMSwgbil7DQoJCW1kZigxLCAxLCBuLCBmW2ldLCBpKTsNCgkJd2hpbGUobm93IDwgbSAmJiBxW25vdysxXS5yIDw9IGkpKytub3csIGFuc1txW25vd10uaWRdID0gcXJ5KDEsIDEsIG4sIHFbbm93XS5sLCBxW25vd10ucik7DQovLwkJZnAoaSwgMSwgbilwcmludGYoIiVkICIsIHFyeSgxLCAxLCBuLCBpLCBpKSk7cHV0cygiIik7DQoJfQ0KCWZwKGksIDEsIG0pcHJpbnRmKCIlbGxkXG4iLCBhbnNbaV0pOw0KCXJldHVybiAwOw0KfQ0K"}]