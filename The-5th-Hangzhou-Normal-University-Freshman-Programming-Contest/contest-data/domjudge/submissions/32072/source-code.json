[{"id":"32072","submission_id":"32072","filename":"111.cpp","source":"I2luY2x1ZGU8aW9zdHJlYW0+DQp1c2luZyBuYW1lc3BhY2Ugc3RkOw0KaW50IG1haW4oKQ0KLy97DQovLwlsb25nIGxvbmcgYVs1MDAwMV0sIGJbNTAwMDFdLCBjWzUwMDAxXTsNCi8vCWludCBuOw0KLy8JY2luID4+IG47DQovLwlmb3IgKGludCBpID0gMTsgaSA8PSBuOyBpKyspDQovLwl7DQovLwkJY2luID4+IGFbaV07DQovLwl9DQovLwlmb3IgKGludCBpID0gMTsgaSA8PSBuOyBpKyspDQovLwl7DQovLwkJY2luID4+IGJbaV07DQovLwkJY1tpXSA9IC1iW2ldOw0KLy8JfQ0KLy8JZm9yIChpbnQgaSA9IDE7IGkgPD0gbjsgaSsrKQ0KLy8Jew0KLy8JCWZvciAoaW50IGogPSAxOyBqIDw9IG4gLSBpOyBqKyspDQovLwkJew0KLy8JCQlpZiAoYVtqXSA+IGFbaiArIDFdKQ0KLy8JCQl7DQovLwkJCQlsb25nIGxvbmcgdGVtcCA9IGFbal07DQovLwkJCQlsb25nIGxvbmcgdGVtcDEgPSBhW2ogKyAxXTsNCi8vCQkJCWFbal0gPSB0ZW1wMTsNCi8vCQkJCWFbaiArIDFdID0gdGVtcDsNCi8vCQkJfQ0KLy8JCQlpZiAoYltqXSA+IGJbaiArIDFdKQ0KLy8JCQl7DQovLwkJCQlsb25nIGxvbmcgdGVtcCA9IGJbal07DQovLwkJCQlsb25nIGxvbmcgdGVtcDEgPSBiW2ogKyAxXTsNCi8vCQkJCWJbal0gPSB0ZW1wMTsNCi8vCQkJCWNbal0gPSAtdGVtcDE7DQovLwkJCQliW2ogKyAxXSA9IHRlbXA7DQovLwkJCQljW2ogKyAxXSA9IC10ZW1wOw0KLy8JCQl9DQovLwkJfQ0KLy8JfQ0KLy8JaW50IG0gPSAwOw0KLy8JaW50IHQgPSAwOw0KLy8NCi8vCWZvciAoaW50IGkgPSAxOyBpIDw9IG47IGkrKykNCi8vCXsNCi8vCQlpZiAoYVtpXSA8IDApDQovLwkJew0KLy8JCQltKys7DQovLwkJfQ0KLy8JCWlmIChiW2ldIDwgMCkNCi8vCQl7DQovLwkJCXQrKzsNCi8vCQl9DQovLwl9DQovLwlpZiAobSAhPSB0ICYmIChuIC0gbSkgIT0gdCkNCi8vCXsNCi8vCQljb3V0IDw8IC0xOw0KLy8JCXJldHVybiAwOw0KLy8JfQ0KLy8JZm9yIChpbnQgaSA9IDE7IGkgPD0gbTsgaSsrKQ0KLy8Jew0KLy8JCWZvciAoaW50IGogPSAxOyBqIDw9IG0gLSBpOyBqKyspDQovLwkJew0KLy8JCQlsb25nIGxvbmcgdGVtcCA9IGFbal07DQovLwkJCWFbal0gPSBhW2ogKyAxXTsNCi8vCQkJYVtqICsgMV0gPSB0ZW1wOw0KLy8JCX0NCi8vCX0NCi8vCWZvciAoaW50IGkgPSAxOyBpIDw9IHQ7IGkrKykNCi8vCXsNCi8vCQlmb3IgKGludCBqID0gMTsgaiA8PSB0IC0gaTsgaisrKQ0KLy8JCXsNCi8vCQkJbG9uZyBsb25nIHRlbXAgPSBiW2pdOw0KLy8JCQliW2pdID0gYltqICsgMV07DQovLwkJCWJbaiArIDFdID0gdGVtcDsNCi8vCQl9DQovLwl9DQovLwlmb3IgKGludCBpID0gMTsgaSA8PSBuOyBpKyspDQovLwl7DQovLwkJZm9yIChpbnQgaiA9IDE7IGogPD0gbiAtIGk7IGorKykNCi8vCQl7DQovLwkJCWlmIChjW2pdID4gY1tqICsgMV0pDQovLwkJCXsNCi8vCQkJCWxvbmcgbG9uZyB0ZW1wID0gY1tqXTsNCi8vCQkJCWxvbmcgbG9uZyB0ZW1wMSA9IGNbaiArIDFdOw0KLy8JCQkJY1tqXSA9IHRlbXAxOw0KLy8JCQkJY1tqICsgMV0gPSB0ZW1wOw0KLy8JCQl9DQovLwkJfQ0KLy8JfQ0KLy8JZm9yIChpbnQgaSA9IDE7IGkgPD0gbiAtIHQ7IGkrKykNCi8vCXsNCi8vCQlmb3IgKGludCBqID0gMTsgaiA8PSBuIC0gdCAtIGk7IGorKykNCi8vCQl7DQovLwkJCWlmIChjW2pdIDwgY1tqICsgMV0pIHsNCi8vCQkJCWxvbmcgbG9uZyB0ZW1wID0gY1tqXTsNCi8vCQkJCWNbal0gPSBjW2ogKyAxXTsNCi8vCQkJCWNbaiArIDFdID0gdGVtcDsNCi8vCQkJfQ0KLy8JCX0NCi8vCX0NCi8vDQovLwlsb25nIGxvbmcgeCA9IGFbMV0sIHkgPSBiWzFdLCB6ID0gY1sxXTsNCi8vCWZvciAoaW50IGkgPSAxOyBpIDw9IG47IGkrKykNCi8vCXsNCi8vCQlsb25nIGxvbmcgeDEgPSBhW2ldLCB5MSA9IGJbaV0sIHoxID0gY1tpXTsNCi8vCQlpZiAoeDEgLSB5MSAhPSB4IC0geSkNCi8vCQl7DQovLwkJCWlmICh4MSAtIHoxICE9IHggLSB6KQ0KLy8JCQl7DQovLwkJCQljb3V0IDw8IC0xOw0KLy8JCQkJcmV0dXJuIDA7DQovLw0KLy8JCQl9DQovLwkJfQ0KLy8JfQ0KLy8NCi8vCWlmIChtID0gbiAtIHQpDQovLwl7DQovLwkJY291dCA8PCBhYnMoeCAtIHopICsgMTsNCi8vCQlyZXR1cm4gMDsNCi8vDQovLwl9DQovLwlpZiAobSA9PSB0KQ0KLy8Jew0KLy8JCWlmICh4ICogeSA+PSAwKQ0KLy8JCXsNCi8vCQkJY291dCA8PCBhYnMoeCAtIHkpOyByZXR1cm4gMDsNCi8vCQl9DQovLwkJaWYgKHggKiB5IDwgMCkNCi8vCQl7DQovLwkJCXggPSAteDsNCi8vCQkJY291dCA8PCBhYnMoeCAtIHkpICsgMTsgcmV0dXJuIDA7DQovLwkJfQ0KLy8JfQ0KLy8JcmV0dXJuIDA7DQovL30NCnsNCglpbnQgbSwgazsNCgljaW4gPj4gbSA+PiBrOw0KCWRvdWJsZSBhWzNdWzZdOw0KCWZvciAoaW50IGkgPSAxOyBpIDw9IDI7IGkrKykNCgl7DQoJCWZvciAoaW50IGogPSAxOyBqIDw9IDU7IGorKykNCgkJew0KCQkJY2luID4+IGFbaV1bal07DQoJCX0NCgl9DQoJZG91YmxlIHgxID0gYVsxXVsxXSwgeTEgPSBhWzJdWzFdOw0KCWRvdWJsZSBtYXggPSB5MSAvIHgxOw0KDQoJZm9yIChpbnQgaSA9IDE7IGkgPD0gNTsgaSsrKQ0KCXsNCgkJZG91YmxlIHggPSBhWzFdW2ldLCB5ID0gYVsyXVtpXTsNCgkJaWYgKGFbMV1baV0gPj0gbSkNCgkJew0KCQkJaWYgKG1heCA8IHkgLyAoeCAtIGspKQ0KCQkJCW1heCA9IHkgLyAoeCAtIGspOw0KCQl9DQoJCWVsc2UNCgkJew0KCQkJaWYgKG1heCA8IHkgLyB4KQ0KCQkJCW1heCA9IHkgLyB4Ow0KCQl9DQoJfQ0KDQoJaW50IGogPSAyOw0KCWZvciAoaW50IGkgPSAxOyBpIDw9IDQ7IGkrKykNCgl7DQoJCWZvciAoaiA9IGkgKyAxOyBqIDw9IDU7IGorKykNCgkJew0KCQkJZG91YmxlIHggPSBhWzFdW2ldLCB5ID0gYVsyXVtpXTsNCgkJCWRvdWJsZSB4MiA9IGFbMV1bal0sIHkyID0gYVsyXVtqXTsNCgkJCWlmICh4ICsgeDIgPj0gbSkNCgkJCXsNCgkJCQlpZiAobWF4IDwgKHkgKyB5MikgLyAoeCArIHgyIC0gaykpDQoJCQkJCW1heCA9ICh5ICsgeTIpIC8gKHggKyB4MiAtIGspOw0KCQkJfQ0KCQkJZWxzZQ0KCQkJew0KCQkJCWlmIChtYXggPCAoeSArIHkyKSAvICh4ICsgeDIpKQ0KCQkJCQltYXggPSAoeSArIHkyKSAvICh4ICsgeDIpOw0KCQkJfQ0KCQl9DQoJfQ0KDQoJaW50IGoxID0gMiwgbCA9IDM7DQoJZm9yIChpbnQgaSA9IDE7IGkgPD0gMzsgaSsrKQ0KCXsNCgkJZm9yIChqMSA9IGkgKyAxOyBqMSA8PSA0OyBqMSsrKQ0KCQl7DQoJCQlmb3IgKGwgPSBqMSArIDE7IGwgPD0gNTsgbCsrKQ0KCQkJew0KCQkJCWRvdWJsZSB4ID0gYVsxXVtpXSwgeSA9IGFbMl1baV07DQoJCQkJZG91YmxlIHgyID0gYVsxXVtqMV0sIHkyID0gYVsyXVtqMV07DQoJCQkJZG91YmxlIHgzID0gYVsxXVtsXSwgeTMgPSBhWzJdW2xdOw0KCQkJCWlmICh4ICsgeDIgKyB4MyA+PSBtKQ0KCQkJCXsNCgkJCQkJaWYgKG1heCA8ICh5ICsgeTIgKyB5MykgLyAoeCArIHgyICsgeDMgLSBrKSkNCgkJCQkJew0KCQkJCQkJbWF4ID0gKHkgKyB5MiArIHkzKSAvICh4ICsgeDIgKyB4MyAtIGspOw0KCQkJCQl9DQoJCQkJfQ0KCQkJCWVsc2UNCgkJCQkJaWYgKG1heCA8ICh5ICsgeTIgKyB5MykgLyAoeCArIHgyICsgeDMpKQ0KCQkJCQkJbWF4ID0gKHkgKyB5MiArIHkzKSAvICh4ICsgeDIgKyB4Myk7DQoJCQl9DQoJCX0NCgl9DQoNCglkb3VibGUgbnVtID0gMCwgbnVtMSA9IDA7DQoJZm9yIChpbnQgaSA9IDE7IGkgPD0gNTsgaSsrKQ0KCXsNCgkJZm9yIChpbnQgajIgPSAyOyBqMiAhPSBpICYmIGogPD0gNTsgajIrKykNCgkJew0KCQkJZG91YmxlIHQgPSBhWzFdW2oyXSwgdSA9IGFbMl1bajJdOw0KCQkJbnVtID0gbnVtICsgdDsNCgkJCW51bTEgPSBudW0xICsgdTsNCgkJfQ0KCQlpZiAobnVtID49IG0pDQoJCXsNCgkJCWlmIChtYXggPCBudW0xIC8gKG51bSAtIGspKQ0KCQkJCW1heCA9IG51bTEgLyAobnVtIC0gayk7DQoNCgkJfQ0KCQllbHNlDQoJCQlpZiAobWF4IDwgbnVtMSAvIG51bSkNCgkJCQltYXggPSBudW0xIC8gbnVtOw0KCX0NCg0KCWludCBoMSA9IDAsIGgyID0gMDsNCglmb3IgKGludCBpID0gMTsgaSA8PSA1OyBpKyspDQoJew0KCQlkb3VibGUgdCA9IGFbMV1baV0sIHUgPSBhWzJdW2ldOw0KCQloMSA9IGgxICsgdDsNCgkJaDIgPSBoMiArIHU7DQoJfQ0KCWlmIChoMSA+PSBtKQ0KCXsNCgkJaWYgKG1heCA8IGgyIC8gKGgxIC0gaykpDQoJCXsNCgkJCW1heCA9IGgyIC8gKGgxIC0gayk7DQoJCX0NCgl9DQoJZWxzZQ0KCXsNCgkJaWYgKG1heCA8IGgyIC8gaDEpDQoJCQltYXggPSBoMiAvIGgxOw0KCX0NCglwcmludGYoIiUuMmxmIiwgbWF4KTsNCglyZXR1cm4gMDsNCn0NCg=="}]