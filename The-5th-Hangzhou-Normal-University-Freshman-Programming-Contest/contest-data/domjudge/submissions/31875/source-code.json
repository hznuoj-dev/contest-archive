[{"id":"31875","submission_id":"31875","filename":"L.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+DQoNCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQoNCmNvbnN0IGludCBOID0gMmU1ICsgMTA7DQoNCnN0cnVjdCBub2RlDQp7DQogICAgaW50IGM7DQogICAgaW50IGE7DQogICAgaW50IGI7DQp9IHN0W05dOw0KDQppbnQgbSwgazsNCg0KaW50IG1haW4oKQ0Kew0KICAgIGNpbiA+PiBtID4+IGs7DQoNCiAgICBmb3IgKGludCBpID0gMDsgaSA8IDU7IGkrKykNCiAgICB7DQogICAgICAgIGNpbiA+PiBzdFtpXS5hOw0KICAgIH0NCg0KICAgIGZvciAoaW50IGkgPSAwOyBpIDwgNTsgaSsrKQ0KICAgIHsNCiAgICAgICAgY2luID4+IHN0W2ldLmI7DQogICAgfQ0KDQogICAgZm9yIChpbnQgaSA9IDA7IGkgPCA1OyBpKyspDQogICAgew0KICAgICAgICBzdFtpXS5jID0gc3RbaV0uYiAtIHN0W2ldLmE7DQogICAgfQ0KDQogICAgZm9yIChpbnQgaSA9IDA7IGkgPCA1OyBpKyspDQogICAgew0KICAgICAgICBpbnQgdCA9IGk7DQogICAgICAgIGZvciAoaW50IGogPSBpICsgMTsgaiA8IDU7IGorKykNCiAgICAgICAgew0KICAgICAgICAgICAgaWYgKHN0W3RdLmMgPCBzdFtqXS5jKQ0KICAgICAgICAgICAgICAgIHQgPSBqOw0KICAgICAgICB9DQogICAgICAgIGlmICh0ICE9IGkpDQogICAgICAgIHsNCiAgICAgICAgICAgIHN3YXAoc3RbdF0uYywgc3RbaV0uYyk7DQogICAgICAgICAgICBzd2FwKHN0W3RdLmEsIHN0W2ldLmEpOw0KICAgICAgICAgICAgc3dhcChzdFt0XS5iLCBzdFtpXS5iKTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIGZvciAoaW50IGkgPSAwOyBpIDwgNTsgaSsrKQ0KICAgIHsNCiAgICAgICAgaW50IGo7DQogICAgICAgIGZvciAoaiA9IGkgKyAxOyBqIDwgNTsgaisrKQ0KICAgICAgICB7DQogICAgICAgICAgICBpZiAoc3Rbal0uYyAhPSBzdFtpXS5jKQ0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICB9DQogICAgICAgIGZvciAoaW50IGsgPSBpOyBrIDwgajsgaysrKQ0KICAgICAgICB7DQogICAgICAgICAgICBpbnQgdCA9IGs7DQogICAgICAgICAgICBmb3IgKGludCBsID0gayArIDE7IGwgPCBqOyBsKyspDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgaWYgKHN0W3RdLmEgPCBzdFtsXS5hKQ0KICAgICAgICAgICAgICAgICAgICB0ID0gbDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmICh0ICE9IGspDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgc3dhcChzdFt0XS5jLCBzdFtrXS5jKTsNCiAgICAgICAgICAgICAgICBzd2FwKHN0W3RdLmEsIHN0W2tdLmEpOw0KICAgICAgICAgICAgICAgIHN3YXAoc3RbdF0uYiwgc3Rba10uYik7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvKmZvciAoaW50IGkgPSAwOyBpIDwgNTsgaSsrKQ0KICAgIHsNCiAgICAgICAgY291dCA8PCAic3RhPSIgPDwgc3RbaV0uYSA8PCBlbmRsOw0KICAgICAgICBjb3V0IDw8ICJzdGI9IiA8PCBzdFtpXS5iIDw8IGVuZGw7DQogICAgICAgIGNvdXQgPDwgInN0Yz0iIDw8IHN0W2ldLmMgPDwgZW5kbDsNCiAgICB9Ki8NCg0KICAgIGludCBzdW0xID0gMDsNCiAgICBpbnQgc3VtMiA9IDA7DQogICAgZG91YmxlIHJlcyA9IC0xZTk7DQogICAgZm9yIChpbnQgaSA9IDA7IGkgPCA1OyBpKyspDQogICAgew0KICAgICAgICBkb3VibGUgdDsNCiAgICAgICAgc3VtMSArPSBzdFtpXS5hOw0KICAgICAgICBzdW0yICs9IHN0W2ldLmI7DQogICAgICAgIGlmIChzdW0xID49IG0pDQogICAgICAgIHsNCiAgICAgICAgICAgIHQgPSAxLjAgKiBzdW0yIC8gKHN1bTEgLSBrKTsNCiAgICAgICAgfQ0KICAgICAgICBlbHNlDQogICAgICAgIHsNCiAgICAgICAgICAgIHQgPSAxLjAgKiBzdW0yIC8gc3VtMTsNCiAgICAgICAgfQ0KICAgICAgICAvLyBwcmludGYoIiUuMmxsZiAiLCB0KTsNCiAgICAgICAgLy8gY291dCA8PCAicmVzPSIgPDwgcmVzIDw8IGVuZGw7DQogICAgICAgIHJlcyA9IG1heChyZXMsIHQpOw0KICAgIH0NCiAgICBwcmludGYoIiUuMmxmIiwgcmVzKTsNCiAgICByZXR1cm4gMDsNCn0="}]