[{"id":"31663","submission_id":"31663","filename":"C.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+DQp1c2luZyBuYW1lc3BhY2Ugc3RkOw0KDQp0eXBlZGVmIGxvbmcgbG9uZyBMTDsNCnR5cGVkZWYgdW5zaWduZWQgbG9uZyBsb25nIFVMTDsNCi8vdHlwZWRlZiBfX2ludDEyOCBMTEw7DQoNCmludCByZWFkKCkgew0KICAgIGludCB4ID0gMCwgZiA9IDE7IGNoYXIgYyA9IGdldGNoYXIoKTsNCiAgICB3aGlsZShjIDwgJzAnIHx8IGMgPiAnOScpIGMgPT0gJy0nID8gZiA9IC0xOiAwLCBjID0gZ2V0Y2hhcigpOw0KCXdoaWxlKGMgPj0gJzAnICYmIGMgPD0gJzknKSB4ID0gKHggPDwgMSkgKyAoeCA8PCAzKSArIChjIF4gJzAnKSwgYyA9IGdldGNoYXIoKTsNCiAgICByZXR1cm4geCAqIGY7DQp9DQoNCmludCBudW1DbnRbXSA9IHs2LCAyLCA1LCA1LCA0LCA1LCA2LCAzLCA3LCA2fTsgLy8gMC05DQppbnQgVE51bVtdID0gezgsIDcsIC0xLCA5LCAtMSwgNiwgOCwgLTEsIC0xLCA4fTsgLy8gzO2809K7uPbWrrrzIA0KDQppbnQgTDFbMTUwXSwgTDJbMTUwXSwgUlsxNTBdOw0KaW50IExUMVsxNTBdLCBMVDJbMTUwXSwgUlRbMTUwXTsNCg0KaW50IGdldENudChpbnQgeCkgew0KICAgIGlmKHggPT0gMCkgcmV0dXJuIG51bUNudFswXTsNCiAgICANCiAgICBpbnQgciA9IDA7DQogICAgd2hpbGUoeCkgew0KICAgICAgICByICs9IG51bUNudFt4ICUgMTBdOw0KICAgICAgICB4IC89IDEwOw0KICAgIH0NCiAgICANCiAgICByZXR1cm4gcjsNCn0NCg0Kc2lnbmVkIG1haW4oKSB7DQogICAgDQovLyAgICBpbnQgc3RrWzEwMDBdLCB0b3AgPSAwOw0KICAgIGZvcihpbnQgaSA9IDA7IGkgPD0gOTsgKytpKSB7DQogICAgICAgIGZvcihpbnQgaiA9IGk7IGogPD0gOTsgKytqKSB7DQogICAgICAgICAgICBpZihpICsgaiA+IDkpIGJyZWFrOw0KICAgICAgICAgICAgaWYoaSA9PSAyICYmIGogPT0gMikgY29udGludWU7DQogICAgICAgICAgICANCiAgICAgICAgICAgIGludCBzID0gKGdldENudChpKSArIGdldENudChqKSArIGdldENudChpICsgaikpOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBpZighTDFbc10gfHwgIUwyW3NdKSB7DQogICAgICAgICAgICAgICAgTDFbc10gPSBMVDFbc10gPSBpLCBMMltzXSA9IExUMltzXSA9IGosIFJbc10gPSBSVFtzXSA9IGkgKyBqOw0KICAgICAgICAgICAgICAgIGlmKFROdW1bTDJbc11dICE9IC0xKSBMVDJbc10gPSBUTnVtW0wyW3NdXTsNCiAgICAgICAgICAgICAgICBlbHNlIGlmKFROdW1bTDFbc11dICE9IC0xKSBMVDFbc10gPSBUTnVtW0wxW3NdXTsNCiAgICAgICAgICAgICAgICBlbHNlIFJUW3NdID0gVE51bVtSVFtzXV07DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQovLyAgICBmb3IoaW50IGkgPSA5OyBpIDw9IDE3OyArK2kpIHsNCi8vICAgICAgICBjb3V0IDw8IGkgPDwgJyAnIDw8IEwxW2ldIDw8ICcrJyA8PCBMMltpXSA8PCAnPScgPDwgUltpXSA8PCAnICcgPDwgTFQxW2ldIDw8ICctJyA8PCBMVDJbaV0gPDwgJz0nIDw8IFJUW2ldIDw8ICcgJyA8PCBlbmRsOw0KLy8gICAgfQ0KICAgIA0KICAgIGludCB0ID0gcmVhZCgpOw0KICAgIHdoaWxlKHQtLSkgew0KICAgICAgICBpbnQgbiA9IHJlYWQoKTsNCiAgICAgICAgaWYobiA8IDkgKyA0KSBwdXRzKCJObyBTb2x1dGlvbiIpOw0KICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgIG4gLT0gNDsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgc3RyaW5nIHMxLCBzMjsNCiAgICAgICAgICAgIGludCBrID0gbiAvIDksIGQgPSBuICUgOTsNCiAgICAgICAgICAgIC0taywgZCArPSA5Ow0KICAgICAgICAgICAgDQogICAgICAgICAgICBmb3IoaW50IGkgPSAxOyBpIDw9IGs7ICsraSkgczIgKz0gKGNoYXIpKEwxWzldICsgJzAnKTsNCiAgICAgICAgICAgIHMyICs9IChjaGFyKShMMVtkXSArICcwJyk7DQogICAgICAgICAgICBzMiArPSAnKyc7DQogICAgICAgICAgICBmb3IoaW50IGkgPSAxOyBpIDw9IGs7ICsraSkgczIgKz0gKGNoYXIpKEwyWzldICsgJzAnKTsNCiAgICAgICAgICAgIHMyICs9IChjaGFyKShMMltkXSArICcwJyk7DQogICAgICAgICAgICBzMiArPSAnPSc7DQogICAgICAgICAgICBmb3IoaW50IGkgPSAxOyBpIDw9IGs7ICsraSkgczIgKz0gKGNoYXIpKFJbOV0gKyAnMCcpOw0KICAgICAgICAgICAgczIgKz0gKGNoYXIpKFJbZF0gKyAnMCcpOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBmb3IoaW50IGkgPSAxOyBpIDw9IGs7ICsraSkgczEgKz0gKGNoYXIpKExUMVs5XSArICcwJyk7DQogICAgICAgICAgICBzMSArPSAoY2hhcikoTFQxW2RdICsgJzAnKTsNCiAgICAgICAgICAgIHMxICs9ICctJzsNCiAgICAgICAgICAgIGZvcihpbnQgaSA9IDE7IGkgPD0gazsgKytpKSBzMSArPSAoY2hhcikoTFQyWzldICsgJzAnKTsNCiAgICAgICAgICAgIHMxICs9IChjaGFyKShMVDJbZF0gKyAnMCcpOw0KICAgICAgICAgICAgczEgKz0gJz0nOw0KICAgICAgICAgICAgZm9yKGludCBpID0gMTsgaSA8PSBrOyArK2kpIHMxICs9IChjaGFyKShSVFs5XSArICcwJyk7DQogICAgICAgICAgICBzMSArPSAoY2hhcikoUlRbZF0gKyAnMCcpOw0KICAgICAgICAgICAgDQogICAgICAgICAgICANCiAgICAgICAgICAgIGNvdXQgPDwgczEgPDwgZW5kbCA8PCBzMiA8PCBlbmRsOw0KICAgICAgICB9DQogICAgfQ0KICAgIHJldHVybiAwOw0KfQ0KDQo="}]