[{"id":"31621","submission_id":"31621","filename":"main.cpp","source":"LyoKI2luY2x1ZGUgPGlvc3RyZWFtPgojaW5jbHVkZSA8Yml0cy9zdGRjKysuaD4KdXNpbmcgbmFtZXNwYWNlIHN0ZDsKY29uc3QgaW50IE49MmU1KzEwOwpsb25nIGxvbmcgaW50IGFbTl0sYltOXSxkZVtOXSxkZTFbTl07CmludCBtYWluKCkgewogICAgaW9zOjpzeW5jX3dpdGhfc3RkaW8oZmFsc2UpOwogICAgY2luLnRpZSgwKTsKICAgIGNvdXQudGllKDApOwogICAgaW50IG47CiAgICBjaW4gPj4gbjsKICAgIGJvb2wgc3Q9IGZhbHNlOwogICAgaW50IGhhc19kaWZmZXJlbnQ9MDsKICAgIGZvciAoaW50IGk9MDtpPG47aSsrKSBjaW4gPj4gYVtpXTsKICAgIGZvciAoaW50IGk9MDtpPG47aSsrKQogICAgewogICAgICAgIGNpbiA+PiBiW2ldOwogICAgICAgIGRlW2ldPWFbaV0tYltpXTsKICAgICAgICBkZTFbaV09KGFbaV0qLTEpLWJbaV07CiAgICAgICAgaWYoaT4wICYmIGRlW2ldIT1kZVtpLTFdKSBzdD0gdHJ1ZTsKICAgIH0KICAgIGJvb2wgc3QxPSBmYWxzZTsKICAgIGlmKHN0KQogICAgewogICAgICAgIGZvciAoaW50IGk9MDtpPG47aSsrKQogICAgICAgIHsKICAgICAgICAgICAgaWYoaT4wICYmIGRlMVtpXSE9ZGUxW2ktMV0pIHN0MT0gdHJ1ZTsKICAgICAgICB9CiAgICB9CiAgICBpZighc3QpIGNvdXQgPDwgYWJzKGRlWzBdKTsKICAgIGVsc2UgaWYoc3QgJiYgIXN0MSkgY291dCA8PCBhYnMoZGUxWzBdKSsxOwogICAgZWxzZSBjb3V0IDw8IC0xOwogICAgcmV0dXJuIDA7Cn0KKi8KLyoKI2luY2x1ZGUgPGlvc3RyZWFtPgojaW5jbHVkZSA8Yml0cy9zdGRjKysuaD4KdXNpbmcgbmFtZXNwYWNlIHN0ZDsKY29uc3QgaW50IE49MmU1KzEwOwpjb25zdCBpbnQgbW9kPTFlOSs3Owpsb25nIGxvbmcgYVtOXSxmYVtOXTsKaW50IHBbTl0sY250W05dOwppbnQgZmluZChpbnQgeCkKewogICAgaWYocFt4XSE9eCkKICAgIHsKICAgICAgICBwW3hdPSBmaW5kKHBbeF0pOwogICAgfQogICAgcmV0dXJuIHBbeF07Cn0KaW50IG1haW4oKXsKICAgIGlvczo6c3luY193aXRoX3N0ZGlvKGZhbHNlKTsKICAgIGNpbi50aWUoMCk7CiAgICBjb3V0LnRpZSgwKTsKICAgIGludCBuLHE7CiAgICBjaW4gPj4gbiA+PiBxOwogICAgZm9yIChpbnQgaT0xO2k8PW47aSsrKQogICAgewogICAgICAgIGNpbiA+PiBhW2ldOwogICAgICAgIHBbaV09aTsKICAgICAgICBmYVtpXT1hW2ldOwogICAgICAgIGNudFtpXT0xOwogICAgfQogICAgd2hpbGUgKHEtLSkKICAgIHsKICAgICAgICBpbnQgbnVtOwogICAgICAgIGNpbiA+PiBudW07CiAgICAgICAgaWYobnVtPT0xKQogICAgICAgIHsKICAgICAgICAgICAgaW50IGEsYjsKICAgICAgICAgICAgY2luID4+IGEgPj4gYjsKICAgICAgICAgICAgYT0gZmluZChhKTsKICAgICAgICAgICAgYj0gZmluZChiKTsKICAgICAgICAgICAgcFthXT1iOwogICAgICAgICAgICBmYVtiXSs9ZmFbYV07CiAgICAgICAgICAgIGNudFtiXSs9Y250W2FdOwogICAgICAgIH1lbHNlIGlmKG51bT09MikKICAgICAgICB7CiAgICAgICAgICAgIGludCBhLGI7CiAgICAgICAgICAgIGNpbiA+PiBhID4+IGI7CiAgICAgICAgICAgIGE9IGZpbmQoYSk7CiAgICAgICAgICAgIGZhW2FdKz1iKmNudFthXTsKICAgICAgICB9ZWxzZSB7CiAgICAgICAgICAgIGludCBiOwogICAgICAgICAgICBjaW4gPj4gYjsKICAgICAgICAgICAgY291dCA8PCBhW2JdJW1vZCA8PCBlbmRsOwogICAgICAgIH0KICAgICAgICBmb3IgKGludCBpPTE7aTw9bjtpKyspCiAgICAgICAgewogICAgICAgICAgICBpbnQgZmF0aGVyPSBmaW5kKGkpOwogICAgICAgICAgICBhW2ldKz1mYVtmYXRoZXJdOwogICAgICAgIH0KICAgIH0KfQoqLwojaW5jbHVkZSA8aW9zdHJlYW0+CiNpbmNsdWRlIDxiaXRzL3N0ZGMrKy5oPgp1c2luZyBuYW1lc3BhY2Ugc3RkOwpjb25zdCBpbnQgTj0yMTA7CmludCBhW05dOwppbnQgYltOXTsKaW50IG1haW4oKXsKLy8gICAgaW9zOjpzeW5jX3dpdGhfc3RkaW8oZmFsc2UpOwovLyAgICBjaW4udGllKDApOwovLyAgICBjb3V0LnRpZSgwKTsKICAgIGludCBtLGs7CiAgICBjaW4gPj4gbSA+PiBrOwogICAgZm9yIChpbnQgaT0wO2k8NTtpKyspIGNpbiA+PiBhW2ldOwogICAgZm9yIChpbnQgaT0wO2k8NTtpKyspIGNpbiA+PiBiW2ldOwogICAgZG91YmxlIHJlcz0wOwogICAgZm9yKGludCBzaXplPTE7c2l6ZTw9NTtzaXplKyspCiAgICB7CiAgICAgICAgaWYoc2l6ZT09MSkKICAgICAgICB7CiAgICAgICAgICAgIGZvciAoaW50IGk9MDtpPDU7aSsrKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBkb3VibGUgamlhZ2U9YVtpXTsKICAgICAgICAgICAgICAgIGlmKGppYWdlPj1tKSBqaWFnZS09azsKICAgICAgICAgICAgICAgIGRvdWJsZSBwaW5namlhPWJbaV07CiAgICAgICAgICAgICAgICByZXM9IG1heChyZXMscGluZ2ppYS9qaWFnZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9ZWxzZSBpZihzaXplPT0yKQogICAgICAgIHsKICAgICAgICAgICAgZm9yIChpbnQgaT0wO2k8NTtpKyspCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGZvciAoaW50IGo9MDtqPDU7aisrKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGlmKGk9PWopIGNvbnRpbnVlOwogICAgICAgICAgICAgICAgICAgIGRvdWJsZSBqaWFnZT1hW2ldK2Fbal07CiAgICAgICAgICAgICAgICAgICAgaWYoamlhZ2U+PW0pIGppYWdlLT1rOwogICAgICAgICAgICAgICAgICAgIGRvdWJsZSBwaW5namlhPWJbaV0rYltqXTsKICAgICAgICAgICAgICAgICAgICByZXM9IG1heChyZXMscGluZ2ppYS9qaWFnZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9ZWxzZSBpZihzaXplPT0zKQogICAgICAgIHsKICAgICAgICAgICAgZm9yIChpbnQgaT0wO2k8NTtpKyspCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGZvciAoaW50IGo9MDtqPDU7aisrKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGZvciAoaW50IG89MDtvPDU7bysrKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoaT09aiB8fCBpPT1vIHx8IGo9PW8pIGNvbnRpbnVlOwogICAgICAgICAgICAgICAgICAgICAgICBkb3VibGUgamlhZ2U9YVtpXSthW2pdK2Fbb107CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGppYWdlPj1tKSBqaWFnZS09azsKICAgICAgICAgICAgICAgICAgICAgICAgZG91YmxlIHBpbmdqaWE9YltpXStiW2pdK2Jbb107CiAgICAgICAgICAgICAgICAgICAgICAgIHJlcz0gbWF4KHJlcyxwaW5namlhL2ppYWdlKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9ZWxzZSBpZihzaXplPT00KQogICAgICAgIHsKICAgICAgICAgICAgZm9yIChpbnQgaT0wO2k8NTtpKyspCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGRvdWJsZSBqaWFnZT0wLHBpbmdqaWE9MDsKICAgICAgICAgICAgICAgIGZvciAoaW50IGo9MDtqPDU7aisrKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGlmKGo9PWkpY29udGludWU7CiAgICAgICAgICAgICAgICAgICAgamlhZ2UrPWFbal07CiAgICAgICAgICAgICAgICAgICAgcGluZ2ppYSs9YltqXTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmKGppYWdlPj1tKSBqaWFnZS09azsKICAgICAgICAgICAgICAgIHJlcz0gbWF4KHJlcyxwaW5namlhL2ppYWdlKTsKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZXsKICAgICAgICAgICAgZG91YmxlIGppYWdlPTAscGluZ2ppYT0wOwogICAgICAgICAgICBmb3IgKGludCBqPTA7ajw1O2orKykKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgamlhZ2UrPWFbal07CiAgICAgICAgICAgICAgICBwaW5namlhKz1iW2pdOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmKGppYWdlPj1tKSBqaWFnZS09azsKICAgICAgICAgICAgcmVzPSBtYXgocmVzLHBpbmdqaWEvamlhZ2UpOwogICAgICAgIH0KICAgIH0KICAgIHByaW50ZigiJS4yZiIscmVzKTsKfQ=="}]