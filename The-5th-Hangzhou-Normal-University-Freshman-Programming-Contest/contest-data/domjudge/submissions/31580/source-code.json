[{"id":"31580","submission_id":"31580","filename":"3.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+DQoNCmNvbnN0IGludCBOID0gMioxZTUgKyAxMDsNCg0KdXNpbmcgbmFtZXNwYWNlIHN0ZDsNCg0KaW50IG1haW4oKQ0Kew0KCWludCBuOw0KCWludCBhW05dOw0KCWludCBiW05dOw0KCWludCBjLGQ7DQoJaW50IGYgPSAwOw0KCWludCBnID0gMDsNCgljaW4gPj4gbjsNCglmb3IoaW50IGkgPSAwIDsgaSA8IG47IGkgKyspDQoJew0KCQljaW4gPj4gYVtpXTsNCgl9DQoJZm9yKGludCBpID0gMCA7IGkgPCBuOyBpICsrKQ0KCXsNCgkJY2luID4+IGJbaV07DQoJfQkNCglzb3J0KGEsYStuKTsNCglzb3J0KGIsYituKTsNCglpbnQgdCA9IDA7DQoJaWYoYVswXSA+PSBiWzBdKQ0KCXsNCgkJaWYobiA+IDEpDQoJCXsNCgkJCWZvcihpbnQgaSA9IDA7IGkgPCBuLTE7IGkgKyspDQoJCQl7DQoJCQkJYyA9IGFbaV0gLSBiW2ldOw0KCQkJCWQgPSBhW2krMV0gLSBiW2krMV07DQoJCQkJZiA9IGM7DQoJCQkJaWYoYyAhPSBkKQ0KCQkJCXsNCgkJCQkJdCA9IDE7DQoJCQkJCWJyZWFrOw0KCQkJCX0NCgkJCX0NCgkJCWlmKHQ9PTApDQoJCQl7DQoJCQkJaWYoLWFbMF0gPj0gYltuLTFdKQ0KCQkJCXsNCgkJCQkJZm9yKGludCBpID0gMDsgaSA8IG4tMTsgaSArKykNCgkJCQkJew0KCQkJCQkJYyA9IC1hW2ldIC0gYltuLTEtaV07DQoJCQkJCQlkID0gLWFbaSsxXSAtIGJbbi0yLWldOw0KCQkJCQkJZyA9IGM7DQoJCQkJCQlpZihjICE9IGQpDQoJCQkJCQl7DQoJCQkJCQkJdCA9IDE7DQoJCQkJCQkJYnJlYWs7DQoJCQkJCQl9DQoJCQkJCX0JCQkJCQ0KCQkJCX0NCgkJCQllbHNlDQoJCQkJew0KCQkJCQlmb3IoaW50IGkgPSAwOyBpIDwgbi0xOyBpICsrKQ0KCQkJCQl7DQoJCQkJCQljID0gYVtuLTEtaV0gKyBiW2ldOw0KCQkJCQkJZCA9IGFbbi0yLWldICsgYltpKzFdOw0KCQkJCQkJZyA9IGM7DQoJCQkJCQlpZihjICE9IGQpDQoJCQkJCQl7DQoJCQkJCQkJdCA9IDE7DQoJCQkJCQkJYnJlYWs7DQoJCQkJCQl9DQoJCQkJCX0JCQkJCQ0KCQkJCX0JCQkJCQkNCgkJCX0NCgkJfQ0KCQllbHNlDQoJCXsNCgkJCWMgPSBhWzBdIC0gYlswXTsNCgkJCWlmKC1hWzBdID49IGJbMF0pDQoJCQl7DQoJCQkJZCA9IC1iWzBdIC0gYVswXTsNCgkJCX0NCgkJCWVsc2UNCgkJCXsNCgkJCQlkID0gYlswXSArIGFbMF07DQoJCQl9DQoJCQlmID0gYzsNCgkJCWcgPSBkOw0KCQl9CQkNCgkJCWlmKHQgPT0gMCkNCgkJCXsNCgkJCQlpZiAoZiA+PSBnICsgMSkNCgkJCQl7DQoJCQkJCWNvdXQgPDwgZyArIDE7DQoJCQkJfQ0KCQkJCWVsc2UNCgkJCQl7DQoJCQkJCWNvdXQgPDwgZjsNCgkJCQl9DQoJCQl9DQoJfQ0KCWVsc2UNCgl7DQoJCWlmKG4gPiAxKQ0KCQl7DQoJCQkNCgkJCWZvcihpbnQgaSA9IDA7IGkgPCBuLTE7IGkgKyspDQoJCQl7DQoJCQkJYyA9IC1hW2ldICsgYltpXTsNCgkJCQlkID0gLWFbaSsxXSArIGJbaSsxXTsNCgkJCQlmID0gYzsNCgkJCQlpZihjICE9IGQpDQoJCQkJew0KCQkJCQl0ID0gMTsNCgkJCQkJYnJlYWs7DQoJCQkJfQ0KCQkJfQ0KCQkJaWYodD09MCkNCgkJCXsNCgkJCQlpZihhW24tMV0gPD0gLWJbMF0pDQoJCQkJew0KCQkJCQlmb3IoaW50IGkgPSAwOyBpIDwgbi0xOyBpICsrKQ0KCQkJCQl7DQoJCQkJCQljID0gLWFbbi0xLWldIC0gYltpXTsNCgkJCQkJCWQgPSAtYVtuLTItaV0gLSBiW2krMV07DQoJCQkJCQlnID0gYzsNCgkJCQkJCWlmKGMgIT0gZCkNCgkJCQkJCXsNCgkJCQkJCQl0ID0gMTsNCgkJCQkJCQlicmVhazsNCgkJCQkJCX0NCgkJCQkJfQkJCQkJDQoJCQkJfQ0KCQkJCWVsc2UNCgkJCQl7DQoJCQkJCWZvcihpbnQgaSA9IDA7IGkgPCBuLTE7IGkgKyspDQoJCQkJCXsNCgkJCQkJCWMgPSBhW2ldICsgYltuLTEtaV07DQoJCQkJCQlkID0gYVtpKzFdICsgYltuLTItaV07DQoJCQkJCQlnID0gYzsNCgkJCQkJCWlmKGMgIT0gZCkNCgkJCQkJCXsNCgkJCQkJCQl0ID0gMTsNCgkJCQkJCQlicmVhazsNCgkJCQkJCX0NCgkJCQkJfQkJCQkJDQoJCQkJfQkJCQkJCQ0KCQkJfQ0KCQl9DQoJCWVsc2UNCgkJew0KCQkJYyA9IGFbMF0gLSBiWzBdOw0KCQkJaWYoLWJbMF0gPj0gYVswXSkNCgkJCXsNCgkJCQlkID0gLWFbMF0gLSBiWzBdOw0KCQkJfQ0KCQkJZWxzZQ0KCQkJew0KCQkJCWQgPSBhWzBdICsgYlswXTsNCgkJCX0NCgkJCWYgPSBjOw0KCQkJZyA9IGQ7CQkJDQoJCX0NCgkJCWlmKHQgPT0gMCkNCgkJCXsNCgkJCQlpZiAoZiA+PSBnICsgMSkNCgkJCQl7DQoJCQkJCWNvdXQgPDwgZyArIDE7DQoJCQkJfQ0KCQkJCWVsc2UNCgkJCQl7DQoJCQkJCWNvdXQgPDwgZjsNCgkJCQl9DQoJCQl9CQ0KCX0NCgkNCglpZih0ID09IDEpDQoJew0KCQljb3V0IDw8ICItMSI7DQoJfQ0KCXJldHVybiAwOw0KfQ0K"}]