[{"id":"31683","submission_id":"31683","filename":"A.cpp","source":"I2luY2x1ZGU8Yml0cy9zdGRjKysuaD4NCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQppbnQgbjsNCmNvbnN0IGludCBtYXhuID0gMmU1ICsgOTsNCmludCBhW21heG5dLGNudFttYXhuXSx0bXBbbWF4bl07DQppbnQgbWFpbigpIHsNCglpb3M6OnN5bmNfd2l0aF9zdGRpbygwKTsNCgljaW4udGllKDApOw0KCWNvdXQudGllKDApOw0KCWNpbiA+PiBuOw0KCWZvcihpbnQgaSA9IDE7IGkgPD0gbjsgaSArKykgew0KCQljaW4gPj4gYVtpXTsNCgkJY250W2FbaV1dKys7DQoJfQ0KCW1lbWNweSh0bXAsYSxzaXplb2YodG1wKSk7DQoJc29ydChhICsgMSxhICsgMSArIG4pOw0KCWlmKG4gJSAyKSB7DQoJCWlmKGNudFthW24vMiArIDFdXSAlIDIpIHsNCgkJCW1lbWNweShhLHRtcCxzaXplb2YoYSkpOw0KCQkJYm9vbCBmID0gMTsNCgkJCWludCBsID0gMCxyID0gMCxrID0gYVtuLzIgKyAxXTsNCgkJCWZvcihpbnQgaSA9IDE7IGkgPD0gbjsgaSArKykgew0KCQkJCWlmKGFbaV0gPCBrKSBsICsrOw0KCQkJCWlmKGFbaV0gPiBrKSByICsrOw0KCQkJCWlmKHIgPiBsKSB7DQoJCQkJCWYgPSAwOw0KCQkJCQlicmVhazsNCgkJCQl9DQoJCQl9DQoJCQlpZihmKSBjb3V0IDw8IDEgPDwgJ1xuJzsNCgkJCWVsc2UgY291dCA8PCAwIDw8ICdcbic7DQoJCX0gZWxzZSBjb3V0IDw8IDAgPDwgJ1xuJzsNCgl9IGVsc2Ugew0KCQlpZihhW24vMl0gIT0gYVtuLzIgKyAxXSkgew0KLy8JCQlpbnQgbCA9IGFbbi8yXSArIDEsciA9IGFbbi8yICsgMV07DQovLwkJCWludCByZWMgPSByOw0KLy8JCQlpbnQgbGVmdCA9IDAscmlnaHQgPSAwLG1pZCA9IChsICsgcikgLyAyOw0KLy8JCQltZW1jcHkoYSx0bXAsc2l6ZW9mKGEpKTsNCi8vCQkJd2hpbGUobCA8IHIpew0KLy8JCQkJYm9vbCBmID0gMDsNCi8vCQkJCWxlZnQgPSAwLHJpZ2h0ID0gMDsNCi8vCQkJCW1pZCA9IChsICsgcikgLyAyOw0KLy8JCQkJZm9yKGludCBpID0gMTtpIDw9IG47aSArKyl7DQovLwkJCQkJaWYoYVtpXSA8IG1pZCkgKysgbGVmdDsNCi8vCQkJCQlpZihhW2ldID4gbWlkKSArKyByaWdodDsNCi8vCQkJCQlpZihyaWdodCA+IGxlZnQpew0KLy8JCQkJCQlsID0gbWlkICsgMTsNCi8vCQkJCQkJZiA9IDE7DQovLwkJCQkJCWJyZWFrOw0KLy8JCQkJCX0NCi8vCQkJCX0NCi8vCQkJCWlmKGYpIGNvbnRpbnVlOw0KLy8JCQkJciA9IG1pZDsNCi8vCQkJfQ0KLy8JCQljb3V0IDw8IHJlYyAtIHIgPDwgJ1xuJzsNCgkJCWludCBsID0gYVtuLzJdICsgMSxyID0gYVtuLzIgKyAxXSAtIDE7DQoJCQlpZihyIC0gbCArIDEgPD0gMCkgY291dCA8PCAnMCcgPDwgJ1xuJzsNCgkJCWVsc2Ugew0KCQkJCWludCBsZWZ0ID0gMCxyaWdodCA9IDA7DQoJCQkJbWVtY3B5KGEsdG1wLHNpemVvZihhKSk7DQoJCQkJYm9vbCBleCA9IDE7DQoJCQkJZm9yKGludCBpID0gMTsgaSA8PSBuOyBpICsrKSB7DQoJCQkJCWlmKGFbaV0gPCBsKSBsZWZ0ICsrOw0KCQkJCQlpZihhW2ldID4gcikgcmlnaHQgKys7DQoJCQkJCWlmKHJpZ2h0ID4gbGVmdCkgew0KCQkJCQkJZXggPSAwOw0KCQkJCQkJYnJlYWs7DQoJCQkJCX0NCgkJCQl9DQoJCQkJaWYoIWV4KSBjb3V0IDw8ICcwJyA8PCAnXG4nOw0KCQkJCWVsc2UgY291dCA8PCByIC0gbCArIDEgPDwgJ1xuJzsNCgkJCX0NCgkJfSBlbHNlIHsNCgkJCWlmKGNudFthW24vMl1dICUgMiA9PSAwKSB7DQoJCQkJbWVtY3B5KGEsdG1wLHNpemVvZihhKSk7DQoJCQkJYm9vbCBmID0gMTsNCgkJCQlpbnQgbCA9IDAsciA9IDAsayA9IGFbbi8yXTsNCgkJCQlmb3IoaW50IGkgPSAxOyBpIDw9IG47IGkgKyspIHsNCgkJCQkJaWYoYVtpXSA8IGspIGwgKys7DQoJCQkJCWlmKGFbaV0gPiBrKSByICsrOw0KCQkJCQlpZihyID4gbCkgew0KCQkJCQkJZiA9IDA7DQoJCQkJCQlicmVhazsNCgkJCQkJfQ0KCQkJCX0NCgkJCQlpZihmKSBjb3V0IDw8IDEgPDwgJ1xuJzsNCgkJCQllbHNlIGNvdXQgPDwgMCA8PCAnXG4nOw0KCQkJfSBlbHNlIGNvdXQgPDwgMCA8PCAnXG4nOw0KCQl9DQoJfQ0KCXJldHVybiAwOw0KfQ0KDQo="}]