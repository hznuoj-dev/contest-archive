[{"id":"31949","submission_id":"31949","filename":"27_2.cpp","source":"I2luY2x1ZGU8aW9zdHJlYW0+DQp1c2luZyBuYW1lc3BhY2Ugc3RkOw0KZG91YmxlIGFbMTBdLGJbMTBdOw0KaW50IGZbMTBdOw0KaW50IG0sZDsNCmludCBtYWluKCkNCnsNCiAgICBjaW4gPj4gbSA+PiBkOw0KICAgIGZvciAoaW50IGkgPSAxOyBpIDw9IDU7IGkgKysgKSBjaW4gPj4gYVtpXTsNCiAgICBmb3IgKGludCBpID0gMTsgaSA8PSA1OyBpICsrICkgY2luID4+IGJbaV07DQogICAgZG91YmxlIG1heDEgPSAtMTsNCiAgICBmb3IgKGludCBpID0gMTsgaSA8PSA1OyBpICsrICkNCiAgICB7DQogICAgICAgIGRvdWJsZSBhbnMgPSBhW2ldOw0KICAgICAgICBpZiAoYW5zID49IG0pIGFucyA9IGFucyAtIGQ7DQogICAgICAgIG1heDEgPSBtYXgobWF4MSxiW2ldL2Fucyk7DQogICAgfQ0KICAgIGZvciAoaW50IGkgPSAxOyBpIDw9IDU7IGkgKysgKQ0KICAgIHsNCiAgICAgICAgZm9yIChpbnQgaiA9IGkgKyAxOyBqIDw9IDU7IGogKysgKQ0KICAgICAgICB7DQogICAgICAgICAgICBkb3VibGUgYW5zID0gYVtpXSArIGFbal07DQogICAgICAgICAgICBkb3VibGUgYW5zMSA9IGJbaV0gKyBiW2pdOw0KICAgICAgICAgICAgaWYgKGFucyA+PSBtKSBhbnMgPSBhbnMgLSBkOw0KICAgICAgICAgICAgbWF4MSA9IG1heChtYXgxLGFuczEvYW5zKTsNCiAgICAgICAgICAgIC8vY291dCA8PCBpIDw8IGogPDwgZW5kbDsNCiAgICAgICAgfQ0KICAgIH0NCiAgICBmb3IgKGludCBpID0gMTsgaSA8PSA1OyBpICsrICkNCiAgICB7DQogICAgICAgIGZvciAoaW50IGogPSBpICsgMTsgaiA8PSA1OyBqICsrICkNCiAgICAgICAgew0KICAgICAgICAgICBmb3IgKGludCBrID0gaiArIDE7IGsgPD0gNTsgayArKykNCiAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGRvdWJsZSBhbnMgPSBhW2ldICsgYVtqXSArIGFba107DQogICAgICAgICAgICAgICAgZG91YmxlIGFuczEgPSBiW2ldICsgYltqXSArIGJba107DQogICAgICAgICAgICAgICAgaWYgKGFucyA+PSBtKSBhbnMgPSBhbnMgLSBkOw0KICAgICAgICAgICAgICAgIG1heDEgPSBtYXgobWF4MSxhbnMxL2Fucyk7DQogICAgICAgICAgICAgICAgLy9jb3V0IDw8IGkgPDwgaiA8PCBrIDw8IGVuZGw7DQogICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCiAgICBmb3IgKGludCBpID0gMTsgaSA8PSA1OyBpICsrICkNCiAgICB7DQogICAgICAgIGZvciAoaW50IGogPSBpICsgMTsgaiA8PSA1OyBqICsrICkNCiAgICAgICAgew0KICAgICAgICAgICBmb3IgKGludCBrID0gaiArIDE7IGsgPD0gNTsgayArKykNCiAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGZvciAoaW50IG4gPSBrICsgMTtuIDw9IDUgO24gKysgKQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgLy9jb3V0IDw8IGkgPDwgaiA8PCBrIDw8IG4gPDwgZW5kbDsNCiAgICAgICAgICAgICAgICAgICAgZG91YmxlIGFucyA9IGFbaV0gKyBhW2pdICsgYVtrXSArIGFbbl07DQogICAgICAgICAgICAgICAgICAgIGRvdWJsZSBhbnMxID0gYltpXSArIGJbal0gKyBiW2tdICsgYltuXTsNCiAgICAgICAgICAgICAgICAgICAgaWYgKGFucyA+PSBtKSBhbnMgPSBhbnMgLSBkOw0KICAgICAgICAgICAgICAgICAgICBtYXgxID0gbWF4KG1heDEsYW5zMS9hbnMpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KICAgIGRvdWJsZSBhbnMgPSBhWzFdICsgYVsyXSArIGFbM10gKyBhWzRdICsgYVs1XTsNCiAgICBkb3VibGUgYW5zMSA9IGJbMV0gKyBiWzJdICsgYlszXSArIGJbNF0gKyBiWzVdOyANCiAgICBpZiAoYW5zID49IG0pIGFucyA9IGFucyAtIGQ7DQogICAgbWF4MSA9IG1heChtYXgxLGFuczEvYW5zKTsNCiAgICBwcmludGYoIiUuMmxmIixtYXgxKTsNCiAgICByZXR1cm4gMDsNCn0="}]