[{"id":"32417","submission_id":"32417","filename":"main.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+DQoNCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQoNCnR5cGVkZWYgbG9uZyBsb25nIGxsOw0KdHlwZWRlZiBsb25nIGRvdWJsZSBsZDsNCg0KI2RlZmluZSBkbCA8PCJcbiINCiNkZWZpbmUgcHViIHB1c2hfYmFjaw0KI2RlZmluZSBwb2IgcG9wX2JhY2sNCiNkZWZpbmUgcG9mIHBvcF9mcm9udA0KI2RlZmluZSBwdWYgcHVzaF9mcm9udA0KI2RlZmluZSBlcHMgMWUtNg0KI2RlZmluZSBNQVhYIDFlNSsxDQojZGVmaW5lIElPUyBpb3M6OnN5bmNfd2l0aF9zdGRpbyhmYWxzZSksIGNpbi50aWUoMCksIGNvdXQudGllKDApDQoNCi8vY29uc3QgbGwgSU5GID0gMHgzZjNmM2YzZjNmM2YzZjNmOw0KY29uc3QgaW50IGluZiA9IDB4M2YzZjNmM2YsIG1vZCA9IDEwMDAwMDAwMDcsIHJnZTEgPSAxMDAwMTAwLCByZ2UyID0gMTAwMDE7DQoNCi8vbGwgc1syMDAwMDFdID0geyAwIH07DQoNCi8qDQpkb3VibGUgbSA9IDAsIGsgPSAwOw0KZG91YmxlIGQgPSAwOw0KDQpzdHJ1Y3QgR09PRCB7DQogICAgZG91YmxlIHA7Ly9wcmljZQ0KICAgIGRvdWJsZSBjOy8vY29tbWVudA0KICAgIGRvdWJsZSByOy8vcmF0ZQ0KfTsNCg0KR09PRCBnWzVdOw0KDQpib29sIG1jKEdPT0QgeCwgR09PRCB5KSB7DQoNCiAgICBpZiAoeC5yICE9IHkucikgew0KDQogICAgICAgIGlmICh4LnIgPiB5LnIpIHsNCiAgICAgICAgICAgIGQgKz0geC5wOw0KICAgICAgICB9DQogICAgICAgIGVsc2Ugew0KICAgICAgICAgICAgZCArPSB5LnA7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4geC5yID4geS5yOw0KICAgIH0NCiAgICBlbHNlIHsNCg0KICAgICAgICBpZiAoeC5wID49IChtIC0gZCkpIHsNCg0KICAgICAgICAgICAgaWYgKHkucCA8IChtIC0gZCkpIHsNCiAgICAgICAgICAgICAgICBkICs9IHgucDsNCiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGVsc2Ugew0KDQogICAgICAgICAgICAgICAgaWYgKHgucCA8IHkucCkgew0KICAgICAgICAgICAgICAgICAgICBkICs9IHgucDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIGQgKz0geS5wOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIHJldHVybiB4LnAgPCB5LnA7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgfQ0KICAgICAgICBlbHNlIHsNCg0KICAgICAgICAgICAgaWYgKHkucCA+PSAobSAtIGQpKSB7DQogICAgICAgICAgICAgICAgZCArPSB5LnA7DQogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgZWxzZSB7DQoNCiAgICAgICAgICAgICAgICBpZiAoeC5wID4geS5wKSB7DQogICAgICAgICAgICAgICAgICAgIGQgKz0geC5wOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgZCArPSB5LnA7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgcmV0dXJuIHgucCA+IHkucDsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICB9DQogICAgDQogICAgfQ0KDQp9DQoqLw0KDQovKg0KbGwgcFsyMDAwMDFdWzNdID0geyAwIH07DQpsbCBSYW5rWzIwMDAwMV0gPSB7IDAgfTsNCg0Kdm9pZCBpbml0KGxsIG4pIHsNCiAgICBmb3IgKGxsIGkgPSAxOyBpIDw9IG47ICsraSkgew0KICAgICAgICBwW2ldWzBdID0gaTsNCiAgICAgICAgcFtpXVsyXSA9IDA7DQogICAgICAgIGNpbiA+PiBwW2ldWzFdOw0KICAgICAgICBwW2ldWzFdICU9IDEwMDAwMDAwMDc7DQogICAgICAgIFJhbmtbaV0gPSAxOw0KICAgIH0NCn0NCg0KbGwgRmluZChsbCB4KSB7DQogICAgcmV0dXJuIHggPT0gcFt4XVswXSA/IHggOiAocFt4XVswXSA9IEZpbmQocFt4XVswXSkpOw0KfQ0KDQp2b2lkIG1lcmdlKCkgew0KDQogICAgbGwgdSA9IDAsIHYgPSAwOw0KICAgIGNpbiA+PiB1ID4+IHY7DQoNCiAgICBsbCB4ID0gRmluZCh1KSwgeSA9IEZpbmQodik7DQoNCiAgICBpZiAoUmFua1t4XSA8PSBSYW5rW3ldKSB7DQogICAgICAgIHBbeF1bMF0gPSB5Ow0KICAgIH0NCiAgICBlbHNlIHsNCiAgICAgICAgcFt5XVswXSA9IHg7DQogICAgfQ0KDQogICAgaWYgKFJhbmtbeF0gPT0gUmFua1t5XSAmJiB4ICE9IHkpIHsNCiAgICAgICAgUmFua1t5XSsrOw0KICAgIH0NCg0KfQ0KDQp2b2lkIHVwKGxsIG4pIHsNCg0KICAgIGxsIHUgPSAwLCB2ID0gMDsNCiAgICBjaW4gPj4gdSA+PiB2Ow0KDQogICAgbGwgZGFkID0gRmluZCh1KTsNCg0KICAgIGZvciAobGwgaSA9IDE7IGkgPD0gbjsgaSsrKSB7DQogICAgICAgIGlmIChkYWQgPT0gRmluZChpKSkgew0KICAgICAgICAgICAgcFtpXVsxXSArPSB2Ow0KICAgICAgICB9DQogICAgfQ0KDQp9DQoNCmxsIHN1bVsyMDAwMDFdID0geyAwIH07DQoNCnZvaWQgZXZlcnlldmUobGwgbikgew0KDQogICAgZm9yIChsbCBpID0gMTsgaSA8PSBuOyBpKyspIHsNCiAgICAgICAgc3VtW2ldID0gMDsNCiAgICB9DQoNCiAgICBmb3IgKGxsIGkgPSAxOyBpIDw9IG47IGkrKykgew0KICAgICAgICANCiAgICAgICAgbGwgZGFkID0gRmluZChpKTsNCiAgICAgICAgc3VtW2RhZF0gKz0gcFtpXVsxXTsNCiAgICAgICAgc3VtW2RhZF0gJT0gMTAwMDAwMDAwNzsNCg0KICAgIH0NCg0KICAgIGZvciAobGwgaSA9IDE7IGkgPD0gbjsgaSsrKSB7DQoNCiAgICAgICAgbGwgZGFkID0gRmluZChpKTsNCg0KICAgICAgICBwW2ldWzJdICs9IHN1bVtkYWRdOw0KICAgICAgICBwW2ldWzJdICU9IDEwMDAwMDAwMDc7DQoNCiAgICB9DQoNCn0NCg0Kdm9pZCBhc2soKSB7DQogICAgbGwgdSA9IDA7DQogICAgY2luID4+IHU7DQogICAgY291dCA8PCBwW3VdWzJdIGRsOw0KfSovDQoNCmxsIGFbMjAwMDAxXSA9IHsgMCB9Ow0KbGwgYlsyMDAwMDFdID0geyAwIH07DQoNCnZvaWQgTG9saXRhU2FtYSgpIHsNCg0KICAgIGxsIG4gPSAwOw0KICAgIGNpbiA+PiBuOw0KDQogICAgaWYgKG4gJSAyICE9IDApIHsNCiAgICAgICAgY291dCA8PCAiMCIgZGw7DQogICAgICAgIHJldHVybjsNCiAgICB9DQoNCiAgICBmb3IgKGludCBpID0gMDsgaSA8IG47IGkrKykgew0KICAgICAgICBjaW4gPj4gYVtpXTsNCiAgICAgICAgYltpXSA9IGFbaV07DQogICAgfQ0KDQogICAgc29ydChiLCBiICsgbik7DQoNCiAgICBpbnQgY250ID0gMDsNCg0KICAgIGZvciAoaW50IGkgPSBiW24gLyAyIC0gMV07IGkgPD0gYltuIC8gMl07IGkrKykgew0KDQogICAgICAgIGludCBvcCA9IDA7DQoNCiAgICAgICAgZm9yIChpbnQgaiA9IDA7IGogPCBuOyBqKyspIHsNCiAgICAgICAgICAgIGlmIChhW2pdIDwgaSkgb3AtLTsNCiAgICAgICAgICAgIGVsc2UgaWYgKGFbal0gPiBpKSBvcCsrOw0KICAgICAgICAgICAgaWYgKG9wID4gMCkgew0KICAgICAgICAgICAgICAgIG9wID0gLTE7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICBpZiAob3AgPT0gMCkgew0KICAgICAgICAgICAgY250Kys7DQogICAgICAgIH0NCg0KICAgIH0NCg0KICAgIGNvdXQgPDwgY250IGRsOw0KDQoNCg0KICAgIC8qDQogICAgbGwgbiA9IDAsIHEgPSAwOw0KICAgIGNpbiA+PiBuID4+IHE7DQoNCiAgICBpbml0KG4pOw0KDQogICAgaW50IG9wID0gMDsNCg0KICAgIHdoaWxlIChxLS0pIHsNCg0KICAgICAgICBldmVyeWV2ZShuKTsNCg0KICAgICAgICBjaW4gPj4gb3A7DQogICAgICAgIHN3aXRjaCAob3ApIHsNCiAgICAgICAgY2FzZSAxOg0KICAgICAgICAgICAgbWVyZ2UoKTsNCiAgICAgICAgICAgIC8vZXZlcnlldmUobik7DQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgY2FzZSAyOg0KICAgICAgICAgICAgdXAobik7DQogICAgICAgICAgICAvL2V2ZXJ5ZXZlKG4pOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgMzoNCiAgICAgICAgICAgIGFzaygpOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIH0NCg0KICAgICAgICAvL2V2ZXJ5ZXZlKG4pOw0KICAgIH0NCiAgICAqLw0KDQogICAgLyoNCiAgICBMDQoNCiAgICBsbCBuID0gMCwgayA9IDA7DQogICAgY2luID4+IG4gPj4gazsNCg0KICAgIGxsIGMgPSAwOw0KDQogICAgZm9yIChsbCBpID0gMTsgaSA8PSBuOyBpKyspIHsNCiAgICAgICAgY2luID4+IHNbaV07DQogICAgICAgIGlmIChzW2ldID09IGkpIGMrKzsNCiAgICB9DQoNCiAgICBpZiAobiA9PSBrICsgMSkgew0KICAgICAgICBjb3V0IDw8ICItMSIgZGw7DQogICAgfQ0KICAgIGVsc2Ugew0KICAgICAgICBjb3V0IDw8IChjICsgMSAtIGspIC8gMiBkbDsNCiAgICB9DQogICAgKi8NCg0KICAgIC8qDQogICAgY2luID4+IG0gPj4gazsNCg0KICAgIGZvciAoaW50IGkgPSAwOyBpIDwgNTsgaSsrKSB7DQogICAgICAgIGNpbiA+PiBnW2ldLnA7DQogICAgfQ0KICAgIGZvciAoaW50IGkgPSAwOyBpIDwgNTsgaSsrKSB7DQogICAgICAgIGNpbiA+PiBnW2ldLmM7DQogICAgICAgIGdbaV0uciA9IGdbaV0uYyAvIGdbaV0ucDsNCiAgICB9DQoNCiAgICBzb3J0KGcsIGcgKyA1LCBtYyk7DQoNCiAgICBkb3VibGUgc3VtcCA9IDA7DQogICAgZG91YmxlIHN1bWMgPSAwOw0KICAgIGRvdWJsZSByZW0gPSBnWzBdLnI7DQoNCiAgICBmb3IgKGludCBpID0gMDsgaSA8IDU7aSsrKSB7DQoNCiAgICAgICAgc3VtcCArPSBnW2ldLnA7DQogICAgICAgIHN1bWMgKz0gZ1tpXS5jOw0KICAgICAgICBpZiAoc3VtcCA+PSBtKSB7DQogICAgICAgICAgICBjb3V0IDw8IGZpeGVkIDw8IHNldHByZWNpc2lvbigyKSA8PCBtYXgoKHN1bWMpIC8gKHN1bXAgLSBrKSwgcmVtKSBkbDsNCiAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgfQ0KDQogICAgfQ0KDQogICAgY291dCA8PCBmaXhlZCA8PCBzZXRwcmVjaXNpb24oMikgPDwgcmVtIGRsOw0KICAgICovDQoNCiAgICAvKg0KICAgIGxsIG4gPSAwOw0KICAgIGNpbiA+PiBuOw0KDQogICAgaWYgKG4gJSAyICE9IDApIHsNCiAgICAgICAgY291dCA8PCAiMCIgZGw7DQogICAgICAgIHJldHVybjsNCiAgICB9DQoNCiAgICBmb3IgKGludCBpID0gMDsgaSA8IG47IGkrKykgew0KICAgICAgICBjaW4gPj4gYVtpXTsNCiAgICB9DQoNCiAgICBpbnQgY250ID0gMDsNCg0KICAgIGZvciAoaW50IGkgPSBhWzBdOyBpIDw9IGFbbiAtIDFdOyBpKyspIHsNCg0KICAgICAgICBpbnQgb3AgPSAwOw0KDQogICAgICAgIGZvciAoaW50IGogPSAwOyBqIDwgbjsgaisrKSB7DQogICAgICAgICAgICBpZiAoYVtqXSA8IGkpIG9wLS07DQogICAgICAgICAgICBlbHNlIGlmIChhW2pdID4gaSkgb3ArKzsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmIChvcCA9PSAwKSB7DQogICAgICAgICAgICBjbnQrKzsNCiAgICAgICAgfQ0KDQogICAgfQ0KDQogICAgY291dCA8PCBjbnQgZGw7DQogICAgKi8NCg0KfQ0KDQppbnQgbWFpbigpIHsNCg0KICAgIC8vSU9TOw0KDQogICAgaW50IFQgPSAxOw0KICAgIC8vY2luID4+IFQ7DQoNCg0KICAgIHdoaWxlIChULS0pIHsNCg0KICAgICAgICBMb2xpdGFTYW1hKCk7DQoNCiAgICB9DQoNCn0NCg=="}]