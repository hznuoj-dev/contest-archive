[{"id":"32368","submission_id":"32368","filename":"main.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+DQoNCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQoNCnR5cGVkZWYgbG9uZyBsb25nIGxsOw0KdHlwZWRlZiBsb25nIGRvdWJsZSBsZDsNCg0KI2RlZmluZSBkbCA8PCJcbiINCiNkZWZpbmUgcHViIHB1c2hfYmFjaw0KI2RlZmluZSBwb2IgcG9wX2JhY2sNCiNkZWZpbmUgcG9mIHBvcF9mcm9udA0KI2RlZmluZSBwdWYgcHVzaF9mcm9udA0KI2RlZmluZSBlcHMgMWUtNg0KI2RlZmluZSBNQVhYIDFlNSsxDQojZGVmaW5lIElPUyBpb3M6OnN5bmNfd2l0aF9zdGRpbyhmYWxzZSksIGNpbi50aWUoMCksIGNvdXQudGllKDApDQoNCi8vY29uc3QgbGwgSU5GID0gMHgzZjNmM2YzZjNmM2YzZjNmOw0KY29uc3QgaW50IGluZiA9IDB4M2YzZjNmM2YsIG1vZCA9IDEwMDAwMDAwMDcsIHJnZTEgPSAxMDAwMTAwLCByZ2UyID0gMTAwMDE7DQoNCi8vbGwgc1syMDAwMDFdID0geyAwIH07DQoNCi8qDQpkb3VibGUgbSA9IDAsIGsgPSAwOw0KZG91YmxlIGQgPSAwOw0KDQpzdHJ1Y3QgR09PRCB7DQogICAgZG91YmxlIHA7Ly9wcmljZQ0KICAgIGRvdWJsZSBjOy8vY29tbWVudA0KICAgIGRvdWJsZSByOy8vcmF0ZQ0KfTsNCg0KR09PRCBnWzVdOw0KDQpib29sIG1jKEdPT0QgeCwgR09PRCB5KSB7DQoNCiAgICBpZiAoeC5yICE9IHkucikgew0KDQogICAgICAgIGlmICh4LnIgPiB5LnIpIHsNCiAgICAgICAgICAgIGQgKz0geC5wOw0KICAgICAgICB9DQogICAgICAgIGVsc2Ugew0KICAgICAgICAgICAgZCArPSB5LnA7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4geC5yID4geS5yOw0KICAgIH0NCiAgICBlbHNlIHsNCg0KICAgICAgICBpZiAoeC5wID49IChtIC0gZCkpIHsNCg0KICAgICAgICAgICAgaWYgKHkucCA8IChtIC0gZCkpIHsNCiAgICAgICAgICAgICAgICBkICs9IHgucDsNCiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGVsc2Ugew0KDQogICAgICAgICAgICAgICAgaWYgKHgucCA8IHkucCkgew0KICAgICAgICAgICAgICAgICAgICBkICs9IHgucDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIGQgKz0geS5wOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIHJldHVybiB4LnAgPCB5LnA7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgfQ0KICAgICAgICBlbHNlIHsNCg0KICAgICAgICAgICAgaWYgKHkucCA+PSAobSAtIGQpKSB7DQogICAgICAgICAgICAgICAgZCArPSB5LnA7DQogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgZWxzZSB7DQoNCiAgICAgICAgICAgICAgICBpZiAoeC5wID4geS5wKSB7DQogICAgICAgICAgICAgICAgICAgIGQgKz0geC5wOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgZCArPSB5LnA7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgcmV0dXJuIHgucCA+IHkucDsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICB9DQogICAgDQogICAgfQ0KDQp9DQoqLw0KDQpsbCBwWzIwMDAwMV1bM10gPSB7IDAgfTsNCmxsIFJhbmtbMjAwMDAxXSA9IHsgMCB9Ow0KDQp2b2lkIGluaXQobGwgbikgew0KICAgIGZvciAobGwgaSA9IDE7IGkgPD0gbjsgKytpKSB7DQogICAgICAgIHBbaV1bMF0gPSBpOw0KICAgICAgICBwW2ldWzJdID0gMDsNCiAgICAgICAgY2luID4+IHBbaV1bMV07DQogICAgICAgIHBbaV1bMV0gJT0gMTAwMDAwMDAwNzsNCiAgICAgICAgUmFua1tpXSA9IDE7DQogICAgfQ0KfQ0KDQpsbCBGaW5kKGxsIHgpIHsNCiAgICByZXR1cm4geCA9PSBwW3hdWzBdID8geCA6IChwW3hdWzBdID0gRmluZChwW3hdWzBdKSk7DQp9DQoNCnZvaWQgbWVyZ2UoKSB7DQoNCiAgICBsbCB1ID0gMCwgdiA9IDA7DQogICAgY2luID4+IHUgPj4gdjsNCg0KICAgIGxsIHggPSBGaW5kKHUpLCB5ID0gRmluZCh2KTsNCg0KICAgIGlmIChSYW5rW3hdIDw9IFJhbmtbeV0pIHsNCiAgICAgICAgcFt4XVswXSA9IHk7DQogICAgfQ0KICAgIGVsc2Ugew0KICAgICAgICBwW3ldWzBdID0geDsNCiAgICB9DQoNCiAgICBpZiAoUmFua1t4XSA9PSBSYW5rW3ldICYmIHggIT0geSkgew0KICAgICAgICBSYW5rW3ldKys7DQogICAgfQ0KDQp9DQoNCnZvaWQgdXAobGwgbikgew0KDQogICAgbGwgdSA9IDAsIHYgPSAwOw0KICAgIGNpbiA+PiB1ID4+IHY7DQoNCiAgICBsbCBkYWQgPSBGaW5kKHUpOw0KDQogICAgZm9yIChsbCBpID0gMTsgaSA8PSBuOyBpKyspIHsNCiAgICAgICAgaWYgKGRhZCA9PSBGaW5kKGkpKSB7DQogICAgICAgICAgICBwW2ldWzFdICs9IHY7DQogICAgICAgIH0NCiAgICB9DQoNCn0NCg0KbGwgc3VtWzIwMDAwMV0gPSB7IDAgfTsNCg0Kdm9pZCBldmVyeWV2ZShsbCBuKSB7DQoNCiAgICBmb3IgKGxsIGkgPSAxOyBpIDw9IG47IGkrKykgew0KICAgICAgICBzdW1baV0gPSAwOw0KICAgIH0NCg0KICAgIGZvciAobGwgaSA9IDE7IGkgPD0gbjsgaSsrKSB7DQogICAgICAgIA0KICAgICAgICBsbCBkYWQgPSBGaW5kKGkpOw0KICAgICAgICBzdW1bZGFkXSArPSBwW2ldWzFdOw0KICAgICAgICBzdW1bZGFkXSAlPSAxMDAwMDAwMDA3Ow0KDQogICAgfQ0KDQogICAgZm9yIChsbCBpID0gMTsgaSA8PSBuOyBpKyspIHsNCg0KICAgICAgICBsbCBkYWQgPSBGaW5kKGkpOw0KDQogICAgICAgIHBbaV1bMl0gKz0gc3VtW2RhZF07DQogICAgICAgIHBbaV1bMl0gJT0gMTAwMDAwMDAwNzsNCg0KICAgIH0NCg0KfQ0KDQp2b2lkIGFzaygpIHsNCiAgICBsbCB1ID0gMDsNCiAgICBjaW4gPj4gdTsNCiAgICBjb3V0IDw8IHBbdV1bMl0gZGw7DQp9DQoNCnZvaWQgTG9saXRhU2FtYSgpIHsNCg0KICAgIGxsIG4gPSAwLCBxID0gMDsNCiAgICBjaW4gPj4gbiA+PiBxOw0KDQogICAgaW5pdChuKTsNCg0KICAgIGludCBvcCA9IDA7DQoNCiAgICB3aGlsZSAocS0tKSB7DQoNCiAgICAgICAgZXZlcnlldmUobik7DQoNCiAgICAgICAgY2luID4+IG9wOw0KICAgICAgICBzd2l0Y2ggKG9wKSB7DQogICAgICAgIGNhc2UgMToNCiAgICAgICAgICAgIG1lcmdlKCk7DQogICAgICAgICAgICAvL2V2ZXJ5ZXZlKG4pOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgMjoNCiAgICAgICAgICAgIHVwKG4pOw0KICAgICAgICAgICAgLy9ldmVyeWV2ZShuKTsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICBjYXNlIDM6DQogICAgICAgICAgICBhc2soKTsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICB9DQoNCiAgICAgICAgLy9ldmVyeWV2ZShuKTsNCiAgICB9DQoNCiAgICAvKg0KICAgIEwNCg0KICAgIGxsIG4gPSAwLCBrID0gMDsNCiAgICBjaW4gPj4gbiA+PiBrOw0KDQogICAgbGwgYyA9IDA7DQoNCiAgICBmb3IgKGxsIGkgPSAxOyBpIDw9IG47IGkrKykgew0KICAgICAgICBjaW4gPj4gc1tpXTsNCiAgICAgICAgaWYgKHNbaV0gPT0gaSkgYysrOw0KICAgIH0NCg0KICAgIGlmIChuID09IGsgKyAxKSB7DQogICAgICAgIGNvdXQgPDwgIi0xIiBkbDsNCiAgICB9DQogICAgZWxzZSB7DQogICAgICAgIGNvdXQgPDwgKGMgKyAxIC0gaykgLyAyIGRsOw0KICAgIH0NCiAgICAqLw0KDQogICAgLyoNCiAgICBjaW4gPj4gbSA+PiBrOw0KDQogICAgZm9yIChpbnQgaSA9IDA7IGkgPCA1OyBpKyspIHsNCiAgICAgICAgY2luID4+IGdbaV0ucDsNCiAgICB9DQogICAgZm9yIChpbnQgaSA9IDA7IGkgPCA1OyBpKyspIHsNCiAgICAgICAgY2luID4+IGdbaV0uYzsNCiAgICAgICAgZ1tpXS5yID0gZ1tpXS5jIC8gZ1tpXS5wOw0KICAgIH0NCg0KICAgIHNvcnQoZywgZyArIDUsIG1jKTsNCg0KICAgIGRvdWJsZSBzdW1wID0gMDsNCiAgICBkb3VibGUgc3VtYyA9IDA7DQogICAgZG91YmxlIHJlbSA9IGdbMF0ucjsNCg0KICAgIGZvciAoaW50IGkgPSAwOyBpIDwgNTtpKyspIHsNCg0KICAgICAgICBzdW1wICs9IGdbaV0ucDsNCiAgICAgICAgc3VtYyArPSBnW2ldLmM7DQogICAgICAgIGlmIChzdW1wID49IG0pIHsNCiAgICAgICAgICAgIGNvdXQgPDwgZml4ZWQgPDwgc2V0cHJlY2lzaW9uKDIpIDw8IG1heCgoc3VtYykgLyAoc3VtcCAtIGspLCByZW0pIGRsOw0KICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICB9DQoNCiAgICB9DQoNCiAgICBjb3V0IDw8IGZpeGVkIDw8IHNldHByZWNpc2lvbigyKSA8PCByZW0gZGw7DQogICAgKi8NCg0KICAgIC8qDQogICAgbGwgbiA9IDA7DQogICAgY2luID4+IG47DQoNCiAgICBpZiAobiAlIDIgIT0gMCkgew0KICAgICAgICBjb3V0IDw8ICIwIiBkbDsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCg0KICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbjsgaSsrKSB7DQogICAgICAgIGNpbiA+PiBhW2ldOw0KICAgIH0NCg0KICAgIGludCBjbnQgPSAwOw0KDQogICAgZm9yIChpbnQgaSA9IGFbMF07IGkgPD0gYVtuIC0gMV07IGkrKykgew0KDQogICAgICAgIGludCBvcCA9IDA7DQoNCiAgICAgICAgZm9yIChpbnQgaiA9IDA7IGogPCBuOyBqKyspIHsNCiAgICAgICAgICAgIGlmIChhW2pdIDwgaSkgb3AtLTsNCiAgICAgICAgICAgIGVsc2UgaWYgKGFbal0gPiBpKSBvcCsrOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKG9wID09IDApIHsNCiAgICAgICAgICAgIGNudCsrOw0KICAgICAgICB9DQoNCiAgICB9DQoNCiAgICBjb3V0IDw8IGNudCBkbDsNCiAgICAqLw0KDQp9DQoNCmludCBtYWluKCkgew0KDQogICAgLy9JT1M7DQoNCiAgICBpbnQgVCA9IDE7DQogICAgLy9jaW4gPj4gVDsNCg0KDQogICAgd2hpbGUgKFQtLSkgew0KDQogICAgICAgIExvbGl0YVNhbWEoKTsNCg0KICAgIH0NCg0KfQ0K"}]