[{"id":"31931","submission_id":"31931","filename":"main.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+CiNkZWZpbmUgaW50IGxvbmcgbG9uZwoKdXNpbmcgbmFtZXNwYWNlIHN0ZDsKCnZvaWQgYSgpewogICAgaW50IG47CiAgICBjaW4gPj4gbjsKICAgIHZlY3RvcjxpbnQ+IHZjKG4pOwogICAgdmVjdG9yPGludD4gYXJyKG4pOwogICAgZm9yIChpbnQgaSA9IDA7IGkgPCBuOyArK2kpIHsKICAgICAgICBjaW4gPj4gdmNbaV07CiAgICAgICAgYXJyW2ldID0gdmNbaV07CiAgICB9CiAgICBpZihuICUgMil7CgogICAgfQogICAgZWxzZXsKICAgICAgICBzdGQ6OnNvcnQodmMuYmVnaW4oKSwgdmMuZW5kKCkpOwogICAgICAgIGludCBtMiA9IHZjW24vMl0sIG0xID0gdmNbbi8yIC0gMV07CiAgICAgICAgaWYobTEgPCBhcnJbMF0pIG0xID0gYXJyWzBdOyBpZihhcnJbbi0xXSA8IG0yKSBtMiA9IGFycltuLTFdOwogICAgICAgIGZvciAoaW50IGkgPSBtMTsgaSA8IG0yOyArK2kpIHsKCiAgICAgICAgfQoKICAgIH0KfQoKdm9pZCBwcl92ZWModmVjdG9yPGludD4mIHZjKXsKICAgIGZvciAoaW50IGkgOiB2YykgewogICAgICAgIGNvdXQgPDwgaSA8PCAiICIgOwogICAgfQogICAgY291dCA8PCAiXG4iOwp9CnZvaWQgYigpewogICAgaW50IG47CiAgICBjaW4gPj4gbjsKICAgIHZlY3RvcjxpbnQ+IGEobik7CiAgICB2ZWN0b3I8aW50PiB2YyhuKTsKICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbjsgKytpKSB7CiAgICAgICAgY2luID4+IGFbaV07CiAgICB9CiAgICBmb3IgKGludCBpID0gMDsgaSA8IG47ICsraSkgewogICAgICAgIGNpbiA+PiB2Y1tpXTsKICAgIH0KCiAgICBzdGQ6OnNvcnQoYS5iZWdpbigpLCBhLmVuZCgpKTsKICAgIHN0ZDo6c29ydCh2Yy5iZWdpbigpLCB2Yy5lbmQoKSk7CgogICAgaW50IHBvaW50ID0gMDsKICAgIGludCBkZXRbMl07CiAgICBkZXRbMF0gPSBhWzBdIC0gdmNbMF07CiAgICBkZXRbMV0gPSBhWzBdIC0gKC12Y1tuLTFdKTsKICAgIGlmKGFicyhkZXRbMF0pID4gYWJzKGRldFsxXSkpewogICAgICAgIGRldFswXSA9IGRldFsxXTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IG47ICsraSkgewogICAgICAgICAgICB2Y1tpXSA9IC12Y1tpXTsKICAgICAgICB9CiAgICAgICAgcHJfdmVjKHZjKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IG4gLyAyOyArK2kpIHsKICAgICAgICAgICAgc3dhcCh2Y1tpXSwgdmNbbi0xLWldKTsKICAgICAgICB9CiAgICAgICAgcHJfdmVjKHZjKTsKCiAgICAgICAgcG9pbnQgPSAxOwogICAgfQogICAgZm9yIChpbnQgaSA9IDA7IGkgPCBuOyArK2kpIHsKICAgICAgICB2Y1tpXSArPSBkZXRbMF07CiAgICB9CiAgICBwcl92ZWModmMpOwoKICAgIGJvb2wgZiA9IHRydWU7CiAgICBmb3IgKGludCBpID0gMDsgaSA8IG47ICsraSkgewogICAgICAgIGlmKGFbaV0gIT0gdmNbaV0pewogICAgICAgICAgICBmID0gZmFsc2U7CiAgICAgICAgfQogICAgfQoKICAgIGlmKGYpewogICAgICAgIGNvdXQgPDwgYWJzKGRldFswXSkgKyBwb2ludDsKICAgIH0KICAgIGVsc2V7CiAgICAgICAgY291dCA8PCAtMTsKICAgIH0KCgoKLy8KLy8gICAgaW50IGNudF9hID0gYVswXTsKLy8gICAgZm9yIChpbnQgaSA9IDA7IGkgPCBuLTE7ICsraSkgewovLyAgICAgICAgaWYoYVtpXSAqIGFbaSsxXSA8IDApewovLyAgICAgICAgICAgIGNudF9hID0gaTsKLy8gICAgICAgICAgICBicmVhazsKLy8gICAgICAgIH0KLy8gICAgfQovLwovLwovLyAgICBpbnQgY250X3ZjID0gdmNbMF07Ci8vICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbi0xOyArK2kpIHsKLy8gICAgICAgIGlmKHZjW2ldICogdmNbaSsxXSA8IDApewovLyAgICAgICAgICAgIGNudF92YyA9IGk7Ci8vICAgICAgICAgICAgYnJlYWs7Ci8vICAgICAgICB9Ci8vICAgIH0KLy8KLy8gICAgaW50IHBvaW50ID0gMDsKLy8gICAgaW50IGRldFsyXTsKLy8gICAgZGV0WzBdID0gY250X2EgLSBjbnRfdmM7Ci8vICAgIGRldFsxXSA9IGNudF9hIC0gKG4tMSAtIGNudF92YyAtIDEpOwovLyAgICBpZihhYnMoZGV0WzBdKSA+IGFicyhkZXRbMV0pKXsKLy8gICAgICAgIC8v5Y+N6L2sCi8vICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IG47ICsraSkgewovLyAgICAgICAgICAgIHZjW2ldID0gLXZjW2ldOwovLyAgICAgICAgfQovLyAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPD0gbiAvIDI7ICsraSkgewovLyAgICAgICAgICAgIHN3YXAodmNbaV0sIHZjW24tMV0pOwovLyAgICAgICAgfQovLyAgICAgICAgZGV0WzBdID0gZGV0WzFdOwovLyAgICAgICAgcG9pbnQgPSAxOwovLyAgICB9Ci8vICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbjsgKytpKSB7Ci8vICAgICAgICB2Y1tpXSArPSBkZXRbMF07Ci8vICAgIH0KLy8KLy8KCgp9CgpzaWduZWQgbWFpbigpIHsKICAgIGIoKTsKfQo="}]