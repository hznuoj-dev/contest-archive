[{"id":"32406","submission_id":"32406","filename":"i.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+DQojZGVmaW5lIGZwKGksIGEsIGIpIGZvcihpbnQgaSA9IChhKSwgZWQgPSAoYik7IGkgPD0gZWQ7ICsraSkNCiNkZWZpbmUgZmIoaSwgYSwgYikgZm9yKGludCBpID0gKGEpLCBlZCA9IChiKTsgaSA+PSBlZDsgLS1pKQ0KI2RlZmluZSBnbyh1LCBpKSBmb3IoaW50IGkgPSBoZWFkW3VdOyBpOyBpID0gZVtpXS5ueHQpDQp1c2luZyBuYW1lc3BhY2Ugc3RkOw0KdHlwZWRlZiBsb25nIGxvbmcgTEw7DQp0eXBlZGVmIHBhaXI8aW50LCBpbnQ+IHBpaTsNCmlubGluZSBpbnQgcmQoKSB7DQoJcmVnaXN0ZXIgaW50IHgoMCksIGYoMSk7IHJlZ2lzdGVyIGNoYXIgYyhnZXRjaGFyKCkpOw0KCXdoaWxlIChjIDwgJzAnIHx8ICc5JyA8IGMpIHsgaWYgKGMgPT0gJy0nKWYgPSAtMTsgYyA9IGdldGNoYXIoKTsgfQ0KCXdoaWxlICgnMCcgPD0gYyAmJiBjIDw9ICc5Jyl4ID0geCoxMCArIGMtJzAnLCBjID0gZ2V0Y2hhcigpOw0KCXJldHVybiB4KmY7DQp9DQppbmxpbmUgTEwgUkQoKSB7DQoJcmVnaXN0ZXIgTEwgeCgwKTsgcmVnaXN0ZXIgaW50IGYoMSk7IHJlZ2lzdGVyIGNoYXIgYyhnZXRjaGFyKCkpOw0KCXdoaWxlIChjIDwgJzAnIHx8ICc5JyA8IGMpIHsgaWYgKGMgPT0gJy0nKWYgPSAtMTsgYyA9IGdldGNoYXIoKTsgfQ0KCXdoaWxlICgnMCcgPD0gYyAmJiBjIDw9ICc5Jyl4ID0geCoxMCArIGMtJzAnLCBjID0gZ2V0Y2hhcigpOw0KCXJldHVybiB4KmY7DQp9DQppbmxpbmUgaW50IGludF9yYW5kKGludCBsLCBpbnQgcil7DQoJaW50IHJlcyA9IDEuMGwqcmFuZCgpL1JBTkRfTUFYKihyLWwrMSk7DQoJaWYocmVzID09IHItbCsxKXJlcyA9IHItbDsNCglyZXR1cm4gbCtyZXM7DQp9DQppbmxpbmUgTEwgTExfcmFuZChMTCBsLCBMTCByKXsNCglMTCByZXMgPSAxLjBsKnJhbmQoKS9SQU5EX01BWCooci1sKzEpOw0KCWlmKHJlcyA9PSByLWwrMSlyZXMgPSByLWw7DQoJcmV0dXJuIGwrcmVzOw0KfQ0KY29uc3QgaW50IG1heG4gPSAxMDEwOw0KaW50IFQsIG4sIHN0a1ttYXhuXSwgdHAsIGlkW21heG5dW21heG5dOw0Kc3RydWN0IGVkZ2V7aW50IHRvLCBueHQ7fWVbbWF4bjw8MV07DQppbnQgaGVhZFttYXhuXSwgazsNCmlubGluZSB2b2lkIGFkZChpbnQgdSwgaW50IHYpe2VbKytrXSA9IChlZGdlKXt2LCBoZWFkW3VdfSwgaGVhZFt1XSA9IGs7fQ0KYm9vbCBkZnMoaW50IHUsIGludCBwcmUsIGludCBkZXMpew0KCXN0a1srK3RwXSA9IHU7DQoJaWYodSA9PSBkZXMpcmV0dXJuIDE7DQoJZ28odSwgaSlpZihlW2ldLnRvICE9IHByZSAmJiBkZnMoZVtpXS50bywgdSwgZGVzKSlyZXR1cm4gMTsNCglyZXR1cm4gLS10cCwgMDsNCn0NCmludCBtYWluKCl7DQoJVCA9IHJkKCk7DQoJd2hpbGUoVC0tKXsNCgkJbiA9IHJkKCksIG1lbXNldChoZWFkLCAwLCBzaXplb2YgaGVhZCksIGsgPSAwOw0KCQlmcChpLCAyLCBuKXsNCgkJCWludCB1ID0gcmQoKSwgdiA9IHJkKCk7DQoJCQlhZGQodSwgdiksIGFkZCh2LCB1KSwgaWRbdV1bdl0gPSBpZFt2XVt1XSA9IGktMTsNCgkJfQ0KCQlpbnQgdSwgdjsNCgkJd2hpbGUoMSl7DQoJCQl1ID0gaW50X3JhbmQoMSwgbiksIHYgPSBpbnRfcmFuZCgxLCBuKTsNCgkJCXByaW50ZigiPyAlZCAlZFxuIiwgdSwgdiksIGZmbHVzaChzdGRvdXQpOw0KCQkJaW50IHJlcyA9IHJkKCk7DQoJCQlpZihyZXMpYnJlYWs7DQoJCX0NCgkJdHAgPSAwLCBkZnModSwgMCwgdik7DQoJCWludCBsID0gMiwgciA9IHRwLCByZXMgPSAwOw0KCQl3aGlsZShsIDw9IHIpew0KCQkJaW50IG1kID0gbCtyPj4xOw0KCQkJcHJpbnRmKCI/ICVkICVkXG4iLCBzdGtbbC0xXSwgc3RrW21kXSksIGZmbHVzaChzdGRvdXQpOw0KCQkJaWYocmQoKSlyZXMgPSBtZCwgciA9IG1kLTE7DQoJCQllbHNlIGwgPSBtZCsxOw0KCQl9DQoJCXByaW50ZigiISAlZFxuIiwgaWRbc3RrW3Jlc11dW3N0a1tyZXMtMV1dKSwgZmZsdXNoKHN0ZG91dCk7DQoJfQ0KCXJldHVybiAwOw0KfQ0K"}]