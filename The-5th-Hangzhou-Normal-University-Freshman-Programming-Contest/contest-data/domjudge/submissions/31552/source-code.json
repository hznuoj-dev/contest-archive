[{"id":"31552","submission_id":"31552","filename":"main.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+Cgp1c2luZyBuYW1lc3BhY2Ugc3RkOwoKdm9pZCBhKCl7CiAgICBpbnQgbjsKICAgIGNpbiA+PiBuOwogICAgdmVjdG9yPGludD4gdmMobik7CiAgICB2ZWN0b3I8aW50PiBhcnIobik7CiAgICBmb3IgKGludCBpID0gMDsgaSA8IG47ICsraSkgewogICAgICAgIGNpbiA+PiB2Y1tpXTsKICAgICAgICBhcnJbaV0gPSB2Y1tpXTsKICAgIH0KICAgIGlmKG4gJSAyKXsKCiAgICB9CiAgICBlbHNlewogICAgICAgIHN0ZDo6c29ydCh2Yy5iZWdpbigpLCB2Yy5lbmQoKSk7CiAgICAgICAgaW50IG0yID0gdmNbbi8yXSwgbTEgPSB2Y1tuLzIgLSAxXTsKICAgICAgICBpZihtMSA8IGFyclswXSkgbTEgPSBhcnJbMF07IGlmKGFycltuLTFdIDwgbTIpIG0yID0gYXJyW24tMV07CiAgICAgICAgZm9yIChpbnQgaSA9IG0xOyBpIDwgbTI7ICsraSkgewoKICAgICAgICB9CgogICAgfQp9Cgp2b2lkIGwoKXsKICAgIGRvdWJsZSBtLCBrOwogICAgY2luID4+IG0gPj4gazsgIC8vIOa7oW3lh49rCgogICAgdmVjdG9yPGRvdWJsZT4gdmFsdWVfeWIoNSk7CiAgICBmb3IgKGludCBpID0gMDsgaSA8IDU7ICsraSkgewogICAgICAgIGNpbiA+PiB2YWx1ZV95YltpXTsKICAgIH0KCiAgICB2ZWN0b3I8ZG91YmxlPiB2YWx1ZV9yZWFsKDUpOwogICAgZm9yIChpbnQgaSA9IDA7IGkgPCA1OyArK2kpIHsKICAgICAgICBjaW4gPj4gdmFsdWVfcmVhbFtpXTsKICAgIH0KCiAgICB2ZWN0b3I8ZG91YmxlPiByZWFsX3liKDUpOwogICAgZm9yIChpbnQgaSA9IDA7IGkgPCA1OyArK2kpIHsKICAgICAgICBkb3VibGUgdl95YiA9IHZhbHVlX3liW2ldID49IG0/IHZhbHVlX3liW2ldIC0gayA6IHZhbHVlX3liW2ldOwogICAgICAgIHJlYWxfeWJbaV0gPSB2YWx1ZV9yZWFsW2ldIC8gdl95YjsKICAgIH0KCiAgICBzdGQ6OnNvcnQocmVhbF95Yi5iZWdpbigpLCByZWFsX3liLmVuZCgpKTsKCiAgICBkb3VibGUgbW9zdF9vbmUgPSByZWFsX3liWzRdOwoKICAgIGRvdWJsZSBtb3N0X21rID0gMDsKCiAgICB2YWx1ZV9yZWFsLnB1c2hfYmFjaygwKTsKICAgIHZhbHVlX3liLnB1c2hfYmFjaygwKTsKCiAgICBpbnQgYVs1XTsKICAgIGZvciAoYVswXSA9IDA7IGFbMF0gPD0gNTsgKythWzBdKSB7CiAgICAgICAgZm9yIChhWzFdID0gMTsgYVsxXSA8PSA1OyArK2FbMV0pIHsKICAgICAgICAgICAgZm9yIChhWzJdID0gMjsgYVsyXSA8PSA1OyArK2FbMl0pIHsKICAgICAgICAgICAgICAgIGZvciAoYVszXSA9IDM7IGFbM10gPD0gNTsgKythWzNdKSB7CiAgICAgICAgICAgICAgICAgICAgZm9yIChhWzRdID0gNDsgYVs0XSA8PSA1OyArK2FbNF0pIHsKCiAgICAgICAgICAgICAgICAgICAgICAgIGJvb2wgZiA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IDQ7ICsraSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChpbnQgaiA9IGkrMTsgaiA8IDU7ICsraikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGFbaV0gPT0gYVtqXSAmJiBhW2ldICE9IDUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGYgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICBpZihmKSBjb250aW51ZTsKCgoKICAgICAgICAgICAgICAgICAgICAgICAgZG91YmxlIGFsbF9yZWFsID0gdmFsdWVfcmVhbFthWzBdXSArIHZhbHVlX3JlYWxbYVsxXV0gKyB2YWx1ZV9yZWFsW2FbMl1dICsgdmFsdWVfcmVhbFthWzNdXSArIHZhbHVlX3JlYWxbYVs0XV07CiAgICAgICAgICAgICAgICAgICAgICAgIGRvdWJsZSBhbGxfeWIgPSB2YWx1ZV95YiBbYVswXV0gKyB2YWx1ZV95YiBbYVsxXV0gKyB2YWx1ZV95YiBbYVsyXV0gKyB2YWx1ZV95YiBbYVszXV0gKyB2YWx1ZV95YiBbYVs0XV07CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGFsbF95YiA+PSBtKSBhbGxfeWIgLT0gazsKCiAgICAgICAgICAgICAgICAgICAgICAgIGlmKG1vc3RfbWsgPCBhbGxfcmVhbCAvIGFsbF95YikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9zdF9tayA9IGFsbF9yZWFsIC8gYWxsX3liOwovLyAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3V0IDw8IG1vc3RfbWsgPDwgIlxuIjsKLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnRmKCIlZCAgICAgICAgJWQgICAgICAgICVkICAgICAgICAlZCAgICAgICAgJWRcbiIsIGFbMF0sIGFbMV0sIGFbMl0sIGFbM10sIGFbNF0pOwovLyAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmludGYoIiVsZiAlbGYgJWxmICVsZiAlbGZcbiIsIHZhbHVlX3JlYWxbYVswXV0sIHZhbHVlX3JlYWxbYVsxXV0sIHZhbHVlX3JlYWxbYVsyXV0sIHZhbHVlX3JlYWxbYVszXV0sIHZhbHVlX3JlYWxbYVs0XV0pOwovLyAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmludGYoIiVsZiAlbGYgJWxmICVsZiAlbGZcblxuIiwgdmFsdWVfeWJbYVswXV0sIHZhbHVlX3liW2FbMV1dLCB2YWx1ZV95YlthWzJdXSwgdmFsdWVfeWJbYVszXV0sIHZhbHVlX3liW2FbNF1dKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICBwcmludGYoIiUuMmxmIiwgbW9zdF9tayA+IG1vc3Rfb25lID8gbW9zdF9tayA6IG1vc3Rfb25lKTsKCn0KCmludCBtYWluKCkgewogICAgbCgpOwp9Cg=="}]