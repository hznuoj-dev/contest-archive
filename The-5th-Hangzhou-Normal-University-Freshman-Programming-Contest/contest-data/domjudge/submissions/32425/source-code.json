[{"id":"32425","submission_id":"32425","filename":"main.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+DQoNCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQoNCnR5cGVkZWYgbG9uZyBsb25nIGxsOw0KdHlwZWRlZiBsb25nIGRvdWJsZSBsZDsNCg0KI2RlZmluZSBkbCA8PCJcbiINCiNkZWZpbmUgcHViIHB1c2hfYmFjaw0KI2RlZmluZSBwb2IgcG9wX2JhY2sNCiNkZWZpbmUgcG9mIHBvcF9mcm9udA0KI2RlZmluZSBwdWYgcHVzaF9mcm9udA0KI2RlZmluZSBlcHMgMWUtNg0KI2RlZmluZSBNQVhYIDFlNSsxDQojZGVmaW5lIElPUyBpb3M6OnN5bmNfd2l0aF9zdGRpbyhmYWxzZSksIGNpbi50aWUoMCksIGNvdXQudGllKDApDQoNCi8vY29uc3QgbGwgSU5GID0gMHgzZjNmM2YzZjNmM2YzZjNmOw0KY29uc3QgaW50IGluZiA9IDB4M2YzZjNmM2YsIG1vZCA9IDEwMDAwMDAwMDcsIHJnZTEgPSAxMDAwMTAwLCByZ2UyID0gMTAwMDE7DQoNCi8vbGwgc1syMDAwMDFdID0geyAwIH07DQoNCi8qDQpkb3VibGUgbSA9IDAsIGsgPSAwOw0KZG91YmxlIGQgPSAwOw0KDQpzdHJ1Y3QgR09PRCB7DQogICAgZG91YmxlIHA7Ly9wcmljZQ0KICAgIGRvdWJsZSBjOy8vY29tbWVudA0KICAgIGRvdWJsZSByOy8vcmF0ZQ0KfTsNCg0KR09PRCBnWzVdOw0KDQpib29sIG1jKEdPT0QgeCwgR09PRCB5KSB7DQoNCiAgICBpZiAoeC5yICE9IHkucikgew0KDQogICAgICAgIGlmICh4LnIgPiB5LnIpIHsNCiAgICAgICAgICAgIGQgKz0geC5wOw0KICAgICAgICB9DQogICAgICAgIGVsc2Ugew0KICAgICAgICAgICAgZCArPSB5LnA7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4geC5yID4geS5yOw0KICAgIH0NCiAgICBlbHNlIHsNCg0KICAgICAgICBpZiAoeC5wID49IChtIC0gZCkpIHsNCg0KICAgICAgICAgICAgaWYgKHkucCA8IChtIC0gZCkpIHsNCiAgICAgICAgICAgICAgICBkICs9IHgucDsNCiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGVsc2Ugew0KDQogICAgICAgICAgICAgICAgaWYgKHgucCA8IHkucCkgew0KICAgICAgICAgICAgICAgICAgICBkICs9IHgucDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIGQgKz0geS5wOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIHJldHVybiB4LnAgPCB5LnA7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgfQ0KICAgICAgICBlbHNlIHsNCg0KICAgICAgICAgICAgaWYgKHkucCA+PSAobSAtIGQpKSB7DQogICAgICAgICAgICAgICAgZCArPSB5LnA7DQogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgZWxzZSB7DQoNCiAgICAgICAgICAgICAgICBpZiAoeC5wID4geS5wKSB7DQogICAgICAgICAgICAgICAgICAgIGQgKz0geC5wOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgZCArPSB5LnA7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgcmV0dXJuIHgucCA+IHkucDsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICB9DQogICAgDQogICAgfQ0KDQp9DQoqLw0KDQovKg0KbGwgcFsyMDAwMDFdWzNdID0geyAwIH07DQpsbCBSYW5rWzIwMDAwMV0gPSB7IDAgfTsNCg0Kdm9pZCBpbml0KGxsIG4pIHsNCiAgICBmb3IgKGxsIGkgPSAxOyBpIDw9IG47ICsraSkgew0KICAgICAgICBwW2ldWzBdID0gaTsNCiAgICAgICAgcFtpXVsyXSA9IDA7DQogICAgICAgIGNpbiA+PiBwW2ldWzFdOw0KICAgICAgICBwW2ldWzFdICU9IDEwMDAwMDAwMDc7DQogICAgICAgIFJhbmtbaV0gPSAxOw0KICAgIH0NCn0NCg0KbGwgRmluZChsbCB4KSB7DQogICAgcmV0dXJuIHggPT0gcFt4XVswXSA/IHggOiAocFt4XVswXSA9IEZpbmQocFt4XVswXSkpOw0KfQ0KDQp2b2lkIG1lcmdlKCkgew0KDQogICAgbGwgdSA9IDAsIHYgPSAwOw0KICAgIGNpbiA+PiB1ID4+IHY7DQoNCiAgICBsbCB4ID0gRmluZCh1KSwgeSA9IEZpbmQodik7DQoNCiAgICBpZiAoUmFua1t4XSA8PSBSYW5rW3ldKSB7DQogICAgICAgIHBbeF1bMF0gPSB5Ow0KICAgIH0NCiAgICBlbHNlIHsNCiAgICAgICAgcFt5XVswXSA9IHg7DQogICAgfQ0KDQogICAgaWYgKFJhbmtbeF0gPT0gUmFua1t5XSAmJiB4ICE9IHkpIHsNCiAgICAgICAgUmFua1t5XSsrOw0KICAgIH0NCg0KfQ0KDQp2b2lkIHVwKGxsIG4pIHsNCg0KICAgIGxsIHUgPSAwLCB2ID0gMDsNCiAgICBjaW4gPj4gdSA+PiB2Ow0KDQogICAgbGwgZGFkID0gRmluZCh1KTsNCg0KICAgIGZvciAobGwgaSA9IDE7IGkgPD0gbjsgaSsrKSB7DQogICAgICAgIGlmIChkYWQgPT0gRmluZChpKSkgew0KICAgICAgICAgICAgcFtpXVsxXSArPSB2Ow0KICAgICAgICB9DQogICAgfQ0KDQp9DQoNCmxsIHN1bVsyMDAwMDFdID0geyAwIH07DQoNCnZvaWQgZXZlcnlldmUobGwgbikgew0KDQogICAgZm9yIChsbCBpID0gMTsgaSA8PSBuOyBpKyspIHsNCiAgICAgICAgc3VtW2ldID0gMDsNCiAgICB9DQoNCiAgICBmb3IgKGxsIGkgPSAxOyBpIDw9IG47IGkrKykgew0KICAgICAgICANCiAgICAgICAgbGwgZGFkID0gRmluZChpKTsNCiAgICAgICAgc3VtW2RhZF0gKz0gcFtpXVsxXTsNCiAgICAgICAgc3VtW2RhZF0gJT0gMTAwMDAwMDAwNzsNCg0KICAgIH0NCg0KICAgIGZvciAobGwgaSA9IDE7IGkgPD0gbjsgaSsrKSB7DQoNCiAgICAgICAgbGwgZGFkID0gRmluZChpKTsNCg0KICAgICAgICBwW2ldWzJdICs9IHN1bVtkYWRdOw0KICAgICAgICBwW2ldWzJdICU9IDEwMDAwMDAwMDc7DQoNCiAgICB9DQoNCn0NCg0Kdm9pZCBhc2soKSB7DQogICAgbGwgdSA9IDA7DQogICAgY2luID4+IHU7DQogICAgY291dCA8PCBwW3VdWzJdIGRsOw0KfSovDQoNCmxsIGFbMjAwMDAxXSA9IHsgMCB9Ow0KbGwgYlsyMDAwMDFdID0geyAwIH07DQoNCnZvaWQgTG9saXRhU2FtYSgpIHsNCg0KICAgIGxsIG4gPSAwOw0KICAgIGNpbiA+PiBuOw0KDQogICAgaWYgKG4gJSAyICE9IDApIHsNCiAgICAgICAgY291dCA8PCAiMCIgZGw7DQogICAgICAgIHJldHVybjsNCiAgICB9DQoNCiAgICBmb3IgKGludCBpID0gMDsgaSA8IG47IGkrKykgew0KICAgICAgICBjaW4gPj4gYVtpXTsNCiAgICAgICAgYltpXSA9IGFbaV07DQogICAgfQ0KDQogICAgc29ydChiLCBiICsgbik7DQoNCiAgICBpbnQgY250ID0gMDsNCg0KICAgIGZvciAoaW50IGkgPSBiW24gLyAyIC0gMV07IGkgPD0gYltuIC8gMl07IGkrKykgew0KDQogICAgICAgIGludCBvcCA9IDA7DQogICAgICAgIGJvb2wgZiA9IGZhbHNlOw0KDQogICAgICAgIGZvciAoaW50IGogPSAwOyBqIDwgbjsgaisrKSB7DQogICAgICAgICAgICBpZiAoYVtqXSA8IGkpIHsgDQogICAgICAgICAgICAgICAgb3AtLTsNCiAgICAgICAgICAgICAgICBmID0gdHJ1ZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGVsc2UgaWYgKGFbal0gPiBpKSB7DQogICAgICAgICAgICAgICAgb3ArKzsNCiAgICAgICAgICAgICAgICBmID0gdHJ1ZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmIChvcCA+IDApIHsNCiAgICAgICAgICAgICAgICBvcCA9IC0xOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKG9wID09IDAgJiYgZiA9PSB0cnVlKSB7DQogICAgICAgICAgICBjbnQrKzsNCiAgICAgICAgfQ0KDQogICAgfQ0KDQogICAgY291dCA8PCBjbnQgZGw7DQoNCg0KDQogICAgLyoNCiAgICBsbCBuID0gMCwgcSA9IDA7DQogICAgY2luID4+IG4gPj4gcTsNCg0KICAgIGluaXQobik7DQoNCiAgICBpbnQgb3AgPSAwOw0KDQogICAgd2hpbGUgKHEtLSkgew0KDQogICAgICAgIGV2ZXJ5ZXZlKG4pOw0KDQogICAgICAgIGNpbiA+PiBvcDsNCiAgICAgICAgc3dpdGNoIChvcCkgew0KICAgICAgICBjYXNlIDE6DQogICAgICAgICAgICBtZXJnZSgpOw0KICAgICAgICAgICAgLy9ldmVyeWV2ZShuKTsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICBjYXNlIDI6DQogICAgICAgICAgICB1cChuKTsNCiAgICAgICAgICAgIC8vZXZlcnlldmUobik7DQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgY2FzZSAzOg0KICAgICAgICAgICAgYXNrKCk7DQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vZXZlcnlldmUobik7DQogICAgfQ0KICAgICovDQoNCiAgICAvKg0KICAgIEwNCg0KICAgIGxsIG4gPSAwLCBrID0gMDsNCiAgICBjaW4gPj4gbiA+PiBrOw0KDQogICAgbGwgYyA9IDA7DQoNCiAgICBmb3IgKGxsIGkgPSAxOyBpIDw9IG47IGkrKykgew0KICAgICAgICBjaW4gPj4gc1tpXTsNCiAgICAgICAgaWYgKHNbaV0gPT0gaSkgYysrOw0KICAgIH0NCg0KICAgIGlmIChuID09IGsgKyAxKSB7DQogICAgICAgIGNvdXQgPDwgIi0xIiBkbDsNCiAgICB9DQogICAgZWxzZSB7DQogICAgICAgIGNvdXQgPDwgKGMgKyAxIC0gaykgLyAyIGRsOw0KICAgIH0NCiAgICAqLw0KDQogICAgLyoNCiAgICBjaW4gPj4gbSA+PiBrOw0KDQogICAgZm9yIChpbnQgaSA9IDA7IGkgPCA1OyBpKyspIHsNCiAgICAgICAgY2luID4+IGdbaV0ucDsNCiAgICB9DQogICAgZm9yIChpbnQgaSA9IDA7IGkgPCA1OyBpKyspIHsNCiAgICAgICAgY2luID4+IGdbaV0uYzsNCiAgICAgICAgZ1tpXS5yID0gZ1tpXS5jIC8gZ1tpXS5wOw0KICAgIH0NCg0KICAgIHNvcnQoZywgZyArIDUsIG1jKTsNCg0KICAgIGRvdWJsZSBzdW1wID0gMDsNCiAgICBkb3VibGUgc3VtYyA9IDA7DQogICAgZG91YmxlIHJlbSA9IGdbMF0ucjsNCg0KICAgIGZvciAoaW50IGkgPSAwOyBpIDwgNTtpKyspIHsNCg0KICAgICAgICBzdW1wICs9IGdbaV0ucDsNCiAgICAgICAgc3VtYyArPSBnW2ldLmM7DQogICAgICAgIGlmIChzdW1wID49IG0pIHsNCiAgICAgICAgICAgIGNvdXQgPDwgZml4ZWQgPDwgc2V0cHJlY2lzaW9uKDIpIDw8IG1heCgoc3VtYykgLyAoc3VtcCAtIGspLCByZW0pIGRsOw0KICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICB9DQoNCiAgICB9DQoNCiAgICBjb3V0IDw8IGZpeGVkIDw8IHNldHByZWNpc2lvbigyKSA8PCByZW0gZGw7DQogICAgKi8NCg0KICAgIC8qDQogICAgbGwgbiA9IDA7DQogICAgY2luID4+IG47DQoNCiAgICBpZiAobiAlIDIgIT0gMCkgew0KICAgICAgICBjb3V0IDw8ICIwIiBkbDsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCg0KICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbjsgaSsrKSB7DQogICAgICAgIGNpbiA+PiBhW2ldOw0KICAgIH0NCg0KICAgIGludCBjbnQgPSAwOw0KDQogICAgZm9yIChpbnQgaSA9IGFbMF07IGkgPD0gYVtuIC0gMV07IGkrKykgew0KDQogICAgICAgIGludCBvcCA9IDA7DQoNCiAgICAgICAgZm9yIChpbnQgaiA9IDA7IGogPCBuOyBqKyspIHsNCiAgICAgICAgICAgIGlmIChhW2pdIDwgaSkgb3AtLTsNCiAgICAgICAgICAgIGVsc2UgaWYgKGFbal0gPiBpKSBvcCsrOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKG9wID09IDApIHsNCiAgICAgICAgICAgIGNudCsrOw0KICAgICAgICB9DQoNCiAgICB9DQoNCiAgICBjb3V0IDw8IGNudCBkbDsNCiAgICAqLw0KDQp9DQoNCmludCBtYWluKCkgew0KDQogICAgLy9JT1M7DQoNCiAgICBpbnQgVCA9IDE7DQogICAgLy9jaW4gPj4gVDsNCg0KDQogICAgd2hpbGUgKFQtLSkgew0KDQogICAgICAgIExvbGl0YVNhbWEoKTsNCg0KICAgIH0NCg0KfQ0K"}]