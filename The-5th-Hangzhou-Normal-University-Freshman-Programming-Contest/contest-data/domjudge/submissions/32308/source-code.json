[{"id":"32308","submission_id":"32308","filename":"main.cpp","source":"LyoKI2luY2x1ZGUgPGlvc3RyZWFtPgojaW5jbHVkZSA8Yml0cy9zdGRjKysuaD4KdXNpbmcgbmFtZXNwYWNlIHN0ZDsKY29uc3QgaW50IE49MmU1KzEwOwpjb25zdCBpbnQgbW9kPTFlOSs3Owpsb25nIGxvbmcgYVtOXSxmYVtOXTsKaW50IHBbTl0sY250W05dOwppbnQgZmluZChpbnQgeCkKewogICAgaWYocFt4XSE9eCkKICAgIHsKICAgICAgICBwW3hdPSBmaW5kKHBbeF0pOwogICAgfQogICAgcmV0dXJuIHBbeF07Cn0KaW50IG1haW4oKXsKICAgIGlvczo6c3luY193aXRoX3N0ZGlvKGZhbHNlKTsKICAgIGNpbi50aWUoMCk7CiAgICBjb3V0LnRpZSgwKTsKICAgIGludCBuLHE7CiAgICBjaW4gPj4gbiA+PiBxOwogICAgZm9yIChpbnQgaT0xO2k8PW47aSsrKQogICAgewogICAgICAgIGNpbiA+PiBhW2ldOwogICAgICAgIHBbaV09aTsKICAgICAgICBmYVtpXT1hW2ldOwogICAgICAgIGNudFtpXT0xOwogICAgfQogICAgd2hpbGUgKHEtLSkKICAgIHsKICAgICAgICBpbnQgbnVtOwogICAgICAgIGNpbiA+PiBudW07CiAgICAgICAgaWYobnVtPT0xKQogICAgICAgIHsKICAgICAgICAgICAgaW50IGEsYjsKICAgICAgICAgICAgY2luID4+IGEgPj4gYjsKICAgICAgICAgICAgYT0gZmluZChhKTsKICAgICAgICAgICAgYj0gZmluZChiKTsKICAgICAgICAgICAgcFthXT1iOwogICAgICAgICAgICBmYVtiXSs9ZmFbYV07CiAgICAgICAgICAgIGNudFtiXSs9Y250W2FdOwogICAgICAgIH1lbHNlIGlmKG51bT09MikKICAgICAgICB7CiAgICAgICAgICAgIGludCBhLGI7CiAgICAgICAgICAgIGNpbiA+PiBhID4+IGI7CiAgICAgICAgICAgIGE9IGZpbmQoYSk7CiAgICAgICAgICAgIGZhW2FdKz1iKmNudFthXTsKICAgICAgICB9ZWxzZSB7CiAgICAgICAgICAgIGludCBiOwogICAgICAgICAgICBjaW4gPj4gYjsKICAgICAgICAgICAgY291dCA8PCBhW2JdJW1vZCA8PCBlbmRsOwogICAgICAgIH0KICAgICAgICBmb3IgKGludCBpPTE7aTw9bjtpKyspCiAgICAgICAgewogICAgICAgICAgICBpbnQgZmF0aGVyPSBmaW5kKGkpOwogICAgICAgICAgICBhW2ldKz1mYVtmYXRoZXJdOwogICAgICAgIH0KICAgIH0KfQoqLwoKI2luY2x1ZGUgPGlvc3RyZWFtPgojaW5jbHVkZSA8Yml0cy9zdGRjKysuaD4KdXNpbmcgbmFtZXNwYWNlIHN0ZDsKY29uc3QgaW50IE49MmU1KzEwOwppbnQgYVtOXTsKaW50IG1haW4oKXsKICAgIGlvczo6c3luY193aXRoX3N0ZGlvKGZhbHNlKTsKICAgIGNpbi50aWUoMCk7CiAgICBjb3V0LnRpZSgwKTsKICAgIGludCBuOwogICAgY2luID4+IG47CiAgICBpbnQgbWluX251bT0xMDAwMDAwLG1heF9udW09LTE7CiAgICBmb3IgKGludCBpPTE7aTw9bjtpKyspCiAgICB7CiAgICAgICAgY2luID4+IGFbaV07CiAgICAgICAgbWluX251bT0gbWluKG1pbl9udW0sYVtpXSk7CiAgICAgICAgbWF4X251bT0gbWF4KG1heF9udW0sYVtpXSk7CiAgICB9CiAgICAgICAgaW50IGFucz0wOwogICAgICAgIGZvciAoaW50IGk9bWluX251bTtpPD1tYXhfbnVtO2krKykKICAgICAgICB7CiAgICAgICAgICAgIHN0YWNrPGludD4gc3Q7CiAgICAgICAgICAgIGJvb2wgc3VjY2Vzc2Z1bD0gdHJ1ZTsKICAgICAgICAgICAgZm9yIChpbnQgaj0xO2o8PW47aisrKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBpZihhW2pdPmkpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgLy8gKQogICAgICAgICAgICAgICAgICAgIGlmKHN0LmVtcHR5KCkpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzZnVsPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlewogICAgICAgICAgICAgICAgICAgICAgICBzdC5wb3AoKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9ZWxzZSBpZihhW2pdPGkpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgLy8gKAogICAgICAgICAgICAgICAgICAgIHN0LnB1c2goMSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYoIXN0LmVtcHR5KCkpIHN1Y2Nlc3NmdWw9IGZhbHNlOwogICAgICAgICAgICBpZihzdWNjZXNzZnVsKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBhbnMrKzsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBjb3V0IDw8IGFuczsKICAgIHJldHVybiAwOwp9CgovKgojaW5jbHVkZSA8aW9zdHJlYW0+CiNpbmNsdWRlIDxiaXRzL3N0ZGMrKy5oPgp1c2luZyBuYW1lc3BhY2Ugc3RkOwpjb25zdCBpbnQgTj0yZTUrMTA7CmxvbmcgbG9uZyBpbnQgYVtOXTsKbG9uZyBsb25nIGludCBub3dbTl07CmludCBtYWluKCl7CiAgICBpb3M6OnN5bmNfd2l0aF9zdGRpbyhmYWxzZSk7CiAgICBjaW4udGllKDApOwogICAgY291dC50aWUoMCk7CgogICAgcmV0dXJuIDA7Cn0KKi8K"}]