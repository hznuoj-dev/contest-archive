[{"id":"31982","submission_id":"31982","filename":"main.cpp","source":"CiNpbmNsdWRlIDxpb3N0cmVhbT4KI2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+CnVzaW5nIG5hbWVzcGFjZSBzdGQ7CmNvbnN0IGludCBOPTJlNSsxMDsKbG9uZyBsb25nIGludCBhW05dLGJbTl0sZGVbTl0sZGUxW05dLGExW05dLGIxW05dOwppbnQgbWFpbigpIHsKICAgIGlvczo6c3luY193aXRoX3N0ZGlvKGZhbHNlKTsKICAgIGNpbi50aWUoMCk7CiAgICBjb3V0LnRpZSgwKTsKICAgIGludCBuOwogICAgY2luID4+IG47CiAgICBpbnQgaGFzX2RpZmZlcmVudD0wOwogICAgZm9yIChpbnQgaT0wO2k8bjtpKyspIGNpbiA+PiBhW2ldLGExW2ldPWFbaV0sYVtpXT0tYVtpXTsKICAgIGZvciAoaW50IGk9MDtpPG47aSsrKQogICAgewogICAgICAgIGNpbiA+PiBiW2ldOwogICAgICAgIGIxW2ldPWJbaV07CiAgICAgICAgYltpXT0tYltpXTsKICAgIH0KICAgIGludCBhbnM9MDsKICAgIHNvcnQoYTEsYTErbik7CiAgICBzb3J0KGIxLGIxK24pOwogICAgc29ydChiLGIrbik7CiAgICBzb3J0KGEsYStuKTsKICAgIGJvb2wgc3QxPSB0cnVlLHN0PSB0cnVlOwogICAgZm9yIChpbnQgaT0wO2k8bjtpKyspCiAgICB7CiAgICAgICAgZGVbaV09YVtpXS1iW2ldOwogICAgICAgIGRlMVtpXT1hMVtpXS1iMVtpXTsKICAgICAgICBpZihpPjAgJiYgZGVbaV0hPWRlW2ktMV0pIHN0PSBmYWxzZTsKICAgICAgICBpZihpPjAgJiYgZGUxW2ldIT1kZTFbaS0xXSkgc3QxPSBmYWxzZTsKICAgIH0KICAgIGlmKHN0ICYmIHN0MSkKICAgIHsKICAgICAgICBhbnM9IG1pbihhYnMoZGVbMF0pLCBhYnMoZGUxWzBdKSk7CiAgICB9ZWxzZSBpZihzdCkKICAgIHsKICAgICAgICBhbnM9IGFicyhkZVswXSk7CiAgICB9ZWxzZSBpZihzdDEpCiAgICB7CiAgICAgICAgYW5zPSBhYnMoZGUxWzBdKTsKICAgIH1lbHNlIGFucz0tMTsKICAgIGNvdXQgPDwgYW5zOwogICAgcmV0dXJuIDA7Cn0KCi8qCiNpbmNsdWRlIDxpb3N0cmVhbT4KI2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+CnVzaW5nIG5hbWVzcGFjZSBzdGQ7CmNvbnN0IGludCBOPTJlNSsxMDsKY29uc3QgaW50IG1vZD0xZTkrNzsKbG9uZyBsb25nIGFbTl0sZmFbTl07CmludCBwW05dLGNudFtOXTsKaW50IGZpbmQoaW50IHgpCnsKICAgIGlmKHBbeF0hPXgpCiAgICB7CiAgICAgICAgcFt4XT0gZmluZChwW3hdKTsKICAgIH0KICAgIHJldHVybiBwW3hdOwp9CmludCBtYWluKCl7CiAgICBpb3M6OnN5bmNfd2l0aF9zdGRpbyhmYWxzZSk7CiAgICBjaW4udGllKDApOwogICAgY291dC50aWUoMCk7CiAgICBpbnQgbixxOwogICAgY2luID4+IG4gPj4gcTsKICAgIGZvciAoaW50IGk9MTtpPD1uO2krKykKICAgIHsKICAgICAgICBjaW4gPj4gYVtpXTsKICAgICAgICBwW2ldPWk7CiAgICAgICAgZmFbaV09YVtpXTsKICAgICAgICBjbnRbaV09MTsKICAgIH0KICAgIHdoaWxlIChxLS0pCiAgICB7CiAgICAgICAgaW50IG51bTsKICAgICAgICBjaW4gPj4gbnVtOwogICAgICAgIGlmKG51bT09MSkKICAgICAgICB7CiAgICAgICAgICAgIGludCBhLGI7CiAgICAgICAgICAgIGNpbiA+PiBhID4+IGI7CiAgICAgICAgICAgIGE9IGZpbmQoYSk7CiAgICAgICAgICAgIGI9IGZpbmQoYik7CiAgICAgICAgICAgIHBbYV09YjsKICAgICAgICAgICAgZmFbYl0rPWZhW2FdOwogICAgICAgICAgICBjbnRbYl0rPWNudFthXTsKICAgICAgICB9ZWxzZSBpZihudW09PTIpCiAgICAgICAgewogICAgICAgICAgICBpbnQgYSxiOwogICAgICAgICAgICBjaW4gPj4gYSA+PiBiOwogICAgICAgICAgICBhPSBmaW5kKGEpOwogICAgICAgICAgICBmYVthXSs9YipjbnRbYV07CiAgICAgICAgfWVsc2UgewogICAgICAgICAgICBpbnQgYjsKICAgICAgICAgICAgY2luID4+IGI7CiAgICAgICAgICAgIGNvdXQgPDwgYVtiXSVtb2QgPDwgZW5kbDsKICAgICAgICB9CiAgICAgICAgZm9yIChpbnQgaT0xO2k8PW47aSsrKQogICAgICAgIHsKICAgICAgICAgICAgaW50IGZhdGhlcj0gZmluZChpKTsKICAgICAgICAgICAgYVtpXSs9ZmFbZmF0aGVyXTsKICAgICAgICB9CiAgICB9Cn0KKi8KLyoKI2luY2x1ZGUgPGlvc3RyZWFtPgojaW5jbHVkZSA8Yml0cy9zdGRjKysuaD4KdXNpbmcgbmFtZXNwYWNlIHN0ZDsKY29uc3QgaW50IE49MmU1KzEwOwppbnQgYVtOXTsKaW50IG1haW4oKXsKICAgIGlvczo6c3luY193aXRoX3N0ZGlvKGZhbHNlKTsKICAgIGNpbi50aWUoMCk7CiAgICBjb3V0LnRpZSgwKTsKICAgIGludCBuOwogICAgY2luID4+IG47CiAgICBpbnQgbWluX251bT0xMDAwMDAwLG1heF9udW09LTE7CiAgICBmb3IgKGludCBpPTE7aTw9bjtpKyspCiAgICB7CiAgICAgICAgY2luID4+IGFbaV07CiAgICAgICAgbWluX251bT0gbWluKG1pbl9udW0sYVtpXSk7CiAgICAgICAgbWF4X251bT0gbWF4KG1heF9udW0sYVtpXSk7CiAgICB9CiAgICAgICAgaW50IGFucz0wOwogICAgICAgIGZvciAoaW50IGk9bWluX251bTtpPD1tYXhfbnVtO2krKykKICAgICAgICB7CiAgICAgICAgICAgIHN0YWNrPGludD4gc3Q7CiAgICAgICAgICAgIGJvb2wgc3VjY2Vzc2Z1bD0gdHJ1ZTsKICAgICAgICAgICAgZm9yIChpbnQgaj0xO2o8PW47aisrKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBpZihhW2pdPmkpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgLy8gKQogICAgICAgICAgICAgICAgICAgIGlmKHN0LmVtcHR5KCkpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzZnVsPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICAgICAgZ290byBhMTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2V7CiAgICAgICAgICAgICAgICAgICAgICAgIHN0LnBvcCgpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH1lbHNlIGlmKGFbal08aSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAvLyAoCiAgICAgICAgICAgICAgICAgICAgc3QucHVzaCgxKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBhMToKICAgICAgICAgICAgaWYoIXN0LmVtcHR5KCkpIHN1Y2Nlc3NmdWw9IGZhbHNlOwogICAgICAgICAgICBpZihzdWNjZXNzZnVsKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBhbnMrKzsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBjb3V0IDw8IGFuczsKICAgIHJldHVybiAwOwp9Ciov"}]