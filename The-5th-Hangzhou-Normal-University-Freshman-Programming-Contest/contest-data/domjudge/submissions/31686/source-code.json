[{"id":"31686","submission_id":"31686","filename":"3.cpp","source":"I2luY2x1ZGUgPGlvc3RyZWFtPg0KI2luY2x1ZGUgPGFsZ29yaXRobT4NCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQoNCmludCBtYWluKCkNCnsNCiAgICBkb3VibGUgYVs1XSwgYls1XTsNCiAgICBpbnQgbSwgazE7DQogICAgZG91YmxlIG1jID0gMDsNCiAgICBkb3VibGUgYyA9IDA7DQogICAgZG91YmxlIHNhID0gMDsNCiAgICBkb3VibGUgc2IgPSAwOw0KICAgIGNpbiA+PiBtID4+IGsxOw0KICAgIGZvciAoaW50IGkgPSAwOyBpIDwgNTsgaSsrKQ0KICAgIHsNCiAgICAgICAgY2luID4+IGFbaV07DQogICAgfQ0KICAgIGZvciAoaW50IGkgPSAwOyBpIDwgNTsgaSsrKQ0KICAgIHsNCiAgICAgICAgY2luID4+IGJbaV07DQogICAgfQ0KICAgIGZvciAoaW50IGkgPSAwOyBpIDwgNTsgaSsrKQ0KICAgIHsNCiAgICAgICAgaWYgKGFbaV0gPj0gbSkNCiAgICAgICAgew0KICAgICAgICAgICAgYyA9IGJbaV0gLyAoYVtpXSAtIGsxKTsNCiAgICAgICAgfQ0KICAgICAgICBlbHNlDQogICAgICAgIHsNCiAgICAgICAgICAgIGMgPSBiW2ldIC8gYVtpXTsNCiAgICAgICAgfQ0KICAgICAgICBpZiAoYyA+IG1jKQ0KICAgICAgICB7DQogICAgICAgICAgICBtYyA9IGM7DQogICAgICAgIH0NCiAgICB9DQogICAgZm9yIChpbnQgaSA9IDA7IGkgPCA1IC0gMTsgaSsrKQ0KICAgIHsNCiAgICAgICAgZm9yIChpbnQgaiA9IGkgKyAxOyBqIDwgNTsgaisrKQ0KICAgICAgICB7DQogICAgICAgICAgICBzYSA9IGFbaV0gKyBhW2pdOw0KICAgICAgICAgICAgc2IgPSBiW2ldICsgYltqXTsNCiAgICAgICAgICAgIGlmIChzYSA+PSBtKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGMgPSBzYiAvIChzYSAtIGsxKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBjID0gc2IgLyBzYTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmIChjID4gbWMpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgbWMgPSBjOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KICAgIGZvciAoaW50IGkgPSAwOyBpIDwgNSAtIDI7IGkrKykNCiAgICB7DQogICAgICAgIGZvciAoaW50IGogPSBpICsgMTsgaiA8IDUgLSAxOyBqKyspDQogICAgICAgIHsNCiAgICAgICAgICAgIGZvciAoaW50IGsgPSBqICsgMTsgayA8IDU7IGsrKykNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBzYSA9IGFbaV0gKyBhW2pdICsgYVtrXTsNCiAgICAgICAgICAgICAgICBzYiA9IGJbaV0gKyBiW2pdICsgYltrXTsNCiAgICAgICAgICAgICAgICBpZiAoc2EgPj0gbSkNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIGMgPSBzYiAvIChzYSAtIGsxKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZWxzZQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgYyA9IHNiIC8gc2E7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGlmIChjID4gbWMpDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICBtYyA9IGM7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KICAgIGZvciAoaW50IGkgPSAwOyBpIDwgNSAtIDM7IGkrKykNCiAgICB7DQogICAgICAgIGZvciAoaW50IGogPSBpICsgMTsgaiA8IDUgLSAyOyBqKyspDQogICAgICAgIHsNCiAgICAgICAgICAgIGZvciAoaW50IGsgPSBqICsgMTsgayA8IDUgLSAxOyBrKyspDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgZm9yIChpbnQgeiA9IGsgKyAxOyB6IDwgNTsgeisrKQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgc2EgPSBhW2ldICsgYVtqXSArIGFba10gKyBhW3pdOw0KICAgICAgICAgICAgICAgICAgICBzYiA9IGJbaV0gKyBiW2pdICsgYltrXSArIGJbel07DQogICAgICAgICAgICAgICAgICAgIGlmIChzYSA+PSBtKQ0KICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICBjID0gc2IgLyAoc2EgLSBrMSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZWxzZQ0KICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICBjID0gc2IgLyBzYTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBpZiAoYyA+IG1jKQ0KICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICBtYyA9IGM7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQogICAgc2EgPSBhWzBdICsgYVsxXSArIGFbMl0gKyBhWzNdICsgYVs0XTsNCiAgICBzYiA9IGJbMF0gKyBiWzFdICsgYlsyXSArIGJbM10gKyBiWzRdOw0KICAgIGlmIChzYSA+PSBtKQ0KICAgIHsNCiAgICAgICAgYyA9IHNiIC8gKHNhIC0gazEpOw0KICAgIH0NCiAgICBlbHNlDQogICAgew0KICAgICAgICBjID0gc2IgLyBzYTsNCiAgICB9DQogICAgaWYgKGMgPiBtYykNCiAgICB7DQogICAgICAgIG1jID0gYzsNCiAgICB9DQogICAgcHJpbnRmKCIlLjJmIiwgbWMpOw0KICAgIHJldHVybiAwOw0KfQ=="}]