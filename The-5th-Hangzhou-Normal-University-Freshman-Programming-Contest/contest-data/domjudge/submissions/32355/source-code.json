[{"id":"32355","submission_id":"32355","filename":"main.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+DQoNCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQoNCnR5cGVkZWYgbG9uZyBsb25nIGxsOw0KdHlwZWRlZiBsb25nIGRvdWJsZSBsZDsNCg0KI2RlZmluZSBkbCA8PCJcbiINCiNkZWZpbmUgcHViIHB1c2hfYmFjaw0KI2RlZmluZSBwb2IgcG9wX2JhY2sNCiNkZWZpbmUgcG9mIHBvcF9mcm9udA0KI2RlZmluZSBwdWYgcHVzaF9mcm9udA0KI2RlZmluZSBlcHMgMWUtNg0KI2RlZmluZSBNQVhYIDFlNSsxDQojZGVmaW5lIElPUyBpb3M6OnN5bmNfd2l0aF9zdGRpbyhmYWxzZSksIGNpbi50aWUoMCksIGNvdXQudGllKDApDQoNCi8vY29uc3QgbGwgSU5GID0gMHgzZjNmM2YzZjNmM2YzZjNmOw0KY29uc3QgaW50IGluZiA9IDB4M2YzZjNmM2YsIG1vZCA9IDEwMDAwMDAwMDcsIHJnZTEgPSAxMDAwMTAwLCByZ2UyID0gMTAwMDE7DQoNCi8vbGwgc1syMDAwMDFdID0geyAwIH07DQoNCi8qDQpkb3VibGUgbSA9IDAsIGsgPSAwOw0KZG91YmxlIGQgPSAwOw0KDQpzdHJ1Y3QgR09PRCB7DQogICAgZG91YmxlIHA7Ly9wcmljZQ0KICAgIGRvdWJsZSBjOy8vY29tbWVudA0KICAgIGRvdWJsZSByOy8vcmF0ZQ0KfTsNCg0KR09PRCBnWzVdOw0KDQpib29sIG1jKEdPT0QgeCwgR09PRCB5KSB7DQoNCiAgICBpZiAoeC5yICE9IHkucikgew0KDQogICAgICAgIGlmICh4LnIgPiB5LnIpIHsNCiAgICAgICAgICAgIGQgKz0geC5wOw0KICAgICAgICB9DQogICAgICAgIGVsc2Ugew0KICAgICAgICAgICAgZCArPSB5LnA7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4geC5yID4geS5yOw0KICAgIH0NCiAgICBlbHNlIHsNCg0KICAgICAgICBpZiAoeC5wID49IChtIC0gZCkpIHsNCg0KICAgICAgICAgICAgaWYgKHkucCA8IChtIC0gZCkpIHsNCiAgICAgICAgICAgICAgICBkICs9IHgucDsNCiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGVsc2Ugew0KDQogICAgICAgICAgICAgICAgaWYgKHgucCA8IHkucCkgew0KICAgICAgICAgICAgICAgICAgICBkICs9IHgucDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIGQgKz0geS5wOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIHJldHVybiB4LnAgPCB5LnA7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgfQ0KICAgICAgICBlbHNlIHsNCg0KICAgICAgICAgICAgaWYgKHkucCA+PSAobSAtIGQpKSB7DQogICAgICAgICAgICAgICAgZCArPSB5LnA7DQogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgZWxzZSB7DQoNCiAgICAgICAgICAgICAgICBpZiAoeC5wID4geS5wKSB7DQogICAgICAgICAgICAgICAgICAgIGQgKz0geC5wOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgZCArPSB5LnA7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgcmV0dXJuIHgucCA+IHkucDsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICB9DQogICAgDQogICAgfQ0KDQp9DQoqLw0KDQoNCmxsIHBbMjAwMDAxXVszXSA9IHswfTsNCmxsIFJhbmtbMjAwMDAxXSA9IHsgMCB9Ow0KDQp2b2lkIGluaXQobGwgbikgew0KICAgIGZvciAobGwgaSA9IDE7IGkgPD0gbjsgKytpKSB7DQogICAgICAgIHBbaV1bMF0gPSBpOw0KICAgICAgICBwW2ldWzJdID0gMDsNCiAgICAgICAgY2luID4+IHBbaV1bMV07DQogICAgICAgIHBbaV1bMV0gJT0gMTAwMDAwMDAwNzsNCiAgICAgICAgUmFua1tpXSA9IDE7DQogICAgfQ0KfQ0KDQpsbCBGaW5kKGxsIHgpIHsNCiAgICByZXR1cm4geCA9PSBwW3hdWzBdID8geCA6IChwW3hdWzBdID0gRmluZChwW3hdWzBdKSk7DQp9DQoNCnZvaWQgbWVyZ2UoKSB7DQoNCiAgICBsbCB1ID0gMCwgdiA9IDA7DQogICAgY2luID4+IHUgPj4gdjsNCg0KICAgIGxsIHggPSBGaW5kKHUpLCB5ID0gRmluZCh2KTsNCg0KICAgIGlmIChSYW5rW3hdIDw9IFJhbmtbeV0pIHsNCiAgICAgICAgcFt4XVswXSA9IHk7DQogICAgfQ0KICAgIGVsc2Ugew0KICAgICAgICBwW3ldWzBdID0geDsNCiAgICB9DQoNCiAgICBpZiAoUmFua1t4XSA9PSBSYW5rW3ldICYmIHggIT0geSkgew0KICAgICAgICBSYW5rW3ldKys7DQogICAgfQ0KDQp9DQoNCnZvaWQgdXAobGwgbikgew0KDQogICAgbGwgdSA9IDAsIHYgPSAwOw0KICAgIGNpbiA+PiB1ID4+IHY7DQoNCiAgICBmb3IgKGxsIGkgPSAxOyBpIDw9IG47IGkrKykgew0KICAgICAgICBpZiAoRmluZCh1KSA9PSBGaW5kKGkpKSB7DQogICAgICAgICAgICBwW2ldWzFdICs9IHY7DQogICAgICAgIH0NCiAgICB9DQoNCn0NCg0KbGwgc3VtWzIwMDAwMV0gPSB7IDAgfTsNCg0Kdm9pZCBldmVyeWV2ZShsbCBuKSB7DQoNCiAgICBmb3IgKGxsIGkgPSAwOyBpIDwgMjAwMDAxOyBpKyspIHsNCiAgICAgICAgc3VtW2ldID0gMDsNCiAgICB9DQoNCiAgICBmb3IgKGxsIGkgPSAxOyBpIDw9IG47IGkrKykgew0KICAgICAgICANCiAgICAgICAgbGwgZGFkID0gRmluZChpKTsNCiAgICAgICAgc3VtW2RhZF0gKz0gcFtpXVsxXTsNCiAgICAgICAgc3VtW2RhZF0gJT0gMTAwMDAwMDAwNzsNCg0KICAgIH0NCg0KICAgIGZvciAobGwgaSA9IDE7IGkgPD0gbjsgaSsrKSB7DQoNCiAgICAgICAgbGwgZGFkID0gRmluZChpKTsNCg0KICAgICAgICBwW2ldWzJdICs9IHN1bVtkYWRdOw0KICAgICAgICBwW2ldWzJdICU9IDEwMDAwMDAwMDc7DQoNCiAgICB9DQoNCn0NCg0Kdm9pZCBhc2soKSB7DQogICAgbGwgdSA9IDA7DQogICAgY2luID4+IHU7DQogICAgcFt1XVsyXSAlPSAxMDAwMDAwMDA3Ow0KICAgIGNvdXQgPDwgcFt1XVsyXSBkbDsNCn0NCg0Kdm9pZCBMb2xpdGFTYW1hKCkgew0KDQogICAgbGwgbiA9IDAsIHEgPSAwOw0KICAgIGNpbiA+PiBuID4+IHE7DQoNCiAgICBpbml0KG4pOw0KDQogICAgaW50IG9wID0gMDsNCg0KICAgIHdoaWxlIChxLS0pIHsNCg0KICAgICAgICBldmVyeWV2ZShuKTsNCg0KICAgICAgICBjaW4gPj4gb3A7DQogICAgICAgIHN3aXRjaCAob3ApIHsNCiAgICAgICAgY2FzZSAxOg0KICAgICAgICAgICAgbWVyZ2UoKTsNCiAgICAgICAgICAgIC8vZXZlcnlldmUobik7DQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgY2FzZSAyOg0KICAgICAgICAgICAgdXAobik7DQogICAgICAgICAgICAvL2V2ZXJ5ZXZlKG4pOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgMzoNCiAgICAgICAgICAgIGFzaygpOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIH0NCg0KICAgICAgICAvL2V2ZXJ5ZXZlKG4pOw0KICAgIH0NCg0KICAgIC8qDQogICAgTA0KDQogICAgbGwgbiA9IDAsIGsgPSAwOw0KICAgIGNpbiA+PiBuID4+IGs7DQoNCiAgICBsbCBjID0gMDsNCg0KICAgIGZvciAobGwgaSA9IDE7IGkgPD0gbjsgaSsrKSB7DQogICAgICAgIGNpbiA+PiBzW2ldOw0KICAgICAgICBpZiAoc1tpXSA9PSBpKSBjKys7DQogICAgfQ0KDQogICAgaWYgKG4gPT0gayArIDEpIHsNCiAgICAgICAgY291dCA8PCAiLTEiIGRsOw0KICAgIH0NCiAgICBlbHNlIHsNCiAgICAgICAgY291dCA8PCAoYyArIDEgLSBrKSAvIDIgZGw7DQogICAgfQ0KICAgICovDQoNCiAgICAvKg0KICAgIGNpbiA+PiBtID4+IGs7DQoNCiAgICBmb3IgKGludCBpID0gMDsgaSA8IDU7IGkrKykgew0KICAgICAgICBjaW4gPj4gZ1tpXS5wOw0KICAgIH0NCiAgICBmb3IgKGludCBpID0gMDsgaSA8IDU7IGkrKykgew0KICAgICAgICBjaW4gPj4gZ1tpXS5jOw0KICAgICAgICBnW2ldLnIgPSBnW2ldLmMgLyBnW2ldLnA7DQogICAgfQ0KDQogICAgc29ydChnLCBnICsgNSwgbWMpOw0KDQogICAgZG91YmxlIHN1bXAgPSAwOw0KICAgIGRvdWJsZSBzdW1jID0gMDsNCiAgICBkb3VibGUgcmVtID0gZ1swXS5yOw0KDQogICAgZm9yIChpbnQgaSA9IDA7IGkgPCA1O2krKykgew0KDQogICAgICAgIHN1bXAgKz0gZ1tpXS5wOw0KICAgICAgICBzdW1jICs9IGdbaV0uYzsNCiAgICAgICAgaWYgKHN1bXAgPj0gbSkgew0KICAgICAgICAgICAgY291dCA8PCBmaXhlZCA8PCBzZXRwcmVjaXNpb24oMikgPDwgbWF4KChzdW1jKSAvIChzdW1wIC0gayksIHJlbSkgZGw7DQogICAgICAgICAgICByZXR1cm47DQogICAgICAgIH0NCg0KICAgIH0NCg0KICAgIGNvdXQgPDwgZml4ZWQgPDwgc2V0cHJlY2lzaW9uKDIpIDw8IHJlbSBkbDsNCiAgICAqLw0KDQogICAgLyoNCiAgICBsbCBuID0gMDsNCiAgICBjaW4gPj4gbjsNCg0KICAgIGlmIChuICUgMiAhPSAwKSB7DQogICAgICAgIGNvdXQgPDwgIjAiIGRsOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KDQogICAgZm9yIChpbnQgaSA9IDA7IGkgPCBuOyBpKyspIHsNCiAgICAgICAgY2luID4+IGFbaV07DQogICAgfQ0KDQogICAgaW50IGNudCA9IDA7DQoNCiAgICBmb3IgKGludCBpID0gYVswXTsgaSA8PSBhW24gLSAxXTsgaSsrKSB7DQoNCiAgICAgICAgaW50IG9wID0gMDsNCg0KICAgICAgICBmb3IgKGludCBqID0gMDsgaiA8IG47IGorKykgew0KICAgICAgICAgICAgaWYgKGFbal0gPCBpKSBvcC0tOw0KICAgICAgICAgICAgZWxzZSBpZiAoYVtqXSA+IGkpIG9wKys7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAob3AgPT0gMCkgew0KICAgICAgICAgICAgY250Kys7DQogICAgICAgIH0NCg0KICAgIH0NCg0KICAgIGNvdXQgPDwgY250IGRsOw0KICAgICovDQoNCn0NCg0KaW50IG1haW4oKSB7DQoNCiAgICAvL0lPUzsNCg0KICAgIGludCBUID0gMTsNCiAgICAvL2NpbiA+PiBUOw0KDQoNCiAgICB3aGlsZSAoVC0tKSB7DQoNCiAgICAgICAgTG9saXRhU2FtYSgpOw0KDQogICAgfQ0KDQp9DQo="}]