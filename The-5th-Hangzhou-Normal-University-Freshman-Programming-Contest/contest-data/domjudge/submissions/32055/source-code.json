[{"id":"32055","submission_id":"32055","filename":"main.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+DQoNCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQoNCnR5cGVkZWYgbG9uZyBsb25nIGxsOw0KdHlwZWRlZiBsb25nIGRvdWJsZSBsZDsNCg0KI2RlZmluZSBkbCA8PCJcbiINCiNkZWZpbmUgcHViIHB1c2hfYmFjaw0KI2RlZmluZSBwb2IgcG9wX2JhY2sNCiNkZWZpbmUgcG9mIHBvcF9mcm9udA0KI2RlZmluZSBwdWYgcHVzaF9mcm9udA0KI2RlZmluZSBlcHMgMWUtNg0KI2RlZmluZSBNQVhYIDFlNSsxDQojZGVmaW5lIElPUyBpb3M6OnN5bmNfd2l0aF9zdGRpbyhmYWxzZSksIGNpbi50aWUoMCksIGNvdXQudGllKDApDQoNCi8vY29uc3QgbGwgSU5GID0gMHgzZjNmM2YzZjNmM2YzZjNmOw0KY29uc3QgaW50IGluZiA9IDB4M2YzZjNmM2YsIG1vZCA9IDEwMDAwMDAwMDcsIHJnZTEgPSAxMDAwMTAwLCByZ2UyID0gMTAwMDE7DQoNCi8vbGwgc1syMDAwMDFdID0geyAwIH07DQoNCi8qDQpkb3VibGUgbSA9IDAsIGsgPSAwOw0KZG91YmxlIGQgPSAwOw0KDQpzdHJ1Y3QgR09PRCB7DQogICAgZG91YmxlIHA7Ly9wcmljZQ0KICAgIGRvdWJsZSBjOy8vY29tbWVudA0KICAgIGRvdWJsZSByOy8vcmF0ZQ0KfTsNCg0KR09PRCBnWzVdOw0KDQpib29sIG1jKEdPT0QgeCwgR09PRCB5KSB7DQoNCiAgICBpZiAoeC5yICE9IHkucikgew0KDQogICAgICAgIGlmICh4LnIgPiB5LnIpIHsNCiAgICAgICAgICAgIGQgKz0geC5wOw0KICAgICAgICB9DQogICAgICAgIGVsc2Ugew0KICAgICAgICAgICAgZCArPSB5LnA7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4geC5yID4geS5yOw0KICAgIH0NCiAgICBlbHNlIHsNCg0KICAgICAgICBpZiAoeC5wID49IChtIC0gZCkpIHsNCg0KICAgICAgICAgICAgaWYgKHkucCA8IChtIC0gZCkpIHsNCiAgICAgICAgICAgICAgICBkICs9IHgucDsNCiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGVsc2Ugew0KDQogICAgICAgICAgICAgICAgaWYgKHgucCA8IHkucCkgew0KICAgICAgICAgICAgICAgICAgICBkICs9IHgucDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIGQgKz0geS5wOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIHJldHVybiB4LnAgPCB5LnA7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgfQ0KICAgICAgICBlbHNlIHsNCg0KICAgICAgICAgICAgaWYgKHkucCA+PSAobSAtIGQpKSB7DQogICAgICAgICAgICAgICAgZCArPSB5LnA7DQogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgZWxzZSB7DQoNCiAgICAgICAgICAgICAgICBpZiAoeC5wID4geS5wKSB7DQogICAgICAgICAgICAgICAgICAgIGQgKz0geC5wOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgZCArPSB5LnA7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgcmV0dXJuIHgucCA+IHkucDsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICB9DQogICAgDQogICAgfQ0KDQp9DQoqLw0KDQpkb3VibGUgcHJpY2VbNl0gPSB7IDAgfSwgY29tbWVudFs2XSA9IHsgMCB9LCByYXRlWzQwXSA9IHsgMCB9Ow0KDQp2b2lkIExvbGl0YVNhbWEoKSB7DQoNCiAgICAvKg0KICAgIEwNCg0KICAgIGxsIG4gPSAwLCBrID0gMDsNCiAgICBjaW4gPj4gbiA+PiBrOw0KDQogICAgbGwgYyA9IDA7DQoNCiAgICBmb3IgKGxsIGkgPSAxOyBpIDw9IG47IGkrKykgew0KICAgICAgICBjaW4gPj4gc1tpXTsNCiAgICAgICAgaWYgKHNbaV0gPT0gaSkgYysrOw0KICAgIH0NCg0KICAgIGlmIChuID09IGsgKyAxKSB7DQogICAgICAgIGNvdXQgPDwgIi0xIiBkbDsNCiAgICB9DQogICAgZWxzZSB7DQogICAgICAgIGNvdXQgPDwgKGMgKyAxIC0gaykgLyAyIGRsOw0KICAgIH0NCiAgICAqLw0KDQogICAgLyoNCiAgICBjaW4gPj4gbSA+PiBrOw0KDQogICAgZm9yIChpbnQgaSA9IDA7IGkgPCA1OyBpKyspIHsNCiAgICAgICAgY2luID4+IGdbaV0ucDsNCiAgICB9DQogICAgZm9yIChpbnQgaSA9IDA7IGkgPCA1OyBpKyspIHsNCiAgICAgICAgY2luID4+IGdbaV0uYzsNCiAgICAgICAgZ1tpXS5yID0gZ1tpXS5jIC8gZ1tpXS5wOw0KICAgIH0NCg0KICAgIHNvcnQoZywgZyArIDUsIG1jKTsNCg0KICAgIGRvdWJsZSBzdW1wID0gMDsNCiAgICBkb3VibGUgc3VtYyA9IDA7DQogICAgZG91YmxlIHJlbSA9IGdbMF0ucjsNCg0KICAgIGZvciAoaW50IGkgPSAwOyBpIDwgNTtpKyspIHsNCiAgICANCiAgICAgICAgc3VtcCArPSBnW2ldLnA7DQogICAgICAgIHN1bWMgKz0gZ1tpXS5jOw0KICAgICAgICBpZiAoc3VtcCA+PSBtKSB7DQogICAgICAgICAgICBjb3V0IDw8IGZpeGVkIDw8IHNldHByZWNpc2lvbigyKSA8PCBtYXgoKHN1bWMpIC8gKHN1bXAgLSBrKSwgcmVtKSBkbDsNCiAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgfQ0KDQogICAgfQ0KDQogICAgY291dCA8PCBmaXhlZCA8PCBzZXRwcmVjaXNpb24oMikgPDwgcmVtIGRsOw0KICAgICovDQoNCiAgICAvKg0KICAgIGxsIG4gPSAwOw0KICAgIGNpbiA+PiBuOw0KDQogICAgaWYgKG4gJSAyICE9IDApIHsNCiAgICAgICAgY291dCA8PCAiMCIgZGw7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgDQogICAgZm9yIChpbnQgaSA9IDA7IGkgPCBuOyBpKyspIHsNCiAgICAgICAgY2luID4+IGFbaV07DQogICAgfQ0KICAgIA0KICAgIGludCBjbnQgPSAwOw0KDQogICAgZm9yIChpbnQgaSA9IGFbMF07IGkgPD0gYVtuIC0gMV07IGkrKykgew0KICAgICAgICANCiAgICAgICAgaW50IG9wID0gMDsNCg0KICAgICAgICBmb3IgKGludCBqID0gMDsgaiA8IG47IGorKykgew0KICAgICAgICAgICAgaWYgKGFbal0gPCBpKSBvcC0tOw0KICAgICAgICAgICAgZWxzZSBpZiAoYVtqXSA+IGkpIG9wKys7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAob3AgPT0gMCkgew0KICAgICAgICAgICAgY250Kys7DQogICAgICAgIH0NCg0KICAgIH0NCg0KICAgIGNvdXQgPDwgY250IGRsOw0KICAgICovDQoNCiAgICBpbnQgbSwgazsNCiAgICBjaW4gPj4gbSA+PiBrOw0KDQogICAgZm9yIChpbnQgaSA9IDE7IGkgPD0gNTsgaSsrKSB7DQogICAgICAgIGNpbiA+PiBwcmljZVtpXTsNCiAgICB9DQoNCiAgICBmb3IgKGludCBpID0gMTsgaSA8PSA1OyBpKyspIHsNCiAgICAgICAgY2luID4+IGNvbW1lbnRbaV07DQogICAgfQ0KDQogICAgZG91YmxlIHN1bXAgPSAwLCBzdW1zID0gMDsNCg0KICAgIC8vMQ0KICAgIHN1bXAgPSBwcmljZVsxXSwgc3VtcyA9IGNvbW1lbnRbMV07DQogICAgaWYgKHN1bXAgPj0gbSkgc3VtcCAtPSBrOw0KICAgIHJhdGVbMV0gPSBzdW1zIC8gc3VtcDsNCiAgICAvLzINCiAgICBzdW1wID0gcHJpY2VbMl0sIHN1bXMgPSBjb21tZW50WzJdOw0KICAgIGlmIChzdW1wID49IG0pIHN1bXAgLT0gazsNCiAgICByYXRlWzJdID0gc3VtcyAvIHN1bXA7DQogICAgLy8zDQogICAgc3VtcCA9IHByaWNlWzNdLCBzdW1zID0gY29tbWVudFszXTsNCiAgICBpZiAoc3VtcCA+PSBtKSBzdW1wIC09IGs7DQogICAgcmF0ZVszXSA9IHN1bXMgLyBzdW1wOw0KICAgIC8vNA0KICAgIHN1bXAgPSBwcmljZVs0XSwgc3VtcyA9IGNvbW1lbnRbNF07DQogICAgaWYgKHN1bXAgPj0gbSkgc3VtcCAtPSBrOw0KICAgIHJhdGVbNF0gPSBzdW1zIC8gc3VtcDsNCiAgICAvLzUNCiAgICBzdW1wID0gcHJpY2VbNV0sIHN1bXMgPSBjb21tZW50WzVdOw0KICAgIGlmIChzdW1wID49IG0pIHN1bXAgLT0gazsNCiAgICByYXRlWzVdID0gc3VtcyAvIHN1bXA7DQoNCiAgICAvLzEgMg0KICAgIHN1bXAgPSBwcmljZVsxXSArIHByaWNlWzJdLCBzdW1zID0gY29tbWVudFsxXSArIGNvbW1lbnRbMl07DQogICAgaWYgKHN1bXAgPj0gbSkgc3VtcCAtPSBrOw0KICAgIHJhdGVbNl0gPSBzdW1zIC8gc3VtcDsNCiAgICAvLzEgMw0KICAgIHN1bXAgPSBwcmljZVsxXSArIHByaWNlWzNdLCBzdW1zID0gY29tbWVudFsxXSArIGNvbW1lbnRbM107DQogICAgaWYgKHN1bXAgPj0gbSkgc3VtcCAtPSBrOw0KICAgIHJhdGVbN10gPSBzdW1zIC8gc3VtcDsNCiAgICAvLzEgNA0KICAgIHN1bXAgPSBwcmljZVsxXSArIHByaWNlWzRdLCBzdW1zID0gY29tbWVudFsxXSArIGNvbW1lbnRbNF07DQogICAgaWYgKHN1bXAgPj0gbSkgc3VtcCAtPSBrOw0KICAgIHJhdGVbOF0gPSBzdW1zIC8gc3VtcDsNCiAgICAvLzEgNQ0KICAgIHN1bXAgPSBwcmljZVsxXSArIHByaWNlWzVdLCBzdW1zID0gY29tbWVudFsxXSArIGNvbW1lbnRbNV07DQogICAgaWYgKHN1bXAgPj0gbSkgc3VtcCAtPSBrOw0KICAgIHJhdGVbOV0gPSBzdW1zIC8gc3VtcDsNCiAgICAvLzIgMw0KICAgIHN1bXAgPSBwcmljZVsyXSArIHByaWNlWzNdLCBzdW1zID0gY29tbWVudFsyXSArIGNvbW1lbnRbM107DQogICAgaWYgKHN1bXAgPj0gbSkgc3VtcCAtPSBrOw0KICAgIHJhdGVbMTBdID0gc3VtcyAvIHN1bXA7DQogICAgLy8yIDQNCiAgICBzdW1wID0gcHJpY2VbMl0gKyBwcmljZVs0XSwgc3VtcyA9IGNvbW1lbnRbMl0gKyBjb21tZW50WzRdOw0KICAgIGlmIChzdW1wID49IG0pIHN1bXAgLT0gazsNCiAgICByYXRlWzExXSA9IHN1bXMgLyBzdW1wOw0KICAgIC8vMiA1DQogICAgc3VtcCA9IHByaWNlWzJdICsgcHJpY2VbNV0sIHN1bXMgPSBjb21tZW50WzJdICsgY29tbWVudFs1XTsNCiAgICBpZiAoc3VtcCA+PSBtKSBzdW1wIC09IGs7DQogICAgcmF0ZVsxMl0gPSBzdW1zIC8gc3VtcDsNCiAgICAvLzMgNA0KICAgIHN1bXAgPSBwcmljZVszXSArIHByaWNlWzRdLCBzdW1zID0gY29tbWVudFszXSArIGNvbW1lbnRbNF07DQogICAgaWYgKHN1bXAgPj0gbSkgc3VtcCAtPSBrOw0KICAgIHJhdGVbMTNdID0gc3VtcyAvIHN1bXA7DQogICAgLy8zIDUNCiAgICBzdW1wID0gcHJpY2VbM10gKyBwcmljZVs1XSwgc3VtcyA9IGNvbW1lbnRbM10gKyBjb21tZW50WzVdOw0KICAgIGlmIChzdW1wID49IG0pIHN1bXAgLT0gazsNCiAgICByYXRlWzE0XSA9IHN1bXMgLyBzdW1wOw0KICAgIC8vNCA1DQogICAgc3VtcCA9IHByaWNlWzRdICsgcHJpY2VbNV0sIHN1bXMgPSBjb21tZW50WzRdICsgY29tbWVudFs1XTsNCiAgICBpZiAoc3VtcCA+PSBtKSBzdW1wIC09IGs7DQogICAgcmF0ZVsxNV0gPSBzdW1zIC8gc3VtcDsNCg0KICAgIC8vMSAyIDMNCiAgICBzdW1wID0gcHJpY2VbMV0gKyBwcmljZVsyXSArIHByaWNlWzNdLCBzdW1zID0gY29tbWVudFsxXSArIGNvbW1lbnRbMl0gKyBjb21tZW50WzNdOw0KICAgIGlmIChzdW1wID49IG0pIHN1bXAgLT0gazsNCiAgICByYXRlWzE2XSA9IHN1bXMgLyBzdW1wOw0KICAgIC8vMSAyIDQNCiAgICBzdW1wID0gcHJpY2VbMV0gKyBwcmljZVsyXSArIHByaWNlWzRdLCBzdW1zID0gY29tbWVudFsxXSArIGNvbW1lbnRbMl0gKyBjb21tZW50WzRdOw0KICAgIGlmIChzdW1wID49IG0pIHN1bXAgLT0gazsNCiAgICByYXRlWzE3XSA9IHN1bXMgLyBzdW1wOw0KICAgIC8vMSAyIDUNCiAgICBzdW1wID0gcHJpY2VbMV0gKyBwcmljZVsyXSArIHByaWNlWzVdLCBzdW1zID0gY29tbWVudFsxXSArIGNvbW1lbnRbMl0gKyBjb21tZW50WzVdOw0KICAgIGlmIChzdW1wID49IG0pIHN1bXAgLT0gazsNCiAgICByYXRlWzE4XSA9IHN1bXMgLyBzdW1wOw0KICAgIC8vMSAzIDQNCiAgICBzdW1wID0gcHJpY2VbMV0gKyBwcmljZVszXSArIHByaWNlWzRdLCBzdW1zID0gY29tbWVudFsxXSArIGNvbW1lbnRbM10gKyBjb21tZW50WzRdOw0KICAgIGlmIChzdW1wID49IG0pIHN1bXAgLT0gazsNCiAgICByYXRlWzE5XSA9IHN1bXMgLyBzdW1wOw0KICAgIC8vMSAzIDUNCiAgICBzdW1wID0gcHJpY2VbMV0gKyBwcmljZVszXSArIHByaWNlWzVdLCBzdW1zID0gY29tbWVudFsxXSArIGNvbW1lbnRbM10gKyBjb21tZW50WzVdOw0KICAgIGlmIChzdW1wID49IG0pIHN1bXAgLT0gazsNCiAgICByYXRlWzIwXSA9IHN1bXMgLyBzdW1wOw0KICAgIC8vMSA0IDUNCiAgICBzdW1wID0gcHJpY2VbMV0gKyBwcmljZVs0XSArIHByaWNlWzVdLCBzdW1zID0gY29tbWVudFsxXSArIGNvbW1lbnRbNF0gKyBjb21tZW50WzVdOw0KICAgIGlmIChzdW1wID49IG0pIHN1bXAgLT0gazsNCiAgICByYXRlWzIxXSA9IHN1bXMgLyBzdW1wOw0KICAgIC8vMiAzIDQNCiAgICBzdW1wID0gcHJpY2VbMl0gKyBwcmljZVszXSArIHByaWNlWzRdLCBzdW1zID0gY29tbWVudFsyXSArIGNvbW1lbnRbM10gKyBjb21tZW50WzRdOw0KICAgIGlmIChzdW1wID49IG0pIHN1bXAgLT0gazsNCiAgICByYXRlWzIyXSA9IHN1bXMgLyBzdW1wOw0KICAgIC8vMiAzIDUNCiAgICBzdW1wID0gcHJpY2VbMl0gKyBwcmljZVszXSArIHByaWNlWzVdLCBzdW1zID0gY29tbWVudFsyXSArIGNvbW1lbnRbM10gKyBjb21tZW50WzVdOw0KICAgIGlmIChzdW1wID49IG0pIHN1bXAgLT0gazsNCiAgICByYXRlWzIzXSA9IHN1bXMgLyBzdW1wOw0KICAgIC8vMiA0IDUNCiAgICBzdW1wID0gcHJpY2VbMl0gKyBwcmljZVs0XSArIHByaWNlWzVdLCBzdW1zID0gY29tbWVudFsyXSArIGNvbW1lbnRbNF0gKyBjb21tZW50WzVdOw0KICAgIGlmIChzdW1wID49IG0pIHN1bXAgLT0gazsNCiAgICByYXRlWzI0XSA9IHN1bXMgLyBzdW1wOw0KICAgIC8vMyA0IDUNCiAgICBzdW1wID0gcHJpY2VbM10gKyBwcmljZVs0XSArIHByaWNlWzVdLCBzdW1zID0gY29tbWVudFszXSArIGNvbW1lbnRbNF0gKyBjb21tZW50WzVdOw0KICAgIGlmIChzdW1wID49IG0pIHN1bXAgLT0gazsNCiAgICByYXRlWzI1XSA9IHN1bXMgLyBzdW1wOw0KDQogICAgLy8xIDIgMyA0DQogICAgc3VtcCA9IHByaWNlWzFdICsgcHJpY2VbMl0gKyBwcmljZVszXSArIHByaWNlWzRdLCBzdW1zID0gY29tbWVudFsxXSArIGNvbW1lbnRbMl0gKyBjb21tZW50WzNdICsgY29tbWVudFs0XTsNCiAgICBpZiAoc3VtcCA+PSBtKSBzdW1wIC09IGs7DQogICAgcmF0ZVsyNl0gPSBzdW1zIC8gc3VtcDsNCiAgICAvLzEgMiAzIDUNCiAgICBzdW1wID0gcHJpY2VbMV0gKyBwcmljZVsyXSArIHByaWNlWzNdICsgcHJpY2VbNV0sIHN1bXMgPSBjb21tZW50WzFdICsgY29tbWVudFsyXSArIGNvbW1lbnRbM10gKyBjb21tZW50WzVdOw0KICAgIGlmIChzdW1wID49IG0pIHN1bXAgLT0gazsNCiAgICByYXRlWzI3XSA9IHN1bXMgLyBzdW1wOw0KICAgIC8vMSAyIDQgNQ0KICAgIHN1bXAgPSBwcmljZVsxXSArIHByaWNlWzJdICsgcHJpY2VbNF0gKyBwcmljZVs1XSwgc3VtcyA9IGNvbW1lbnRbMV0gKyBjb21tZW50WzJdICsgY29tbWVudFs0XSArIGNvbW1lbnRbNV07DQogICAgaWYgKHN1bXAgPj0gbSkgc3VtcCAtPSBrOw0KICAgIHJhdGVbMjhdID0gc3VtcyAvIHN1bXA7DQogICAgLy8xIDMgNCA1DQogICAgc3VtcCA9IHByaWNlWzFdICsgcHJpY2VbM10gKyBwcmljZVs0XSArIHByaWNlWzVdLCBzdW1zID0gY29tbWVudFsxXSArIGNvbW1lbnRbM10gKyBjb21tZW50WzRdICsgY29tbWVudFs1XTsNCiAgICBpZiAoc3VtcCA+PSBtKSBzdW1wIC09IGs7DQogICAgcmF0ZVsyOV0gPSBzdW1zIC8gc3VtcDsNCiAgICAvLzIgMyA0IDUNCiAgICBzdW1wID0gcHJpY2VbMl0gKyBwcmljZVszXSArIHByaWNlWzRdICsgcHJpY2VbNV0sIHN1bXMgPSBjb21tZW50WzJdICsgY29tbWVudFszXSArIGNvbW1lbnRbNF0gKyBjb21tZW50WzVdOw0KICAgIGlmIChzdW1wID49IG0pIHN1bXAgLT0gazsNCiAgICByYXRlWzMwXSA9IHN1bXMgLyBzdW1wOw0KDQogICAgLy8xIDIgMyA0IDUNCiAgICBzdW1wID0gcHJpY2VbMV0gKyBwcmljZVsyXSArIHByaWNlWzNdICsgcHJpY2VbNF0gKyBwcmljZVs1XSwgc3VtcyA9IGNvbW1lbnRbMV0gKyBjb21tZW50WzJdICsgY29tbWVudFszXSArIGNvbW1lbnRbNF0gKyBjb21tZW50WzVdOw0KICAgIGlmIChzdW1wID49IG0pIHN1bXAgLT0gazsNCiAgICByYXRlWzMxXSA9IHN1bXMgLyBzdW1wOw0KICAgIA0KICAgIHNvcnQocmF0ZSArIDEsIHJhdGUgKyAzMik7DQoNCiAgICBwcmludGYoIiUuMmxmXG4iLCByYXRlWzMxXSk7DQoNCn0NCg0KaW50IG1haW4oKSB7DQoNCiAgICAvL0lPUzsNCg0KICAgIGludCBUID0gMTsNCiAgICAvL2NpbiA+PiBUOw0KDQoNCiAgICB3aGlsZSAoVC0tKSB7DQoNCiAgICAgICAgTG9saXRhU2FtYSgpOw0KDQogICAgfQ0KDQp9DQo="}]