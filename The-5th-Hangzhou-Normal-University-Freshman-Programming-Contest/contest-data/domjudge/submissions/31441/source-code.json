[{"id":"31441","submission_id":"31441","filename":"j.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+DQojZGVmaW5lIGZwKGksIGEsIGIpIGZvcihpbnQgaSA9IChhKSwgZWQgPSAoYik7IGkgPD0gZWQ7ICsraSkNCiNkZWZpbmUgZmIoaSwgYSwgYikgZm9yKGludCBpID0gKGEpLCBlZCA9IChiKTsgaSA+PSBlZDsgLS1pKQ0KI2RlZmluZSBnbyh1LCBpKSBmb3IoaW50IGkgPSBoZWFkW3VdOyBpOyBpID0gZVtpXS5ueHQpDQp1c2luZyBuYW1lc3BhY2Ugc3RkOw0KdHlwZWRlZiBsb25nIGxvbmcgTEw7DQp0eXBlZGVmIHBhaXI8aW50LCBpbnQ+IHBpaTsNCmlubGluZSBpbnQgcmQoKSB7DQoJcmVnaXN0ZXIgaW50IHgoMCksIGYoMSk7IHJlZ2lzdGVyIGNoYXIgYyhnZXRjaGFyKCkpOw0KCXdoaWxlIChjIDwgJzAnIHx8ICc5JyA8IGMpIHsgaWYgKGMgPT0gJy0nKWYgPSAtMTsgYyA9IGdldGNoYXIoKTsgfQ0KCXdoaWxlICgnMCcgPD0gYyAmJiBjIDw9ICc5Jyl4ID0geCoxMCArIGMtJzAnLCBjID0gZ2V0Y2hhcigpOw0KCXJldHVybiB4KmY7DQp9DQppbmxpbmUgTEwgUkQoKSB7DQoJcmVnaXN0ZXIgTEwgeCgwKTsgcmVnaXN0ZXIgaW50IGYoMSk7IHJlZ2lzdGVyIGNoYXIgYyhnZXRjaGFyKCkpOw0KCXdoaWxlIChjIDwgJzAnIHx8ICc5JyA8IGMpIHsgaWYgKGMgPT0gJy0nKWYgPSAtMTsgYyA9IGdldGNoYXIoKTsgfQ0KCXdoaWxlICgnMCcgPD0gYyAmJiBjIDw9ICc5Jyl4ID0geCoxMCArIGMtJzAnLCBjID0gZ2V0Y2hhcigpOw0KCXJldHVybiB4KmY7DQp9DQppbmxpbmUgaW50IGludF9yYW5kKGludCBsLCBpbnQgcil7DQoJaW50IHJlcyA9IDEuMGwqcmFuZCgpL1JBTkRfTUFYKihyLWwrMSk7DQoJaWYocmVzID09IHItbCsxKXJlcyA9IHItbDsNCglyZXR1cm4gbCtyZXM7DQp9DQppbmxpbmUgTEwgTExfcmFuZChMTCBsLCBMTCByKXsNCglMTCByZXMgPSAxLjBsKnJhbmQoKS9SQU5EX01BWCooci1sKzEpOw0KCWlmKHJlcyA9PSByLWwrMSlyZXMgPSByLWw7DQoJcmV0dXJuIGwrcmVzOw0KfQ0KY29uc3QgaW50IG1heG4gPSAyMDAwMTAsIG1heG0gPSA4MDAwMTAsIG1vZCA9IDFlOSs3Ow0KaW50IG4sIG0sIEssIGZbbWF4bl0sIHRbbWF4bl0sIGRlZ1ttYXhuXTsNCnF1ZXVlPGludD4gcTsNCnN0cnVjdCBlZGdle2ludCB0bywgbnh0O31lW21heG1dOw0KaW50IGhlYWRbbWF4bl0sIGs7DQppbmxpbmUgdm9pZCBhZGQoaW50IHUsIGludCB2KXtlWysra10gPSAoZWRnZSl7diwgaGVhZFt1XX0sIGhlYWRbdV0gPSBrO30NCmlubGluZSBpbnQgZnBvdyhpbnQgYSwgaW50IGIsIGludCBhbnMgPSAxKXsNCglmb3IoOyBiOyBiID4+PSAxLCBhID0gMWxsKmEqYSVtb2QpaWYoYiYxKWFucyA9IDFsbCphbnMqYSVtb2Q7DQoJcmV0dXJuIGFuczsNCn0NCmludCBtYWluKCl7DQoJbiA9IHJkKCksIG0gPSByZCgpLCBLID0gcmQoKTsNCglmcChpLCAxLCBtKXsNCgkJaW50IHUgPSByZCgpLCB2ID0gcmQoKTsNCgkJYWRkKHUsIHYpLCArK2RlZ1t2XTsNCgl9DQoJZnAoaSwgMSwgbilpZighZGVnW2ldKXEucHVzaChpKTsNCgl3aGlsZShxLnNpemUoKSl7DQoJCWludCB1ID0gcS5mcm9udCgpOyBxLnBvcCgpOw0KCQlnbyh1LCBpKXsNCgkJCWZbZVtpXS50b10gPSBtYXgoZltlW2ldLnRvXSwgZlt1XSsxKTsNCgkJCWlmKCEoLS1kZWdbZVtpXS50b10pKXEucHVzaChlW2ldLnRvKTsNCgkJfQ0KCX0NCglmcChpLCAxLCBuKSsrdFtmW2ldXTsNCglpbnQgc3VtID0gMCwgYW5zID0gMDsNCglmYihpLCBuLCAwKWFucyA9IChhbnMgKyAxbGwqc3VtKnRbaV0pJW1vZCwgc3VtID0gKHN1bSt0W2ldKSVtb2Q7DQoJYW5zID0gZnBvdyhhbnMsIEspOw0KCXByaW50ZigiJWRcbiIsIGFucyk7DQoJcmV0dXJuIDA7DQp9DQo="}]