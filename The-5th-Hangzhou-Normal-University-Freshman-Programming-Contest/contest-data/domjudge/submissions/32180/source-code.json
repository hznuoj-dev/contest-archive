[{"id":"32180","submission_id":"32180","filename":"111.cpp","source":"I2luY2x1ZGU8aW9zdHJlYW0+DQp1c2luZyBuYW1lc3BhY2Ugc3RkOw0KaW50IG1haW4oKQ0Kew0KICAgIGludCBuOw0KICAgIGludCBudW1hID0gMCwgbnVtYiA9IDAsIG51bWMgPSAwOw0KICAgIGNpbiA+PiBuOw0KICAgIGxvbmcgbG9uZyBhWzIwMDAwMV0sIGJbMjAwMDAxXSwgY1syMDAwMDFdOw0KICAgIGZvciAoaW50IGkgPSAxOyBpIDw9IG47IGkrKykNCiAgICB7DQogICAgICAgIGNpbiA+PiBhW2ldOw0KICAgIH0NCiAgICBmb3IgKGludCBpID0gMTsgaSA8PSBuOyBpKyspDQogICAgew0KICAgICAgICBjaW4gPj4gYltpXTsNCiAgICAgICAgbG9uZyBsb25nIHggPSBiW2ldOw0KICAgICAgICBjW2ldID0gLXg7DQogICAgfQ0KICAgIGZvciAoaW50IGkgPSAxOyBpIDw9IG47IGkrKykvL+ehruWumuWwj+S6jumbtuS4quaVsA0KICAgIHsNCiAgICAgICAgaWYgKGFbaV0gPCAwKQ0KICAgICAgICAgICAgbnVtYSsrOw0KICAgICAgICBpZiAoYltpXSA8IDApDQogICAgICAgICAgICBudW1iKys7DQogICAgICAgIGlmIChjW2ldIDwgMCkNCiAgICAgICAgICAgIG51bWMrKzsNCiAgICB9DQogICAgZm9yIChpbnQgaSA9IDE7IGkgPD0gbjsgaSsrKQ0KICAgIHsNCiAgICAgICAgZm9yIChpbnQgaiA9IDE7IGogPD0gbiAtIGk7IGorKykNCiAgICAgICAgew0KICAgICAgICAgICAgaWYgKGFbal0gPiBhW2ogKyAxXSkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBsb25nIGxvbmcgdGVtcDEgPSBhW2pdOw0KICAgICAgICAgICAgICAgIGFbal0gPSBhW2ogKyAxXTsNCiAgICAgICAgICAgICAgICBhW2ogKyAxXSA9IHRlbXAxOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKGJbal0gPiBiW2ogKyAxXSkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBsb25nIGxvbmcgdGVtcDIgPSBiW2pdOw0KICAgICAgICAgICAgICAgIGJbal0gPSBiW2ogKyAxXTsNCiAgICAgICAgICAgICAgICBiW2ogKyAxXSA9IHRlbXAyOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKGNbal0gPiBjW2ogKyAxXSkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBsb25nIGxvbmcgdGVtcDMgPSBjW2pdOw0KICAgICAgICAgICAgICAgIGNbal0gPSBjW2ogKyAxXTsNCiAgICAgICAgICAgICAgICBjW2ogKyAxXSA9IHRlbXAzOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KICAgIGlmIChudW1hID4gMCkNCiAgICAgICAgZm9yIChpbnQgaSA9IDE7IGkgPD0gbnVtYTsgaSsrKQ0KICAgICAgICB7DQogICAgICAgICAgICBmb3IgKGludCBqID0gMTsgaiA8PSBudW1hIC0gaTsgaisrKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGlmIChhW2pdIDwgYVtqICsgMV0pDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICBsb25nIGxvbmcgdGVtcDEgPSBhW2pdOw0KICAgICAgICAgICAgICAgICAgICBhW2pdID0gYVtqICsgMV07DQogICAgICAgICAgICAgICAgICAgIGFbaiArIDFdID0gdGVtcDE7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgaWYgKG51bWIgPiAwKQ0KICAgICAgICBmb3IgKGludCBpID0gMTsgaSA8PSBudW1iOyBpKyspDQogICAgICAgIHsNCiAgICAgICAgICAgIGZvciAoaW50IGogPSAxOyBqIDw9IG51bWIgLSBpOyBqKyspDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgaWYgKGJbal0gPCBiW2ogKyAxXSkNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIGxvbmcgbG9uZyB0ZW1wMSA9IGJbal07DQogICAgICAgICAgICAgICAgICAgIGJbal0gPSBiW2ogKyAxXTsNCiAgICAgICAgICAgICAgICAgICAgYltqICsgMV0gPSB0ZW1wMTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICBpZiAobnVtYyA+IDApDQogICAgICAgIGZvciAoaW50IGkgPSAxOyBpIDw9IG51bWM7IGkrKykNCiAgICAgICAgew0KICAgICAgICAgICAgZm9yIChpbnQgaiA9IDE7IGogPD0gbnVtYyAtIGk7IGorKykNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBpZiAoY1tqXSA8IGNbaiArIDFdKQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgbG9uZyBsb25nIHRlbXAxID0gY1tqXTsNCiAgICAgICAgICAgICAgICAgICAgY1tqXSA9IGNbaiArIDFdOw0KICAgICAgICAgICAgICAgICAgICBjW2ogKyAxXSA9IHRlbXAxOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIGludCBhMSA9IGFbMV0sIGIxID0gYlsxXSwgYzEgPSBjWzFdOw0KICAgIGZvciAoaW50IGkgPSAxOyBpIDw9IG47IGkrKykNCiAgICB7DQogICAgICAgIGludCBhMiA9IGFbaV0sIGIyID0gYltpXSwgYzIgPSBjW2ldOw0KICAgICAgICBpZiAoYTEgLSBiMSAhPSBhMiAtIGIyICYmIGExIC0gYzEgIT0gYTIgLSBjMikNCiAgICAgICAgew0KICAgICAgICAgICAgY291dCA8PCAtMTsNCiAgICAgICAgICAgIHJldHVybiAwOw0KICAgICAgICB9DQogICAgfQ0KICAgIGlmIChudW1iID09IG51bWMpDQogICAgew0KICAgICAgICBjb3V0IDw8IG1pbihhYnMoYTEgLSBiMSksIGFicyhhMSAtIGMxKSArIDEpOw0KDQogICAgfQ0KICAgIGVsc2UNCiAgICB7DQogICAgICAgIGlmIChudW1hID09IG51bWIpDQogICAgICAgIHsNCiAgICAgICAgICAgIGNvdXQgPDwgYWJzKGExIC0gYjEpOw0KICAgICAgICB9DQogICAgICAgIGlmIChudW1hID09IG51bWMpDQogICAgICAgIHsNCiAgICAgICAgICAgIGNvdXQgPDwgYWJzKGExIC0gYzEpICsgMTsNCiAgICAgICAgfQ0KICAgIH0NCiAgICByZXR1cm4gMDsNCn0NCg0K"}]