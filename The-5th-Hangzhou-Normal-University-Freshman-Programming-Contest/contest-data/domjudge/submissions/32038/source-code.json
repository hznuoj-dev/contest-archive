[{"id":"32038","submission_id":"32038","filename":"main.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+CnVzaW5nIGxsID0gbG9uZyBsb25nOwp1c2luZyBwaWkgPSBzdGQ6OnBhaXI8bGwsIGxsPjsKY29uc3QgaW50IE4gPSAxZTQgKyAzOwpjb25zdCBpbnQgUCA9IDFlOSArIDc7CgppbnQgZVtOICogMl0sIG5lW04gKiAyXSwgaFtOXSwgaWR4Owp2b2lkIGFkZChpbnQgYSwgaW50IGIpIHsKICAgIGVbaWR4XSA9IGIsIG5lW2lkeF0gPSBoW2FdLCBoW2FdID0gaWR4Kys7Cn0KaW50IGZhW05dOwppbnQgZGVlcFtOXTsKc3RkOjp2ZWN0b3I8c3RkOjp2ZWN0b3I8aW50Pj5zb247CnN0ZDo6dmVjdG9yPHN0ZDo6dmVjdG9yPGludD4+ZGVwOwp2b2lkIGRmcyhpbnQgdCwgaW50IGYpIHsKICAgIGZhW3RdID0gZjsKICAgIGRlcFtkZWVwW3RdXS5wdXNoX2JhY2sodCk7CiAgICBmb3IoaW50IGkgPSBoW3RdO35pO2kgPSBuZVtpXSkgewogICAgICAgIGludCBqID0gZVtpXTsKICAgICAgICBpZihqID09IGYpIGNvbnRpbnVlOwogICAgICAgIHNvblt0XS5wdXNoX2JhY2soaik7CiAgICAgICAgZGVlcFtqXSA9IGRlZXBbdF0gKyAxOwogICAgICAgIGRmcyhqLCB0KTsKICAgIH0KfQpzdGQ6OnZlY3RvcjxwaWk+cm9hZDsKaW50IGdldHJvYWQoaW50IGEsIGludCBiKSB7CiAgICBpZihhID4gYikgc3RkOjpzd2FwKGEsIGIpOwogICAgZm9yKGludCBpID0gMDtpIDwgcm9hZC5zaXplKCk7aSsrKSB7CiAgICAgICAgaWYocm9hZFtpXS5maXJzdCA9PSBhICYmIHJvYWRbaV0uc2Vjb25kID09IGIpIHsKICAgICAgICAgICAgcmV0dXJuIGkgKyAxOwogICAgICAgIH0KICAgIH0KICAgIHJldHVybiAtMTsKfQp2b2lkIHNvbHZlKCkgewogICAgaW50IG47CiAgICBzdGQ6OmNpbiA+PiBuOwogICAgbWVtc2V0KGgsIC0xLCBzaXplb2YgaCk7CiAgICBpZHggPSAwOwogICAgc3RkOjp2ZWN0b3I8aW50PmR1KG4gKyAzKTsKICAgIHNvbi5jbGVhcigpOwogICAgc29uLnJlc2l6ZShuICsgMyk7CiAgICBkZXAuY2xlYXIoKTsKICAgIGRlcC5yZXNpemUobiArIDMpOwogICAgcm9hZC5jbGVhcigpOwogICAgZm9yKGludCBpID0gMTtpIDwgbjtpKyspIHsKICAgICAgICBpbnQgdSwgdjsKICAgICAgICBzdGQ6OmNpbiA+PiB1ID4+IHY7CiAgICAgICAgcm9hZC5lbXBsYWNlX2JhY2soc3RkOjptaW4odSwgdiksIHN0ZDo6bWF4KHUsIHYpKTsKICAgICAgICBhZGQodSwgdik7CiAgICAgICAgYWRkKHYsIHUpOwogICAgfQogICAgZGZzKDEsIDApOwogICAgc3RkOjp2ZWN0b3I8Ym9vbD5zdChuICsgMyk7CiAgICBmb3IoaW50IGkgPSBuO2kgPj0gMDtpLS0pIHsKICAgICAgICBmb3IoYXV0byBwIDogZGVwW2ldKSB7CiAgICAgICAgICAgIGlmKHN0W3BdKWNvbnRpbnVlOwogICAgICAgICAgICBpbnQgZiA9IGZhW3BdOwogICAgICAgICAgICBzdGQ6OnZlY3RvcjxpbnQ+cyhzb25bZl0pOwogICAgICAgICAgICBpbnQgc3RhcnQgPSAtMTsKICAgICAgICAgICAgZm9yKGludCBqID0gMDtqIDwgcy5zaXplKCk7aisrKSB7CiAgICAgICAgICAgICAgICBpZihzdFtzW2pdXSkgY29udGludWU7CiAgICAgICAgICAgICAgICBpZihzdGFydCA9PSAtMSkgc3RhcnQgPSBzW2pdOwogICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgc3RkOjpjb3V0IDw8ICI/ICIgPDwgc3RhcnQgPDwgIiAiIDw8IHNbal0gPDwgc3RkOjplbmRsOwogICAgICAgICAgICAgICAgICAgIGludCBoaDtzdGQ6OmNpbiA+PiBoaDsKICAgICAgICAgICAgICAgICAgICBpZihoaCkgewogICAgICAgICAgICAgICAgICAgICAgICBzdGQ6OmNvdXQgPDwgIj8gIiA8PCBzdGFydCA8PCAiICIgPDwgZiA8PCBzdGQ6OmVuZGw7CiAgICAgICAgICAgICAgICAgICAgICAgIHN0ZDo6Y2luID4+IGhoOwogICAgICAgICAgICAgICAgICAgICAgICBpZihoaCkgc3RkOjpjb3V0IDw8ICIhICIgPDwgZ2V0cm9hZChzdGFydCwgZikgPDwgc3RkOjplbmRsOwogICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHN0ZDo6Y291dCA8PCAiISAiIDw8IGdldHJvYWQoc1tqXSwgZikgPDwgc3RkOjplbmRsOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHN0W3N0YXJ0XSA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgc3Rbc1tqXV0gPSB0cnVlOwogICAgICAgICAgICAgICAgICAgIHN0YXJ0ID0gLTE7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYoc3RhcnQgIT0gLTEpIHsKICAgICAgICAgICAgICAgIGlmKGYgPT0gMSkgewogICAgICAgICAgICAgICAgICAgIHN0ZDo6Y291dCA8PCAiISAiIDw8IGdldHJvYWQoc3RhcnQsIGYpIDw8IHN0ZDo6ZW5kbDsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpbnQgZmYgPSBmYVtmXTsKICAgICAgICAgICAgICAgIHN0ZDo6Y291dCA8PCAiPyAiIDw8IHN0YXJ0IDw8ICIgIiA8PCBmZiA8PCBzdGQ6OmVuZGw7CiAgICAgICAgICAgICAgICBpbnQgaGg7IHN0ZDo6Y2luID4+IGhoOwogICAgICAgICAgICAgICAgaWYoaGgpIHsKICAgICAgICAgICAgICAgICAgICBzdGQ6OmNvdXQgPDwgIj8gIiA8PCBzdGFydCA8PCAiICIgPDwgZiA8PCBzdGQ6OmVuZGw7CiAgICAgICAgICAgICAgICAgICAgc3RkOjpjaW4gPj4gaGg7CiAgICAgICAgICAgICAgICAgICAgaWYoaGgpIHN0ZDo6Y291dCA8PCAiISAiIDw8IGdldHJvYWQoc3RhcnQsIGYpIDw8IHN0ZDo6ZW5kbDsKICAgICAgICAgICAgICAgICAgICBlbHNlIHN0ZDo6Y291dCA8PCAiISAiIDw8IGdldHJvYWQoZmYsIGYpIDw8IHN0ZDo6ZW5kbDsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBzdFtzdGFydF0gPSB0cnVlOwogICAgICAgICAgICAgICAgc3RbZl0gPSB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKfQoKaW50IG1haW4oKSB7Ci8vICAgIHN0ZDo6aW9zOjpzeW5jX3dpdGhfc3RkaW8oZmFsc2UpOwovLyAgICBzdGQ6OmNpbi50aWUobnVsbHB0cik7Ci8vICAgIHN0ZDo6Y291dC50aWUobnVsbHB0cik7CiAgICBpbnQgVCA9IDE7CiAgICBzdGQ6OmNpbiA+PiBUOwogICAgd2hpbGUoVC0tKSB7CiAgICAgICAgc29sdmUoKTsKICAgIH0KfQ=="}]