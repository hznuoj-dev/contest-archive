[{"id":"31848","submission_id":"31848","filename":"main.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+CiNkZWZpbmUgaW50IGxvbmcgbG9uZwoKdXNpbmcgbmFtZXNwYWNlIHN0ZDsKCnZvaWQgYSgpewogICAgaW50IG47CiAgICBjaW4gPj4gbjsKICAgIHZlY3RvcjxpbnQ+IHZjKG4pOwogICAgdmVjdG9yPGludD4gYXJyKG4pOwogICAgZm9yIChpbnQgaSA9IDA7IGkgPCBuOyArK2kpIHsKICAgICAgICBjaW4gPj4gdmNbaV07CiAgICAgICAgYXJyW2ldID0gdmNbaV07CiAgICB9CiAgICBpZihuICUgMil7CgogICAgfQogICAgZWxzZXsKICAgICAgICBzdGQ6OnNvcnQodmMuYmVnaW4oKSwgdmMuZW5kKCkpOwogICAgICAgIGludCBtMiA9IHZjW24vMl0sIG0xID0gdmNbbi8yIC0gMV07CiAgICAgICAgaWYobTEgPCBhcnJbMF0pIG0xID0gYXJyWzBdOyBpZihhcnJbbi0xXSA8IG0yKSBtMiA9IGFycltuLTFdOwogICAgICAgIGZvciAoaW50IGkgPSBtMTsgaSA8IG0yOyArK2kpIHsKCiAgICAgICAgfQoKICAgIH0KfQoKdm9pZCBiKCl7CiAgICBpbnQgbjsKICAgIGNpbiA+PiBuOwogICAgdmVjdG9yPGludD4gYShuKTsKICAgIHZlY3RvcjxpbnQ+IHZjKG4pOwogICAgZm9yIChpbnQgaSA9IDA7IGkgPCBuOyArK2kpIHsKICAgICAgICBjaW4gPj4gYVtpXTsKICAgIH0KICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbjsgKytpKSB7CiAgICAgICAgY2luID4+IHZjW2ldOwogICAgfQoKICAgIHN0ZDo6c29ydChhLmJlZ2luKCksIGEuZW5kKCkpOwogICAgc3RkOjpzb3J0KHZjLmJlZ2luKCksIHZjLmVuZCgpKTsKCiAgICBpbnQgY250X2EgPSBhWzBdOwogICAgZm9yIChpbnQgaSA9IDA7IGkgPCBuLTE7ICsraSkgewogICAgICAgIGlmKGFbaV0gKiBhW2krMV0gPCAwKXsKICAgICAgICAgICAgY250X2EgPSBpOwogICAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICB9CgoKICAgIGludCBjbnRfdmMgPSB2Y1swXTsKICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbi0xOyArK2kpIHsKICAgICAgICBpZih2Y1tpXSAqIHZjW2krMV0gPCAwKXsKICAgICAgICAgICAgY250X3ZjID0gaTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgfQoKICAgIGludCBwb2ludCA9IDA7CiAgICBpbnQgZGV0WzJdOwogICAgZGV0WzBdID0gY250X2EgLSBjbnRfdmM7CiAgICBkZXRbMV0gPSBjbnRfYSAtIChuLTEgLSBjbnRfdmMgLSAxKTsKICAgIGlmKGFicyhkZXRbMF0pID4gYWJzKGRldFsxXSkpewogICAgICAgIC8v5Y+N6L2sCiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBuOyArK2kpIHsKICAgICAgICAgICAgdmNbaV0gPSAtdmNbaV07CiAgICAgICAgfQogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDw9IG4gLyAyOyArK2kpIHsKICAgICAgICAgICAgc3dhcCh2Y1tpXSwgdmNbbi0xXSk7CiAgICAgICAgfQogICAgICAgIGRldFswXSA9IGRldFsxXTsKICAgICAgICBwb2ludCA9IDE7CiAgICB9CiAgICBmb3IgKGludCBpID0gMDsgaSA8IG47ICsraSkgewogICAgICAgIHZjW2ldICs9IGRldFswXTsKICAgIH0KCiAgICBib29sIGYgPSB0cnVlOwogICAgZm9yIChpbnQgaSA9IDA7IGkgPCBuOyArK2kpIHsKICAgICAgICBpZihhW2ldICE9IHZjW2ldKXsKICAgICAgICAgICAgZiA9IGZhbHNlOwogICAgICAgIH0KICAgIH0KCiAgICBpZihmKXsKICAgICAgICBjb3V0IDw8IGFicyhkZXRbMF0pICsgcG9pbnQ7CiAgICB9CiAgICBlbHNlewogICAgICAgIGNvdXQgPDwgLTE7CiAgICB9CgoKCi8vCi8vICAgIGJvb2wgZl91cCA9IHRydWU7Ci8vICAgIGludCB1cCA9IGFbMF0gLSB2Y191cFswXTsKLy8gICAgZm9yIChpbnQgaSA9IDE7IGkgPCBuOyArK2kpIHsKLy8gICAgICAgIGlmKGFbaV0gLSB2Y191cFtpXSAhPSB1cCl7Ci8vICAgICAgICAgICAgZl91cCA9IGZhbHNlOwovLyAgICAgICAgICAgIHVwID0gSU5UMzJfTUFYOwovLyAgICAgICAgICAgIGJyZWFrOwovLyAgICAgICAgfQovLyAgICB9Ci8vICAgIGlmKGZfdXApewovLyAgICAgICAgdXAgPSBhYnModXApOwovLyAgICB9Ci8vCi8vICAgIGJvb2wgZl9kb3duID0gdHJ1ZTsKLy8gICAgaW50IGRvd24gPSBhWzBdIC0gdmNfdXBbMF07Ci8vICAgIGZvciAoaW50IGkgPSAxOyBpIDwgbjsgKytpKSB7Ci8vICAgICAgICBpZihhW2ldIC0gdmNfZG93bltpXSAhPSBkb3duKXsKLy8gICAgICAgICAgICBmX2Rvd24gPSBmYWxzZTsKLy8gICAgICAgICAgICBkb3duID0gSU5UMzJfTUFYOwovLyAgICAgICAgICAgIGJyZWFrOwovLyAgICAgICAgfQovLyAgICB9Ci8vICAgIGlmKGZfZG93bil7Ci8vICAgICAgICBkb3duID0gYWJzKGRvd24pOwovLyAgICB9Ci8vCi8vCi8vICAgIGludCByZXMgPSB1cCA8IGRvd24gPyB1cCA6IGRvd247Ci8vICAgIGlmKHJlcyAhPSBJTlQzMl9NQVgpewovLyAgICAgICAgY291dCA8PCByZXM7Ci8vICAgIH0KLy8gICAgZWxzZXsKLy8gICAgICAgIGNvdXQgPDwgLTE7Ci8vICAgIH0KLy8KCgoKfQoKdm9pZCBsKCl7CiAgICBkb3VibGUgbSwgazsKICAgIGNpbiA+PiBtID4+IGs7ICAvLyDmu6Ft5YePawoKICAgIHZlY3Rvcjxkb3VibGU+IHZhbHVlX3liKDUpOwogICAgZm9yIChpbnQgaSA9IDA7IGkgPCA1OyArK2kpIHsKICAgICAgICBjaW4gPj4gdmFsdWVfeWJbaV07CiAgICB9CgogICAgdmVjdG9yPGRvdWJsZT4gdmFsdWVfcmVhbCg1KTsKICAgIGZvciAoaW50IGkgPSAwOyBpIDwgNTsgKytpKSB7CiAgICAgICAgY2luID4+IHZhbHVlX3JlYWxbaV07CiAgICB9CgogICAgdmVjdG9yPGRvdWJsZT4gcmVhbF95Yig1KTsKICAgIGZvciAoaW50IGkgPSAwOyBpIDwgNTsgKytpKSB7CiAgICAgICAgZG91YmxlIHZfeWIgPSB2YWx1ZV95YltpXSA+PSBtPyB2YWx1ZV95YltpXSAtIGsgOiB2YWx1ZV95YltpXTsKICAgICAgICByZWFsX3liW2ldID0gdmFsdWVfcmVhbFtpXSAvIHZfeWI7CiAgICB9CgogICAgc3RkOjpzb3J0KHJlYWxfeWIuYmVnaW4oKSwgcmVhbF95Yi5lbmQoKSk7CgogICAgZG91YmxlIG1vc3Rfb25lID0gcmVhbF95Yls0XTsKCiAgICBkb3VibGUgbW9zdF9tayA9IDA7CgogICAgdmFsdWVfcmVhbC5wdXNoX2JhY2soMCk7CiAgICB2YWx1ZV95Yi5wdXNoX2JhY2soMCk7CgogICAgaW50IGFbNV07CiAgICBmb3IgKGFbMF0gPSAwOyBhWzBdIDw9IDU7ICsrYVswXSkgewogICAgICAgIGZvciAoYVsxXSA9IDE7IGFbMV0gPD0gNTsgKythWzFdKSB7CiAgICAgICAgICAgIGZvciAoYVsyXSA9IDI7IGFbMl0gPD0gNTsgKythWzJdKSB7CiAgICAgICAgICAgICAgICBmb3IgKGFbM10gPSAzOyBhWzNdIDw9IDU7ICsrYVszXSkgewogICAgICAgICAgICAgICAgICAgIGZvciAoYVs0XSA9IDQ7IGFbNF0gPD0gNTsgKythWzRdKSB7CgogICAgICAgICAgICAgICAgICAgICAgICBib29sIGYgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCA0OyArK2kpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoaW50IGogPSBpKzE7IGogPCA1OyArK2opIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihhW2ldID09IGFbal0gJiYgYVtpXSAhPSA1KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgaWYoZikgY29udGludWU7CgoKCiAgICAgICAgICAgICAgICAgICAgICAgIGRvdWJsZSBhbGxfcmVhbCA9IHZhbHVlX3JlYWxbYVswXV0gKyB2YWx1ZV9yZWFsW2FbMV1dICsgdmFsdWVfcmVhbFthWzJdXSArIHZhbHVlX3JlYWxbYVszXV0gKyB2YWx1ZV9yZWFsW2FbNF1dOwogICAgICAgICAgICAgICAgICAgICAgICBkb3VibGUgYWxsX3liID0gdmFsdWVfeWIgW2FbMF1dICsgdmFsdWVfeWIgW2FbMV1dICsgdmFsdWVfeWIgW2FbMl1dICsgdmFsdWVfeWIgW2FbM11dICsgdmFsdWVfeWIgW2FbNF1dOwogICAgICAgICAgICAgICAgICAgICAgICBpZihhbGxfeWIgPj0gbSkgYWxsX3liIC09IGs7CgogICAgICAgICAgICAgICAgICAgICAgICBpZihtb3N0X21rIDwgYWxsX3JlYWwgLyBhbGxfeWIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vc3RfbWsgPSBhbGxfcmVhbCAvIGFsbF95YjsKLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgY291dCA8PCBtb3N0X21rIDw8ICJcbiI7Ci8vICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByaW50ZigiJWQgICAgICAgICVkICAgICAgICAlZCAgICAgICAgJWQgICAgICAgICVkXG4iLCBhWzBdLCBhWzFdLCBhWzJdLCBhWzNdLCBhWzRdKTsKLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnRmKCIlbGYgJWxmICVsZiAlbGYgJWxmXG4iLCB2YWx1ZV9yZWFsW2FbMF1dLCB2YWx1ZV9yZWFsW2FbMV1dLCB2YWx1ZV9yZWFsW2FbMl1dLCB2YWx1ZV9yZWFsW2FbM11dLCB2YWx1ZV9yZWFsW2FbNF1dKTsKLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnRmKCIlbGYgJWxmICVsZiAlbGYgJWxmXG5cbiIsIHZhbHVlX3liW2FbMF1dLCB2YWx1ZV95YlthWzFdXSwgdmFsdWVfeWJbYVsyXV0sIHZhbHVlX3liW2FbM11dLCB2YWx1ZV95YlthWzRdXSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgcHJpbnRmKCIlLjJsZiIsIG1vc3RfbWsgPiBtb3N0X29uZSA/IG1vc3RfbWsgOiBtb3N0X29uZSk7Cgp9CgpzaWduZWQgbWFpbigpIHsKICAgIGIoKTsKfQo="}]