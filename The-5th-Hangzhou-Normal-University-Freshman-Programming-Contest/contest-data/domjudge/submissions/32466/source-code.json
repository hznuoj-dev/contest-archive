[{"id":"32466","submission_id":"32466","filename":"I.cpp","source":"I2luY2x1ZGUgPGlvc3RyZWFtPg0KI2luY2x1ZGUgPHVub3JkZXJlZF9zZXQ+DQojaW5jbHVkZSA8dmVjdG9yPg0KdXNpbmcgbmFtZXNwYWNlIHN0ZDsNCmNvbnN0IGludCBOID0gMWUzICsgMTA7DQp1bm9yZGVyZWRfc2V0PGludD4gZWRnZXNbTl07DQppbnQgbWFya1tOXSwgZmxhZywgZltOXSwgZGVwW05dLCBHW05dW05dOw0KDQp2b2lkIGluaXQoaW50IHUsIGludCBmYSkgew0KICAgIGRlcFt1XSA9IGRlcFtmYV0gKyAxOw0KICAgIGZbdV0gPSBmYTsNCiAgICBlZGdlc1t1XS5lcmFzZShmYSk7DQogICAgZm9yKGludCBueHQ6IGVkZ2VzW3VdKSAgaW5pdChueHQsIHUpOw0KfQ0KDQp2ZWN0b3I8aW50PiBwYXRoMSwgcGF0aDI7DQoNCnZvaWQgZmluZFBhdGgoaW50IHUsIGludCB2KSB7DQogICAgcGF0aDEuY2xlYXIoKTsNCiAgICBwYXRoMi5jbGVhcigpOw0KICAgIHBhdGgxLnB1c2hfYmFjayh1KTsNCiAgICBwYXRoMi5wdXNoX2JhY2sodik7DQogICAgd2hpbGUodSAhPSB2KSB7DQogICAgICAgIGlmKGRlcFt1XSA+PSBkZXBbdl0pICAgIHsNCiAgICAgICAgICAgIHUgPSBmW3VdOw0KICAgICAgICAgICAgcGF0aDEucHVzaF9iYWNrKHUpOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgdiA9IGZbdl07DQogICAgICAgICAgICBwYXRoMi5wdXNoX2JhY2sodik7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBmb3IoaW50IGkgPSBwYXRoMi5zaXplKCkgLSAyOyBpID49IDA7IGktLSkgIHBhdGgxLnB1c2hfYmFjayhwYXRoMltpXSk7DQp9DQoNCnZvaWQgZmluZChpbnQgdSwgaW50IHYpIHsNCiAgICBmaW5kUGF0aCh1LCB2KTsNCiAgICBpbnQgbGggPSAwLCByaCA9IHBhdGgxLnNpemUoKSAtIDEsIHg7DQogICAgd2hpbGUobGggKyAxIDwgcmgpIHsNCiAgICAgICAgaW50IG1pZCA9IChsaCArIHJoKSAvIDI7DQogICAgICAgIHByaW50ZigiPyAlZCAlZFxuIiwgcGF0aDFbbWlkXSwgcGF0aDFbcmhdKTsNCiAgICAgICAgZmZsdXNoKHN0ZG91dCk7DQogICAgICAgIHNjYW5mKCIlZCIsICZ4KTsNCiAgICAgICAgaWYoeCA9PSAxKSB7DQogICAgICAgICAgICBsaCA9IG1pZDsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIHJoID0gbWlkOw0KICAgICAgICB9DQogICAgfQ0KICAgIHByaW50ZigiISAlZFxuIiwgR1twYXRoMVtsaF1dW3BhdGgxW2xoKzFdXSk7DQogICAgZmZsdXNoKHN0ZG91dCk7DQp9DQoNCnZvaWQgZGZzKGludCB1LCBpbnQgZmEpIHsNCiAgICAvLyBwcmludGYoIjo6JWRcbiIsIHUpOw0KICAgIGlmKGZsYWcpICAgIHJldHVybjsNCiAgICB2ZWN0b3I8aW50PiB2Ow0KICAgIGZvcihpbnQgbnh0OiBlZGdlc1t1XSkgew0KICAgICAgICBkZnMobnh0LCB1KTsNCiAgICAgICAgdi5wdXNoX2JhY2sobnh0KTsNCiAgICB9DQogICAgLy8gcHJpbnRmKCI6JWRcbiIsIHYuc2l6ZSgpKTsNCiAgICBpbnQgeDsNCiAgICBmb3IoaW50IGkgPSAxOyBpIDwgdi5zaXplKCkgJiYgIWZsYWc7IGkgKz0gMikgeyAgICANCiAgICAgICAgcHJpbnRmKCI/ICVkICVkXG4iLCBtYXJrW3ZbaS0xXV0sIG1hcmtbdltpXV0pOw0KICAgICAgICBmZmx1c2goc3Rkb3V0KTsNCiAgICAgICAgc2NhbmYoIiVkIiwgJngpOw0KICAgICAgICBpZih4KSAgIHsNCiAgICAgICAgICAgIGZpbmQobWFya1t2W2ktMV1dLCBtYXJrW3ZbaV1dKTsNCiAgICAgICAgICAgIGZsYWcgPSAxOw0KICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICB9DQogICAgICAgIGVkZ2VzW3VdLmVyYXNlKHZbaS0xXSk7DQogICAgICAgIGVkZ2VzW3VdLmVyYXNlKHZbaV0pOw0KICAgIH0NCiAgICBpZihlZGdlc1t1XS5lbXB0eSgpKSAgICBtYXJrW3VdID0gdTsNCiAgICBlbHNlICAgICAgICAgICAgICAgICAgICBtYXJrW3VdID0gdi5iYWNrKCk7DQp9DQoNCnZvaWQgc29sdmUoKQ0Kew0KICAgIGludCBuOw0KICAgIHNjYW5mKCIlZCIsICZuKTsNCiAgICBpbnQgdSwgdjsNCiAgICBmb3IoaW50IGkgPSAxOyBpIDw9IG47IGkrKykgZWRnZXNbaV0uY2xlYXIoKTsNCiAgICBmb3IoaW50IGkgPSAxOyBpIDwgbjsgaSsrKSB7DQogICAgICAgIHNjYW5mKCIlZCAlZCIsICZ1LCAmdik7DQogICAgICAgIGVkZ2VzW3VdLmluc2VydCh2KTsNCiAgICAgICAgZWRnZXNbdl0uaW5zZXJ0KHUpOw0KICAgICAgICBHW3VdW3ZdID0gR1t2XVt1XSA9IGk7DQogICAgfQ0KDQogICAgaW5pdCgxLCAwKTsNCiAgICBmbGFnID0gMDsNCiAgICBkZnMoMSwgMSk7DQp9DQoNCg0KaW50IG1haW4oKQ0Kew0KICAgIGludCBUOw0KICAgIHNjYW5mKCIlZCIsICZUKTsNCiAgICB3aGlsZShULS0pICBzb2x2ZSgpOw0KDQogICAgcmV0dXJuIDA7DQp9"}]