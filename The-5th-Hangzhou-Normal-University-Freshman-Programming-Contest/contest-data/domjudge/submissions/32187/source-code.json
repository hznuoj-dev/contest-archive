[{"id":"32187","submission_id":"32187","filename":"D.cpp","source":"I2luY2x1ZGUgPGlvc3RyZWFtPg0KI2luY2x1ZGUgPGFsZ29yaXRobT4NCiNpbmNsdWRlIDxtYXA+DQojaW5jbHVkZSA8dmVjdG9yPg0KdXNpbmcgbmFtZXNwYWNlIHN0ZDsNCnVzaW5nIGxsID0gbG9uZyBsb25nOw0KY29uc3QgaW50IE4gPSAyZTUgKyAxMCwgSU5GID0gMmU5ICsgMTA7DQpsbCBiaXRzW05dOw0KaW50IG4sIGssIHE7DQppbmxpbmUgaW50IGxvd2JpdChpbnQgeCkgew0KICAgIHJldHVybiB4ICYgKC14KTsNCn0NCnZvaWQgYWRkKGludCB4LCBpbnQgdikgew0KICAgIHdoaWxlKHggPD0gbikgew0KICAgICAgICBiaXRzW3hdICs9IHY7DQogICAgICAgIHggKz0gbG93Yml0KHgpOw0KICAgIH0NCn0NCmxsIHF1ZXJ5KGludCB4KSB7DQogICAgbGwgcmV0ID0gMDsNCiAgICB3aGlsZSh4KSB7DQogICAgICAgIHJldCArPSBiaXRzW3hdOw0KICAgICAgICB4IC09IGxvd2JpdCh4KTsNCiAgICB9DQogICAgcmV0dXJuIHJldDsNCn0NCg0KaW50IHJQb3NbTl0sIGFbTl07DQoNCnN0cnVjdCBub2RlIHsNCiAgICBpbnQgaWQsIHZhbDsNCn07DQppbnQgbWFpbigpDQp7DQogICAgc2NhbmYoIiVkICVkICVkIiwgJm4sICZrLCAmcSk7DQogICAgZm9yKGludCBpID0gMTsgaSA8PSBuOyBpKyspIHNjYW5mKCIlZCIsICZhW2ldKTsNCiAgICANCiAgICB2ZWN0b3I8bm9kZT4gYXNjLCBkZXM7DQogICAgYXNjLnB1c2hfYmFjayh7bisxLCBJTkZ9KTsNCiAgICBkZXMucHVzaF9iYWNrKHtuKzEsIC1JTkZ9KTsNCiAgICBmb3IoaW50IGkgPSBuOyBpID49IDE7IGktLSkgew0KICAgICAgICByUG9zW2ldID0gSU5GOw0KICAgICAgICB3aGlsZShhc2MuYmFjaygpLnZhbCA8IGFbaV0pICAgIGFzYy5wb3BfYmFjaygpOw0KICAgICAgICBhc2MucHVzaF9iYWNrKHtpLCBhW2ldfSk7DQogICAgICAgIHdoaWxlKGRlcy5iYWNrKCkudmFsID4gYVtpXSkgICAgZGVzLnBvcF9iYWNrKCk7DQogICAgICAgIGRlcy5wdXNoX2JhY2soe2ksIGFbaV19KTsNCiAgICAgICAgaW50IGxoID0gMCwgcmggPSBhc2Muc2l6ZSgpIC0gMSwgcG9zOw0KICAgICAgICB3aGlsZShsaCA8PSByaCkgew0KICAgICAgICAgICAgaW50IG1pZCA9IChsaCArIHJoKSAvIDI7DQogICAgICAgICAgICBpZihhc2NbbWlkXS52YWwgPiBhW2ldICsgaykgew0KICAgICAgICAgICAgICAgIHBvcyA9IGFzY1ttaWRdLmlkOw0KICAgICAgICAgICAgICAgIGxoID0gbWlkICsgMTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgcmggPSBtaWQgLSAxOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIHJQb3NbaV0gPSBtaW4oclBvc1tpXSwgcG9zIC0gaSAtIDEpOw0KICAgICAgICBsaCA9IDAsIHJoID0gZGVzLnNpemUoKSAtIDE7DQogICAgICAgIHdoaWxlKGxoIDw9IHJoKSB7DQogICAgICAgICAgICBpbnQgbWlkID0gKGxoICsgcmgpIC8gMjsNCiAgICAgICAgICAgIGlmKGRlc1ttaWRdLnZhbCA8IGFbaV0gLSBrKSB7DQogICAgICAgICAgICAgICAgcG9zID0gZGVzW21pZF0uaWQ7DQogICAgICAgICAgICAgICAgbGggPSBtaWQgKyAxOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICByaCA9IG1pZCAtIDE7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgclBvc1tpXSA9IG1pbihyUG9zW2ldLCBwb3MgLSBpIC0gMSk7DQogICAgICAgIGFkZChpLCByUG9zW2ldICsgMSk7DQogICAgfQ0KDQogICAgLy8gZm9yKGludCBpID0gMTsgaSA8PSBuOyBpKyspIHByaW50ZigiOiVkXG4iLCByUG9zW2ldKTsNCiAgICBpbnQgbCwgcjsNCiAgICBmb3IoaW50IGkgPSAwOyBpIDwgcTsgaSsrKSB7DQogICAgICAgIHNjYW5mKCIlZCAlZCIsICZsLCAmcik7DQogICAgICAgIGludCBsaCA9IGwsIHJoID0gciwgcG9zID0gcjsNCiAgICAgICAgd2hpbGUobGggPD0gcmgpIHsNCiAgICAgICAgICAgIGludCBtaWQgPSAobGggKyByaCkgLyAyOw0KICAgICAgICAgICAgaWYoclBvc1ttaWRdICsgbWlkID49IHIpIHsNCiAgICAgICAgICAgICAgICBwb3MgPSBtaWQ7DQogICAgICAgICAgICAgICAgcmggPSBtaWQgLSAxOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBsaCA9IG1pZCArIDE7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICBsb25nIGxvbmcgYW5zID0gMDsNCiAgICAgICAgaW50IG51bSA9IHIgLSBwb3MgKyAxOw0KICAgICAgICByID0gcG9zIC0gMTsNCiAgICAgICAgYW5zICs9IG51bSAqIDFsbCAqIChudW0gKyAxKSAvIDI7DQogICAgICAgIGlmKHIgPj0gbCkgIGFucyArPSBxdWVyeShyKSAtIHF1ZXJ5KGwtMSk7DQogICAgICAgIHByaW50ZigiJWxsZFxuIiwgYW5zKTsNCiAgICB9DQoNCiAgICByZXR1cm4gMDsNCn0="}]