[{"id":"32210","submission_id":"32210","filename":"27_1.cpp","source":"I2luY2x1ZGU8aW9zdHJlYW0+DQojaW5jbHVkZTxhbGdvcml0aG0+DQp1c2luZyBuYW1lc3BhY2Ugc3RkOw0KaW50IGFbMjAwMDEwXSxiWzIwMDAxMF07DQppbnQgbjsNCmludCBmbGFnMSxhbnM7DQppbnQgbWFpbigpDQp7DQogICAgY2luID4+IG47DQogICAgZm9yIChpbnQgaSA9IDE7IGkgPD0gbiA7IGkgKysgKSBjaW4gPj4gYVtpXTsNCiAgICBmb3IgKGludCBpID0gMTsgaSA8PSBuIDsgaSArKyApIGNpbiA+PiBiW2ldOw0KICAgIHNvcnQoYSArIDEsYSArIG4gKyAxKSxzb3J0KGIgKyAxLGIgKyBuICsgMSk7DQogICAgLy9mb3IgKGludCBpID0gMTsgaSA8PSBuOyBpICsrICkgY291dCA8PCBhW2ldIDw8ICIgIjsNCiAgICBpbnQgeCA9IGFbMV0gLSBiWzFdLGZsYWcgPSAwOw0KICAgIGZvciAoaW50IGkgPSAyOyBpIDw9IG4gOyBpICsrICkNCiAgICB7DQogICAgICAgIGlmIChhW2ldIC0gYltpXSAhPSB4KSBmbGFnID0gMTsNCiAgICB9DQogICAgaW50IHkgPSAwOw0KICAgIGZvciAoaW50IGkgPSAxOyBpIDw9IG47IGkgKysgKQ0KICAgIHsNCiAgICAgICAgaWYgKGFbaV0gIT0gYVsxXSkgZmxhZzEgPSAxOw0KICAgICAgICBpZiAoYltpXSAhPSBiWzFdKSBmbGFnMSA9IDE7DQogICAgfQ0KICAgIGlmIChmbGFnMSA9PSAwKSBhbnMgPSBhYnMobWluKGFbMV0sYlsxXSkgKiAyKTsgDQogICAgaWYgKGZsYWcgPT0gMSkNCiAgICB7DQogICAgZm9yIChpbnQgaSA9IDE7IGkgPD0gbjsgaSArKyApDQogICAgew0KICAgICAgICBhW2ldID0gMCAtIGFbaV07DQogICAgfQ0KICAgIHNvcnQoYSArIDEsYSArIG4gKyAxKTsNCiAgICB5ID0gYVsxXSAtIGJbMV07DQogICAgZm9yIChpbnQgaSA9IDI7IGkgPD0gbiA7IGkgKysgKQ0KICAgIHsNCiAgICAgICAgaWYgKGFbaV0gLSBiW2ldICE9IHkgJiYgZmxhZyAhPSAtMSkgDQogICAgICAgIHsNCiAgICAgICAgICAgIGNvdXQgPDwgIi0xIiA8PCBlbmRsOw0KICAgICAgICAgICAgZmxhZyA9IC0xOw0KICAgICAgICB9DQogICAgfSANCiAgICB9DQogICAgaWYgKGZsYWcgPT0gMCAmJiAoKGFbMV0gPT0gYWJzKGFbMV0pICYmIGJbMV0gPT0gYWJzKGJbMV0pIHx8IGFbMV0gIT0gYWJzKGFbMV0pICYmIGJbMV0gIT0gYWJzKGJbMV0pICkpKSBjb3V0IDw8IGFicyh4KTsNCiAgICBlbHNlIGlmIChmbGFnID09IDAgJiYgZmxhZzEgPT0gMCAmJigoYVsxXSAhPSBhYnMoYVsxXSkgJiYgYlsxXSA9PSBhYnMoYlsxXSkgfHwgYVsxXSA9PSBhYnMoYVsxXSkgJiYgYlsxXSAhPSBhYnMoYlsxXSkgKSkpIGNvdXQgPDwgYWJzKHgpIC0gYW5zICsgMTsNCiAgICBlbHNlIGlmIChmbGFnID09IDAgJiYgZmxhZzEgIT0gMCkgY291dCA8PCBhYnMoeCk7DQogICAgZWxzZSBpZiAoZmxhZyA9PSAxKSBjb3V0IDw8IGFicyh5KSArIDE7DQogICAgcmV0dXJuIDA7DQp9"}]