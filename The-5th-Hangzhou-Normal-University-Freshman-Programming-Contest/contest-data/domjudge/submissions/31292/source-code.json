[{"id":"31292","submission_id":"31292","filename":"f.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+DQojZGVmaW5lIGZwKGksIGEsIGIpIGZvcihpbnQgaSA9IChhKSwgZWQgPSAoYik7IGkgPD0gZWQ7ICsraSkNCiNkZWZpbmUgZmIoaSwgYSwgYikgZm9yKGludCBpID0gKGEpLCBlZCA9IChiKTsgaSA+PSBlZDsgLS1pKQ0KI2RlZmluZSBnbyh1LCBpKSBmb3IoaW50IGkgPSBoZWFkW3VdOyBpOyBpID0gZVtpXS5ueHQpDQp1c2luZyBuYW1lc3BhY2Ugc3RkOw0KdHlwZWRlZiBsb25nIGxvbmcgTEw7DQp0eXBlZGVmIHBhaXI8aW50LCBpbnQ+IHBpaTsNCmlubGluZSBpbnQgcmQoKSB7DQoJcmVnaXN0ZXIgaW50IHgoMCksIGYoMSk7IHJlZ2lzdGVyIGNoYXIgYyhnZXRjaGFyKCkpOw0KCXdoaWxlIChjIDwgJzAnIHx8ICc5JyA8IGMpIHsgaWYgKGMgPT0gJy0nKWYgPSAtMTsgYyA9IGdldGNoYXIoKTsgfQ0KCXdoaWxlICgnMCcgPD0gYyAmJiBjIDw9ICc5Jyl4ID0geCoxMCArIGMtJzAnLCBjID0gZ2V0Y2hhcigpOw0KCXJldHVybiB4KmY7DQp9DQppbmxpbmUgTEwgUkQoKSB7DQoJcmVnaXN0ZXIgTEwgeCgwKTsgcmVnaXN0ZXIgaW50IGYoMSk7IHJlZ2lzdGVyIGNoYXIgYyhnZXRjaGFyKCkpOw0KCXdoaWxlIChjIDwgJzAnIHx8ICc5JyA8IGMpIHsgaWYgKGMgPT0gJy0nKWYgPSAtMTsgYyA9IGdldGNoYXIoKTsgfQ0KCXdoaWxlICgnMCcgPD0gYyAmJiBjIDw9ICc5Jyl4ID0geCoxMCArIGMtJzAnLCBjID0gZ2V0Y2hhcigpOw0KCXJldHVybiB4KmY7DQp9DQppbmxpbmUgaW50IGludF9yYW5kKGludCBsLCBpbnQgcil7DQoJaW50IHJlcyA9IDEuMGwqcmFuZCgpL1JBTkRfTUFYKihyLWwrMSk7DQoJaWYocmVzID09IHItbCsxKXJlcyA9IHItbDsNCglyZXR1cm4gbCtyZXM7DQp9DQppbmxpbmUgTEwgTExfcmFuZChMTCBsLCBMTCByKXsNCglMTCByZXMgPSAxLjBsKnJhbmQoKS9SQU5EX01BWCooci1sKzEpOw0KCWlmKHJlcyA9PSByLWwrMSlyZXMgPSByLWw7DQoJcmV0dXJuIGwrcmVzOw0KfQ0KY29uc3QgaW50IG1heG4gPSAyMDAwMTA7DQppbnQgbiwgbSwgZlttYXhuXSwgZ1ttYXhuXSwgc2l6W21heG5dOw0Kc3RydWN0IGVkZ2V7aW50IHRvLCB3LCBueHQ7fWVbbWF4bjw8MV07DQppbnQgaGVhZFttYXhuXSwgazsNCmlubGluZSB2b2lkIGFkZChpbnQgdSwgaW50IHYsIGludCB3KXtlWysra10gPSB7diwgdywgaGVhZFt1XX0sIGhlYWRbdV0gPSBrO30NCnZvaWQgZGZzKGludCB1LCBpbnQgcHJlKXsNCglzaXpbdV0gPSAxOw0KCWdvKHUsIGkpaWYoZVtpXS50byAhPSBwcmUpew0KCQlkZnMoZVtpXS50bywgdSksIHNpelt1XSArPSBzaXpbZVtpXS50b107DQoJCWlmKHNpeltlW2ldLnRvXSYxKWZbdV0gXj0gZVtpXS53XmZbZVtpXS50b107DQoJCWVsc2UgZlt1XSBePSBmW2VbaV0udG9dOw0KCX0NCn0NCnZvaWQgZGZzMihpbnQgdSwgaW50IHByZSl7DQoJZ28odSwgaSlpZihlW2ldLnRvICE9IHByZSl7DQoJCWludCByZXMgPSBzaXpbZVtpXS50b10mMSA/IGdbdV1eZVtpXS53XmZbZVtpXS50b10gOiBnW3VdXmZbZVtpXS50b107DQoJCWlmKG4tc2l6W2VbaV0udG9dJjEpZ1tlW2ldLnRvXSA9IGZbZVtpXS50b11ecmVzXmVbaV0udzsNCgkJZWxzZSBnW2VbaV0udG9dID0gZltlW2ldLnRvXV5yZXM7DQoJCWRmczIoZVtpXS50bywgdSk7DQoJfQ0KfQ0KaW50IG1haW4oKXsNCi8vCWZyZW9wZW4oImEuaW4iLCAiciIsIHN0ZGluKTsNCi8vCWZyZW9wZW4oImEub3V0IiwgInciLCBzdGRvdXQpOw0KCW4gPSByZCgpOw0KCWZwKGksIDIsIG4pew0KCQlpbnQgdSA9IHJkKCksIHYgPSByZCgpLCB3ID0gcmQoKTsNCgkJYWRkKHUsIHYsIHcpLCBhZGQodiwgdSwgdyk7DQoJfQ0KCWRmcygxLCAwKSwgZ1sxXSA9IGZbMV0sIGRmczIoMSwgMCksIG0gPSByZCgpOw0KCXdoaWxlKG0tLSl7DQoJCWludCB1ID0gcmQoKSwgdiA9IHJkKCk7DQoJCXByaW50ZigiJWRcbiIsIG4mMSA/IGdbdV1ediA6IGdbdV0pOw0KCX0NCglyZXR1cm4gMDsNCn0NCg=="}]