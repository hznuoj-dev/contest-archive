[{"id":"32397","submission_id":"32397","filename":"main.cpp","source":"Ly8jaW5jbHVkZSA8aW9zdHJlYW0+Ci8vdXNpbmcgbmFtZXNwYWNlIHN0ZDsKLy9jb25zdCBpbnQgTiA9IDJlNSArIDEwOwovL2xvbmcgbG9uZyBxcG93KGxvbmcgbG9uZyBhICwgbG9uZyBsb25nIG4gLCBsb25nIGxvbmcgbW9kKXsKLy8gICAgbG9uZyBsb25nIGFucyA9IDE7Ci8vICAgIHdoaWxlKG4pewovLyAgICAgICAgaWYobiAmIDEpewovLyAgICAgICAgICAgIGFucyA9IGFucyAqIGEgJSBtb2Q7Ci8vICAgICAgICB9Ci8vICAgICAgICBuID4+PSAxOwovLyAgICAgICAgYSA9IGEgKiBhICUgbW9kOwovLyAgICB9Ci8vICAgIHJldHVybiBhbnM7Ci8vfQovL2ludCBmYVtOXSAsIGFbTl0gLCBzdW1bTl0gLCBiW05dOwovL2ludCBuICwgcTsKLy92b2lkIEluaXQoKXsKLy8gICAgZm9yKGludCBpID0gMSA7IGkgPD0gbjtpKyspIHsKLy8gICAgICAgIGZhW2ldID0gaTsKLy8gICAgICAgIHN1bVtpXSA9IDE7Ci8vICAgIH0KLy99Ci8vaW50IGZpbmQoaW50IHgpewovLyAgICByZXR1cm4gZmFbeF0gPT0geCA/IHggOiBmaW5kKGZhW3hdKTsKLy99Ci8vaW50IG1haW4oKSB7Ci8vICAgIGNpbiA+PiBuID4+IHE7Ci8vICAgIEluaXQoKTsKLy8gICAgZm9yKGludCBpID0gMSA7IGkgPD0gbjtpKyspewovLyAgICAgICAgY2luID4+IGJbaV07Ci8vICAgICAgICBhW2ldID0gYltpXTsKLy8gICAgfQovLyAgICBmb3IoaW50IGkgPSAxIDsgaSA8PSBxO2krKyl7Ci8vICAgICAgICBpbnQgayAsIHUgLCB2OwovLyAgICAgICAgY2luID4+IGsgPj4gdTsKLy8gICAgICAgIGlmKGsgPT0gMSl7Ci8vICAgICAgICAgICAgY2luID4+IHY7Ci8vICAgICAgICAgICAgaW50IGZ1ID0gZmluZCh1KTsKLy8gICAgICAgICAgICBpbnQgZnYgPSBmaW5kKHYpOwovLyAgICAgICAgICAgIGlmKGZ1ICE9IGZ2KSB7Ci8vICAgICAgICAgICAgICAgIGZhW2Z2XSA9IGZ1OwovLyAgICAgICAgICAgICAgICBzdW1bZnVdICs9IHN1bVtmdl07Ci8vICAgICAgICAgICAgICAgIGFbZnVdICs9IGFbZnZdOwovLyAgICAgICAgICAgIH0KLy8gICAgICAgIH1lbHNlIGlmKGsgPT0gMil7Ci8vICAgICAgICAgICAgY2luID4+IHY7Ci8vICAgICAgICAgICAgaW50IGZ1ID0gZmluZCh1KTsKLy8gICAgICAgICAgICBhW2Z1XSArPSB2ICogc3VtW2Z1XTsKLy8gICAgICAgIH1lbHNlewovLyAgICAgICAgICAgIGNvdXQgPDwKLy8gICAgICAgIH0KLy8gICAgfQovLyAgICByZXR1cm4gMDsKLy99CgoKI2luY2x1ZGUgImlvc3RyZWFtIgojaW5jbHVkZSAibWFwIgp1c2luZyBuYW1lc3BhY2Ugc3RkOwpjb25zdCBpbnQgTiA9IDJlNSArIDEwOwppbnQgYVtOXSAsIHN1bSA9IDA7CmludCBmYVtOXSAsIGJbTl07CmludCBuICwgazsKbWFwPGludCxpbnQ+IG1hcDE7CnZvaWQgSW5pdCgpewogICAgZm9yKGludCBpID0gMSA7IGkgPD0gbjtpKyspIHsKICAgICAgICBmYVtpXSA9IGk7CiAgICAgICAgYltpXSA9IDE7CiAgICB9Cn0KaW50IGZpbmQoaW50IHgpewogICAgcmV0dXJuIGZhW3hdID09IHggPyB4IDogZmluZChmYVt4XSk7Cn0KaW50IG1haW4oKXsKICAgIGNpbiA+PiBuID4+IGs7CiAgICBmb3IoaW50IGkgPSAxIDsgaSA8PSBuO2krKyl7CiAgICAgICAgY2luID4+IGFbaV07CiAgICAgICAgaWYoYVtpXSA9PSBpKSBzdW0rKzsKICAgIH0KICAgIGlmKGsgPT0gbiAtIDEpIGNvdXQgPDwgLTE7CiAgICBlbHNlewogICAgICAgIGlmKHN1bSA+PSBrKXsKICAgICAgICAgICAgaWYoKHN1bSAtIGspICUgMiA9PSAwKXsKICAgICAgICAgICAgICAgIGNvdXQgPDwgKHN1bSAtIGspIC8gMjsKICAgICAgICAgICAgfWVsc2V7CiAgICAgICAgICAgICAgICBjb3V0IDw8IChzdW0gLSBrKSAvIDIgKyAxOwogICAgICAgICAgICB9CiAgICAgICAgfWVsc2V7CiAgICAgICAgICAgIEluaXQoKTsKICAgICAgICAgICAgZm9yKGludCBpID0gMSA7IGkgPD0gbjtpKyspewogICAgICAgICAgICAgICAgaWYoYVtpXSAhPSBpICYmIGZhW2ldID09IGkpewogICAgICAgICAgICAgICAgICAgIGludCB6ID0gYVtpXTsKICAgICAgICAgICAgICAgICAgICB3aGlsZSh6ICE9IGkpewogICAgICAgICAgICAgICAgICAgICAgICBpbnQgZnogPSBmaW5kKHopOwogICAgICAgICAgICAgICAgICAgICAgICBpbnQgZmkgPSBmaW5kKGFbel0pOwogICAgICAgICAgICAgICAgICAgICAgICBpZihmeiAhPSBmaSl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmYVtmaV0gPSBmejsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJbZnpdICs9IGJbZmldOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIHogPSBhW3pdOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBtYXAxW2Jbel1dKys7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaW50IGFucyA9IDA7CiAgICAgICAgICAgIGsgLT0gc3VtOwogICAgICAgICAgICBmb3IoYXV0byBpIDogbWFwMSl7CiAgICAgICAgICAgICAgICBpZihpLmZpcnN0ID09IDEpIGNvbnRpbnVlOwogICAgICAgICAgICAgICAgaWYoayA9PSAxICYmIG4gLSBpLmZpcnN0ICogaS5zZWNvbmQgLSBzdW0gIT0gMCkgewogICAgICAgICAgICAgICAgICAgIGFucysrOwogICAgICAgICAgICAgICAgICAgIGsgPSAwOwogICAgICAgICAgICAgICAgfWVsc2UgaWYoayA8PSBpLmZpcnN0ICogaS5zZWNvbmQpewogICAgICAgICAgICAgICAgICAgIGFucyArPSAoayAvIGkuZmlyc3QpICogKGkuZmlyc3QgLSAxKSArIChrICUgaS5maXJzdCk7CiAgICAgICAgICAgICAgICAgICAgaWYoayAlIDIgPT0gMSAmJiBpLmZpcnN0ID09IDIpIGFucysrOwogICAgICAgICAgICAgICAgICAgIGsgPSAwOwogICAgICAgICAgICAgICAgfWVsc2V7CiAgICAgICAgICAgICAgICAgICAgYW5zICs9IChpLmZpcnN0IC0gMSkgKiBpLnNlY29uZDsKICAgICAgICAgICAgICAgICAgICBrIC09IGkuZmlyc3QgKiBpLnNlY29uZDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmKGsgPT0gMClicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgICBjb3V0IDw8IGFuczsKICAgICAgICB9CiAgICB9Cn0KCgovLyNpbmNsdWRlICJpb3N0cmVhbSIKLy8jaW5jbHVkZSAidmVjdG9yIgovLyNpbmNsdWRlICJtYXAiCi8vdXNpbmcgbmFtZXNwYWNlIHN0ZDsKLy9jb25zdCBpbnQgTiA9IDJlNSArIDEwOwovL3ZlY3RvcjxwYWlyPGludCxpbnQ+PiB2ZWNbTl07Ci8vbWFwPGludCxpbnQ+IG1hcDE7Ci8vaW50IGRmcyhpbnQgdSAsIGludCBmYSAsaW50IHgpewovLyAgICBpbnQgYW5zID0geDsKLy8gICAgZm9yKGF1dG8mW3YgLCB3XSA6IHZlY1t1XSl7Ci8vICAgICAgICBpZih2ID09IGZhKSBjb250aW51ZTsKLy8gICAgICAgIGFucyBePSBkZnModiAsIHUgLCB4IF4gdyk7Ci8vICAgIH0KLy8gICAgcmV0dXJuIGFuczsKLy99Ci8vaW50IG1haW4oKXsKLy8gICAgaW9zOjpzeW5jX3dpdGhfc3RkaW8oZmFsc2UpOwovLyAgICBjaW4udGllKDApOwovLyAgICBjb3V0LnRpZSgwKTsKLy8gICAgaW50IG4gLCBxOwovLyAgICBjaW4gPj4gbjsKLy8gICAgZm9yKGludCBpID0gMSA7IGkgPD0gbiAtIDE7aSsrKXsKLy8gICAgICAgIGludCB1ICwgdiAsIHc7Ci8vICAgICAgICBjaW4gPj4gdSA+PiB2ID4+IHc7Ci8vICAgICAgICB2ZWNbdV0ucHVzaF9iYWNrKHt2ICwgd30pOwovLyAgICAgICAgdmVjW3ZdLnB1c2hfYmFjayh7dSAsIHd9KTsKLy8gICAgfQovLyAgICBjaW4gPj4gcTsKLy8gICAgd2hpbGUocS0tKXsKLy8gICAgICAgIGludCB1ICwgeDsKLy8gICAgICAgIGNpbiA+PiB1ID4+IHg7Ci8vICAgICAgICBjb3V0IDw8IGRmcyh1ICwgdSAsIHgpIDw8IGVuZGw7Ci8vICAgIH0KLy99CgovLyNpbmNsdWRlICJpb3N0cmVhbSIKLy8jaW5jbHVkZSAibWFwIgovL3VzaW5nIG5hbWVzcGFjZSBzdGQ7Ci8vY29uc3QgaW50IE4gPSAyZTUgKyAxMDsKLy9pbnQgYVtOXTsKLy9tYXA8aW50LGludD4gbWFwMTsKLy9pbnQgbWFpbigpewovLyAgICBpbnQgbjsKLy8gICAgY2luID4+IG47Ci8vICAgIGZvcihpbnQgaSA9IDEgOyBpIDw9IG47aSsrKSB7Ci8vICAgICAgICBjaW4gPj4gYVtpXTsKLy8gICAgICAgIG1hcDFbYVtpXV0rKzsKLy8gICAgfQovLyAgICBpbnQgc3VtID0gMCAsIGFucyA9IDA7Ci8vICAgIGludCBsYXN0ID0gMDsKLy8gICAgZm9yKGF1dG8gaSA6IG1hcDEpewovLyAgICAgICAgaWYobiAtIGkuc2Vjb25kIC0gc3VtID09IHN1bSkgYW5zICs9IDE7Ci8vICAgICAgICBlbHNlIGlmKG4gLSBzdW0gLSBpLnNlY29uZCA9PSBzdW0gKyBpLnNlY29uZCkgbGFzdCA9IGkuZmlyc3QgKyAxOwovLyAgICAgICAgZWxzZSBpZihuIC0gc3VtID09IHN1bSkgYW5zICs9IGkuZmlyc3QgLSBsYXN0OwovLyAgICAgICAgc3VtICs9IGkuc2Vjb25kOwovLyAgICB9Ci8vICAgIGNvdXQgPDwgYW5zOwovL30="}]