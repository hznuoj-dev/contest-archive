[{"id":"32107","submission_id":"32107","filename":"main.cpp","source":"LyoKI2luY2x1ZGUgPGlvc3RyZWFtPgojaW5jbHVkZSA8Yml0cy9zdGRjKysuaD4KdXNpbmcgbmFtZXNwYWNlIHN0ZDsKY29uc3QgaW50IE49MmU1KzEwOwpjb25zdCBpbnQgbW9kPTFlOSs3Owpsb25nIGxvbmcgYVtOXSxmYVtOXTsKaW50IHBbTl0sY250W05dOwppbnQgZmluZChpbnQgeCkKewogICAgaWYocFt4XSE9eCkKICAgIHsKICAgICAgICBwW3hdPSBmaW5kKHBbeF0pOwogICAgfQogICAgcmV0dXJuIHBbeF07Cn0KaW50IG1haW4oKXsKICAgIGlvczo6c3luY193aXRoX3N0ZGlvKGZhbHNlKTsKICAgIGNpbi50aWUoMCk7CiAgICBjb3V0LnRpZSgwKTsKICAgIGludCBuLHE7CiAgICBjaW4gPj4gbiA+PiBxOwogICAgZm9yIChpbnQgaT0xO2k8PW47aSsrKQogICAgewogICAgICAgIGNpbiA+PiBhW2ldOwogICAgICAgIHBbaV09aTsKICAgICAgICBmYVtpXT1hW2ldOwogICAgICAgIGNudFtpXT0xOwogICAgfQogICAgd2hpbGUgKHEtLSkKICAgIHsKICAgICAgICBpbnQgbnVtOwogICAgICAgIGNpbiA+PiBudW07CiAgICAgICAgaWYobnVtPT0xKQogICAgICAgIHsKICAgICAgICAgICAgaW50IGEsYjsKICAgICAgICAgICAgY2luID4+IGEgPj4gYjsKICAgICAgICAgICAgYT0gZmluZChhKTsKICAgICAgICAgICAgYj0gZmluZChiKTsKICAgICAgICAgICAgcFthXT1iOwogICAgICAgICAgICBmYVtiXSs9ZmFbYV07CiAgICAgICAgICAgIGNudFtiXSs9Y250W2FdOwogICAgICAgIH1lbHNlIGlmKG51bT09MikKICAgICAgICB7CiAgICAgICAgICAgIGludCBhLGI7CiAgICAgICAgICAgIGNpbiA+PiBhID4+IGI7CiAgICAgICAgICAgIGE9IGZpbmQoYSk7CiAgICAgICAgICAgIGZhW2FdKz1iKmNudFthXTsKICAgICAgICB9ZWxzZSB7CiAgICAgICAgICAgIGludCBiOwogICAgICAgICAgICBjaW4gPj4gYjsKICAgICAgICAgICAgY291dCA8PCBhW2JdJW1vZCA8PCBlbmRsOwogICAgICAgIH0KICAgICAgICBmb3IgKGludCBpPTE7aTw9bjtpKyspCiAgICAgICAgewogICAgICAgICAgICBpbnQgZmF0aGVyPSBmaW5kKGkpOwogICAgICAgICAgICBhW2ldKz1mYVtmYXRoZXJdOwogICAgICAgIH0KICAgIH0KfQoqLwovKgojaW5jbHVkZSA8aW9zdHJlYW0+CiNpbmNsdWRlIDxiaXRzL3N0ZGMrKy5oPgp1c2luZyBuYW1lc3BhY2Ugc3RkOwpjb25zdCBpbnQgTj0yZTUrMTA7CmludCBhW05dOwppbnQgbWFpbigpewogICAgaW9zOjpzeW5jX3dpdGhfc3RkaW8oZmFsc2UpOwogICAgY2luLnRpZSgwKTsKICAgIGNvdXQudGllKDApOwogICAgaW50IG47CiAgICBjaW4gPj4gbjsKICAgIGludCBtaW5fbnVtPTEwMDAwMDAsbWF4X251bT0tMTsKICAgIGZvciAoaW50IGk9MTtpPD1uO2krKykKICAgIHsKICAgICAgICBjaW4gPj4gYVtpXTsKICAgICAgICBtaW5fbnVtPSBtaW4obWluX251bSxhW2ldKTsKICAgICAgICBtYXhfbnVtPSBtYXgobWF4X251bSxhW2ldKTsKICAgIH0KICAgICAgICBpbnQgYW5zPTA7CiAgICAgICAgZm9yIChpbnQgaT1taW5fbnVtO2k8PW1heF9udW07aSsrKQogICAgICAgIHsKICAgICAgICAgICAgc3RhY2s8aW50PiBzdDsKICAgICAgICAgICAgYm9vbCBzdWNjZXNzZnVsPSB0cnVlOwogICAgICAgICAgICBmb3IgKGludCBqPTE7ajw9bjtqKyspCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGlmKGFbal0+aSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAvLyApCiAgICAgICAgICAgICAgICAgICAgaWYoc3QuZW1wdHkoKSkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3NmdWw9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgICAgICBnb3RvIGExOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZXsKICAgICAgICAgICAgICAgICAgICAgICAgc3QucG9wKCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfWVsc2UgaWYoYVtqXTxpKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIC8vICgKICAgICAgICAgICAgICAgICAgICBzdC5wdXNoKDEpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGExOgogICAgICAgICAgICBpZighc3QuZW1wdHkoKSkgc3VjY2Vzc2Z1bD0gZmFsc2U7CiAgICAgICAgICAgIGlmKHN1Y2Nlc3NmdWwpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGFucysrOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGNvdXQgPDwgYW5zOwogICAgcmV0dXJuIDA7Cn0KKi8KI2luY2x1ZGUgPGlvc3RyZWFtPgojaW5jbHVkZSA8Yml0cy9zdGRjKysuaD4KdXNpbmcgbmFtZXNwYWNlIHN0ZDsKY29uc3QgaW50IE49MmU1KzEwOwppbnQgYVtOXTsKaW50IG5vd1tOXTsKaW50IG1haW4oKXsKICAgIGlvczo6c3luY193aXRoX3N0ZGlvKGZhbHNlKTsKICAgIGNpbi50aWUoMCk7CiAgICBjb3V0LnRpZSgwKTsKICAgIGludCBuLG0sYjsKICAgIGNpbiA+PiBuPj4gbSA+PmI7CiAgICBmb3IgKGludCBpPTA7aTxuO2krKykKICAgIHsKICAgICAgICBjaW4gPj4gYVtpXTsKICAgICAgICBpZihpPT0wKQogICAgICAgIHsKICAgICAgICAgICAgbm93W2ldPWFbaV07CiAgICAgICAgfWVsc2V7CiAgICAgICAgICAgIG5vd1tpXT1hW2ldK25vd1tpLTFdOwogICAgICAgIH0KICAgIH0KICAgIGludCBhbnM9LTE7CiAgICBmb3IgKGludCBpPTA7aTxtO2krKykKICAgIHsKICAgICAgICBpbnQgc3VtPW5vd1tpXTsgLy/njrDlnKjmnInlpJrlsJHkurrlnKjpmJ/liJfkuK0KICAgICAgICBpbnQgcmVzPTA7CiAgICAgICAgZm9yIChpbnQgaj1pO2o8bjtqKz1tKQogICAgICAgIHsKICAgICAgICAgICAgcmVzPSByZXMgKyBtaW4obm93W2pdLXJlcyxiKTsKICAgICAgICB9CiAgICAgICAgYW5zPSBtYXgoYW5zLHJlcyk7CiAgICB9CiAgICBjb3V0IDw8IGFuczsKICAgIHJldHVybiAwOwp9Cg=="}]