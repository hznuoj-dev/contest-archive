[{"id":"31812","submission_id":"31812","filename":"C.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+DQp1c2luZyBuYW1lc3BhY2Ugc3RkOw0KDQp0eXBlZGVmIGxvbmcgbG9uZyBMTDsNCnR5cGVkZWYgdW5zaWduZWQgbG9uZyBsb25nIFVMTDsNCi8vdHlwZWRlZiBfX2ludDEyOCBMTEw7DQoNCmludCByZWFkKCkgew0KICAgIGludCB4ID0gMCwgZiA9IDE7IGNoYXIgYyA9IGdldGNoYXIoKTsNCiAgICB3aGlsZShjIDwgJzAnIHx8IGMgPiAnOScpIGMgPT0gJy0nID8gZiA9IC0xOiAwLCBjID0gZ2V0Y2hhcigpOw0KCXdoaWxlKGMgPj0gJzAnICYmIGMgPD0gJzknKSB4ID0gKHggPDwgMSkgKyAoeCA8PCAzKSArIChjIF4gJzAnKSwgYyA9IGdldGNoYXIoKTsNCiAgICByZXR1cm4geCAqIGY7DQp9DQoNCmludCBudW1DbnRbXSA9IHs2LCAyLCA1LCA1LCA0LCA1LCA2LCAzLCA3LCA2fTsgLy8gMC05DQppbnQgVE51bVtdID0gezgsIDcsIC0xLCA5LCAtMSwgNiwgOCwgLTEsIC0xLCA4fTsgLy8gzO2809K7uPbWrrrzIA0KDQppbnQgTDFbMTUwXSwgTDJbMTUwXSwgUlsxNTBdOw0KaW50IExUMVsxNTBdLCBMVDJbMTUwXSwgUlRbMTUwXTsNCg0KaW50IHN0a1sxMDAwNTBdLCB0b3AsIHRyWzEwMDA1MF07DQoNCmludCBnZXRDbnQoaW50IHgsIGludCByID0gMCkgew0KICAgIGlmKHggPT0gMCkgcmV0dXJuIG51bUNudFswXTsNCiAgICB3aGlsZSh4KSByICs9IG51bUNudFt4ICUgMTBdLCB4IC89IDEwOw0KICAgIHJldHVybiByOw0KfQ0KDQp2b2lkIHByaW50KGJvb2wgZikgew0KICAgIHN0cmluZyBzID0gIiI7DQogICAgZm9yKGludCBpID0gMTsgaSA8PSB0b3A7ICsraSkgew0KICAgICAgICBpZih0cltpXSkgcyArPSAoY2hhcikoTFQxW3N0a1tpXV0gKyAnMCcpOw0KICAgICAgICBlbHNlIHMgKz0gKGNoYXIpKEwxW3N0a1tpXV0gKyAnMCcpOw0KICAgIH0NCiAgICBzICs9IGYgPyAiLSIgOiAiKyI7DQogICAgZm9yKGludCBpID0gMTsgaSA8PSB0b3A7ICsraSkgew0KICAgICAgICBpZih0cltpXSkgcyArPSAoY2hhcikoTFQyW3N0a1tpXV0gKyAnMCcpOw0KICAgICAgICBlbHNlIHMgKz0gKGNoYXIpKEwyW3N0a1tpXV0gKyAnMCcpOw0KICAgIH0NCiAgICBzICs9ICc9JzsNCiAgICBmb3IoaW50IGkgPSAxOyBpIDw9IHRvcDsgKytpKSB7DQogICAgICAgIGlmKHRyW2ldKSBzICs9IChjaGFyKShSVFtzdGtbaV1dICsgJzAnKTsNCiAgICAgICAgZWxzZSBzICs9IChjaGFyKShSW3N0a1tpXV0gKyAnMCcpOw0KICAgIH0NCiAgICBjb3V0IDw8IHMgPDwgZW5kbDsNCn0NCg0Kc2lnbmVkIG1haW4oKSB7DQogICAgDQovLyAgICBpbnQgc3RrWzEwMDBdLCB0b3AgPSAwOw0KICAgIGZvcihpbnQgaSA9IDA7IGkgPD0gOTsgKytpKSB7DQogICAgICAgIGZvcihpbnQgaiA9IGk7IGogPD0gOTsgKytqKSB7DQogICAgICAgICAgICBpZihpICsgaiA+IDkpIGJyZWFrOw0KICAgICAgICAgICAgaWYoaSA9PSAyICYmIGogPT0gMikgY29udGludWU7DQogICAgICAgICAgICANCiAgICAgICAgICAgIGludCBzID0gKGdldENudChpKSArIGdldENudChqKSArIGdldENudChpICsgaikpOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBpZighTDFbc10gfHwgIUwyW3NdKSB7DQogICAgICAgICAgICAgICAgTDFbc10gPSBMVDFbc10gPSBpLCBMMltzXSA9IExUMltzXSA9IGosIFJbc10gPSBSVFtzXSA9IGkgKyBqOw0KICAgICAgICAgICAgICAgIGlmKFROdW1bTDJbc11dICE9IC0xKSBMVDJbc10gPSBUTnVtW0wyW3NdXTsNCiAgICAgICAgICAgICAgICBlbHNlIGlmKFROdW1bTDFbc11dICE9IC0xKSBMVDFbc10gPSBUTnVtW0wxW3NdXTsNCiAgICAgICAgICAgICAgICBlbHNlIFJUW3NdID0gVE51bVtSVFtzXV07DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQovLyAgICBmb3IoaW50IGkgPSA5OyBpIDw9IDE3OyArK2kpIHsNCi8vICAgICAgICBjb3V0IDw8IGkgPDwgJyAnIDw8IEwxW2ldIDw8ICcrJyA8PCBMMltpXSA8PCAnPScgPDwgUltpXSA8PCAnICcgPDwgTFQxW2ldIDw8ICctJyA8PCBMVDJbaV0gPDwgJz0nIDw8IFJUW2ldIDw8ICcgJyA8PCBlbmRsOw0KLy8gICAgfQ0KICAgIA0KICAgIGludCB0ID0gcmVhZCgpOw0KICAgIHdoaWxlKHQtLSkgew0KICAgICAgICBpbnQgbiA9IHJlYWQoKTsNCiAgICAgICAgaWYobiA8IDkgKyA0KSB7DQogICAgICAgICAgICBpZihuID09IDEyKSBjb3V0IDw8ICIzPTUiIDw8IGVuZGwgPDwgIjU9NSIgPDwgZW5kbDsNCiAgICAgICAgICAgIGVsc2UgY291dCA8PCAiTm8gU29sdXRpb24iIDw8IGVuZGw7DQogICAgICAgIH0NCiAgICAgICAgZWxzZSB7DQogICAgICAgICAgICBuIC09IDQ7DQogICAgICAgICAgICANCiAgICAgICAgICAgIHN0cmluZyBzMSwgczI7DQogICAgICAgICAgICBpbnQgayA9IG4gLyA5IC0gMSwgZCA9IG4gJSA5ICsgOTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgdG9wID0gMDsNCiAgICAgICAgICAgIGZvcihpbnQgaSA9IDE7IGkgPD0gazsgKytpKSBzdGtbKyt0b3BdID0gOSwgdHJbdG9wXSA9IDA7DQogICAgICAgICAgICBzdGtbKyt0b3BdID0gZCwgdHJbdG9wXSA9IDA7DQogICAgICAgICAgICANCiAgICAgICAgICAgIHRyWzFdID0gMSwgcHJpbnQodHJ1ZSk7DQogICAgICAgICAgICB0clsxXSA9IDAsIHByaW50KGZhbHNlKTsNCiAgICAgICAgfQ0KICAgIH0NCiAgICByZXR1cm4gMDsNCn0NCg0K"}]