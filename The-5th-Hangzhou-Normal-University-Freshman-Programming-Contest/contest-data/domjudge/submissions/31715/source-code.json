[{"id":"31715","submission_id":"31715","filename":"L.cpp","source":"I2luY2x1ZGU8Yml0cy9zdGRjKysuaD4NCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQpjb25zdCBpbnQgTiA9IDEwMDA1Ow0KaW50IGFbTl0sYltOXTsNCmRvdWJsZSBhbnM7DQppbnQgbWFpbigpDQp7DQoJaW50IG0sIGs7DQogICAgY2luID4+IG0gPj4gazsNCiAgICBjb3V0PDxmaXhlZDw8c2V0cHJlY2lzaW9uKDIpOw0KICAgIGZvciAoaW50IGkgPSAxOyBpIDw9IDU7IGkrKykNCiAgICB7DQogICAgICBjaW4gPj4gYVtpXTsNCiAgICB9DQogICAgZm9yIChpbnQgaSA9IDE7IGkgPD0gNTsgaSsrKQ0KICAgICAgICBjaW4gPj4gYltpXTsNCiAgICBmb3IgKGludCBpID0gMTsgaSA8PSA1OyBpKyspDQogICAgew0KICAgICAgICBpbnQgc3VtID0gYVtpXTsNCiAgICAgICAgaW50IG1hbnlpemhpID0gYltpXTsNCiAgICAgICAgaWYgKHN1bSA+PSBtKXN1bSAtPSBrOw0KICAgICAgICBpZiAobWFueWl6aGkgKiAxLjAgLyBzdW0gPiBhbnMpDQoJCWFucyA9IG1hbnlpemhpICogMS4wIC8gc3VtOw0KICAgIH0NCiAgICBmb3IgKGludCBpID0gMTsgaSA8PSA1OyBpKyspDQogICAgew0KICAgICAgICBmb3IgKGludCBqID0gaSsxOyBqIDw9IDU7IGorKykNCiAgICAgICAgew0KICAgICAgICAgICAgaW50IHN1bSA9IGFbaV0rYVtqXTsNCiAgICAgICAgICAgIGludCBtYW55aXpoaSA9IGJbaV0rYltqXTsNCiAgICAgICAgICAgIGlmIChzdW0gPj0gbSlzdW0gLT0gazsNCiAgICAgICAgICAgIGlmIChtYW55aXpoaSAqIDEuMCAvIHN1bSA+IGFucykNCgkJCWFucyA9IG1hbnlpemhpICogMS4wIC8gc3VtOw0KICAgICAgICB9DQogICAgfQ0KICAgIGZvciAoaW50IGkgPSAxOyBpIDw9IDU7IGkrKykNCiAgICB7DQogICAgICAgIGZvciAoaW50IGogPSBpKzE7IGogPD0gNTsgaisrKQ0KICAgICAgICB7DQogICAgICAgICAgICBmb3IgKGludCB0ID0gaiArIDE7IHQgPD0gNTsgdCsrKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGludCBzdW0gPSBhW2ldICsgYVtqXSthW3RdOw0KICAgICAgICAgICAgICAgIGludCBtYW55aXpoaSA9YltpXSArIGJbal0gKyBiW3RdIDsNCiAgICAgICAgICAgICAgICBpZiAoc3VtID49IG0pc3VtIC09IGs7DQogICAgICAgICAgICAgICAgaWYgKG1hbnlpemhpICogMS4wIC9zdW0gPiBhbnMpDQoJCQkJYW5zID0gbWFueWl6aGkgKiAxLjAgLyBzdW07DQogICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCiAgICBmb3IgKGludCBpID0gMTsgaSA8PSA1OyBpKyspDQogICAgew0KICAgICAgICBmb3IgKGludCBqID0gaSArIDE7IGogPD0gNTsgaisrKQ0KICAgICAgICB7DQogICAgICAgICAgICBmb3IgKGludCB0ID0gaiArIDE7IHQgPD0gNTsgdCsrKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGZvciAoaW50IHcgPSB0ICsgMTsgdyA8PSA1OyB3KyspDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICBpbnQgc3VtID0gYVtpXSArIGFbal0gKyBhW3RdK2Fbd107DQogICAgICAgICAgICAgICAgICAgIGludCBtYW55aXpoaSA9IGJbaV0gKyBiW2pdICsgYlt0XStiW3ddOw0KICAgICAgICAgICAgICAgICAgICBpZiAoc3VtID49IG0pc3VtIC09IGs7DQogICAgICAgICAgICAgICAgICAgIGlmIChtYW55aXpoaSAqIDEuMCAvIHN1bSA+IGFucykNCgkJCQkJYW5zID0gbWFueWl6aGkgKiAxLjAgLyBzdW07DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KICAgIGludCBzdW0sbWFueWl6aGk7DQogICAgZm9yKGludCBpPTE7aTw9NTtpKyspDQogICAgew0KCQlzdW0rPWFbaV07DQoJCW1hbnlpemhpKz1iW2ldOw0KCX0NCiAgICBpZiAoc3VtID49IG0pc3VtIC09IGs7DQogICAgaWYgKG1hbnlpemhpICogMS4wIC8gc3VtID4gYW5zKQ0KCWFucyA9IG1hbnlpemhpICogMS4wIC8gc3VtOw0KICAgIGNvdXQ8PGFuczsNCiAgICByZXR1cm4gMDsNCn0NCg=="}]