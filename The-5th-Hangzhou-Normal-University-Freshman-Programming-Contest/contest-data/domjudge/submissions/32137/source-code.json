[{"id":"32137","submission_id":"32137","filename":"D.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+DQojZGVmaW5lIGludCBsb25nIGxvbmcNCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQoNCnR5cGVkZWYgbG9uZyBsb25nIExMOw0KdHlwZWRlZiB1bnNpZ25lZCBsb25nIGxvbmcgVUxMOw0KLy90eXBlZGVmIF9faW50MTI4IExMTDsNCg0KaW50IHJlYWQoKSB7DQogICAgaW50IHggPSAwLCBmID0gMTsgY2hhciBjID0gZ2V0Y2hhcigpOw0KICAgIHdoaWxlKGMgPCAnMCcgfHwgYyA+ICc5JykgYyA9PSAnLScgPyBmID0gLTE6IDAsIGMgPSBnZXRjaGFyKCk7DQoJd2hpbGUoYyA+PSAnMCcgJiYgYyA8PSAnOScpIHggPSAoeCA8PCAxKSArICh4IDw8IDMpICsgKGMgXiAnMCcpLCBjID0gZ2V0Y2hhcigpOw0KICAgIHJldHVybiB4ICogZjsNCn0NCg0KaW50IHFwb3coaW50IGEsIGludCBrLCBpbnQgciA9IDEpIHsNCglmb3IoOyBrOyBrID4+PSAxLCBhID0gYSAqIGEpDQoJCWlmKGsgJiAxKSByID0gciAqIGE7DQoJcmV0dXJuIHI7DQp9DQoNCmludCBuLCBrLCBxLCBhWzIwMDA1MF0sIFJbMjAwMDUwXTsNCmludCBzdG14WzI1XVsyMDAwNTBdLCBzdG1uWzI1XVsyMDAwNTBdOw0KaW50IGlkWzIwMDA1MF0sIHFsWzIwMDA1MF0sIHFyWzIwMDA1MF07DQpMTCBhbnNbMjAwMDUwXSwgYlsyMDAwNTBdLCBjWzIwMDA1MF07DQp2ZWN0b3I8aW50PiBlcVsyMDAwNTBdOw0KDQpMTCBxcnkoTEwgYltdLCBpbnQgaSwgTEwgciA9IDApIHsNCiAgICBmb3IoOyBpOyBpIC09IChpICYgLWkpKSByICs9IGJbaV07DQogICAgcmV0dXJuIHI7DQp9DQoNCnZvaWQgYWRkKExMIGJbXSwgaW50IGksIExMIHYpIHsNCiAgICBmb3IoOyBpIDw9IG47IGkgKz0gKGkgJiAtaSkpIGJbaV0gKz0gdjsNCn0NCg0KaW50IGdldE1heChpbnQgbCwgaW50IHIpIHsNCiAgICBpbnQgayA9IGxvZzIociAtIGwgKyAxKTsNCiAgICByZXR1cm4gbWF4KHN0bXhba11bbF0sIHN0bXhba11bciAtICgxIDw8IGspICsgMV0pOw0KfQ0KDQppbnQgZ2V0TWluKGludCBsLCBpbnQgcikgew0KICAgIGludCBrID0gbG9nMihyIC0gbCArIDEpOw0KICAgIHJldHVybiBtaW4oc3RtbltrXVtsXSwgc3RtbltrXVtyIC0gKDEgPDwgaykgKyAxXSk7DQp9DQoNCmJvb2wgY2hrKGludCBsLCBpbnQgciwgaW50IGspIHsNCiAgICByZXR1cm4gZ2V0TWF4KGwsIHIpIC0gZ2V0TWluKGwsIHIpIDw9IGs7DQp9DQoNCnZvaWQgaW5zKGludCBpKSB7DQogICAgZm9yKGludCB4IDogZXFbaV0pIHsNCiAgICAgICAgTEwgeiA9IHFyeShiLCB4KSAtIHFyeShiLCB4IC0gMSk7DQogICAgICAgIGFkZChiLCB4LCAteiArIGkpOw0KICAgICAgICBhZGQoYywgeCwgMSk7DQogICAgfQ0KfQ0KDQpzaWduZWQgbWFpbigpIHsNCiAgICBtZW1zZXQoc3RteCwgMCwgc2l6ZW9mIHN0bXgpOw0KICAgIG1lbXNldChzdG1uLCAweDNmLCBzaXplb2Ygc3Rtbik7DQogICAgDQogICAgbiA9IHJlYWQoKSwgayA9IHJlYWQoKSwgcSA9IHJlYWQoKTsNCiAgICBmb3IoaW50IGkgPSAxOyBpIDw9IG47ICsraSkgYVtpXSA9IHN0bXhbMF1baV0gPSBzdG1uWzBdW2ldID0gcmVhZCgpOw0KICAgIA0KICAgIGZvcihpbnQgayA9IDE7IGsgPD0gMjA7ICsraykgew0KICAgICAgICBmb3IoaW50IGkgPSAxOyBpICsgKDEgPDwgaykgLSAxIDw9IG47ICsraSkgew0KICAgICAgICAgICAgc3RteFtrXVtpXSA9IG1heChzdG14W2sgLSAxXVtpXSwgc3RteFtrIC0gMV1baSArICgxIDw8IGsgLSAxKV0pOw0KICAgICAgICAgICAgc3RtbltrXVtpXSA9IG1pbihzdG1uW2sgLSAxXVtpXSwgc3RtbltrIC0gMV1baSArICgxIDw8IGsgLSAxKV0pOw0KICAgICAgICB9DQogICAgfQ0KICAgIA0KICAgIGZvcihpbnQgaSA9IDE7IGkgPD0gbjsgKytpKSB7DQogICAgICAgIGludCBsID0gaSwgciA9IG47DQogICAgICAgIHdoaWxlKGwgPCByKSB7DQogICAgICAgICAgICBpbnQgbWlkID0gbCArIHIgKyAxID4+IDE7DQogICAgICAgICAgICBpZihjaGsoaSwgbWlkLCBrKSkgbCA9IG1pZDsNCiAgICAgICAgICAgIGVsc2UgciA9IG1pZCAtIDE7DQogICAgICAgIH0NCiAgICAgICAgZXFbbF0ucHVzaF9iYWNrKGkpOw0KICAgIH0NCiAgICANCiAgICBmb3IoaW50IGkgPSAxOyBpIDw9IHE7ICsraSkNCiAgICAgICAgYVtpXSA9IGksIGlkW2ldID0gaSwgcWxbaV0gPSByZWFkKCksIHFyW2ldID0gcmVhZCgpOw0KICAgIA0KICAgIHNvcnQoYSArIDEsIGEgKyBxICsgMSwgW10oaW50IHgsIGludCB5KSAtPiBib29sIHsNCiAgICAgICAgcmV0dXJuIHFyW3hdID09IHFyW3ldID8gcWxbeF0gPCBxbFt5XSA6IHFyW3hdIDwgcXJbeV07DQogICAgfSk7DQogICAgDQogICAgaW50IHIgPSAwOw0KICAgIGZvcihpbnQgcCA9IDE7IHAgPD0gcTsgKytwKSB7DQogICAgICAgIGludCBpID0gYVtwXTsNCiAgICAgICAgd2hpbGUociA8IHFyW2ldKSBpbnMoKytyKTsNCiAgICAgICAgTEwgeCA9IHFyeShiLCBxcltpXSkgLSBxcnkoYiwgcWxbaV0gLSAxKTsNCiAgICAgICAgTEwgeSA9IChxcltpXSAtIHFsW2ldICsgMSAtIHFyeShjLCBxcltpXSkgKyBxcnkoYywgcWxbaV0gLSAxKSkgKiByOw0KICAgICAgICANCi8vICAgICAgICBjb3V0IDw8IHFsW2ldIDw8ICcgJyA8PCBxcltpXSA8PCAnICcgPDwgeCA8PCAnICcgPDwgeSA8PCBlbmRsOw0KICAgICAgICANCiAgICAgICAgYW5zW2lkW2ldXSA9IHggKyB5IC0gMWxsICogKHFsW2ldICsgcXJbaV0pICogKHFyW2ldIC0gcWxbaV0gKyAxKSAvIDIgKyAocXJbaV0gLSBxbFtpXSArIDEpOw0KICAgIH0NCiAgICANCiAgICBmb3IoaW50IGkgPSAxOyBpIDw9IHE7ICsraSkgcHJpbnRmKCIlbGxkXG4iLCBhbnNbaV0pOw0KICAgIHJldHVybiAwOw0KfQ0KDQo="}]