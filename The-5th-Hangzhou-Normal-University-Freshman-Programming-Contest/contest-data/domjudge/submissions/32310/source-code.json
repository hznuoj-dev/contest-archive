[{"id":"32310","submission_id":"32310","filename":"D.cpp","source":"I2luY2x1ZGU8Yml0cy9zdGRjKysuaD4NCnR5cGVkZWYgbG9uZyBsb25nIGxsOyB1c2luZyBuYW1lc3BhY2Ugc3RkOw0KI2RlZmluZSBpbnQgbG9uZyBsb25nDQojZGVmaW5lIGZ1KGksIGEsIGIpIGZvcihpbnQgaSA9IChhKSwgZWQgPSAoYik7IGkgPD0gZWQ7ICsraSkNCiNkZWZpbmUgZmQoaSwgYSwgYikgZm9yKGludCBpID0gKGEpLCBlZCA9IChiKTsgaSA+PSBlZDsgLS1pKQ0KI2RlZmluZSBQUk4oWCkgY291dCA8PCAjWCA8PCAiPSIgPDwgWCA8PCBlbmRsDQojZGVmaW5lIFBSKFgpIGNvdXQgPDwgI1ggPDwgIj0iIDw8IFggPDwgIiAiDQoNCg0KY29uc3QgaW50IE4gPSAyZTUgKyA1Ow0KDQppbnQgcmVhZCgpIHsNCiAgICBpbnQgZiA9IDEsIHggPSAwOyBjaGFyIGNoID0gZ2V0Y2hhcigpOw0KICAgIHdoaWxlIChjaCA+ICc5JyB8fCBjaCA8ICcwJykgeyBpZiAoY2ggPT0gJy0nKWYgPSAtMTsgY2ggPSBnZXRjaGFyKCk7IH0NCiAgICB3aGlsZSAoY2ggPD0gJzknICYmIGNoID49ICcwJykgeyB4ID0gKHggPDwgMSkgKyAoeCA8PCAzKSArIChjaCBeIDQ4KTsgIGNoID0gZ2V0Y2hhcigpOyB9DQogICAgcmV0dXJuIHggKiBmOw0KfQ0Kc3RydWN0IHRyZWUvL8/fts7K973hubkNCnsNCiAgICBpbnQgbCwgcjsvL7T6se292rXjzqy7pLXEx/i85Le2zqc7DQogICAgbGwgZGF0YTsgLy+0+rHtuMO92rXjzqy7pLXE1rU7DQogICAgbGwgbGF6eTsgLy/J5rywbGF6ebHqvMe1xLarzvcs09DKsbrybGF6ebK71rnSu7j2KMnmvLC1vcf4vOTQ3rjEyrG74cq508O1vSk7DQp9dFtOICogMTBdOy8vz9+2zsr30ruw47+qNLG2v9W85CzWwdPazqrKssO0wu8sztLSsrK71qq1wCy8x9ehvs26w7rZutk7DQppbmxpbmUgaW50IGxzb24oaW50IHApIHsgcmV0dXJuIHAgPDwgMTsgfS8v1/O2+dfTOw0KaW5saW5lIGludCByc29uKGludCBwKSB7IHJldHVybiBwIDw8IDEgfCAxOyB9Ly/T0rb519M7DQp2b2lkIGJ1aWxkKGludCBwLCBpbnQgbCwgaW50IHIpDQp7DQogICAgdFtwXS5sID0gbCwgdFtwXS5yID0gcjsvL9LUcM6qseC6xbXEvdq1486su6S1xMf4vOTOqltsLHJdOw0KICAgIGlmIChsID09IHIpCQkJICAvL9K219O92rXjtOa3xdXmyrW1xMr91rU7DQogICAgew0KICAgICAgICB0W3BdLmRhdGEgPSAwOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIGludCBtaWQgPSB0W3BdLmwgKyB0W3BdLnIgPj4gMTsvL9LUtbHHsMf4vOTW0LXjzqq9572owaLX89PStvnX0zsNCiAgICBidWlsZChwIDw8IDEsIGwsIG1pZCk7Ly8NCiAgICBidWlsZChwIDw8IDEgfCAxLCBtaWQgKyAxLCByKTsNCg0KICAgIC8vu9jL3cqxvavG5NfTvdq147XE0MXPorTmz8LAtChwdXNoX3VwstnX9yk7DQogICAgdFtwXS5kYXRhID0gdFtsc29uKHApXS5kYXRhICsgdFtyc29uKHApXS5kYXRhOw0KfQ0Kdm9pZCBwdXNoX2Rvd24oaW50IHApLy+13bnptb2077Wxx7C92rXjOw0Kew0KICAgIGlmICh0W3BdLmxhenkpDQogICAgew0KICAgICAgICAvL8jnuftsYXp5seq8x7K7zqowLL7NvavG5M/CtKss0N64xNfz09K2+dfTzqy7pLXE1rU7DQogICAgICAgIHRbbHNvbihwKV0uZGF0YSArPSB0W3BdLmxhenkgKiAodFtsc29uKHApXS5yIC0gdFtsc29uKHApXS5sICsgMSk7DQogICAgICAgIHRbcnNvbihwKV0uZGF0YSArPSB0W3BdLmxhenkgKiAodFtyc29uKHApXS5yIC0gdFtyc29uKHApXS5sICsgMSk7DQoNCiAgICAgICAgLy+908zmuLjH17XEyM7O8Sy1yLT9u/q74c/CtKs7DQogICAgICAgIHRbbHNvbihwKV0ubGF6eSArPSB0W3BdLmxhenk7DQogICAgICAgIHRbcnNvbihwKV0ubGF6eSArPSB0W3BdLmxhenk7DQoNCiAgICAgICAgdFtwXS5sYXp5ID0gMDsvL8/CtKvN6rPJLLj80MJsYXp5zqowOw0KICAgIH0NCn0NCnZvaWQgdXBkYXRlKGludCBwLCBpbnQgbCwgaW50IHIsIGxsIHZhbHVlKQ0Kew0KICAgIGlmIChsIDw9IHRbcF0ubCAmJiByID49IHRbcF0ucikvL8f4vOSxu7iyuMcsvs3Q3rjEOw0KICAgIHsNCiAgICAgICAgdFtwXS5kYXRhICs9IHZhbHVlICogKHRbcF0uciAtIHRbcF0ubCArIDEpOw0KICAgICAgICB0W3BdLmxhenkgKz0gdmFsdWU7DQogICAgICAgIHJldHVybjsNCiAgICB9DQoNCiAgICAvL8jnufvDu9PQsbu4srjHLMTHvs3Q6NKqvMzQ+M/yz8LV0jsNCiAgICBwdXNoX2Rvd24ocCk7Ly/P8s/CuPzQwrb519O92rXjtcTK/b7dOw0KICAgIC8vv7zCx7b519PL+c6su6S1xMf4vOS/ycTc0vLOqsDBseq8x7XEtObU2rb4w7vT0NDeuMQs0vK0y72rwMGx6rzHz8K3xTsNCg0KICAgIGludCBtaWQgPSB0W3BdLmwgKyB0W3BdLnIgPj4gMTsNCiAgICBpZiAobCA8PSBtaWQpdXBkYXRlKGxzb24ocCksIGwsIHIsIHZhbHVlKTsvL7iyuMfBy9fztvnX077N0N64xNfztvnX0zsNCiAgICBpZiAociA+IG1pZCl1cGRhdGUocnNvbihwKSwgbCwgciwgdmFsdWUpOy8vuLK4x8HL09K2+dfTvs3Q3rjE09K2+dfTOw0KDQogICAgdFtwXS5kYXRhID0gdFtsc29uKHApXS5kYXRhICsgdFtyc29uKHApXS5kYXRhOy8vz/LJz7j80MK4uMfXvdq147XEyv2+3TsNCn0NCmxsIHF1ZXJ5U3VtKGludCBwLCBpbnQgbCwgaW50IHIpDQp7DQogICAgaWYgKGwgPD0gdFtwXS5sICYmIHIgPj0gdFtwXS5yKXJldHVybiB0W3BdLmRhdGE7Ly+4srjHwcu4w8f4vOQNCg0KICAgIHB1c2hfZG93bihwKTsvL7TLtKa1xHB1c2hfZG93brrNdXBkYXRluq/K/crH0ru49rqs0uU7DQoNCiAgICBsbCBzdW0gPSAwOw0KICAgIGludCBtaWQgPSB0W3BdLmwgKyB0W3BdLnIgPj4gMTsNCiAgICBpZiAobCA8PSBtaWQpc3VtICs9IHF1ZXJ5U3VtKGxzb24ocCksIGwsIHIpOy8v1fu6z9fztvnX07XEyv2+3TsNCiAgICBpZiAociA+IG1pZClzdW0gKz0gcXVlcnlTdW0ocnNvbihwKSwgbCwgcik7Ly/V+7rP09K2+dfTtcTK/b7dOw0KDQogICAgcmV0dXJuIHN1bTsvL8DbvNO08LC4t7W72Nfz09K2+dfTtcS6zTsNCn0NCg0KaW50IGFbTl0sIG4sIExbTl07DQpzdHJ1Y3QgUXVlc3Rpb24gew0KICAgIGludCBsLCByLCByazsNCn07DQpib29sIGNtcChRdWVzdGlvbiBhLCBRdWVzdGlvbiBiKSB7DQogICAgaWYgKGEuciAhPSBiLnIpIHJldHVybiBhLnIgPCBiLnI7DQogICAgcmV0dXJuIGEubCA8IGIubDsNCn0NCnZvaWQgc29sdmUoKSB7DQogICAgbiA9IHJlYWQoKTsgaW50IGsgPSByZWFkKCk7IGludCBxID0gcmVhZCgpOw0KICAgIGRlcXVlPGludD4gcTEsIHEyOw0KICAgIGludCBub3cgPSAxOw0KICAgIGZ1KGksIDEsIG4pIHsNCiAgICAgICAgYVtpXSA9IHJlYWQoKTsNCiAgICAgICAgd2hpbGUgKCFxMS5lbXB0eSgpICYmIGFbcTEuYmFjaygpXSA8PSBhW2ldKSBxMS5wb3BfYmFjaygpOw0KICAgICAgICB3aGlsZSAoIXEyLmVtcHR5KCkgJiYgYVtxMi5iYWNrKCldID49IGFbaV0pIHEyLnBvcF9iYWNrKCk7DQogICAgICAgIHExLnB1c2hfYmFjayhpKSwgcTIucHVzaF9iYWNrKGkpOw0KICAgICAgICANCiAgICAgICAgd2hpbGUgKGFbcTEuZnJvbnQoKV0gLSBhW3EyLmZyb250KCldID4gaykgew0KICAgICAgICAgICAgaWYgKHExLmZyb250KCkgPCBxMi5mcm9udCgpKSBub3cgPSBxMS5mcm9udCgpICsgMSwgcTEucG9wX2Zyb250KCk7DQogICAgICAgICAgICBlbHNlIG5vdyA9IHEyLmZyb250KCkgKyAxLCBxMi5wb3BfZnJvbnQoKTsNCiAgICAgICAgfQ0KICAgICAgICBMW2ldID0gbm93Ow0KICAgIH0NCiAgICAvL2Z1KGksIDEsIG4pIFBSKExbaV0pOw0KICAgIHZlY3RvcjxpbnQ+IGFucyhxICsgMSk7DQogICAgdmVjdG9yPFF1ZXN0aW9uPiBROw0KICAgIGJ1aWxkKDEsIDEsIG4pOw0KICAgIGZ1KGksIDEsIHEpIHsNCiAgICAgICAgaW50IGwgPSByZWFkKCksIHIgPSByZWFkKCk7DQogICAgICAgIFEucHVzaF9iYWNrKHsgbCwgciwgaSB9KTsNCiAgICB9DQogICAgc29ydChRLmJlZ2luKCksIFEuZW5kKCksIGNtcCk7DQogICAgaW50IG5vd0wgPSBuICsgMSwgbm93UiA9IG4gKyAxOw0KICAgIG5vdyA9IDE7DQogICAgZnUoaSwgMCwgcSAtIDEpIHsNCiAgICAgICAgd2hpbGUgKG5vdyA8PSBRW2ldLnIpIHVwZGF0ZSgxLCBMW25vd10sIG5vdywgMSksIG5vdysrOw0KICAgICAgICBhbnNbUVtpXS5ya10gPSBxdWVyeVN1bSgxLCBRW2ldLmwsIFFbaV0ucik7DQogICAgfQ0KICAgIGZ1KGksIDEsIHEpIGNvdXQgPDwgYW5zW2ldIDw8ICJcbiI7DQoNCn0NCnNpZ25lZCBtYWluKCkgew0KICAgIGludCB0ID0gMTsNCiAgICB3aGlsZSAodC0tKSB7DQogICAgICAgIHNvbHZlKCk7DQogICAgfQ0KfQ0KDQoNCg=="}]