[{"id":"32037","submission_id":"32037","filename":"main.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+DQoNCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQoNCnR5cGVkZWYgbG9uZyBsb25nIGxsOw0KdHlwZWRlZiBsb25nIGRvdWJsZSBsZDsNCg0KI2RlZmluZSBkbCA8PCJcbiINCiNkZWZpbmUgcHViIHB1c2hfYmFjaw0KI2RlZmluZSBwb2IgcG9wX2JhY2sNCiNkZWZpbmUgcG9mIHBvcF9mcm9udA0KI2RlZmluZSBwdWYgcHVzaF9mcm9udA0KI2RlZmluZSBlcHMgMWUtNg0KI2RlZmluZSBNQVhYIDFlNSsxDQojZGVmaW5lIElPUyBpb3M6OnN5bmNfd2l0aF9zdGRpbyhmYWxzZSksIGNpbi50aWUoMCksIGNvdXQudGllKDApDQoNCi8vY29uc3QgbGwgSU5GID0gMHgzZjNmM2YzZjNmM2YzZjNmOw0KY29uc3QgaW50IGluZiA9IDB4M2YzZjNmM2YsIG1vZCA9IDEwMDAwMDAwMDcsIHJnZTEgPSAxMDAwMTAwLCByZ2UyID0gMTAwMDE7DQoNCi8vbGwgc1syMDAwMDFdID0geyAwIH07DQoNCi8qDQpkb3VibGUgbSA9IDAsIGsgPSAwOw0KZG91YmxlIGQgPSAwOw0KDQpzdHJ1Y3QgR09PRCB7DQogICAgZG91YmxlIHA7Ly9wcmljZQ0KICAgIGRvdWJsZSBjOy8vY29tbWVudA0KICAgIGRvdWJsZSByOy8vcmF0ZQ0KfTsNCg0KR09PRCBnWzVdOw0KDQpib29sIG1jKEdPT0QgeCwgR09PRCB5KSB7DQoNCiAgICBpZiAoeC5yICE9IHkucikgew0KDQogICAgICAgIGlmICh4LnIgPiB5LnIpIHsNCiAgICAgICAgICAgIGQgKz0geC5wOw0KICAgICAgICB9DQogICAgICAgIGVsc2Ugew0KICAgICAgICAgICAgZCArPSB5LnA7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4geC5yID4geS5yOw0KICAgIH0NCiAgICBlbHNlIHsNCg0KICAgICAgICBpZiAoeC5wID49IChtIC0gZCkpIHsNCg0KICAgICAgICAgICAgaWYgKHkucCA8IChtIC0gZCkpIHsNCiAgICAgICAgICAgICAgICBkICs9IHgucDsNCiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGVsc2Ugew0KDQogICAgICAgICAgICAgICAgaWYgKHgucCA8IHkucCkgew0KICAgICAgICAgICAgICAgICAgICBkICs9IHgucDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIGQgKz0geS5wOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIHJldHVybiB4LnAgPCB5LnA7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgfQ0KICAgICAgICBlbHNlIHsNCg0KICAgICAgICAgICAgaWYgKHkucCA+PSAobSAtIGQpKSB7DQogICAgICAgICAgICAgICAgZCArPSB5LnA7DQogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgZWxzZSB7DQoNCiAgICAgICAgICAgICAgICBpZiAoeC5wID4geS5wKSB7DQogICAgICAgICAgICAgICAgICAgIGQgKz0geC5wOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgZCArPSB5LnA7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgcmV0dXJuIHgucCA+IHkucDsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICB9DQogICAgDQogICAgfQ0KDQp9DQoqLw0KDQoNCnZvaWQgTG9saXRhU2FtYSgpIHsNCg0KICAgIC8qDQogICAgTA0KDQogICAgbGwgbiA9IDAsIGsgPSAwOw0KICAgIGNpbiA+PiBuID4+IGs7DQoNCiAgICBsbCBjID0gMDsNCg0KICAgIGZvciAobGwgaSA9IDE7IGkgPD0gbjsgaSsrKSB7DQogICAgICAgIGNpbiA+PiBzW2ldOw0KICAgICAgICBpZiAoc1tpXSA9PSBpKSBjKys7DQogICAgfQ0KDQogICAgaWYgKG4gPT0gayArIDEpIHsNCiAgICAgICAgY291dCA8PCAiLTEiIGRsOw0KICAgIH0NCiAgICBlbHNlIHsNCiAgICAgICAgY291dCA8PCAoYyArIDEgLSBrKSAvIDIgZGw7DQogICAgfQ0KICAgICovDQoNCiAgICAvKg0KICAgIGNpbiA+PiBtID4+IGs7DQoNCiAgICBmb3IgKGludCBpID0gMDsgaSA8IDU7IGkrKykgew0KICAgICAgICBjaW4gPj4gZ1tpXS5wOw0KICAgIH0NCiAgICBmb3IgKGludCBpID0gMDsgaSA8IDU7IGkrKykgew0KICAgICAgICBjaW4gPj4gZ1tpXS5jOw0KICAgICAgICBnW2ldLnIgPSBnW2ldLmMgLyBnW2ldLnA7DQogICAgfQ0KDQogICAgc29ydChnLCBnICsgNSwgbWMpOw0KDQogICAgZG91YmxlIHN1bXAgPSAwOw0KICAgIGRvdWJsZSBzdW1jID0gMDsNCiAgICBkb3VibGUgcmVtID0gZ1swXS5yOw0KDQogICAgZm9yIChpbnQgaSA9IDA7IGkgPCA1O2krKykgew0KICAgIA0KICAgICAgICBzdW1wICs9IGdbaV0ucDsNCiAgICAgICAgc3VtYyArPSBnW2ldLmM7DQogICAgICAgIGlmIChzdW1wID49IG0pIHsNCiAgICAgICAgICAgIGNvdXQgPDwgZml4ZWQgPDwgc2V0cHJlY2lzaW9uKDIpIDw8IG1heCgoc3VtYykgLyAoc3VtcCAtIGspLCByZW0pIGRsOw0KICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICB9DQoNCiAgICB9DQoNCiAgICBjb3V0IDw8IGZpeGVkIDw8IHNldHByZWNpc2lvbigyKSA8PCByZW0gZGw7DQogICAgKi8NCg0KICAgIC8qDQogICAgbGwgbiA9IDA7DQogICAgY2luID4+IG47DQoNCiAgICBpZiAobiAlIDIgIT0gMCkgew0KICAgICAgICBjb3V0IDw8ICIwIiBkbDsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICANCiAgICBmb3IgKGludCBpID0gMDsgaSA8IG47IGkrKykgew0KICAgICAgICBjaW4gPj4gYVtpXTsNCiAgICB9DQogICAgDQogICAgaW50IGNudCA9IDA7DQoNCiAgICBmb3IgKGludCBpID0gYVswXTsgaSA8PSBhW24gLSAxXTsgaSsrKSB7DQogICAgICAgIA0KICAgICAgICBpbnQgb3AgPSAwOw0KDQogICAgICAgIGZvciAoaW50IGogPSAwOyBqIDwgbjsgaisrKSB7DQogICAgICAgICAgICBpZiAoYVtqXSA8IGkpIG9wLS07DQogICAgICAgICAgICBlbHNlIGlmIChhW2pdID4gaSkgb3ArKzsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmIChvcCA9PSAwKSB7DQogICAgICAgICAgICBjbnQrKzsNCiAgICAgICAgfQ0KDQogICAgfQ0KDQogICAgY291dCA8PCBjbnQgZGw7DQogICAgKi8NCg0KICAgIGRvdWJsZSBwcmljZVs2XSwgY29tbWVudFs2XSwgcmF0ZVs0MF07DQoNCiAgICBpbnQgbSwgazsNCiAgICBjaW4gPj4gbSA+PiBrOw0KDQogICAgZm9yIChpbnQgaSA9IDE7IGkgPD0gNTsgaSsrKSB7DQogICAgICAgIGNpbiA+PiBwcmljZVtpXTsNCiAgICB9DQoNCiAgICBmb3IgKGludCBpID0gMTsgaSA8PSA1OyBpKyspIHsNCiAgICAgICAgY2luID4+IGNvbW1lbnRbaV07DQogICAgfQ0KDQogICAgZG91YmxlIGFucyA9IDA7DQoNCiAgICAvLzENCiAgICBpbnQgc3VtcCA9IHByaWNlWzFdLCBzdW1zID0gY29tbWVudFsxXTsNCiAgICBpZiAoc3VtcCA+PSBtKSBzdW1wIC09IGs7DQogICAgcmF0ZVsxXSA9IHN1bXMgLyBzdW1wOw0KICAgIC8vMg0KICAgIHN1bXAgPSBwcmljZVsyXSwgc3VtcyA9IGNvbW1lbnRbMl07DQogICAgaWYgKHN1bXAgPj0gbSkgc3VtcCAtPSBrOw0KICAgIHJhdGVbMl0gPSBzdW1zIC8gc3VtcDsNCiAgICAvLzMNCiAgICBzdW1wID0gcHJpY2VbM10sIHN1bXMgPSBjb21tZW50WzNdOw0KICAgIGlmIChzdW1wID49IG0pIHN1bXAgLT0gazsNCiAgICByYXRlWzNdID0gc3VtcyAvIHN1bXA7DQogICAgLy80DQogICAgc3VtcCA9IHByaWNlWzRdLCBzdW1zID0gY29tbWVudFs0XTsNCiAgICBpZiAoc3VtcCA+PSBtKSBzdW1wIC09IGs7DQogICAgcmF0ZVs0XSA9IHN1bXMgLyBzdW1wOw0KICAgIC8vNQ0KICAgIHN1bXAgPSBwcmljZVs1XSwgc3VtcyA9IGNvbW1lbnRbNV07DQogICAgaWYgKHN1bXAgPj0gbSkgc3VtcCAtPSBrOw0KICAgIHJhdGVbNV0gPSBzdW1zIC8gc3VtcDsNCg0KICAgIC8vMSAyDQogICAgc3VtcCA9IHByaWNlWzFdICsgcHJpY2VbMl0sIHN1bXMgPSBjb21tZW50WzFdICsgY29tbWVudFsyXTsNCiAgICBpZiAoc3VtcCA+PSBtKSBzdW1wIC09IGs7DQogICAgcmF0ZVs2XSA9IHN1bXMgLyBzdW1wOw0KICAgIC8vMSAzDQogICAgc3VtcCA9IHByaWNlWzFdICsgcHJpY2VbM10sIHN1bXMgPSBjb21tZW50WzFdICsgY29tbWVudFszXTsNCiAgICBpZiAoc3VtcCA+PSBtKSBzdW1wIC09IGs7DQogICAgcmF0ZVs3XSA9IHN1bXMgLyBzdW1wOw0KICAgIC8vMSA0DQogICAgc3VtcCA9IHByaWNlWzFdICsgcHJpY2VbNF0sIHN1bXMgPSBjb21tZW50WzFdICsgY29tbWVudFs0XTsNCiAgICBpZiAoc3VtcCA+PSBtKSBzdW1wIC09IGs7DQogICAgcmF0ZVs4XSA9IHN1bXMgLyBzdW1wOw0KICAgIC8vMSA1DQogICAgc3VtcCA9IHByaWNlWzFdICsgcHJpY2VbNV0sIHN1bXMgPSBjb21tZW50WzFdICsgY29tbWVudFs1XTsNCiAgICBpZiAoc3VtcCA+PSBtKSBzdW1wIC09IGs7DQogICAgcmF0ZVs5XSA9IHN1bXMgLyBzdW1wOw0KICAgIC8vMiAzDQogICAgc3VtcCA9IHByaWNlWzJdICsgcHJpY2VbM10sIHN1bXMgPSBjb21tZW50WzJdICsgY29tbWVudFszXTsNCiAgICBpZiAoc3VtcCA+PSBtKSBzdW1wIC09IGs7DQogICAgcmF0ZVsxMF0gPSBzdW1zIC8gc3VtcDsNCiAgICAvLzIgNA0KICAgIHN1bXAgPSBwcmljZVsyXSArIHByaWNlWzRdLCBzdW1zID0gY29tbWVudFsyXSArIGNvbW1lbnRbNF07DQogICAgaWYgKHN1bXAgPj0gbSkgc3VtcCAtPSBrOw0KICAgIHJhdGVbMTFdID0gc3VtcyAvIHN1bXA7DQogICAgLy8yIDUNCiAgICBzdW1wID0gcHJpY2VbMl0gKyBwcmljZVs1XSwgc3VtcyA9IGNvbW1lbnRbMl0gKyBjb21tZW50WzVdOw0KICAgIGlmIChzdW1wID49IG0pIHN1bXAgLT0gazsNCiAgICByYXRlWzEyXSA9IHN1bXMgLyBzdW1wOw0KICAgIC8vMyA0DQogICAgc3VtcCA9IHByaWNlWzNdICsgcHJpY2VbNF0sIHN1bXMgPSBjb21tZW50WzNdICsgY29tbWVudFs0XTsNCiAgICBpZiAoc3VtcCA+PSBtKSBzdW1wIC09IGs7DQogICAgcmF0ZVsxM10gPSBzdW1zIC8gc3VtcDsNCiAgICAvLzMgNQ0KICAgIHN1bXAgPSBwcmljZVszXSArIHByaWNlWzVdLCBzdW1zID0gY29tbWVudFszXSArIGNvbW1lbnRbNV07DQogICAgaWYgKHN1bXAgPj0gbSkgc3VtcCAtPSBrOw0KICAgIHJhdGVbMTRdID0gc3VtcyAvIHN1bXA7DQogICAgLy80IDUNCiAgICBzdW1wID0gcHJpY2VbNF0gKyBwcmljZVs1XSwgc3VtcyA9IGNvbW1lbnRbNF0gKyBjb21tZW50WzVdOw0KICAgIGlmIChzdW1wID49IG0pIHN1bXAgLT0gazsNCiAgICByYXRlWzE1XSA9IHN1bXMgLyBzdW1wOw0KDQogICAgLy8xIDIgMw0KICAgIHN1bXAgPSBwcmljZVsxXSArIHByaWNlWzJdICsgcHJpY2VbM10sIHN1bXMgPSBjb21tZW50WzFdICsgY29tbWVudFsyXSArIGNvbW1lbnRbM107DQogICAgaWYgKHN1bXAgPj0gbSkgc3VtcCAtPSBrOw0KICAgIHJhdGVbMTZdID0gc3VtcyAvIHN1bXA7DQogICAgLy8xIDIgNA0KICAgIHN1bXAgPSBwcmljZVsxXSArIHByaWNlWzJdICsgcHJpY2VbNF0sIHN1bXMgPSBjb21tZW50WzFdICsgY29tbWVudFsyXSArIGNvbW1lbnRbNF07DQogICAgaWYgKHN1bXAgPj0gbSkgc3VtcCAtPSBrOw0KICAgIHJhdGVbMTddID0gc3VtcyAvIHN1bXA7DQogICAgLy8xIDIgNQ0KICAgIHN1bXAgPSBwcmljZVsxXSArIHByaWNlWzJdICsgcHJpY2VbNV0sIHN1bXMgPSBjb21tZW50WzFdICsgY29tbWVudFsyXSArIGNvbW1lbnRbNV07DQogICAgaWYgKHN1bXAgPj0gbSkgc3VtcCAtPSBrOw0KICAgIHJhdGVbMThdID0gc3VtcyAvIHN1bXA7DQogICAgLy8xIDMgNA0KICAgIHN1bXAgPSBwcmljZVsxXSArIHByaWNlWzNdICsgcHJpY2VbNF0sIHN1bXMgPSBjb21tZW50WzFdICsgY29tbWVudFszXSArIGNvbW1lbnRbNF07DQogICAgaWYgKHN1bXAgPj0gbSkgc3VtcCAtPSBrOw0KICAgIHJhdGVbMTldID0gc3VtcyAvIHN1bXA7DQogICAgLy8xIDMgNQ0KICAgIHN1bXAgPSBwcmljZVsxXSArIHByaWNlWzNdICsgcHJpY2VbNV0sIHN1bXMgPSBjb21tZW50WzFdICsgY29tbWVudFszXSArIGNvbW1lbnRbNV07DQogICAgaWYgKHN1bXAgPj0gbSkgc3VtcCAtPSBrOw0KICAgIHJhdGVbMjBdID0gc3VtcyAvIHN1bXA7DQogICAgLy8xIDQgNQ0KICAgIHN1bXAgPSBwcmljZVsxXSArIHByaWNlWzRdICsgcHJpY2VbNV0sIHN1bXMgPSBjb21tZW50WzFdICsgY29tbWVudFs0XSArIGNvbW1lbnRbNV07DQogICAgaWYgKHN1bXAgPj0gbSkgc3VtcCAtPSBrOw0KICAgIHJhdGVbMjFdID0gc3VtcyAvIHN1bXA7DQogICAgLy8yIDMgNA0KICAgIHN1bXAgPSBwcmljZVsyXSArIHByaWNlWzNdICsgcHJpY2VbNF0sIHN1bXMgPSBjb21tZW50WzJdICsgY29tbWVudFszXSArIGNvbW1lbnRbNF07DQogICAgaWYgKHN1bXAgPj0gbSkgc3VtcCAtPSBrOw0KICAgIHJhdGVbMjJdID0gc3VtcyAvIHN1bXA7DQogICAgLy8yIDMgNQ0KICAgIHN1bXAgPSBwcmljZVsyXSArIHByaWNlWzNdICsgcHJpY2VbNV0sIHN1bXMgPSBjb21tZW50WzJdICsgY29tbWVudFszXSArIGNvbW1lbnRbNV07DQogICAgaWYgKHN1bXAgPj0gbSkgc3VtcCAtPSBrOw0KICAgIHJhdGVbMjNdID0gc3VtcyAvIHN1bXA7DQogICAgLy8yIDQgNQ0KICAgIHN1bXAgPSBwcmljZVsyXSArIHByaWNlWzRdICsgcHJpY2VbNV0sIHN1bXMgPSBjb21tZW50WzJdICsgY29tbWVudFs0XSArIGNvbW1lbnRbNV07DQogICAgaWYgKHN1bXAgPj0gbSkgc3VtcCAtPSBrOw0KICAgIHJhdGVbMjRdID0gc3VtcyAvIHN1bXA7DQogICAgLy8zIDQgNQ0KICAgIHN1bXAgPSBwcmljZVszXSArIHByaWNlWzRdICsgcHJpY2VbNV0sIHN1bXMgPSBjb21tZW50WzNdICsgY29tbWVudFs0XSArIGNvbW1lbnRbNV07DQogICAgaWYgKHN1bXAgPj0gbSkgc3VtcCAtPSBrOw0KICAgIHJhdGVbMjVdID0gc3VtcyAvIHN1bXA7DQoNCiAgICAvLzEgMiAzIDQNCiAgICBzdW1wID0gcHJpY2VbMV0gKyBwcmljZVsyXSArIHByaWNlWzNdICsgcHJpY2VbNF0sIHN1bXMgPSBjb21tZW50WzFdICsgY29tbWVudFsyXSArIGNvbW1lbnRbM10gKyBjb21tZW50WzRdOw0KICAgIGlmIChzdW1wID49IG0pIHN1bXAgLT0gazsNCiAgICByYXRlWzI2XSA9IHN1bXMgLyBzdW1wOw0KICAgIC8vMSAyIDMgNQ0KICAgIHN1bXAgPSBwcmljZVsxXSArIHByaWNlWzJdICsgcHJpY2VbM10gKyBwcmljZVs1XSwgc3VtcyA9IGNvbW1lbnRbMV0gKyBjb21tZW50WzJdICsgY29tbWVudFszXSArIGNvbW1lbnRbNV07DQogICAgaWYgKHN1bXAgPj0gbSkgc3VtcCAtPSBrOw0KICAgIHJhdGVbMjddID0gc3VtcyAvIHN1bXA7DQogICAgLy8xIDIgNCA1DQogICAgc3VtcCA9IHByaWNlWzFdICsgcHJpY2VbMl0gKyBwcmljZVs0XSArIHByaWNlWzVdLCBzdW1zID0gY29tbWVudFsxXSArIGNvbW1lbnRbMl0gKyBjb21tZW50WzRdICsgY29tbWVudFs1XTsNCiAgICBpZiAoc3VtcCA+PSBtKSBzdW1wIC09IGs7DQogICAgcmF0ZVsyOF0gPSBzdW1zIC8gc3VtcDsNCiAgICAvLzEgMyA0IDUNCiAgICBzdW1wID0gcHJpY2VbMV0gKyBwcmljZVszXSArIHByaWNlWzRdICsgcHJpY2VbNV0sIHN1bXMgPSBjb21tZW50WzFdICsgY29tbWVudFszXSArIGNvbW1lbnRbNF0gKyBjb21tZW50WzVdOw0KICAgIGlmIChzdW1wID49IG0pIHN1bXAgLT0gazsNCiAgICByYXRlWzI5XSA9IHN1bXMgLyBzdW1wOw0KICAgIC8vMiAzIDQgNQ0KICAgIHN1bXAgPSBwcmljZVsyXSArIHByaWNlWzNdICsgcHJpY2VbNF0gKyBwcmljZVs1XSwgc3VtcyA9IGNvbW1lbnRbMl0gKyBjb21tZW50WzNdICsgY29tbWVudFs0XSArIGNvbW1lbnRbNV07DQogICAgaWYgKHN1bXAgPj0gbSkgc3VtcCAtPSBrOw0KICAgIHJhdGVbMzBdID0gc3VtcyAvIHN1bXA7DQoNCiAgICAvLzEgMiAzIDQgNQ0KICAgIHN1bXAgPSBwcmljZVsxXSArIHByaWNlWzJdICsgcHJpY2VbM10gKyBwcmljZVs0XSArIHByaWNlWzVdLCBzdW1zID0gY29tbWVudFsxXSArIGNvbW1lbnRbMl0gKyBjb21tZW50WzNdICsgY29tbWVudFs0XSArIGNvbW1lbnRbNV07DQogICAgaWYgKHN1bXAgPj0gbSkgc3VtcCAtPSBrOw0KICAgIHJhdGVbMzFdID0gc3VtcyAvIHN1bXA7DQogICAgDQogICAgc29ydChyYXRlICsgMSwgcmF0ZSArIDMyKTsNCg0KICAgIHByaW50ZigiJS4ybGZcbiIsIHJhdGVbMzFdKTsNCg0KfQ0KDQppbnQgbWFpbigpIHsNCg0KICAgIC8vSU9TOw0KDQogICAgaW50IFQgPSAxOw0KICAgIC8vY2luID4+IFQ7DQoNCg0KICAgIHdoaWxlIChULS0pIHsNCg0KICAgICAgICBMb2xpdGFTYW1hKCk7DQoNCiAgICB9DQoNCn0NCg=="}]