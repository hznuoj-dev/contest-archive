[{"id":"32517","submission_id":"32517","filename":"e.cpp","source":"I2luY2x1ZGU8Yml0cy9zdGRjKysuaD4NCiNkZWZpbmUgRm9yKGksIGEsIGIpIGZvcihpbnQgaSA9IChhKSwgZW4gPSAoYik7IGkgPD0gZW47ICsraSkNCiNkZWZpbmUgUm9mKGksIGEsIGIpIGZvcihpbnQgaSA9IChhKSwgZW4gPSAoYik7IGkgPj0gZW47IC0taSkNCiNkZWZpbmUgVHJhKHUsIGkpIGZvcihpbnQgaSA9IGhkW3VdOyB+aTsgaSA9IGVbaV0ubmV0KQ0KI2RlZmluZSBjc3QgY29uc3QNCiNkZWZpbmUgTEwgbG9uZyBsb25nDQojZGVmaW5lIEREIGRvdWJsZQ0KI2RlZmluZSBMRCBsb25nIGRvdWJsZQ0KI2RlZmluZSBwYiBwdXNoX2JhY2sNCiNkZWZpbmUgbXAgbWFrZV9wYWlyDQojZGVmaW5lIGZpciBmaXJzdA0KI2RlZmluZSBzZWMgc2Vjb25kDQojZGVmaW5lIGluZiAweDNmM2YzZjNmDQojZGVmaW5lIEluZiAweDNmM2YzZjNmM2YzZjNmM2YNCiNkZWZpbmUgZXBzIDFlLTEyDQojZGVmaW5lIG1heG4gMzAwMDAwDQojZGVmaW5lIG1vZCAxMDAwMDAwMDA3DQp1c2luZyBuYW1lc3BhY2Ugc3RkOw0KDQppbnQgbiwgcTsNCkxMIGFbbWF4biArIDVdOw0Kc3RydWN0IFBvaXsNCiAgICBpbnQgZmEsIGNoWzJdLCBzejsNCiAgICBMTCBscHJbMl0sIHZhbFsyXTsNCn07DQpjbGFzcyBUcmVlew0KICAgIHB1YmxpYzoNCiAgICAgICAgUG9pIHBvaVttYXhuICsgNV07DQogICAgICAgIHZvaWQgbXNvbihpbnQgcnQsIExMIHgxLCBMTCB4Mil7DQogICAgICAgICAgICBhW3J0XSArPSB4MTsNCiAgICAgICAgICAgIGFbcnRdICU9IG1vZDsNCiAgICAgICAgICAgIHBvaVtydF0udmFsWzBdICs9IHgxICogcG9pW3J0XS5zejsNCiAgICAgICAgICAgIHBvaVtydF0udmFsWzBdICU9IG1vZDsNCiAgICAgICAgICAgIHBvaVtydF0ubHByWzBdICs9IHgxOw0KICAgICAgICAgICAgcG9pW3J0XS5scHJbMF0gJT0gbW9kOw0KDQogICAgICAgICAgICBwb2lbcnRdLnZhbFsxXSArPSB4MjsNCiAgICAgICAgICAgIHBvaVtydF0udmFsWzFdICU9IG1vZDsNCiAgICAgICAgICAgIHBvaVtydF0ubHByWzFdICs9IHgyOw0KICAgICAgICAgICAgcG9pW3J0XS5scHJbMV0gJT0gbW9kOw0KICAgICAgICB9DQogICAgICAgIHZvaWQgc3ByKGludCBydCl7DQogICAgICAgICAgICBpZihwb2lbcnRdLmxwclswXSB8fCBwb2lbcnRdLmxwclsxXSl7DQogICAgICAgICAgICAgICAgRm9yKG8sIDAsIDEpIGlmKHBvaVtydF0uY2hbb10pIG1zb24ocG9pW3J0XS5jaFtvXSwgcG9pW3J0XS5scHJbMF0sIHBvaVtydF0ubHByWzFdKTsNCiAgICAgICAgICAgICAgICBwb2lbcnRdLmxwclswXSA9IHBvaVtydF0ubHByWzFdID0gMDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICB2b2lkIHVwZChpbnQgcnQpew0KICAgICAgICAgICAgcG9pW3J0XS52YWxbMF0gPSAocG9pW3BvaVtydF0uY2hbMF1dLnZhbFswXSArIHBvaVtwb2lbcnRdLmNoWzFdXS52YWxbMF0gKyBhW3J0XSkgJSBtb2Q7DQogICAgICAgICAgICBwb2lbcnRdLnN6ID0gcG9pW3BvaVtydF0uY2hbMF1dLnN6ICsgcG9pW3BvaVtydF0uY2hbMV1dLnN6ICsgMTsNCiAgICAgICAgfQ0KICAgICAgICB2b2lkIHJvdChpbnQgcnQpew0KICAgICAgICAgICAgaW50IGZhID0gcG9pW3J0XS5mYSwgZmZhID0gcG9pW2ZhXS5mYSwgdG8gPSBwb2lbZmFdLmNoWzFdID09IHJ0Ow0KICAgICAgICAgICAgaWYoIXJ0IHx8ICFmYSkgcmV0dXJuOw0KICAgICAgICAgICAgc3ByKGZhKTsgc3ByKHJ0KTsNCiAgICAgICAgICAgIGlmKGZmYSkgcG9pW3BvaVtmZmFdLmNoW3BvaVtmZmFdLmNoWzFdID09IGZhXSA9IHJ0XS5mYSA9IGZmYTsNCiAgICAgICAgICAgIGVsc2UgcG9pW3J0XS5mYSA9IDA7DQogICAgICAgICAgICBpZihwb2lbcnRdLmNoWyF0b10pIHBvaVtwb2lbZmFdLmNoW3RvXSA9IHBvaVtydF0uY2hbIXRvXV0uZmEgPSBmYTsNCiAgICAgICAgICAgIGVsc2UgcG9pW2ZhXS5jaFt0b10gPSAwOw0KICAgICAgICAgICAgcG9pW3BvaVtydF0uY2hbIXRvXSA9IGZhXS5mYSA9IHJ0Ow0KICAgICAgICAgICAgdXBkKGZhKTsgdXBkKHJ0KTsNCiAgICAgICAgfQ0KICAgICAgICB2b2lkIHNwbGF5KGludCBydCl7aWYoIXJ0KSByZXR1cm47IHdoaWxlKHBvaVtydF0uZmEpIHJvdChydCksIHJ0ID0gcG9pW3J0XS5mYTt9DQogICAgICAgIHZvaWQgbWVyKGludCB0aW0sIGludCBydDEsIGludCBydDIpew0KICAgICAgICAgICAgc3BsYXkocnQxKTsgc3BsYXkocnQyKTsNCiAgICAgICAgICAgIG1zb24ocnQxLCAwLCB0aW0gKiBwb2lbcnQxXS52YWxbMF0gJSBtb2QpOw0KICAgICAgICAgICAgbXNvbihydDIsIDAsIHRpbSAqIHBvaVtydDJdLnZhbFswXSAlIG1vZCk7DQogICAgICAgICAgICBpbnQgbm93ID0gcnQxOw0KICAgICAgICAgICAgd2hpbGUocG9pW25vd10uY2hbMV0pIG5vdyA9IHBvaVtub3ddLmNoWzFdOw0KICAgICAgICAgICAgc3BsYXkobm93KTsNCiAgICAgICAgICAgIHNwcihub3cpOw0KICAgICAgICAgICAgcG9pW3BvaVtub3ddLmNoWzFdID0gcnQyXS5mYSA9IG5vdzsNCiAgICAgICAgICAgIHVwZChub3cpOw0KICAgICAgICAgICAgbXNvbihub3csIDAsIG1vZCAtIHRpbSAqIHBvaVtub3ddLnZhbFswXSAlIG1vZCk7DQogICAgICAgIH0NCiAgICAgICAgdm9pZCBtZHkoaW50IHRpbSwgaW50IHJ0LCBpbnQgeCl7DQogICAgICAgICAgICBzcGxheShydCk7DQogICAgICAgICAgICBtc29uKHJ0LCAwLCB0aW0gKiBwb2lbcnRdLnZhbFswXSAlIG1vZCk7DQogICAgICAgICAgICBtc29uKHJ0LCB4LCAwKTsNCiAgICAgICAgICAgIG1zb24ocnQsIDAsIG1vZCAtIHRpbSAqIHBvaVtydF0udmFsWzBdICUgbW9kKTsNCiAgICAgICAgfQ0KICAgICAgICBpbnQgcXVlKGludCB0aW0sIGludCBydCl7DQogICAgICAgICAgICBzcGxheShydCk7DQogICAgICAgICAgICByZXR1cm4gKHRpbSAqIHBvaVtydF0udmFsWzBdICUgbW9kICsgcG9pW3J0XS52YWxbMV0pICUgbW9kOw0KICAgICAgICB9DQp9IHRyOw0KDQp0ZW1wbGF0ZSA8Y2xhc3MgVD4NCnZvaWQgcmVhZChUICZ4KXsNCgljaGFyIGNoOw0KCWJvb2wgb2s7DQoJZm9yKG9rID0gMCwgY2ggPSBnZXRjaGFyKCk7ICFpc2RpZ2l0KGNoKTsgY2ggPSBnZXRjaGFyKCkpIGlmKGNoID09ICctJykgb2sgPSAxOw0KCWZvcih4ID0gMDsgaXNkaWdpdChjaCk7IHggPSB4ICogMTAgKyBjaCAtICcwJywgY2ggPSBnZXRjaGFyKCkpOw0KCWlmKG9rKSB4ID0gLXg7DQp9DQoNCmludCBtYWluKCl7DQoJLy8gZnJlb3BlbigiaW4udHh0IiwgInIiLCBzdGRpbik7DQogICAgcmVhZChuKTsgcmVhZChxKTsNCiAgICBGb3IoaSwgMSwgbil7DQogICAgICAgIHJlYWQoYVtpXSk7DQogICAgICAgIHRyLnBvaVtpXS52YWxbMF0gPSBhW2ldOw0KICAgICAgICB0ci5wb2lbaV0uc3ogPSAxOw0KICAgIH0NCiAgICBGb3IoaSwgMSwgcSl7DQogICAgICAgIGludCBvcDsgcmVhZChvcCk7DQogICAgICAgIGlmKG9wID09IDEpew0KICAgICAgICAgICAgaW50IHUsIHY7IHJlYWQodSk7IHJlYWQodik7DQogICAgICAgICAgICB0ci5tZXIoaSwgdSwgdik7DQogICAgICAgIH0NCiAgICAgICAgaWYob3AgPT0gMil7DQogICAgICAgICAgICBpbnQgdSwgdjsgcmVhZCh1KTsgcmVhZCh2KTsNCiAgICAgICAgICAgIHRyLm1keShpLCB1LCB2KTsNCiAgICAgICAgfQ0KICAgICAgICBpZihvcCA9PSAzKXsNCiAgICAgICAgICAgIGludCB1OyByZWFkKHUpOw0KICAgICAgICAgICAgcHJpbnRmKCIlZFxuIiwgdHIucXVlKGksIHUpKTsNCiAgICAgICAgfQ0KICAgIH0NCglyZXR1cm4gMDsNCn0NCg0K"}]