[{"id":"31420","submission_id":"31420","filename":"main.cpp","source":"CiNpbmNsdWRlIDxiaXRzL3N0ZGMrKy5oPgp1c2luZyBuYW1lc3BhY2Ugc3RkOwojZGVmaW5lIHJlcChpLGosaykgZm9yKGk9ajtpPD1rOysraSkKI2RlZmluZSBkb3coaSxqLGspIGZvcihpPWo7aT49azstLWkpCiNkZWZpbmUgcHIgcGFpcgojZGVmaW5lIG1rcCBtYWtlX3BhaXIKI2RlZmluZSBmaSBmaXJzdAojZGVmaW5lIHNlIHNlY29uZApjb25zdCBpbnQgTj0yZTUrMTA7CiNkZWZpbmUgTEwgbG9uZyBsb25nCmludCBuLGFbTl0sbXhbTl1bMjBdLG1uW05dWzIwXSxsZ1tOXSxrLHRvW05dLHE7CkxMIGFuc1tOXTsKaW50IGRlbHRhKGludCBsLGludCByKXsKICAgIGludCBrPWxnW3ItbCsxXTsKICAgIHJldHVybiBtYXgobXhbbF1ba10sbXhbci0oMTw8aykrMV1ba10pLW1pbihtbltsXVtrXSxtbltyLSgxPDxrKSsxXVtrXSk7Cn0KTEwgc2VnW048PDJdLHRhZ1tOPDwyXSxzdW1bTjw8Ml07CnZvaWQgcHVzaHVwKGludCBydCl7CiAgICBzZWdbcnRdPXNlZ1tydDw8MV0rc2VnW3J0PDwxfDFdOwogICAgc3VtW3J0XT1zdW1bcnQ8PDFdK3N1bVtydDw8MXwxXTsKfQp2b2lkIHB1c2hkb3duKGludCBydCl7CiAgICBpZih0YWdbcnRdKXsKICAgICAgICBzdW1bcnQ8PDFdKz1zZWdbcnQ8PDFdKnRhZ1tydF07c3VtW3J0PDwxfDFdKz1zZWdbcnQ8PDF8MV0qdGFnW3J0XTsKICAgICAgICB0YWdbcnQ8PDFdKz10YWdbcnRdO3RhZ1tydDw8MXwxXSs9dGFnW3J0XTt0YWdbcnRdPTA7CiAgICB9Cn0KCnZvaWQgbW9kaWZ5KGludCBydCxpbnQgbCxpbnQgcixpbnQgayxpbnQgZCl7CiAgICBpZihsPT1yKXsKICAgICAgICBpZihkKXNlZ1tydF09MSxzdW1bcnRdPTE7CiAgICAgICAgZWxzZSBzZWdbcnRdPXN1bVtydF09MDsKICAgICAgICByZXR1cm47CiAgICB9CiAgICBpbnQgbWlkPWwrcj4+MTtwdXNoZG93bihydCk7CiAgICBpZihtaWQ+PWspbW9kaWZ5KHJ0PDwxLGwsbWlkLGssZCk7CiAgICBlbHNlIG1vZGlmeShydDw8MXwxLG1pZCsxLHIsayxkKTsKfQp2b2lkIG1keShpbnQgcnQsaW50IGwsaW50IHIsaW50IHFsLGludCBxcixMTCBkKXsKICAgIGlmKHFsPD1sICYmIHI8PXFyKXsKICAgICAgICB0YWdbcnRdKz1kO3N1bVtydF0rPWQqc2VnW3J0XTtyZXR1cm47CiAgICB9CiAgICBwdXNoZG93bihydCk7aW50IG1pZD1sK3I+PjE7CiAgICBpZihtaWQ+PXFsKW1keShydDw8MSxsLG1pZCxxbCxxcixkKTsKICAgIGlmKG1pZCsxPD1xciltZHkocnQ8PDF8MSxtaWQrMSxyLHFsLHFyLGQpO3B1c2h1cChydCk7Cn0KTEwgcXVlcnkoaW50IHJ0LGludCBsLGludCByLGludCBxbCxpbnQgcXIpewogICAgaWYocWw8PWwgJiYgcjw9cXIpcmV0dXJuIHN1bVtydF07CiAgICBpbnQgbWlkPWwrcj4+MTsKICAgIExMIHJlcz0wO3B1c2hkb3duKHJ0KTsKICAgIGlmKG1pZD49cWwpcmVzKz1xdWVyeShydDw8MSxsLG1pZCxxbCxxcik7CiAgICBpZihtaWQrMTw9cXIpcmVzKz1xdWVyeShydDw8MXwxLG1pZCsxLHIscWwscXIpOwogICAgcHVzaHVwKHJ0KTtyZXR1cm4gcmVzOwp9CnZlY3RvcjxwcjxpbnQsaW50PiA+dFtOXTsKdmVjdG9yPGludD5idXRbTl07CnN0cnVjdCBiaXR7CiAgICBMTCBjW05dOwogICAgaW50IGxvd2JpdChpbnQgeCl7cmV0dXJuIHgmLXg7fQogICAgTEwgcXJ5KGludCB4KXsKICAgICAgICBMTCByZXM9MDt3aGlsZSh4KXtyZXMrPWNbeF07eC09bG93Yml0KHgpO31yZXR1cm4gcmVzOwogICAgfQogICAgdm9pZCBjbmcoaW50IHgsTEwgZCl7CiAgICAgICAgd2hpbGUoeDw9bil7Y1t4XSs9ZDt4Kz1sb3diaXQoeCk7fQogICAgfQogICAgTEwgc2lnKGludCBsLGludCByKXsKICAgICAgICBpZihsPT0xKXJldHVybiBxcnkocik7cmV0dXJuIHFyeShyKS1xcnkobC0xKTsKICAgIH0KfXRyMSx0cjIsdHIzOwoKCmludCBtYWluKCl7Ly9mcmVvcGVuKCJpbi50eHQiLCJyIixzdGRpbik7CiAgICBzY2FuZigiJWQlZCVkIiwmbiwmaywmcSk7aW50IGksajsKICAgIHJlcChpLDEsbilzY2FuZigiJWQiLCZhW2ldKSxteFtpXVswXT1tbltpXVswXT1hW2ldOwogICAgcmVwKGksMixuKWxnW2ldPWxnW2k+PjFdKzE7CiAgICByZXAoaiwxLDE5KWZvcihpPTE7aSsoMTw8aiktMTw9bjsrK2kpbW5baV1bal09bWluKG1uW2ldW2otMV0sbW5baSsoMTw8ai0xKV1bai0xXSksbXhbaV1bal09bWF4KG14W2ldW2otMV0sbXhbaSsoMTw8ai0xKV1bai0xXSk7CiAgICByZXAoaSwxLG4pewogICAgICAgIGludCBsPWkscj1uLHJlczsKICAgICAgICB3aGlsZShsPD1yKXsKICAgICAgICAgICAgaW50IG1pZD1sK3I+PjE7CiAgICAgICAgICAgIGlmKGRlbHRhKGksbWlkKTw9aylyZXM9bWlkLGw9bWlkKzE7ZWxzZSByPW1pZC0xOwogICAgICAgIH0KICAgICAgICB0b1tpXT1yZXM7CiAgICAgICAgYnV0W3Jlc10ucHVzaF9iYWNrKGkpOwogICAgfQogICAgcmVwKGksMSxxKXsKICAgICAgICBpbnQgeCx5O3NjYW5mKCIlZCVkIiwmeCwmeSk7CiAgICAgICAgdFt5XS5wdXNoX2JhY2sobWtwKGkseCkpOwogICAgfQogICAgcmVwKGksMSxuKXsKICAgICAgICB0cjEuY25nKGksMSk7dHIyLmNuZyhpLGktMSk7CiAgICAgICAgZm9yKGF1dG8gdjp0W2ldKXsKICAgICAgICAgICAgYW5zW3YuZmldPXRyMS5zaWcodi5zZSxpKSooTEwpaS10cjIuc2lnKHYuc2UsaSkrdHIzLnNpZyh2LnNlLGkpOwogICAgICAgIH0KICAgICAgICBmb3IoYXV0byB2OmJ1dFtpXSl7CiAgICAgICAgICAgIHRyMS5jbmcodiwtMSk7dHIyLmNuZyh2LDEtdik7CiAgICAgICAgICAgIHRyMy5jbmcodix0b1t2XS12KzEpOwogICAgICAgIH0KICAgIH0KICAgIHJlcChpLDEscSlwcmludGYoIiVsbGRcbiIsYW5zW2ldKTsKfQ=="}]