[{"id":"3880","submission_id":"3880","filename":"G.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+DQoNCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQojZGVmaW5lIGxuICdcbicNCg0KY29uc3QgaW50IE49MWU1KzU7DQoNCmludCBmW05dLHNpeltOXSxjb2xbTl0sd1tOXSxpZFtOXTsNCg0KaW50IGZpbmQoaW50IHgpIHsNCglpZihmW3hdID09IHgpIHJldHVybiB4Ow0KCWludCBwYXIgPSBmaW5kKGZbeF0pOw0KCWNvbFt4XSA9IGNvbFtmW3hdXSBeIHdbeF07DQoJcmV0dXJuIHBhcjsNCn0NCg0KYm9vbCBhbnMgPSB0cnVlOw0KDQp2b2lkIG1lcmdlKGludCB4LCBpbnQgeSwgaW50IFcpIHsNCglpbnQgZnggPSBmaW5kKHgpLCBmeSA9IGZpbmQoeSk7DQoJaWYoZnggPT0gZnkpIHsNCgkJaWYoY29sW3hdIF4gY29sW3ldICE9IFcpIGFucyA9IGZhbHNlOw0KCQlyZXR1cm47DQoJfQ0KCWlmKHNpeltmeF0gPCBzaXpbZnldKSANCgkJc3dhcCh4LCB5KSwgc3dhcChmeCwgZnkpOw0KCQ0KCXNpeltmeF0gKz0gc2l6W2Z5XTsNCglmW2Z5XSA9IGZ4Ow0KCXdbZnldID0gY29sW3hdIF4gY29sW3ldIF4gVzsNCgkNCn0NCg0KdmVjdG9yPGludD4gYW5zX2dvb2Q7DQp2ZWN0b3I8aW50PiBnb29kW05dLCBiYWRbTl07DQpiaXRzZXQ8MTAwMDA1PiBwW05dOw0KDQppbmxpbmUgdm9pZCBzb2x2ZSgpIHsNCglpbnQgbixxLG07DQoJc2NhbmYoIiVkJWQlZCIsICZuLCAmcSwgJm0pOw0KCWZvcihpbnQgaSA9IDE7IGkgPD0gbjsgaSsrKSANCgkJZltpXSA9IGksIGNvbFtpXSA9IDAsIHNpeltpXSA9IDEsIHdbaV0gPSAwOw0KCWZvcihpbnQgaSA9IDE7IGkgPD0gbTsgaSsrKSB7DQoJCWludCB4LCB5LCB3Ow0KCQlzY2FuZigiJWQlZCVkIiwgJncsICZ4LCAmeSk7DQoJCW1lcmdlKHgsIHksIHcpOw0KCX0NCgkNCglpZiAoYW5zID09IGZhbHNlKXsNCgkJcHV0cygiTk8iKTsNCgkJcmV0dXJuOw0KCX0NCg0KCWludCB0b3QgPSAwOw0KCWZvcihpbnQgaSA9IDE7IGkgPD0gbjsgaSsrKSANCgkJaWYoZmluZChpKSA9PSBpKSBpZFtpXSA9ICsrdG90OwkNCglmb3IoaW50IGkgPSAxOyBpIDw9IG47IGkrKykgDQoJCWlkW2ldID0gaWRbZmluZChpKV07DQoJCQ0KDQoJZm9yKGludCBpID0gMTsgaSA8PSBuOyBpKyspIHsNCgkJaWYoY29sW2ldID09IDApDQoJCQlnb29kW2lkW2ldXS5wdXNoX2JhY2soaSk7DQoJCWVsc2UNCgkJCWJhZFtpZFtpXV0ucHVzaF9iYWNrKGkpOw0KCX0NCgkNCglwWzBdWzBdID0gMTsNCglmb3IoaW50IGkgPSAxOyBpIDw9IHRvdDsgaSsrKQ0KCQlwW2ldID0gKCAocFtpIC0gMV0gPDwgZ29vZFtpXS5zaXplKCkpIHwgKHBbaSAtIDFdIDw8IGJhZFtpXS5zaXplKCkpICk7DQoNCglpZihxID4gMTAwMDAwIHx8IHBbdG90XVtxXSA9PSAwKXsNCgkJcHV0cygiTk8iKTsNCgkJcmV0dXJuOw0KCX0NCgkNCgkNCglmb3IoaW50IGkgPSB0b3Q7IGk7IGktLSkNCgkJaWYocSA+PSBnb29kW2ldLnNpemUoKSAmJiBwW2kgLSAxXVtxIC0gZ29vZFtpXS5zaXplKCldKSAgew0KCQkJcSAtPSBnb29kW2ldLnNpemUoKTsgDQoJCQlmb3IoYXV0byB4OiBnb29kW2ldKSBhbnNfZ29vZC5wdXNoX2JhY2soeCk7DQoJCX0gZWxzZSBpZiAocSA+PSBiYWRbaV0uc2l6ZSgpICYmIHBbaSAtIDFdW3EgLSBiYWRbaV0uc2l6ZSgpXSl7DQoJCQlxIC09IGJhZFtpXS5zaXplKCk7DQoJCQlmb3IoYXV0byB4OiBiYWRbaV0pIGFuc19nb29kLnB1c2hfYmFjayh4KTsNCgkJfSBlbHNlIHsNCgkJCXB1dHMoIk5PIik7DQoJCQlyZXR1cm47DQoJCX0NCglwdXRzKCJZRVMiKTsNCglzb3J0KGFuc19nb29kLmJlZ2luKCksIGFuc19nb29kLmVuZCgpKTsNCglmb3IoYXV0byB4OiBhbnNfZ29vZCkgDQoJCXByaW50ZigiJWQgIiwgeCk7DQp9DQoNCmludCBtYWluKCkgew0KCXNvbHZlKCk7DQoJcmV0dXJuIDA7DQp9"}]