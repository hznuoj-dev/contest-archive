[{"id":"3364","submission_id":"3364","filename":"I.cpp","source":"I2luY2x1ZGU8Yml0cy9zdGRjKysuaD4NCiNkZWZpbmUgbGwgbG9uZyBsb25nDQojZGVmaW5lIGFsbChhKSAoYSkuYmVnaW4oKSwoYSkuZW5kOw0KdXNpbmcgbmFtZXNwYWNlIHN0ZDsNCmNvbnN0IGludCBOID0gNWUzICsgMTA7DQoNCmxsIHAgPSAyMzMzLCBtb2QgPSAxZTkgKyA3LCBoMVtOXSwgaDJbTl07DQpsbCBwcFtOXTsNCg0KaW5saW5lIGxsIGdldDEoaW50IGwsIGludCByKQ0Kew0KCXJldHVybiAoaDFbcl0gLSBoMVtsIC0gMV0gKiBwcFtyIC0gbCArIDFdICUgbW9kICsgbW9kKSAlIG1vZDsNCn0NCg0KaW5saW5lIGxsIGdldDIoaW50IGwsIGludCByKQ0Kew0KCXJldHVybiAoaDJbbF0gLSBoMltyICsgMV0gKiBwcFtyIC0gbCArIDFdICUgbW9kICsgbW9kKSAlIG1vZDsNCn0NCg0KaW5saW5lIGludCBjYWwoaW50IGksIGludCBqKQ0Kew0KCWlmKGogPD0gaSkgcmV0dXJuIC0xOw0KCQ0KCWludCBsID0gMSwgciA9IChqIC0gaSArIDEpIC8gMiwgcmVzID0gLTE7DQoJd2hpbGUobCA8PSByKQ0KCXsNCgkJaW50IG1pZCA9IChsICsgcikgLyAyOw0KCQkNCgkJbGwgczEgPSBnZXQxKGksIGkgKyBtaWQgLSAxKTsNCgkJbGwgczIgPSBnZXQyKGogLSBtaWQgKyAxLCBqKTsNCgkJDQoJCWlmKHMxICE9IHMyKSANCgkJew0KCQkJcmVzID0gbWlkOw0KCQkJciA9IG1pZCAtIDE7DQoJCX0NCgkJZWxzZQ0KCQkJbCA9IG1pZCArIDE7DQoJfQ0KCXJldHVybiByZXM7DQp9DQoNCnZvaWQgc29sdmUoKQ0Kew0KCXN0cmluZyBzOw0KCWNpbiA+PiBzOw0KCWludCBuID0gcy5zaXplKCk7DQoJcyA9ICc/JyArIHM7DQoJDQoJZm9yKGludCBpID0gMTsgaSA8PSBuOyBpKyspIGgxW2ldID0gKGgxW2kgLSAxXSAqIHAgJSBtb2QgKyBzW2ldKSAlIG1vZDsNCgloMltuICsgMV0gPSAwOw0KCWZvcihpbnQgaSA9IG47IGkgPj0gMTsgaS0tKSBoMltpXSA9IChoMltpICsgMV0gKiBwICUgbW9kICsgc1tpXSkgJSBtb2Q7DQoJDQoJaW50IGFucyA9IDA7DQoJZm9yKGludCBpID0gMTsgaSA8PSBuOyBpKyspDQoJew0KCQlmb3IoaW50IGogPSBpICsgMTsgaiA8PSBuOyBqKyspDQoJCXsNCgkJCWludCByZXMgPSBjYWwoaSwgaik7DQoJCQkNCgkJCWlmKHJlcyA9PSAtMSkNCgkJCXsNCgkJCQlhbnMgPSBtYXgoaiAtIGkgKyAxLCBhbnMpOw0KCQkJCWNvbnRpbnVlOw0KCQkJfQ0KCQkJDQoJCQlpbnQgTDEgPSBpICsgcmVzIC0gMTsNCgkJCWludCBSMSA9IGogLSByZXMgKyAxOw0KCQkJDQoJCQlyZXMgPSBjYWwoTDEgKyAxLCBSMSAtIDEpOw0KCQkJDQoJCQlpZihyZXMgPT0gLTEpDQoJCQl7DQoJCQkJaW50IGxlbiA9IGogLSBpICsgMTsNCgkJCQlpZihsZW4gJiAxKQ0KCQkJCXsNCgkJCQkJaWYoc1tMMV0gPT0gc1tpICsgKGogLSBpKSAvIDJdIHx8IHNbUjFdID09IHNbaSArIChqIC0gaSkgLyAyXSkNCgkJCQkJCWFucyA9IG1heChhbnMsIGogLSBpICsgMSk7DQoJCQkJfQ0KCQkJCWNvbnRpbnVlOw0KCQkJfQ0KCQkJDQoJCQlpbnQgTDIgPSBMMSArIHJlczsNCgkJCWludCBSMiA9IFIxIC0gcmVzOw0KCQkJDQoJCQlpZihMMiArIDEgPD0gUjIgLSAxICYmIGdldDEoTDIgKyAxLCBSMiAtIDEpID09IGdldDIoTDIgKyAxLCBSMiAtIDEpKSByZXMgPSAtMTsNCgkJCWVsc2UgcmVzID0gMTsNCgkJCQ0KCQkJaWYocmVzICE9IC0xKSBjb250aW51ZTsNCgkJCQ0KCQkJaWYoc1tMMV0gPT0gc1tMMl0gJiYgc1tSMV0gPT0gc1tSMl0gfHwgc1tMMV0gPT0gc1tSMl0gJiYgc1tSMV0gPT0gc1tMMl0pDQoJCQkJYW5zID0gbWF4KGFucywgaiAtIGkgKyAxKTsNCgkJfQ0KCX0NCgkNCgljb3V0IDw8IGFucyA8PCAnXG4nOw0KfQ0KDQpzaWduZWQgbWFpbigpDQp7DQoJaW9zOjpzeW5jX3dpdGhfc3RkaW8oZmFsc2UpOw0KCWNpbi50aWUoMCk7Y291dC50aWUoMCk7DQoJaW50IHQgPSAxOw0KCXBwWzBdID0gMTsNCglmb3IoaW50IGkgPSAxOyBpIDwgTjsgaSsrKSBwcFtpXSA9IHBwW2kgLSAxXSAqIHAgJSBtb2Q7DQoJY2luID4+IHQ7DQoJd2hpbGUodC0tKSBzb2x2ZSgpOw0KCXJldHVybiAwOw0KfQ0KLyoNCjQNCmFiY2NhYg0KaWhpDQpzdGZnZml1dA0KcGFsaW5kcm9tZQ0KKi8="}]