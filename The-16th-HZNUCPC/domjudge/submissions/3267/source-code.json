[{"id":"3267","submission_id":"3267","filename":"D.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+DQ0jZGVmaW5lIGRiZyh4Li4uKSBcDSAgICBkbyB7IFwNICAgICAgICBzdGQ6OmNvdXQgPDwgI3ggPDwgIiAtPiAiOyBcDSAgICAgICAgZXJyKHgpOyBcDSAgICB9IHdoaWxlICgwKQ0Ndm9pZCBlcnIoKSB7DSAgICBzdGQ6OmNvdXQgPDwgc3RkOjplbmRsOw19DQ10ZW1wbGF0ZTxjbGFzcyBULCBjbGFzcy4uLiBUcz4Ndm9pZCBlcnIoVCBhcmcsIFRzICYuLi4gYXJncykgew0gICAgc3RkOjpjb3V0IDw8IGFyZyA8PCAnICc7DSAgICBlcnIoYXJncy4uLik7DX0NDXVzaW5nIGxsID0gbG9uZyBsb25nOw11c2luZyBsZCA9IGxvbmcgZG91YmxlOw11c2luZyB1bGwgPSB1bnNpZ25lZCBsb25nIGxvbmc7DXVzaW5nIGkxMjggPSBfX2ludDEyODsNDWNvbnN0ZXhwciBpbnQgaW5mID0gMWU5Ow0Nc3RydWN0IE1pbiB7DSAgICBpbnQgeCA9IGluZjsNDSAgICBNaW4oaW50IHggPSBpbmYpIDogeCh4KSB7fQ0NICAgIGJvb2wgb3BlcmF0b3I9PShjb25zdCBNaW4gJmFubykgew0gICAgICAgIHJldHVybiB4ID09IGFuby54Ow0gICAgfQ0NICAgIE1pbiAmb3BlcmF0b3IrPShjb25zdCBNaW4gJmFubykgew0gICAgICAgIHggPSBzdGQ6Om1pbih4LCBhbm8ueCk7DSAgICAgICAgcmV0dXJuICp0aGlzOw0gICAgfQ0NICAgIGZyaWVuZCBNaW4gb3BlcmF0b3IrKE1pbiAmbGhzLCBNaW4gJnJocykgew0gICAgICAgIE1pbiByZXQgPSBsaHM7DSAgICAgICAgcmV0ICs9IHJoczsNICAgICAgICByZXR1cm4gcmV0Ow0gICAgfQ19Ow0Ndm9pZCBpbmZvQXBwbHkoTWluICZpbmZvLCBpbnQgbCwgaW50IHIsIE1pbiB4KSB7DSAgICBpbmZvICs9IHg7DX0NDXZvaWQgdGFnQXBwbHkoTWluICZ0YWcsIGludCBsLCBpbnQgciwgTWluIHgpIHsNICAgIHRhZyArPSB4Ow19DQ0NdGVtcGxhdGU8Y2xhc3MgSW5mbywgY2xhc3MgVGFnPg1jbGFzcyBzZWdUcmVlIHsNI2RlZmluZSBscyBpIDw8IDENI2RlZmluZSBycyBpIDw8IDEgfCAxDSNkZWZpbmUgbWlkICgobCArIHIpID4+IDEpDSNkZWZpbmUgbHNvbiBscywgbCwgbWlkDSNkZWZpbmUgcnNvbiBycywgbWlkICsgMSwgcg0NICAgIGludCBuOw0gICAgc3RkOjp2ZWN0b3I8SW5mbz4gaW5mbzsNICAgIHN0ZDo6dmVjdG9yPFRhZz4gdGFnOw1wdWJsaWM6DSAgICBzZWdUcmVlKGNvbnN0IHN0ZDo6dmVjdG9yPEluZm8+ICZpbml0KSA6IG4oaW5pdC5zaXplKCkpIHsNICAgICAgICBhc3NlcnQobiA+IDApOw0gICAgICAgIGluZm8ucmVzaXplKDQgPDwgc3RkOjpfX2xnKG4pKTsNICAgICAgICB0YWcucmVzaXplKDQgPDwgc3RkOjpfX2xnKG4pKTsNICAgICAgICBhdXRvIGJ1aWxkID0gWyZdKGF1dG8gZGZzLCBpbnQgaSwgaW50IGwsIGludCByKSB7DSAgICAgICAgICAgIGlmIChsID09IHIpIHsNICAgICAgICAgICAgICAgIGluZm9baV0gPSBpbml0W2xdOw0gICAgICAgICAgICAgICAgcmV0dXJuOw0gICAgICAgICAgICB9DSAgICAgICAgICAgIGRmcyhkZnMsIGxzb24pOw0gICAgICAgICAgICBkZnMoZGZzLCByc29uKTsNICAgICAgICAgICAgcHVsbChpKTsNICAgICAgICB9Ow0gICAgICAgIGJ1aWxkKGJ1aWxkLCAxLCAwLCBuIC0gMSk7DSAgICB9DQ1wcml2YXRlOg0gICAgdm9pZCBwdWxsKGludCBpKSB7IGluZm9baV0gPSBpbmZvW2xzXSArIGluZm9bcnNdOyB9DQ0gICAgdGVtcGxhdGU8Y2xhc3MuLi4gVD4NICAgIHZvaWQgYXBwbHkoaW50IGksIGludCBsLCBpbnQgciwgY29uc3QgVCAmLi4uIHZhbCkgew0gICAgICAgIDo6aW5mb0FwcGx5KGluZm9baV0sIGwsIHIsIHZhbC4uLik7DSAgICAgICAgOjp0YWdBcHBseSh0YWdbaV0sIGwsIHIsIHZhbC4uLik7DSAgICB9DQ0gICAgdm9pZCBwdXNoKGludCBpLCBpbnQgbCwgaW50IHIpIHsNICAgICAgICBpZiAodGFnW2ldID09IFRhZygpKSByZXR1cm47DSAgICAgICAgYXBwbHkobHNvbiwgdGFnW2ldKTsNICAgICAgICBhcHBseShyc29uLCB0YWdbaV0pOw0gICAgICAgIHRhZ1tpXSA9IHt9Ow0gICAgfQ0NcHVibGljOg0gICAgdGVtcGxhdGU8Y2xhc3MuLi4gVD4NICAgIHZvaWQgcmFuZ2VBcHBseShpbnQgcWwsIGludCBxciwgTWluIHZhbCkgew0gICAgICAgIGF1dG8gZGZzID0gWyZdKGF1dG8gZGZzLCBpbnQgaSwgaW50IGwsIGludCByKSB7DSAgICAgICAgICAgIGlmIChxciA8IGwgfHwgciA8IHFsKSByZXR1cm47DSAgICAgICAgICAgIGlmIChxbCA8PSBsICYmIHIgPD0gcXIpIHsNICAgICAgICAgICAgICAgIGFwcGx5KGksIGwsIHIsIHZhbCk7DSAgICAgICAgICAgICAgICByZXR1cm47DSAgICAgICAgICAgIH0NICAgICAgICAgICAgcHVzaChpLCBsLCByKTsNICAgICAgICAgICAgZGZzKGRmcywgbHNvbik7DSAgICAgICAgICAgIGRmcyhkZnMsIHJzb24pOw0gICAgICAgICAgICBwdWxsKGkpOw0gICAgICAgIH07DSAgICAgICAgZGZzKGRmcywgMSwgMCwgbiAtIDEpOw0gICAgfQ0NICAgIEluZm8gcmFuZ2VBc2soaW50IHFsLCBpbnQgcXIpIHsNICAgICAgICBJbmZvIHJlc3t9Ow0gICAgICAgIGF1dG8gZGZzID0gWyZdKGF1dG8gZGZzLCBpbnQgaSwgaW50IGwsIGludCByKSB7DSAgICAgICAgICAgIGlmIChxciA8IGwgfHwgciA8IHFsKSByZXR1cm47DSAgICAgICAgICAgIGlmIChxbCA8PSBsICYmIHIgPD0gcXIpIHsNICAgICAgICAgICAgICAgIHJlcyA9IHJlcyArIGluZm9baV07DSAgICAgICAgICAgICAgICByZXR1cm47DSAgICAgICAgICAgIH0NICAgICAgICAgICAgcHVzaChpLCBsLCByKTsNICAgICAgICAgICAgZGZzKGRmcywgbHNvbik7DSAgICAgICAgICAgIGRmcyhkZnMsIHJzb24pOw0gICAgICAgIH07DSAgICAgICAgZGZzKGRmcywgMSwgMCwgbiAtIDEpOw0gICAgICAgIHJldHVybiByZXM7DSAgICB9DQ0jdW5kZWYgcnNvbg0jdW5kZWYgbHNvbg0jdW5kZWYgbWlkDSN1bmRlZiBycw0jdW5kZWYgbHMNfTsNDXZvaWQgcnVuKGludCB0Q2FzZSkgew0gICAgaW50IG4sIG0sIHg7DSAgICBzdGQ6OmNpbiA+PiBuID4+IG0gPj4geDsNICAgIHN0ZDo6dmVjdG9yPGludD4gdmFsOw0gICAgdmFsLnB1c2hfYmFjayh4KTsNICAgIHN0ZDo6dmVjdG9yPHN0ZDo6dHVwbGU8aW50LCBpbnQsIGludD4+IGJ1c2VzKG4pOw0gICAgc3RkOjp2ZWN0b3I8c3RkOjp0dXBsZTxpbnQsIGludCwgaW50Pj4gcGVvcGxlKG0pOw0gICAgc3RkOjp2ZWN0b3I8aW50PiBhbnMobSk7DSAgICBmb3IgKGF1dG8gJlt0LCByLCBsXTogYnVzZXMpIHsNICAgICAgICBzdGQ6OmNpbiA+PiB0ID4+IGwgPj4gcjsNICAgICAgICB2YWwucHVzaF9iYWNrKGwpOw0gICAgICAgIHZhbC5wdXNoX2JhY2socik7DSAgICB9DSAgICBmb3IgKGludCBpID0gMDsgaSA8IG07ICsraSkgew0gICAgICAgIGF1dG8gJltjLCBwLCBpZF0gPSBwZW9wbGVbaV07DSAgICAgICAgc3RkOjpjaW4gPj4gYyA+PiBwOw0gICAgICAgIHZhbC5wdXNoX2JhY2socCk7DSAgICAgICAgaWQgPSBpOw0gICAgfQ0gICAgc3RkOjpzb3J0KHZhbC5iZWdpbigpLCB2YWwuZW5kKCkpOw0gICAgdmFsLmVyYXNlKHN0ZDo6dW5pcXVlKHZhbC5iZWdpbigpLCB2YWwuZW5kKCkpLCB2YWwuZW5kKCkpOw0gICAgc3RkOjptYXA8aW50LCBpbnQ+IG1wOw0gICAgZm9yIChpbnQgaSA9IDA7IGkgPCB2YWwuc2l6ZSgpOyArK2kpIHsNICAgICAgICBtcFt2YWxbaV1dID0gaTsNICAgIH0NICAgIHN0ZDo6c29ydChidXNlcy5iZWdpbigpLCBidXNlcy5lbmQoKSwgc3RkOjpncmVhdGVyPD4oKSk7DSAgICBzdGQ6OnNvcnQocGVvcGxlLmJlZ2luKCksIHBlb3BsZS5lbmQoKSwgc3RkOjpncmVhdGVyPD4oKSk7DSAgICBpbnQgbm93ID0gMDsNICAgIHN0ZDo6dmVjdG9yPE1pbj4gaW5pdCh2YWwuc2l6ZSgpKTsNICAgIGluaXQuYmFjaygpLnggPSAwOw0gICAgc2VnVHJlZTxNaW4sIE1pbj4gc2VnVHJlZShpbml0KTsNICAgIGZvciAoYXV0byBbdCwgciwgbF06IGJ1c2VzKSB7DSAgICAgICAgd2hpbGUgKG5vdyA8IG0pIHsNICAgICAgICAgICAgYXV0byBbYywgcCwgaWRdID0gcGVvcGxlW25vd107DSAgICAgICAgICAgIGlmIChjIDw9IHQpIGJyZWFrOw0gICAgICAgICAgICBub3crKzsNICAgICAgICAgICAgcCA9IG1wW3BdOw0gICAgICAgICAgICBhdXRvIGluZm8gPSBzZWdUcmVlLnJhbmdlQXNrKHAsIHApOw0gICAgICAgICAgICBhbnNbaWRdID0gaW5mby54Ow0gICAgICAgIH0NICAgICAgICBsID0gbXBbbF0sIHIgPSBtcFtyXTsNICAgICAgICBhdXRvIGluZm8gPSBzZWdUcmVlLnJhbmdlQXNrKHIsIHIpOw0gICAgICAgIHNlZ1RyZWUucmFuZ2VBcHBseShsLCByIC0gMSwgTWluKGluZm8ueCArIDEpKTsNICAgIH0NICAgIC8vcmVtZW1iZXIgdG8gc29sdmUgcmVzdCBwZW9wbGUNICAgIHdoaWxlIChub3cgPCBtKSB7DSAgICAgICAgYXV0byBbYywgcCwgaWRdID0gcGVvcGxlW25vd107DSAgICAgICAgbm93Kys7DSAgICAgICAgcCA9IG1wW3BdOw0gICAgICAgIGF1dG8gaW5mbyA9IHNlZ1RyZWUucmFuZ2VBc2socCwgcCk7DSAgICAgICAgYW5zW2lkXSA9IGluZm8ueDsNICAgIH0NICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbTsgKytpKSB7DSAgICAgICAgaWYgKGFuc1tpXSA9PSBpbmYpIGFuc1tpXSA9IC0xOw0gICAgICAgIHN0ZDo6Y291dCA8PCBhbnNbaV0gPDwgJ1xuJzsNICAgIH0NfQ0NaW50IG1haW4oKSB7DSAgICBzdGQ6Omlvc19iYXNlOjpzeW5jX3dpdGhfc3RkaW8oZmFsc2UpOw0gICAgc3RkOjpjaW4udGllKG51bGxwdHIpOw0gICAgaW50IFQgPSAxOw0vLyAgICBzdGQ6OmNpbiA+PiBUOw0gICAgZm9yIChpbnQgdCA9IDE7IHQgPD0gVDsgKyt0KSB7DSAgICAgICAgcnVuKHQpOw0gICAgfQ0gICAgcmV0dXJuIDA7DX0="}]