[{"id":"2882","submission_id":"2882","filename":"G.cpp","source":"I2luY2x1ZGU8Yml0cy9zdGRjKysuaD4NCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQojZGVmaW5lIE4gMjAwMDEwDQojZGVmaW5lIHJlcChpLGwscikgZm9yKGludCBpPShsKTtpPD0ocik7aSsrKQ0KdXNpbmcgbGwgPWxvbmcgbG9uZyA7DQoNCmludCBuLGZhW05dLG0sZ29vZHMsc3pbTl07DQppbnQgRmluZChpbnQgeCl7cmV0dXJuIGZhW3hdPT14P3g6ZmFbeF09RmluZChmYVt4XSk7fQ0KdmVjdG9yPHBhaXI8aW50LGludD4+IGU7DQp2ZWN0b3I8aW50PiBnW05dOw0Kdm9pZCBtZXJnZShpbnQgdSxpbnQgdil7DQogICAgaW50IHB4PUZpbmQodSkscHk9RmluZCh2KTsNCiAgICBpZihweD09cHkpcmV0dXJuOw0KICAgIGZhW3B4XT1weTsNCiAgICBzeltweV0rPXN6W3B4XTsNCn0NCg0KYm9vbCB2aXNbTl07dmVjdG9yPGludD4geHh4W05dOw0KaW50IGNudFsyXSxjb2xbTl0sYVtOXSxiW05dLHBwOw0Kdm9pZCBkZnMoaW50IHUsaW50IHgpew0KICAgIHh4eFtwcF0ucHVzaF9iYWNrKHUpOw0KICAgIGNvbFt1XT14Ow0KICAgIGNudFtjb2xbdV1dKz1zelt1XTsNCiAgICB2aXNbdV09MTsNCiAgICBmb3IoaW50IHY6Z1t1XSl7DQogICAgICAgIGlmKHZpc1t2XT09MClkZnModix4XjEpOw0KICAgICAgICBlbHNlew0KICAgICAgICAgICAgaWYoY29sW3ZdPT14KXsNCiAgICAgICAgICAgICAgICBwdXRzKCJOTyIpOw0KICAgICAgICAgICAgICAgIGV4aXQoMCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQp9DQoNCmJpdHNldDwxMDAwMTA+IHRtcCxkcFsxMDAwMTBdLGdnLGgsZjsNCg0KaW50IGNbTl07DQp2ZWN0b3I8aW50PiBfaW5bTl07DQp2b2lkIHNvbHZlKCl7DQogICAgc2NhbmYoIiVkJWQlZCIsJm4sJmdvb2RzLCZtKTsNCiAgICByZXAoaSwxLG4pZmFbaV09aSxzeltpXT0xOw0KICAgIHJlcChpLDEsbSl7DQogICAgICAgIGludCBvLHUsdjsNCiAgICAgICAgc2NhbmYoIiVkJWQlZCIsJm8sJnUsJnYpOw0KICAgICAgICBpZihvPT0wKXsNCiAgICAgICAgICAgIG1lcmdlKHUsdik7DQogICAgICAgIH1lbHNlew0KICAgICAgICAgICAgZS5wdXNoX2JhY2soe3Usdn0pOw0KICAgICAgICB9DQogICAgfQ0KICAgIGZvcihhdXRvIFt1LHZdOmUpew0KICAgICAgICBpZihGaW5kKHUpPT1GaW5kKHYpKXsNCiAgICAgICAgICAgIHB1dHMoIk5PIik7DQogICAgICAgICAgICByZXR1cm47DQogICAgICAgIH0NCiAgICAgICAgZ1tGaW5kKHUpXS5wdXNoX2JhY2soRmluZCh2KSk7DQogICAgICAgIGdbRmluZCh2KV0ucHVzaF9iYWNrKEZpbmQodSkpOw0KICAgICAgICAvL3ByaW50ZigiJWQgJWRcbiIsRmluZCh1KSxGaW5kKHYpKTsNCiAgICB9DQogICAgcmVwKGksMSxuKV9pbltGaW5kKGkpXS5wdXNoX2JhY2soaSk7DQogICAgbT0wOw0KICAgIHJlcChpLDEsbil7DQogICAgICAgIGlmKEZpbmQoaSkhPWkpY29udGludWU7DQogICAgICAgIGlmKHZpc1tpXSljb250aW51ZTsNCiAgICAgICAgY250WzBdPWNudFsxXT0wOw0KICAgIHBwPWk7DQogICAgICAgIGRmcyhpLDApOw0KICAgICAgICBhWysrbV09Y250WzBdOw0KICAgICAgICBiW21dPWNudFsxXTsNCiAgICAgICAgY1ttXT1pOw0KDQogICAgICAgIC8vZm9yKGludCB1Onh4eFtpXSlwcmludGYoIiVkICIsdSk7cHV0cygiIik7DQogICAgfQ0KICAgIC8vcmVwKGksMSxtKXByaW50ZigiJWQgJWRcbiIsYVtpXSxiW2ldKTsNCiAgICBmWzBdPTEsZHBbMF09ZjsNCiAgICByZXAoaSwxLG0pew0KICAgICAgICBnZz0oZjw8YVtpXSk7DQogICAgICAgIGg9KGY8PGJbaV0pOw0KICAgICAgICAvL2Z8PWdnLGZ8PWg7DQogICAgICAgIGY9Z2d8aDsNCiAgICAgICAgZHBbaV09ZjsNCiAgICB9DQogICAgLy9yZXAoaSwxLG4paWYoZltpXT09MSlwcmludGYoIiVkICIsaSk7cHV0cygiIik7DQoNCiAgICBpZihmW2dvb2RzXT09MClwdXRzKCJOTyIpOw0KICAgIGVsc2V7DQogICAgICAgIHB1dHMoIllFUyIpOw0KICAgICAgICBpbnQgY3VyPWdvb2RzOw0KICAgICAgICBmb3IoaW50IGk9bTtpPj0xOy0taSl7DQogICAgICAgICAgICAvL2Fzc2VydChkcFtpXVtjdXJdPT0xKTsNCiAgICAgICAgICAgIGlmKGRwW2ldW2N1cl09PTApe3doaWxlKDEpO30NCiAgICAgICAgICAgICAgICAvL3ByaW50ZigiaT0lZCxjdXI9JWRcbiIsaSxjdXIpOw0KICAgICAgICAgICAgaWYoY3VyPT0wKWJyZWFrOw0KICAgICAgICAgICAgaWYoY3VyLWFbaV0+PTAmJmRwW2ktMV1bY3VyLWFbaV1dPT0xKXsNCiAgICAgICAgICAgICAgICAvL3ByaW50ZigiJWQgIixhW2ldKTsNCiAgICAgICAgICAgICAgICBmb3IoaW50IHU6eHh4W2NbaV1dKWlmKGNvbFt1XT09MCl7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IoaW50IHg6X2luW3VdKXByaW50ZigiJWQgIix4KTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgY3VyLT1hW2ldOw0KICAgICAgICAgICAgfWVsc2UgaWYoY3VyLWJbaV0+PTAmJmRwW2ktMV1bY3VyLWJbaV1dPT0xKXsNCiAgICAgICAgICAgICAgICAvL3ByaW50ZigiJWQgIixiW2ldKTsNCiAgICAgICAgICAgICAgICBjdXItPWJbaV07DQogICAgICAgICAgICAgICAgZm9yKGludCB1Onh4eFtjW2ldXSlpZihjb2xbdV09PTEpew0KICAgICAgICAgICAgICAgICAgICBmb3IoaW50IHg6X2luW3VdKXByaW50ZigiJWQgIix4KTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9ZWxzZXsNCiAgICAgICAgICAgICAgICAvL2V4aXQoMCk7DQogICAgICAgICAgICAgICAgd2hpbGUoMSk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KDQogICAgfQ0KfQ0KDQppbnQgbWFpbigpIHsNCiAgICAvL2ZyZW9wZW4oImluLnR4dCIsInIiLHN0ZGluKTsNCiAgICBpbnQgdD0xOw0KICAgIHdoaWxlKHQtLSlzb2x2ZSgpOw0KCXJldHVybiAwOw0KfQ0K"}]