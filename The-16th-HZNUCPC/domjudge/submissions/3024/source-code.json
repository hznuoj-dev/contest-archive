[{"id":"3024","submission_id":"3024","filename":"i.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+DQp1c2luZyBuYW1lc3BhY2Ugc3RkOw0KI2RlZmluZSBsbCBsb25nIGxvbmcNCiNkZWZpbmUgZW5kbCAnXG4nDQpsbCB0Ow0KbGwgbFs1XTsNCmxsIHJbNV07DQpsbCB0dGVtcFs1XTsNCnN0cmluZyBzOw0KaW50IG1haW4oKXsNCiAgICBpb3M6OnN5bmNfd2l0aF9zdGRpbyhmYWxzZSksY2luLnRpZSgwKSxjb3V0LnRpZSgwKTsNCiAgICBjaW4+PnQ7DQogICAgd2hpbGUodC0tKXsNCiAgICAgICAgY2luPj5zOw0KICAgICAgICBsbCBhbnMgPXMuc2l6ZSgpLTE7DQogICAgICAgIGxsIG1pbm49MDsNCiAgICAgICAgZm9yKGludCBpPTA7aTw9YW5zO2krKyl7DQogICAgICAgICAgICBsbCBsZW49bWluKChsbClpLChsbClhbnMtaSk7DQogICAgICAgICAgICBsbCB0ZW1wPTE7DQogICAgICAgICAgICBsbCBmbGFnPTA7DQogICAgICAgICAgICBmb3IoaW50IGo9MTtqPD1sZW47aisrKXsNCiAgICAgICAgICAgICAgICBpZihzW2ktal09PXNbaStqXSl7DQogICAgICAgICAgICAgICAgICAgIHRlbXArPTI7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGVsc2V7DQogICAgICAgICAgICAgICAgICAgIGZsYWcrKzsNCiAgICAgICAgICAgICAgICAgICAgbFtmbGFnXT1pLWo7DQogICAgICAgICAgICAgICAgICAgIHJbZmxhZ109aStqOw0KICAgICAgICAgICAgICAgICAgICB0dGVtcFtmbGFnLTFdPXRlbXA7DQogICAgICAgICAgICAgICAgICAgIHRlbXArPTI7DQogICAgICAgICAgICAgICAgICAgIGlmKGZsYWc9PTMpDQogICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHR0ZW1wW2ZsYWddPXRlbXA7DQogICAgICAgICAgICBpZihmbGFnPT0wKXsNCiAgICAgICAgICAgICAgICBpZihsZW4+MCl7DQogICAgICAgICAgICAgICAgICAgIG1pbm49bWF4KG1pbm4sdHRlbXBbZmxhZ10pOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGVsc2UgaWYoZmxhZz09MSl7DQogICAgICAgICAgICAgICAgaWYoc1tsW2ZsYWddXT09c1tpXXx8c1tyW2ZsYWddXT09c1tpXSl7DQogICAgICAgICAgICAgICAgICAgIG1pbm49bWF4KG1pbm4sdHRlbXBbZmxhZ10pOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZih0dGVtcFswXT4xKXsNCiAgICAgICAgICAgICAgICAgICAgbWlubj1tYXgobWlubix0dGVtcFswXSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgZWxzZSBpZihmbGFnPT0yKXsNCiAgICAgICAgICAgICAgICBpZihmbGFnPT0zKQ0KICAgICAgICAgICAgICAgIGZsYWctLTsNCiAgICAgICAgICAgICAgICBpZigoc1tsW2ZsYWddXT09c1tsW2ZsYWctMV1dJiZzW3JbZmxhZ11dPT1zW3JbZmxhZy0xXV0pfHwoc1tsW2ZsYWddXT09c1tyW2ZsYWctMV1dJiZzW3JbZmxhZ11dPT1zW2xbZmxhZy0xXV0pKQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgbWlubj1tYXgobWlubix0dGVtcFtmbGFnXSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGZsYWctLTsNCiAgICAgICAgICAgICAgICBpZihzW2xbZmxhZ11dPT1zW2ldfHxzW3JbZmxhZ11dPT1zW2ldKXsNCiAgICAgICAgICAgICAgICAgICAgbWlubj1tYXgobWlubix0dGVtcFtmbGFnXSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGlmKHR0ZW1wWzBdPjEpew0KICAgICAgICAgICAgICAgICAgICBtaW5uPW1heChtaW5uLHR0ZW1wWzBdKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgZm9yKGludCBpPTA7aTxhbnM7aSsrKXsNCiAgICAgICAgICAgIGxsIGo9aSsxOw0KICAgICAgICAgICAgbGwgbGVuPW1pbigobGwpaSsxLChsbClhbnMtaisxKTsNCiAgICAgICAgICAgIGxsIHRlbXA9MDsNCiAgICAgICAgICAgIGxsIGZsYWc9MDsNCiAgICAgICAgICAgIGZvcihpbnQgaz0xO2s8PWxlbjtrKyspew0KICAgICAgICAgICAgICAgIGlmKHNbaS1rKzFdPT1zW2oray0xXSl7DQogICAgICAgICAgICAgICAgICAgIHRlbXArPTI7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGVsc2V7DQogICAgICAgICAgICAgICAgICAgIGZsYWcrKzsNCiAgICAgICAgICAgICAgICAgICAgbFtmbGFnXT1pLWsrMTsNCiAgICAgICAgICAgICAgICAgICAgcltmbGFnXT1qK2stMTsNCiAgICAgICAgICAgICAgICAgICAgdHRlbXBbZmxhZy0xXT10ZW1wOw0KICAgICAgICAgICAgICAgICAgICB0ZW1wKz0yOw0KICAgICAgICAgICAgICAgICAgICBpZihmbGFnPT0zKQ0KICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICB0dGVtcFtmbGFnXT10ZW1wOw0KICAgICAgICAgICAgaWYoZmxhZz09MCl7DQogICAgICAgICAgICAgICAgaWYobGVuPj0xKXsNCiAgICAgICAgICAgICAgICAgICAgbWlubj1tYXgobWlubix0dGVtcFtmbGFnXSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYoZmxhZz09MSl7DQogICAgICAgICAgICAgICAgaWYodHRlbXBbMF0+MSkNCiAgICAgICAgICAgICAgICBtaW5uPW1heChtaW5uLHR0ZW1wWzBdKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGVsc2UgaWYoZmxhZz09Mnx8ZmxhZz09Myl7DQogICAgICAgICAgICAgICAgaWYoZmxhZz09MykNCiAgICAgICAgICAgICAgICBmbGFnLS07DQogICAgICAgICAgICAgICAgaWYoKHNbbFtmbGFnXV09PXNbbFtmbGFnLTFdXSYmc1tyW2ZsYWddXT09c1tyW2ZsYWctMV1dKXx8KHNbbFtmbGFnXV09PXNbcltmbGFnLTFdXSYmc1tyW2ZsYWddXT09c1tsW2ZsYWctMV1dKSkNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIG1pbm49bWF4KG1pbm4sdHRlbXBbZmxhZ10pOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZih0dGVtcFswXT4xKXsNCiAgICAgICAgICAgICAgICAgICAgbWlubj1tYXgobWlubix0dGVtcFswXSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIGNvdXQ8PG1pbm48PGVuZGw7DQogICAgfQ0KfQ=="}]