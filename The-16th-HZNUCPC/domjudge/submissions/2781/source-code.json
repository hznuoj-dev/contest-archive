[{"id":"2781","submission_id":"2781","filename":"A.cpp","source":"I2luY2x1ZGUgPGlvc3RyZWFtPg0KI2luY2x1ZGUgPGNzdHJpbmc+DQojaW5jbHVkZSA8c3RkbGliLmg+DQoNCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQp1c2luZyBsbCA9IGxvbmcgbG9uZzsNCg0KaW50IHBvc1syMF1bMjBdOw0Kdm9pZCBkZnMoaW50IHgsIGludCB5LGludCBudW0pDQp7DQoJaWYoeDw9MTkmJng+PTEmJnk+PTEmJnk8PTE5KQ0KCXsNCgkJaWYocG9zW3hdW3ldPT0xKQ0KCXsJDQoJCQ0KCQlwb3NbeF1beV09bnVtOw0KCQlkZnMoeCsxLHksbnVtKTsNCgkJZGZzKHgseS0xLG51bSk7DQoJCWRmcyh4LTEseSxudW0pOw0KCQlkZnMoeCx5KzEsbnVtKTsNCgkJcmV0dXJuOw0KCX0NCgllbHNlDQoJcmV0dXJuOw0KCX0NCglyZXR1cm47DQoJDQoJDQp9DQoNCg0KaW50IGNtcChjb25zdCB2b2lkKiBhLCBjb25zdCB2b2lkKiBiKSB7DQoJcmV0dXJuICooaW50KilhIC0gKihpbnQqKWI7DQp9DQoNCmludCBtYWluKCkNCnsNCglpbnQgaSxqLGssbDsNCglpbnQgbixtLHgseSxjLHN1bSA9IDAsY291bnQgPSAyOw0KCWNpbiA+PiBuOw0KCWZvcihpPTE7aTw9bjtpKyspDQoJew0KCQlmb3IgKGogPSAxOyBqIDwgMjA7IGorKykgew0KCQkJZm9yIChrID0gMTsgayA8IDIwOyBrKyspIHsNCgkJCQlwb3Nbal1ba10gPSAwOw0KCQkJfQ0KCQl9DQoJCXN1bSA9IDA7DQoJCWNvdW50ID0gMjsNCgkJY2luID4+IG07DQoJCWZvcihqPTE7ajw9bTtqKyspDQoJCXsNCgkJCWNpbiA+PnggPj4geSA+PiBjOw0KCQkJaWYoYz09MSkNCgkJCXsNCgkJCQlwb3NbeF1beV09MTsNCgkJCQkNCgkJCX0NCgkJCWVsc2UNCgkJCXsNCgkJCQlwb3NbeF1beV09LTE7DQoJCQl9DQoJCQkNCgkJfQkNCgkJCWZvcihqPTE7ajw9MTk7aisrKQ0KCQl7DQoJCQlmb3Ioaz0xO2s8PTE5O2srKykNCgkJCXsNCgkJCQlpZihwb3Nbal1ba109PTEpDQoJCQkJew0KCQkJCQlkZnMoaixrLGNvdW50KTsNCgkJCQkJY291bnQrKzsNCgkJCQl9DQoJCQl9DQoJCQkNCgkJfQ0KCQkNCgkJLypmb3Ioaj0xO2o8PTE5O2orKykNCgkJew0KCQkJZm9yKGs9MTtrPD0xOTtrKyspDQoJCQl7DQoJCQljb3V0IDw8IHBvc1tqXVtrXSA8PCAiICI7DQoJCQl9DQoJCQljb3V0IDw8IGVuZGw7DQoJCX0NCgkJKi8NCgkJDQoJCWludCBjbnQgPSAwOw0KCQkNCgkJZm9yIChqID0gMTsgaiA8IDIwOyBqKyspIHsNCgkJCWZvciAoayA9IDE7IGsgPCAyMDsgaysrKSB7DQoJCQkJaWYgKHBvc1tqXVtrXSA9PSAwKSB7DQoJCQkJCWludCBvcFs0XSA9IHswfSwgY250MSA9IDAsYiA9IDAsIGNudDIgPSAwOw0KCQkJCQlpZiAocG9zW2ogKyAxXVtrXSA+IDEgJiYgaiArIDEgPCAyMCkgew0KCQkJCQkJb3BbY250Ml0gPSBwb3NbaiArIDFdW2tdOw0KCQkJCQkJY250MiArKzsNCgkJCQkJfQ0KCQkJCQlpZiAocG9zW2ogLSAxXVtrXSA+IDEgJiYgaiAtIDEgPiAwKSB7DQoJCQkJCQlvcFtjbnQyXSA9IHBvc1tqIC0gMV1ba107DQoJCQkJCQljbnQyICsrOw0KCQkJCQl9DQoJCQkJCWlmIChwb3Nbal1bayArIDFdID4gMSAmJiBrICsgMSA8IDIwKSB7DQoJCQkJCQlvcFtjbnQyXSA9IHBvc1tqXVtrICsgMV07DQoJCQkJCQljbnQyICsrOw0KCQkJCQl9DQoJCQkJCWlmIChwb3Nbal1bayAtIDFdID4gMSAmJiBrIC0gMSA+IDApIHsNCgkJCQkJCW9wW2NudDJdID0gcG9zW2pdW2sgLSAxXTsNCgkJCQkJCWNudDIgKys7DQoJCQkJCX0NCgkJCQkJaWYgKGNudDIgPT0gMCkgew0KCQkJCQkJY29udGludWU7DQoJCQkJCX0NCgkJCQkJLypmb3IgKGNudDEgPSAwOyBjbnQxIDwgY250MjsgY250MSArKykgew0KCQkJCQkJY291dCA8PCBvcFtjbnQxXSA8PCAiICI7DQoJCQkJCX0NCgkJCQkJY291dCA8PCBlbmRsOyovDQoJCQkJCWlmIChjbnQyID09IDEpIHsNCgkJCQkJCWNudCsrOw0KCQkJCQkJY29udGludWU7DQoJCQkJCX0NCgkJCQkJaWYgKGNudDIgPT0gMikgew0KCQkJCQkJaWYgKG9wWzBdID09IG9wWzFdKSB7DQoJCQkJCQkJY250Kys7DQoJCQkJCQl9IGVsc2Ugew0KCQkJCQkJCWNudCArPSAyOw0KCQkJCQkJfQ0KCQkJCQkJY29udGludWU7DQoJCQkJCX0NCgkJCQkJcXNvcnQob3AsIGNudDIsIHNpemVvZiAoaW50KSwgY21wKTsNCgkJCQkJY250Kys7DQoJCQkJCWZvciAoY250MSA9IDE7IGNudDEgPCBjbnQyOyBjbnQxKyspIHsNCgkJCQkJCWlmIChvcFtjbnQxXSAhPSBvcFtjbnQxIC0gMV0pIHsNCgkJCQkJCQljbnQrKzsNCgkJCQkJCX0NCgkJCQkJfQ0KCQkJCQkNCgkJCQl9DQoJCQkJDQoJCQl9DQoJCX0NCgkJY291dCA8PCBjbnQgPDwgZW5kbDsNCgl9DQoJcmV0dXJuIDA7DQp9DQoNCg=="}]