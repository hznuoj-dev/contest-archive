[{"id":"4030","submission_id":"4030","filename":"E.cpp","source":"I2luY2x1ZGU8Yml0cy9zdGRjKysuaD4NCiNkZWZpbmUgZW5kbCAnXG4nDQojZGVmaW5lIHBsbCBwYWlyPGxsLCBsbD4NCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQoNCnR5cGVkZWYgbG9uZyBsb25nIGxsOw0KY29uc3QgbGwgTiA9IDFlOSArIDc7DQpjb25zdCBsb25nIGRvdWJsZSBlcHMgPSAxZS0zOw0KbGwgbjsNCnBsbCBwWzEwNV07DQoNCmxsIGdjZChsbCB4LCBsbCB5KXsNCglyZXR1cm4geSA9PSAwID8geCA6IGdjZCh5LCB4ICUgeSk7DQp9DQoNCmJvb2wgY2hlY2soaW50IGksIGludCBqLCBpbnQgaywgcGxsIHBbXSkgew0KCWxsIHgxID0gcFtpXS5maXJzdCwgeTExID0gcFtpXS5zZWNvbmQ7DQoJbGwgeDIgPSBwW2pdLmZpcnN0LCB5MiA9IHBbal0uc2Vjb25kOw0KCWxsIHgzID0gcFtrXS5maXJzdCwgeTMgPSBwW2tdLnNlY29uZDsNCglsb25nIGRvdWJsZSBrMSA9ICh5MiAtIHkxMSkgKiAxLjAgLyAoeDIgLSB4MSk7DQoJbG9uZyBkb3VibGUgYjEgPSB5MTEgLSAoeTIgLSB5MTEpICogMS4wIC8gKHgyIC0geDEpOw0KCWxvbmcgZG91YmxlIGsyID0gKHkzIC0geTExKSAqIDEuMCAvICh4MyAtIHgxKTsNCglsb25nIGRvdWJsZSBiMiA9IHkxMSAtICh5MyAtIHkxMSkgKiAxLjAgLyAoeDMgLSB4MSk7DQoJaWYgKGZhYnMoazEgLSBrMikgPD0gZXBzKQ0KCQlyZXR1cm4gZmFsc2U7DQoJcmV0dXJuIHRydWU7CQkNCn0NCg0KaW50IG1haW4oKSB7DQoJY2luID4+IG47DQoJZm9yIChpbnQgaSA9IDEsIHUsIHY7IGkgPD0gbjsgaSsrKXsNCgkJY2luID4+IHUgPj4gdjsNCgkJcFtpXSA9IHt1LCB2fTsNCgl9DQoJbGwgYW5zID0gMDsNCglmb3IgKGludCBpID0gMTsgaSA8PSBuIC0gMjsgKytpKSB7DQoJCWZvciAoaW50IGogPSBpICsgMTsgaiA8PSBuIC0gMTsgKytqKSB7DQoJCQlmb3IgKGludCBrID0gaiArIDE7IGsgPD0gbjsgKytrKSB7DQovLwkJCQlkb3VibGUgYTEgPSBzcXJ0KCgocFtpXS5maXJzdCAtIHBbal0uZmlyc3QpICogKHBbaV0uZmlyc3QgLSBwW2pdLmZpcnN0KSkgKyAoKHBbaV0uc2Vjb25kIC0gcFtqXS5zZWNvbmQpICogKHBbaV0uc2Vjb25kIC0gcFtqXS5zZWNvbmQpKSk7DQovLwkJCQlkb3VibGUgYTIgPSBzcXJ0KCgocFtpXS5maXJzdCAtIHBba10uZmlyc3QpICogKHBbaV0uZmlyc3QgLSBwW2tdLmZpcnN0KSkgKyAoKHBbaV0uc2Vjb25kIC0gcFtrXS5zZWNvbmQpICogKHBbaV0uc2Vjb25kIC0gcFtrXS5zZWNvbmQpKSk7DQovLwkJCQlkb3VibGUgYTMgPSBzcXJ0KCgocFtrXS5maXJzdCAtIHBbal0uZmlyc3QpICogKHBba10uZmlyc3QgLSBwW2pdLmZpcnN0KSkgKyAoKHBba10uc2Vjb25kIC0gcFtqXS5zZWNvbmQpICogKHBba10uc2Vjb25kIC0gcFtqXS5zZWNvbmQpKSk7DQoJCQkJaWYgKGNoZWNrKGksIGosIGssIHApKSB7DQoJCQkJCQkNCgkJCQkJLy9jb3V0IDw8IGkgPDwgIiAiIDw8IGogPDwgIiAiIDw8IGsgPDwgZW5kbDsNCgkJCQkJbGwgbnVtID0gMDsNCgkJCQkJbGwgaWpmID0gYWJzKHBbaV0uZmlyc3QgLSBwW2pdLmZpcnN0KSwgaWpzID0gYWJzKHBbaV0uc2Vjb25kIC0gcFtqXS5zZWNvbmQpOw0KCQkJCQlsbCBpa2YgPSBhYnMocFtpXS5maXJzdCAtIHBba10uZmlyc3QpLCBpa3MgPSBhYnMocFtpXS5zZWNvbmQgLSBwW2tdLnNlY29uZCk7DQoJCQkJCWxsIGtqZiA9IGFicyhwW2tdLmZpcnN0IC0gcFtqXS5maXJzdCksIGtqcyA9IGFicyhwW2tdLnNlY29uZCAtIHBbal0uc2Vjb25kKTsNCgkJCQkJLy9jb3V0IDw8IGlqZiA8PCAiICIgPDwgaWpzIDw8IGVuZGw7DQoJCQkJCS8vY291dCA8PCBpa2YgPDwgIiAiIDw8IGlrcyA8PCBlbmRsOw0KCQkJCQkvL2NvdXQgPDwga2pmIDw8ICIgIiA8PCBranMgPDwgZW5kbDsNCgkJCQkJaWYgKG1pbihpanMsIGlqZikgPT0gMCludW0gKz0gbWF4KGlqcywgaWpmKTsNCgkJCQkJZWxzZSBudW0gKz0gbWF4KGlqZiwgaWpzKSAvIChtYXgoaWpmLCBpanMpIC8gZ2NkKGlqZiwgaWpzKSk7DQoJCQkJCWlmIChtaW4oaWtzLCBpa2YpID09IDApbnVtICs9IG1heChpa3MsIGlrZik7DQoJCQkJCWVsc2UgbnVtICs9IG1heChpa2YsIGlrcykgLyAobWF4KGlrZiwgaWtzKSAvIGdjZChpa2YsIGlrcykpOw0KCQkJCQlpZiAobWluKGtqcywga2pmKSA9PSAwKW51bSArPSBtYXgoa2pzLCBramYpOw0KCQkJCQllbHNlIG51bSArPSBtYXgoa2pmLCBranMpIC8gKG1heChramYsIGtqcykgLyBnY2Qoa2pmLCBranMpKTsNCgkJCQkJLy9jb3V0IDw8IG51bSA8PCBlbmRsOw0KCQkJCQlhbnMgPSBtYXgoYW5zLCBudW0pOw0KCQkJCQkNCgkJCQl9DQoJCQkJDQoJCQl9DQoJCX0NCgl9DQoJY291dCA8PCBhbnMgPDwgZW5kbDsNCglyZXR1cm4gMDsNCn0="}]