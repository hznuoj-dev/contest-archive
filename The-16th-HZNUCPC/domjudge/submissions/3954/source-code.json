[{"id":"3954","submission_id":"3954","filename":"I.cpp","source":"I2luY2x1ZGU8aW9zdHJlYW0+DQojaW5jbHVkZTxzdHJpbmc+DQojaW5jbHVkZTx2ZWN0b3I+DQojaW5jbHVkZTxtYXA+DQoNCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQoNCmludCBuLCB0LCB4LCB5Ow0Kc3RyaW5nIHN0cjsNCg0Kdm9pZCBydW4oKSB7DQoJY2luID4+IHN0cjsNCglpbnQgbGVuID0gc3RyLmxlbmd0aCgpOw0KCXN0ciA9ICIgIiArIHN0cjsNCglpbnQgbWF4YW5zID0gMDsNCgkvLyAtLS0tLS0tLS0gb2RkIC0tLS0tLS0tLS0tLS0NCglmb3IgKGludCBpID0gMTsgaSA8PSBsZW47IGkrKykgew0KCQlpbnQgYW5zID0gMDsNCgkJdmVjdG9yPHBhaXI8Y2hhcixjaGFyPiA+IHByOw0KCQlpbnQgbCA9IGksIHIgPSBpLCBjbnQgPSAwOw0KCQljaGFyIGEsIGIsIGMgPSBzdHJbaV07DQoJCXdoaWxlIChsID49IDEgJiYgciA8PSBsZW4pIHsNCgkJCWlmIChzdHJbbF0gIT0gc3RyW3JdKSB7DQoJCQkJcHIucHVzaF9iYWNrKG1ha2VfcGFpcihzdHJbbF0sIHN0cltyXSkpOw0KCQkJfQ0KCQkJaWYgKHByLnNpemUoKSA+PSAzKSBicmVhazsgDQoJCQlsLS07IHIrKzsgY250Kys7DQoJCX0NCgkJaWYgKHByLnNpemUoKSA9PSAxKSB7DQoJCQlpZiAocHJbMF0uZmlyc3QgPT0gYyB8fCBwclswXS5zZWNvbmQgPT0gYykgew0KCQkJCXdoaWxlIChsID49IDEgJiYgciA8PSBsZW4pIHsNCgkJCQkJaWYgKHN0cltsXSA9PSBzdHJbcl0pIHsNCgkJCQkJCWwtLTsgcisrOyBjbnQrKzsNCgkJCQkJfSBlbHNlIHsNCgkJCQkJCWJyZWFrOw0KCQkJCQl9DQoJCQkJfQ0KCQkJCWFucyA9IG1heChhbnMsIGNudCAqIDIgKyAxKTsNCgkJCX0NCgkJCWVsc2Ugew0KCQkJCWwgPSBpIC0gMSwgciA9IGksIGNudCA9IDE7DQoJCQkJaWYgKHN0cltsXSAhPSBzdHJbcl0pIGFucyA9IG1heChhbnMsIDApOw0KCQkJCXdoaWxlIChsID49IDEgJiYgciA8PSBsZW4pIHsNCgkJCQkJaWYgKHN0cltsXSA9PSBzdHJbcl0pIHsNCgkJCQkJCWwtLTsgcisrOyBjbnQrKzsNCgkJCQkJfSBlbHNlIHsNCgkJCQkJCWJyZWFrOw0KCQkJCQl9DQoJCQkJfQ0KCQkJfQ0KCQkJYW5zID0gbWF4KGFucywgY250ICogMiArIDEpOw0KCQl9DQoJCWVsc2UgaWYgKHByLnNpemUoKSA9PSAyKSB7DQoJCQlpbnQgYTEgPSBwclswXS5maXJzdCwgYTIgPSBwclswXS5zZWNvbmQsIGIxID0gcHJbMV0uZmlyc3QsIGIyID0gcHJbMV0uc2Vjb25kOw0KCQkJaWYgKChhMSA9PSBiMSAmJiBhMiA9PSBiMikgfHwgKGExID09IGIyICYmIGEyID09IGIxKSkgew0KCQkJCXdoaWxlIChsID49IDEgJiYgciA8PSBsZW4pIHsNCgkJCQkJaWYgKHN0cltsXSA9PSBzdHJbcl0pIHsNCgkJCQkJCWwtLTsgcisrOyBjbnQrKzsNCgkJCQkJfSBlbHNlIHsNCgkJCQkJCWJyZWFrOw0KCQkJCQl9DQoJCQkJfQ0KCQkJCWFucyA9IG1heChhbnMsIGNudCAqIDIgKyAxKTsNCgkJCX0gZWxzZSB7DQoJCQkJaWYgKHByWzBdLmZpcnN0ID09IGMgfHwgcHJbMV0uc2Vjb25kID09IGMpIHsNCgkJCQkJd2hpbGUgKGwgPj0gMSAmJiByIDw9IGxlbikgew0KCQkJCQkJaWYgKHN0cltsXSA9PSBzdHJbcl0pIHsNCgkJCQkJCQlsLS07IHIrKzsgY250Kys7DQoJCQkJCQl9IGVsc2Ugew0KCQkJCQkJCWJyZWFrOw0KCQkJCQkJfQ0KCQkJCQl9DQoJCQkJCWFucyA9IG1heChhbnMsIGNudCAqIDIgKyAxKTsNCgkJCQl9IGVsc2Ugew0KCQkJCQlsID0gaSAtIDEsIHIgPSBpLCBjbnQgPSAxOw0KCQkJCQlpZiAoc3RyW2xdICE9IHN0cltyXSkgYW5zID0gbWF4KGFucywgMCk7DQoJCQkJCXdoaWxlIChsID49IDEgJiYgciA8PSBsZW4pIHsNCgkJCQkJCWlmIChzdHJbbF0gPT0gc3RyW3JdKSB7DQoJCQkJCQkJbC0tOyByKys7IGNudCsrOw0KCQkJCQkJfSBlbHNlIHsNCgkJCQkJCQlicmVhazsNCgkJCQkJCX0NCgkJCQkJfQ0KCQkJCX0NCgkJCQlhbnMgPSBtYXgoYW5zLCBjbnQgKiAyICsgMSk7DQoJCQl9DQoJCX0gZWxzZSBpZiAocHIuc2l6ZSgpID09IDMpIHsNCgkJCWwgPSBpIC0gMSwgciA9IGksIGNudCA9IDE7DQoJCQlpZiAoc3RyW2xdICE9IHN0cltyXSkgYW5zID0gbWF4KGFucywgMCk7DQoJCQl3aGlsZSAobCA+PSAxICYmIHIgPD0gbGVuKSB7DQoJCQkJaWYgKHN0cltsXSA9PSBzdHJbcl0pIHsNCgkJCQkJbC0tOyByKys7IGNudCsrOw0KCQkJCX0gZWxzZSB7DQoJCQkJCWJyZWFrOw0KCQkJCX0NCgkJCX0NCgkJCWFucyA9IG1heChhbnMsIGNudCAqIDIgKyAxKTsNCgkJfSBlbHNlIHsNCgkJCXdoaWxlIChsID49IDEgJiYgciA8PSBsZW4pIHsNCgkJCQlpZiAoc3RyW2xdID09IHN0cltyXSkgew0KCQkJCQlsLS07IHIrKzsgY250Kys7DQoJCQkJfSBlbHNlIHsNCgkJCQkJYnJlYWs7DQoJCQkJfQ0KCQkJfQ0KCQkJYW5zID0gbWF4KGFucywgY250ICogMiArIDEpOw0KCQl9DQoJCW1heGFucyA9IG1heChhbnMsIG1heGFucyk7DQoJfQ0KCQ0KCWNvdXQgPDwgbWF4YW5zIDw8ICdcbic7DQoJbWF4YW5zID0gMDsNCgkNCgkNCgkvLyAtLS0tLS0tLS0gZXZlbiAtLS0tLS0tLS0tLS0NCglmb3IgKGludCBpID0gMjsgaSA8PSBsZW47IGkrKykgew0KCQlpbnQgYW5zID0gMDsNCgkJdmVjdG9yPHBhaXI8Y2hhcixjaGFyPiA+IHByOw0KCQlpbnQgbCA9IGkgLSAxLCByID0gaSwgY250ID0gMTsNCgkJaWYgKHN0cltsXSAhPSBzdHJbcl0pIHsNCgkJCXByLnB1c2hfYmFjayhtYWtlX3BhaXIobCxyKSk7DQoJCX0NCgkJY2hhciBhLCBiOw0KCQl3aGlsZSAobCA+PSAxICYmIHIgPD0gbGVuKSB7DQoJCQlpZiAoc3RyW2xdICE9IHN0cltyXSkgew0KCQkJCXByLnB1c2hfYmFjayhtYWtlX3BhaXIoc3RyW2xdLCBzdHJbcl0pKTsNCgkJCX0NCgkJCWlmIChwci5zaXplKCkgPj0gMikgYnJlYWs7IA0KCQkJbC0tOyByKys7IGNudCsrOw0KCQl9DQoJCWlmIChwci5zaXplKCkgPT0gMSkgew0KCQkJbCA9IGkgLSAxLCByID0gaSwgY250ID0gMTsNCgkJCWlmIChzdHJbbF0gIT0gc3RyW3JdKSBhbnMgPSBtYXgoYW5zLCAwKTsNCgkJCXdoaWxlIChsID49IDEgJiYgciA8PSBsZW4pIHsNCgkJCQlpZiAoc3RyW2xdID09IHN0cltyXSkgew0KCQkJCQlsLS07IHIrKzsgY250Kys7DQoJCQkJfSBlbHNlIHsNCgkJCQkJYnJlYWs7DQoJCQkJfQ0KCQkJfQ0KCQkJYW5zID0gbWF4KGFucywgY250ICogMik7DQoJCX0NCgkJZWxzZSBpZiAocHIuc2l6ZSgpID09IDIpIHsNCgkJCWludCBhMSA9IHByWzBdLmZpcnN0LCBhMiA9IHByWzBdLnNlY29uZCwgYjEgPSBwclsxXS5maXJzdCwgYjIgPSBwclsxXS5zZWNvbmQ7DQoJCQlpZiAoKGExID09IGIxICYmIGEyID09IGIyKSB8fCAoYTEgPT0gYjIgJiYgYTIgPT0gYjEpKSB7DQoJCQkJd2hpbGUgKGwgPj0gMSAmJiByIDw9IGxlbikgew0KCQkJCQlpZiAoc3RyW2xdID09IHN0cltyXSkgew0KCQkJCQkJbC0tOyByKys7IGNudCsrOw0KCQkJCQl9IGVsc2Ugew0KCQkJCQkJYnJlYWs7DQoJCQkJCX0NCgkJCQl9DQoJCQkJYW5zID0gbWF4KGFucywgY250ICogMik7DQoJCQl9IGVsc2Ugew0KCQkJCWwgPSBpIC0gMSwgciA9IGksIGNudCA9IDE7DQoJCQkJaWYgKHN0cltsXSAhPSBzdHJbcl0pIGFucyA9IG1heChhbnMsIDApOw0KCQkJCXdoaWxlIChsID49IDEgJiYgciA8PSBsZW4pIHsNCgkJCQkJaWYgKHN0cltsXSA9PSBzdHJbcl0pIHsNCgkJCQkJCWwtLTsgcisrOyBjbnQrKzsNCgkJCQkJfSBlbHNlIHsNCgkJCQkJCWJyZWFrOw0KCQkJCQl9DQoJCQkJfQ0KCQkJCWFucyA9IG1heChhbnMsIGNudCAqIDIpOw0KCQkJfQ0KCQl9IGVsc2Ugew0KCQkJd2hpbGUgKGwgPj0gMSAmJiByIDw9IGxlbikgew0KCQkJCWlmIChzdHJbbF0gPT0gc3RyW3JdKSB7DQoJCQkJCWwtLTsgcisrOyBjbnQrKzsNCgkJCQl9IGVsc2Ugew0KCQkJCQlicmVhazsNCgkJCQl9DQoJCQl9DQoJCQlhbnMgPSBtYXgoYW5zLCBjbnQgKiAyKTsNCgkJfQ0KCQltYXhhbnMgPSBtYXgoYW5zLCBtYXhhbnMpOw0KCX0NCgkNCgkNCgljb3V0IDw8IG1heGFucyA8PCAnXG4nOw0KfQ0KDQppbnQgbWFpbiAoKSB7DQoJY2luID4+IHQ7DQoJd2hpbGUgKHQtLSkgew0KCQlydW4oKTsNCgl9DQoJcmV0dXJuIDA7DQp9"}]