[{"id":"2659","submission_id":"2659","filename":"F.cpp","source":"I2luY2x1ZGU8Yml0cy9zdGRjKysuaD4NCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQpjb25zdCBpbnQgTj0xZTUrNTsNCmludCBuLHEsbTsNCmludCBmYVtOKjJdLHN6W04qMl07DQppbnQgZmluZChpbnQgeCkgew0KCXJldHVybiBmYVt4XT09eD94OmZhW3hdPWZpbmQoZmFbeF0pOw0KfQ0Kdm9pZCB1bmkoaW50IHgsaW50IHkpIHsNCglpbnQgZng9ZmluZCh4KSxmeT1maW5kKHkpOw0KCWlmKGZ4PT1meSlyZXR1cm47DQoJc3pbZnldKz1zeltmeF07DQoJZmFbZnhdPWZ5Ow0KfQ0KYm9vbCBmbGFnPXRydWU7DQpzdHJ1Y3Qgbm9kZSB7DQoJaW50IGZmLHZhbCx2YWxuOw0KfTsNCnZlY3Rvcjxub2RlPm1lc3M7DQpiaXRzZXQ8Tj5kcFtOXTsNCmJvb2wgdmlzW04qMl0sZ29vZFtOKjJdOw0KaW50IG1haW4oKSB7DQovLwljb3V0PDxzaXplb2YoZHApLzEwMjQvMTAyNC84PDwnXG4nOw0KCWlvczo6c3luY193aXRoX3N0ZGlvKGZhbHNlKTsNCgljaW4+Pm4+PnE+Pm07DQoJZm9yKGludCBpPTE7IGk8PW4qMjsgaSsrKSB7DQoJCWZhW2ldPWk7DQoJCWlmKGk8PW4pc3pbaV09MTsNCgkJZWxzZSBzeltpXT0wOw0KCX0NCglmb3IoaW50IGk9MSxrLGEsYjsgaTw9bTsgaSsrKSB7DQoJCWNpbj4+az4+YT4+YjsNCgkJaWYoIWZsYWcpY29udGludWU7DQoJCWlmKGs9PTApIHsNCgkJCS8vYSBiICBhK24gYituDQoJCQlpZihmaW5kKGEpPT1maW5kKGIrbikgfHwgZmluZChiKT09ZmluZChhK24pKSB7DQoJCQkJZmxhZz1mYWxzZTsNCgkJCX0gZWxzZSB7DQoJCQkJdW5pKGEsYik7DQoJCQkJdW5pKGErbixiK24pOw0KCQkJfQ0KCQl9IGVsc2Ugew0KCQkJLy9hIGIrbiAgYiBhK24NCgkJCWlmKGZpbmQoYSk9PWZpbmQoYikgfHwgZmluZChhK24pPT1maW5kKGIrbikpIHsNCgkJCQlmbGFnPWZhbHNlOw0KCQkJfSBlbHNlIHsNCgkJCQl1bmkoYSxiK24pOw0KCQkJCXVuaShiLGErbik7DQoJCQl9DQoJCX0NCgl9DQoJaWYoZmxhZykgew0KCQlmb3IoaW50IGk9MTsgaTw9bjsgaSsrKSB7DQoJCQlpZighdmlzW2ZpbmQoaSldKSB7DQoJCQkvL2NvdXQ8PGk8PCcgJzw8ZmluZChpKTw8JyAnPDxzeltmaW5kKGkpXTw8JyAnPDxzeltmaW5kKGkrbildPDwnXG4nOwkNCgkJCQltZXNzLnB1c2hfYmFjayh7aSxzeltmaW5kKGkpXSxzeltmaW5kKGkrbildfSk7DQoJCQkJdmlzW2ZpbmQoaSldPXZpc1tmaW5kKGkrbildPXRydWU7DQoJCQl9DQoJCX0NCgkJaW50IHRvdD1tZXNzLnNpemUoKTsNCi8vCQlmb3IoaW50IGk9MDtpPHRvdDtpKyspew0KLy8JCQljb3V0PDxtZXNzW2ldLmZmPDwnICc8PHN6W2ZpbmQobWVzc1tpXS5mZildPDwnICc8PHN6W2ZpbmQobWVzc1tpXS5mZituKV08PCdcbic7DQovLwkJfQ0KCQlmb3IoaW50IGk9MDtpPD10b3Q7aSsrKXsNCgkJCWRwW2ldLnJlc2V0KCk7DQoJCX0NCgkJZHBbMF1bMF09MTsNCgkJZm9yKGludCBpPTE7aTw9dG90O2krKyl7DQoJCQkvL2ktMQ0KCQkJZHBbaV18PShkcFtpLTFdPDxtZXNzW2ktMV0udmFsKTsNCgkJCWRwW2ldfD0oZHBbaS0xXTw8bWVzc1tpLTFdLnZhbG4pOw0KCQl9DQoJCWlmKGRwW3RvdF1bcV09PTEpew0KCQkJY291dDw8IllFU1xuIjsNCgkJCWludCBtcT1xOw0KCQkJZm9yKGludCBpPXRvdC0xO2k+PTA7aS0tKXsNCgkJCQlpZihtcS1tZXNzW2ldLnZhbD49MCAmJiBkcFtpXVttcS1tZXNzW2ldLnZhbF09PTEpew0KCQkJCQkvL2Fuc1tpXT1maW5kKG1lc3NbaV0uZmYpOw0KCQkJCQlnb29kW2ZpbmQobWVzc1tpXS5mZildPXRydWU7DQoJCQkJCW1xLT1tZXNzW2ldLnZhbDsNCgkJCQl9ZWxzZSBpZihtcS1tZXNzW2ldLnZhbG4+PTAgJiYgZHBbaV1bbXEtbWVzc1tpXS52YWxuXT09MSl7DQoJCQkJCS8vYW5zW2ldPWZpbmQobWVzc1tpXS5mZituKTsNCgkJCQkJZ29vZFtmaW5kKG1lc3NbaV0uZmYrbildPXRydWU7DQoJCQkJCW1xLT1tZXNzW2ldLnZhbG47DQoJCQkJfQ0KCQkJfQ0KCQkJZm9yKGludCBpPTE7aTw9bjtpKyspew0KCQkJCWlmKGdvb2RbZmluZChpKV0pew0KCQkJCQljb3V0PDxpPDwnICc7DQoJCQkJfQ0KCQkJfQ0KCQkJY291dDw8J1xuJzsNCgkJfWVsc2V7DQoJCQljb3V0PDwiTk9cbiI7DQoJCX0NCgl9IGVsc2Ugew0KCQljb3V0PDwiTk9cbiI7DQoJfQ0KCXJldHVybiAwOw0KfQ=="}]