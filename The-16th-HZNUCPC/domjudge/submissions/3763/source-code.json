[{"id":"3763","submission_id":"3763","filename":"3.cpp","source":"I2luY2x1ZGU8Yml0cy9zdGRjKysuaD4NCmNvbnN0IGludCBOPTFlNSsxMDsNCmNvbnN0IGludCBpbmY9MHgzZjNmM2YzZjsNCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQpzdHJ1Y3Qgbm9kZQ0Kew0KCWludCB0LGwscjsNCn1hW05dOw0Kc3RydWN0IE5vZGUNCnsNCglpbnQgdCx4LGlkOw0KfWJbTl07DQpib29sIGNtcChub2RlIHgsbm9kZSB5KQ0Kew0KCXJldHVybiB4LnQ9PXkudD94LnI+eS5yOngudD55LnQ7DQp9DQpib29sIENtcChOb2RlIHgsTm9kZSB5KQ0Kew0KCXJldHVybiB4LnQ+eS50Ow0KfQ0KaW50IG4sbSx4LGFuc1tOXTsNCmludCBjbnQsY1tOPDwyXTsNCmludCB0cltOPDw0XSx0YWdbTjw8NF07DQojZGVmaW5lIGxzIChudzw8MSkNCiNkZWZpbmUgcnMgKGxzKzEpDQojZGVmaW5lIG1pZCAobCtyPj4xKQ0Kdm9pZCBidWlsZChpbnQgbncsaW50IGwsaW50IHIpDQp7DQoJaWYobD09cikNCgl7DQoJCWlmKHI9PXgpdHJbbnddPTA7DQoJCWVsc2UgdHJbbnddPWluZjsNCgkJcmV0dXJuOw0KCX0NCglidWlsZChscyxsLG1pZCk7DQoJYnVpbGQocnMsbWlkKzEscik7DQp9DQp2b2lkIGRvd24oaW50IG53LGludCBsLGludCByKQ0Kew0KCWlmKHRhZ1tud10pDQoJew0KCQlpZihsPT1yKQ0KCQkJdHJbbnddPW1pbih0cltud10sdGFnW253XSk7DQoJCWVsc2UNCgkJew0KCQkJaWYodGFnW2xzXSl0YWdbbHNdPW1pbih0YWdbbHNdLHRhZ1tud10pOw0KCQkJZWxzZSB0YWdbbHNdPXRhZ1tud107DQoJCQlpZih0YWdbcnNdKXRhZ1tyc109bWluKHRhZ1tyc10sdGFnW253XSk7DQoJCQllbHNlIHRhZ1tyc109dGFnW253XTsNCgkJfQ0KCQl0YWdbbnddPTA7DQoJfQ0KfQ0KaW50IHF1ZXJ5KGludCBudyxpbnQgbCxpbnQgcixpbnQgaykNCnsNCglkb3duKG53LGwscik7DQoJaWYobD09cilyZXR1cm4gdHJbbnddOw0KCWlmKGs8PW1pZClyZXR1cm4gcXVlcnkobHMsbCxtaWQsayk7DQoJZWxzZSByZXR1cm4gcXVlcnkocnMsbWlkKzEscixrKTsNCn0NCnZvaWQgdXBkYXRlKGludCBudyxpbnQgbCxpbnQgcixpbnQgcWwsaW50IHFyLGludCBrKQ0Kew0KCWRvd24obncsbCxyKTsNCglpZihxbDw9bCYmcjw9cXIpDQoJew0KCQl0YWdbbnddPWs7DQoJCXJldHVybjsNCgl9DQoJaWYocWw8PW1pZCkNCgkJdXBkYXRlKGxzLGwsbWlkLHFsLHFyLGspOw0KCWlmKHFyPm1pZCkNCgkJdXBkYXRlKHJzLG1pZCsxLHIscWwscXIsayk7DQp9DQppbnQgbWFpbigpDQp7DQoJc2NhbmYoIiVkJWQlZCIsJm4sJm0sJngpOw0KCWNbKytjbnRdPXg7DQoJZm9yKGludCBpPTE7aTw9bjtpKyspDQoJew0KCQlzY2FuZigiJWQlZCVkIiwmYVtpXS50LCZhW2ldLmwsJmFbaV0ucik7DQoJCWNbKytjbnRdPWFbaV0ubDsNCgkJY1srK2NudF09YVtpXS5yOw0KCX0NCglzb3J0KGErMSxhKzErbixjbXApOw0KCWZvcihpbnQgaT0xO2k8PW07aSsrKQ0KCXsNCgkJc2NhbmYoIiVkJWQiLCZiW2ldLnQsJmJbaV0ueCk7DQoJCWJbaV0uaWQ9aTsNCgkJY1srK2NudF09YltpXS54Ow0KCX0NCglzb3J0KGIrMSxiKzErbSxDbXApOw0KCXNvcnQoYysxLGMrMStjbnQpOw0KCWNudD11bmlxdWUoYysxLGMrMStjbnQpLWMtMTsNCgl4PWxvd2VyX2JvdW5kKGMrMSxjKzErY250LHgpLWM7DQoJYnVpbGQoMSwxLGNudCk7DQoJZm9yKGludCBpPTEsaj0xO2k8PW07aSsrKQ0KCXsNCgkJd2hpbGUoajw9biYmYVtqXS50Pj1iW2ldLnQpDQoJCXsNCgkJCWludCBsPWxvd2VyX2JvdW5kKGMrMSxjKzErY250LGFbal0ubCktYzsNCgkJCWludCByPWxvd2VyX2JvdW5kKGMrMSxjKzErY250LGFbal0uciktYzsNCgkJCXVwZGF0ZSgxLDEsY250LGwscixxdWVyeSgxLDEsY250LHIpKzEpOw0KCQkJaisrOw0KCQl9DQoJCWludCB5PWxvd2VyX2JvdW5kKGMrMSxjKzErY250LGJbaV0ueCktYzsNCgkJYW5zW2JbaV0uaWRdPXF1ZXJ5KDEsMSxjbnQseSk7DQoJfQ0KCWZvcihpbnQgaT0xO2k8PW07aSsrKQ0KCQlwcmludGYoIiVkXG4iLGFuc1tpXT09aW5mPy0xOmFuc1tpXSk7DQoJcmV0dXJuIDA7DQp9"}]