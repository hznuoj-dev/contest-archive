[{"id":"3866","submission_id":"3866","filename":"Untitled3.cpp","source":"I2luY2x1ZGU8Yml0cy9zdGRjKysuaD4NCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQpjb25zdCBpbnQgTiA9IDJlNSArIDEwMDsNCmludCBuLG0scTsNCmludCBmYVtOXSxzeltOXTsNCmludCBmb3VuZChpbnQgeCkNCnsNCglpZih4ID09IGZhW3hdKXJldHVybiB4Ow0KCWVsc2UgcmV0dXJuIGZhW3hdID0gZm91bmQoZmFbeF0pOw0KfQ0Kdm9pZCB1bml0eShpbnQgeCxpbnQgeSkNCnsNCi8vCWNvdXQgPDwnICc8PCB4IDw8ICcgJyA8PCB5IDw8ICdcbic7DQoJeCA9IGZvdW5kKHgpOw0KCXkgPSBmb3VuZCh5KTsNCglpZih4ID09IHkpcmV0dXJuOw0KCWlmKHN6W3hdID4gc3pbeV0pc3dhcCh4LHkpOy8veSBkYQ0KCWZhW3hdID0geTsNCglzelt5XSArPSBzelt4XTsNCn0NCmludCBoYW8oaW50IHgpDQp7DQoJcmV0dXJuIHggKiAyIC0gMTsNCn0NCmludCBodWFpKGludCB4KQ0Kew0KCXJldHVybiB4ICogMjsNCn0NCmludCBnZXR5dWFuKGludCB4KQ0Kew0KCWlmKHggJiAxKXJldHVybiB4IC8gMiArIDE7DQoJZWxzZSByZXR1cm4geCAvIDI7DQp9DQppbnQgdmlzW05dOw0Kc3RydWN0IEF7DQoJaW50IGEsYjsNCglpbnQgaWQ7DQp9dFtOXTsNCi8vaW50IGFbTl0sYltOXTsNCnZlY3RvcjxpbnQ+IGJlbG9uZ1tOXTsNCmludCBkcFtOXSx0bXBbMl1bTl07DQpwYWlyPGludCxpbnQ+IHFpYW5bTl0sdG1wcWlhblsyXVtOXTsNCmludCBwcmVbTl0sc3VmW05dOw0Kc2lnbmVkIG1haW4oKQ0Kew0KCXNjYW5mKCIlZCVkJWQiLCZuLCZxLCZtKTsNCglmb3IoaW50IGkgPSAxOyBpIDw9IDIgKiBuOyArK2kpew0KCQlmYVtpXSA9IGk7DQoJCXN6W2ldID0gMTsNCgl9DQoJZm9yKGludCBpID0gMTsgaSA8PSBtOyArK2kpew0KCQlpbnQgayxhLGI7DQoJCXNjYW5mKCIlZCVkJWQiLCZrLCZhLCZiKTsNCgkJaWYoayA9PSAwKXsNCgkJCXVuaXR5KGhhbyhhKSxoYW8oYikpOw0KCQkJdW5pdHkoaHVhaShhKSxodWFpKGIpKTsNCgkJfWVsc2V7DQoJCQl1bml0eShodWFpKGEpLGhhbyhiKSk7DQoJCQl1bml0eShoYW8oYSksaHVhaShiKSk7DQoJCX0NCgl9DQoJDQoJaW50IGNudCA9IDA7DQoJZm9yKGludCBpID0gMTsgaSA8PSBuOyArK2kpew0KCQlpZihmb3VuZChoYW8oaSkpID09IGZvdW5kKGh1YWkoaSkpKXsNCi8vCQkJY291dCA8PCIhXG4iOw0KCQkJcHJpbnRmKCJOT1xuIik7DQoJCQlyZXR1cm4gMDsNCgkJfQ0KCX0NCglmb3IoaW50IGkgPSAxOyBpIDw9IDIgKiBuOyArK2kpew0KLy8JCWNvdXQgPDwgZm91bmQoaSkgPDwgJyAnIDw8IGkgPDwgJ1xuJzsNCgkJYmVsb25nW2ZvdW5kKGkpXS5wdXNoX2JhY2soaSk7DQoJfQ0KCWZvcihpbnQgaSA9IDE7IGkgPD0gMiAqIG47ICsraSl7DQoJCWlmKGJlbG9uZ1tpXS5lbXB0eSgpKWNvbnRpbnVlOw0KCQlpbnQgaGFvY250ID0gMCxodWFpY250ID0gMDsNCgkJaWYodmlzW2dldHl1YW4oYmVsb25nW2ldLmJhY2soKSldKWNvbnRpbnVlOw0KCQlmb3IoYXV0byAmIHggOiBiZWxvbmdbaV0pew0KLy8JCQljb3V0IDw8IHggPDwgJyAnOw0KCQkJaWYoeCAmIDEpaGFvY250Kys7DQoJCQllbHNlIGh1YWljbnQrKzsNCgkJCXZpc1tnZXR5dWFuKHgpXSA9IDE7DQoJCX0NCi8vCQljb3V0PDwnXG4nOw0KCQl0WysrY250XS5hID0gaGFvY250Ow0KCQl0W2NudF0uYiA9IGh1YWljbnQ7DQoJCWlmKHRbY250XS5hIDwgdFtjbnRdLmIpc3dhcCh0W2NudF0uYSx0W2NudF0uYik7DQoJCXRbY250XS5pZCA9IGk7DQoJfQ0KCXNvcnQodCArIDEsdCArIGNudCArIDEsW10oQSAmeCxBICZ5KXsNCgkJcmV0dXJuIHguYSArIHguYiA8IHkuYSArIHkuYjsNCgl9KTsNCglmb3IoaW50IGkgPSAxOyBpIDw9IGNudDsgKytpKXsNCgkJcHJlW2ldID0gcHJlW2kgLSAxXSArIG1heCh0W2ldLmEsdFtpXS5iKTsNCgl9DQoJZm9yKGludCBpID0gY250OyBpID49IDE7IC0taSl7DQoJCXN1ZltpXSA9IHN1ZltpICsgMV0gKyBtYXgodFtpXS5hLHRbaV0uYik7DQoJfQ0KLy8JY291dCA8PCBjbnQgPDwgImNudFxuIjsNCi8vCWNvdXQgPDwgdFsxXS5hIDw8ICcgJyA8PHRbMV0uYiA8PCAnXG4nOw0KLy8JZm9yKGludCBpID0gMTsgaSA8PSBjbnQ7ICsraSl7DQovLwkJY291dCA8PCB0W2ldLmEgPDwgJyAnIDw8IHRbaV0uYiA8PCAnXG4nOw0KLy8JfQ0KCWRwWzBdID0gMTsNCglmb3IoaW50IGkgPSAxOyBpIDw9IGNudDsgKytpKXsNCgkJZm9yKGludCBqID0gcTsgaiA+PSAwOyAtLWopew0KCQkJaWYoaiA+PSB0W2ldLmEpaWYoZHBbaiAtIHRbaV0uYV0gJiYhZHBbal0pZHBbal09MSxxaWFuW2pdPXtqLXRbaV0uYSxpfTsNCgkJCWlmKGogPj0gdFtpXS5iKWlmKGRwW2otdFtpXS5iXSYmIWRwW2pdKWRwW2pdPTEscWlhbltqXT17ai10W2ldLmIsaX07DQoJCX0NCi8vCQlpbnQgbCA9IG1heChxIC0gc3VmW2kgKyAxXSwwKSxyID0gbWluKHByZVtpXSxxKTsNCi8vCQlmb3IoaW50IGogPSBxOyBqID49IDA7IC0tail7DQovLwkJCWlmKGogLSB0W2ldLmEgPj0gMCAmJiBkcFtqIC0gdFtpXS5hXSl0bXBbMF1bal0gPSAxLHRtcHFpYW5bMF1bal0gPSB7aiAtIHRbaV0uYSxpfTsNCi8vCQkJZWxzZSB0bXBbMF1bal0gPSAwOw0KLy8JCQlpZihqIC0gdFtpXS5iID49IDAgJiYgZHBbaiAtIHRbaV0uYl0pdG1wWzFdW2pdID0gMSx0bXBxaWFuWzFdW2pdID0ge2ogLSB0W2ldLmIsaX07DQovLwkJCWVsc2UgdG1wWzFdW2pdID0gMDsNCi8vCQl9DQovLwkJZm9yKGludCBqID0gcTsgaiA+PSAwOyAtLWopew0KLy8JCQlpZih0bXBbMF1bal0pew0KLy8JCQkJZHBbal0gPSAxOw0KLy8JCQkJcWlhbltqXSA9IHRtcHFpYW5bMF1bal07DQovLwkJCX1lbHNlIGlmKHRtcFsxXVtqXSl7DQovLwkJCQlkcFtqXSA9IDE7DQovLwkJCQlxaWFuW2pdID0gdG1wcWlhblsxXVtqXTsNCi8vCQkJfQ0KLy8JCX0NCgl9DQoJaWYoZHBbcV0pew0KCQljb3V0IDw8IllFU1xuIjsNCgkJaW50IGsgPSBxOw0KCQl2ZWN0b3I8aW50PiBhbnM7DQoJCXdoaWxlKGspew0KCQkJaW50IGhhb2NudCA9IDAsaHVhaWNudCA9IDA7DQoJCQlpbnQgaWQgPSB0W3FpYW5ba10uc2Vjb25kXS5pZDsNCgkJCWZvcihhdXRvICYgeCA6IGJlbG9uZ1tpZF0pew0KLy8JCQkJY291dCA8PCB4IDw8ICcgJzsNCgkJCQlpZih4ICYgMSloYW9jbnQrKzsNCgkJCQllbHNlIGh1YWljbnQrKzsNCgkJCX0NCi8vCQkJY291dCA8PCIhXG4iOw0KCQkJaWYoaGFvY250ID09IGsgLSBxaWFuW2tdLmZpcnN0KXsNCgkJCQlmb3IoYXV0byAmIHggOiBiZWxvbmdbaWRdKXsNCgkJCQkJaWYoeCAmIDEpYW5zLnB1c2hfYmFjayhnZXR5dWFuKHgpKTsNCgkJCQl9DQoJCQl9ZWxzZXsNCgkJCQlmb3IoYXV0byAmIHggOiBiZWxvbmdbaWRdKXsNCgkJCQkJaWYoeCAmIDEpOw0KCQkJCQllbHNlIGFucy5wdXNoX2JhY2soZ2V0eXVhbih4KSk7DQoJCQkJfQ0KCQkJfQ0KCQkJayA9IHFpYW5ba10uZmlyc3Q7DQoJCX0NCgkJc29ydChhbnMuYmVnaW4oKSxhbnMuZW5kKCkpOw0KCQlmb3IoYXV0byAmIHggOiBhbnMpew0KCQkJcHJpbnRmKCIlZCAiLHgpOw0KCQl9DQoJCXByaW50ZigiXG4iKTsNCgl9ZWxzZXsNCgkJY291dCA8PCAiTk9cbiI7DQoJfQ0KCXJldHVybiAwOw0KfQ0KLyoNCjQgMiA0DQoxIDEgMw0KMSAyIDQNCjAgMyA0DQowIDEgMg0KDQoxMyA3IDExDQowIDEgMg0KMCAxIDMNCjAgMSA0DQowIDEgNQ0KMSAxIDYNCjEgMSA3DQowIDggOQ0KMCA4IDEwDQowIDggMTENCjEgMTMgMTINCjEgMTIgMTMNCiov"}]