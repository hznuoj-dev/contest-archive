[{"id":"2247","submission_id":"2247","filename":"g.cpp","source":"I2luY2x1ZGU8Yml0cy9zdGRjKysuaD4NCiNkZWZpbmUgRm9yKGksbCxyKSBmb3IoaW50IGk9bCxpIyNlbmQ9cjtpPD1pIyNlbmQ7KytpKQ0KI2RlZmluZSByRm9yKGkscixsKSBmb3IoaW50IGk9cixpIyNlbmQ9bDtpPj1pIyNlbmQ7LS1pKQ0KI2RlZmluZSBwdXRzIGNvdXQ8PA0KdHlwZWRlZiBsb25nIGxvbmcgbGw7DQp1c2luZyBuYW1lc3BhY2Ugc3RkOw0KaW50IGZhWzEwMDAwNV0sd1sxMDAwMDVdOw0KaW5saW5lIGludCBmaW5kKGludCB4KXtyZXR1cm4gZmFbeF09PXg/eDpmYVt4XT1maW5kKGZhW3hdKTt9DQppbnQgbixxLG0sc1s1XTsNCmludCBza1sxMDAwMDVdLHNhWzEwMDAwNV0sc2JbMTAwMDA1XTsNCnZlY3RvcjxpbnQ+IHRvWzEwMDAwNV07DQppbnQgdmlzWzEwMDAwNV0sdmlzMlsxMDAwMDVdOw0KaW50IGZsYWc9MDsNCnZvaWQgZGZzKGludCB4KXsNCi8vCXByaW50ZigiJWRcbiIseCk7DQoJc1t2aXNbeF1dKz13W3hdOw0KCWZvcihpbnQgaT0wO2k8dG9beF0uc2l6ZSgpO2krKyl7DQoJCWludCB5PXRvW3hdW2ldOw0KCQlpZih2aXNbeV0pew0KCQkJaWYodmlzW3ldPT12aXNbeF0pIGZsYWc9MTsNCgkJfWVsc2V7DQoJCQl2aXNbeV09dmlzW3hdXjM7DQoJCQlkZnMoeSk7DQoJCX0NCgl9DQp9DQppbnQgc3VtOw0KdmVjdG9yPGludD4gZHMsZ3MsYXM7DQpuYW1lc3BhY2UgYmIgew0KCWNvbnN0IGludCBOPTFlNSsxMDsNCglpbnQgbixtLGZbTl0sbDFbTl0sbDJbTl07DQoJdmVjdG9yPGludD50W05dOw0KCWludCBsc3RbTl07DQoJdm9pZCB0cmFucyhpbnQgdyxpbnQgYykgew0KCQlGb3IoaSwwLHctMSkgbHN0W2ldPS0xZTk7DQoJCUZvcihpLDAsbSkgew0KCQkJaWYoIWZbaV0pIHsNCgkJCQlpbnQgbD1sc3RbaSV3XTsNCgkJCQlpZihpLWw8PXcqYykgew0KCQkJCQlmW2ldPTE7DQoJCQkJCWwxW2ldPXc7IGwyW2ldPShpLWwpL3c7DQoJCQkJfQ0KCQkJfSBlbHNlIGxzdFtpJXddPWk7DQoJCX0NCgl9DQoJdmVjdG9yPGludD4gd29yayhpbnQgX24saW50IF9tLGludCAqYSkgew0KCQluPV9uOyBtPV9tOw0KCQlGb3IoaSwwLG4tMSkgdFthW2ldXS5wdXNoX2JhY2soaSk7DQoJCWZbMF09MTsNCgkJRm9yKGksMSxtKSBpZih0W2ldLnNpemUoKSkgew0KCQkJdHJhbnMoaSx0W2ldLnNpemUoKSk7DQoJCX0NCgkJaWYoIWZbbV0pIHJldHVybiB7LTF9Ow0KCQlpbnQgeD1tOyB2ZWN0b3I8aW50PmFuczsNCgkJd2hpbGUoeCkgew0KCQkJRm9yKGosMCxsMlt4XS0xKSBhbnMucHVzaF9iYWNrKHRbbDFbeF1dW2pdKTsNCgkJCXgtPWwxW3hdKmwyW3hdOw0KCQl9DQoJCXJldHVybiBhbnM7DQoJfQ0KfQ0KdmVjdG9yPGludD4gdDsNCmludCB0b25bMTAwMDA1XSx0dG9uWzEwMDAwNV07DQp2ZWN0b3I8aW50PiB0YW5zLGRhbnM7DQp2b2lkIGRmczIoaW50IHgsaW50IHcpew0KCS8vcHJpbnRmKCJzcSAlZCAlZCAlZFxuIix4LHZpc1t4XSx3KTsNCgl2aXMyW3hdPTE7DQoJaWYodmlzW3hdPT13KSB0dG9uW3hdPTE7Ly9wcmludGYoImFxICVkXG4iLHgpOw0KCWZvcihpbnQgaT0wO2k8dG9beF0uc2l6ZSgpO2krKyl7DQoJCWludCB5PXRvW3hdW2ldOw0KCQlpZighdmlzMlt5XSkgdmlzMlt5XT0xLGRmczIoeSx3KTsNCgl9DQp9DQpzaWduZWQgbWFpbigpIHsNCiAgICBpb3M6OnN5bmNfd2l0aF9zdGRpbygwKTsgY2luLnRpZSgwKTsNCiAgICBjaW4+Pm4+PnE+Pm07DQogICAgZm9yKGludCBpPTE7aTw9bjtpKyspIGZhW2ldPWksd1tpXT0xOw0KICAgIGZvcihpbnQgaT0xO2k8PW07aSsrKSBjaW4+PnNrW2ldPj5zYVtpXT4+c2JbaV07DQogICAgZm9yKGludCBpPTE7aTw9bTtpKyspIGlmKCFza1tpXSkgd1tmaW5kKHNiW2ldKV0rPXdbZmluZChzYVtpXSldLGZhW2ZpbmQoc2FbaV0pXT1maW5kKHNiW2ldKTsNCiAgICBmb3IoaW50IGk9MTtpPD1tO2krKykgaWYoc2tbaV0pIHRvW2ZpbmQoc2FbaV0pXS5wdXNoX2JhY2soZmluZChzYltpXSkpLHRvW2ZpbmQoc2JbaV0pXS5wdXNoX2JhY2soZmluZChzYVtpXSkpOw0KICAgIGZvcihpbnQgaT0xO2k8PW47aSsrKSBpZihmaW5kKGkpPT1pJiYhdmlzW2ldKXsNCiAgICAJdmlzW2ldPTE7c1sxXT0wLHNbMl09MDsNCi8vICAgIAlwdXRzKCJRV1EiKTsNCiAgICAJZGZzKGkpOw0KLy8gICAgCXByaW50ZigiJWQgJWRcbiIsc1sxXSxzWzJdKTsNCiAgICAJaWYoZmxhZykgcmV0dXJuIHB1dHMoIk5PXG4iKSwwOw0KICAgIAlzdW0rPW1pbihzWzFdLHNbMl0pOw0KICAgIAl0LnB1c2hfYmFjayhtYXgoc1syXSxzWzFdKS1taW4oc1syXSxzWzFdKSk7DQoJfQ0KCXEtPXN1bTsgaWYocTwwKSByZXR1cm4gY291dDw8Ik5PXG4iLDA7DQovLwlwcmludGYoIiVkXG4iLHEpOw0KLy8JZm9yKGludCBpPTA7aTx0LnNpemUoKTtpKyspIHByaW50ZigiJWQgIix0W2ldKTtwdXRzKCIiKTsNCglhcz1iYjo6d29yayh0LnNpemUoKSxxLHQuZGF0YSgpKTsNCglpZihhcy5zaXplKCkmJmFzWzBdPT0tMSkgcmV0dXJuIHB1dHMoIk5PXG4iKSwwOw0KCXB1dHMoIllFU1xuIik7DQoJZm9yKGludCBpPTA7aTxhcy5zaXplKCk7aSsrKXsNCgkJdG9uW3RbYXNbaV1dXSsrOw0KCX0NCgltZW1zZXQodmlzLDAsc2l6ZW9mKHZpcykpOw0KCWZvcihpbnQgaT0xO2k8PW47aSsrKSBpZihmaW5kKGkpPT1pJiYhdmlzW2ldKXsNCiAgICAJdmlzW2ldPTE7c1sxXT0wLHNbMl09MDsNCiAgICAJZGZzKGkpOw0KICAgIAlpbnQgZmxhZzsNCiAgICAJaWYoIXRvblttYXgoc1syXSxzWzFdKS1taW4oc1syXSxzWzFdKV0pIGZsYWc9KHNbMV08c1syXT8xOjIpOw0KICAgIAllbHNlew0KICAgIAkJdG9uW21heChzWzJdLHNbMV0pLW1pbihzWzJdLHNbMV0pXS0tOw0KICAgIAkJZmxhZz0oc1sxXT5zWzJdPzE6Mik7DQoJCX0NCiAgICAJZGZzMihpLGZsYWcpOw0KCX0NCglmb3IoaW50IGk9MTtpPD1uO2krKykgaWYodHRvbltmaW5kKGkpXSkgY291dDw8aTw8IiAiOw0KfQ0K"}]