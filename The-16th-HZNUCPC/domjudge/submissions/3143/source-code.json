[{"id":"3143","submission_id":"3143","filename":"D.cpp","source":"I2luY2x1ZGU8Yml0cy9zdGRjKysuaD4NCi8vI2RlZmluZSBpbnQgbG9uZyBsb25nDQojZGVmaW5lIGxsIGxvbmcgbG9uZw0KI2RlZmluZSB2aSB2ZWN0b3I8aW50Pg0KI2RlZmluZSBwYiBwdXNoX2JhY2sNCg0KdXNpbmcgbmFtZXNwYWNlIHN0ZDsNCmNvbnN0IGludCBtb2QgPSAxZTkgKyA3Ow0KY29uc3QgaW50IElORiA9IDB4M2YzZjNmM2Y7DQpjb25zdCBpbnQgTiA9IDNlNSArIDEwOw0KaW50IHRyW048PDRdLCBsYXp5W04gPDwgNF07DQp2b2lkIHB1c2goaW50IG8pIHsNCglpZiAobGF6eVtvXSA8IElORikgew0KCQl0cltvICogMl0gPSBtaW4odHJbbyAqIDJdLCBsYXp5W29dKTsNCgkJdHJbbyAqIDIgKyAxXSA9IG1pbih0cltvICogMiArIDFdLCBsYXp5W29dKTsNCgkJbGF6eVtvICogMl0gPSBtaW4obGF6eVsyICogb10sIGxhenlbb10pOw0KCQlsYXp5W28gKiAyICsgMV0gPSBtaW4obGF6eVsyICogbyArIDFdLCBsYXp5W29dKTsNCgkJbGF6eVtvXSA9IElORjsNCgl9DQp9DQp2b2lkIHVwZChpbnQgcCwgaW50IHgsIGludCBvLCBpbnQgbCwgaW50IHIpIHsNCglpZiAobCA9PSByKSB7DQoJCXRyW29dID0geDsNCgkJcmV0dXJuOw0KCX0NCglpbnQgbWlkID0gKGwgKyByKSAvIDI7DQoJaWYgKHAgPD0gbWlkKSB1cGQocCwgeCwgbyAqIDIsIGwsIG1pZCk7DQoJZWxzZSB1cGQocCwgeCwgbyAqIDIgKyAxLCBtaWQgKyAxLCByKTsNCgl0cltvXSA9IG1pbih0cltvICogMl0sIHRyW28gKiAyICsgMV0pOw0KfQ0Kdm9pZCB1cGRhdGUoaW50IEwsIGludCBSLCBpbnQgeCwgaW50IG8sIGludCBsLCBpbnQgcikgew0KCWlmIChMIDw9IGwgJiYgciA8PSBSKSB7DQoJCXRyW29dID0gbWluKHRyW29dLCB4KTsNCgkJbGF6eVtvXSA9IG1pbihsYXp5W29dLCB4KTsNCgkJcmV0dXJuOw0KCX0NCglwdXNoKG8pOw0KCWludCBtaWQgPSAobCArIHIpIC8gMjsNCglpZiAoTCA8PSBtaWQpIHVwZGF0ZShMLCBSLCB4LCBvICogMiwgbCwgbWlkKTsNCglpZiAoUiA+IG1pZCkgdXBkYXRlKEwsIFIsIHgsIG8gKiAyICsgMSwgbWlkICsgMSwgcik7DQoJdHJbb10gPSBtaW4odHJbbyAqIDJdLCB0cltvICogMiArIDFdKTsNCn0NCmludCBxdWUoaW50IHAsIGludCBvLCBpbnQgbCwgaW50IHIpIHsNCglpZiAobCA9PSByKSB7DQoJCXJldHVybiB0cltvXTsNCgl9DQoJcHVzaChvKTsNCglpbnQgbWlkID0gKGwgKyByKSAvIDI7DQoJaWYgKHAgPD0gbWlkKSByZXR1cm4gcXVlKHAsIG8gKiAyLCBsLCBtaWQpOw0KCWVsc2UgcmV0dXJuIHF1ZShwLCBvICogMiArIDEsIG1pZCArIDEsIHIpOw0KfQ0Kdm9pZCBzb2x2ZSgpIHsNCgltZW1zZXQodHIsIDB4M2YsIHNpemVvZiB0cik7DQoJbWVtc2V0KGxhenksIDB4M2YsIHNpemVvZiBsYXp5KTsNCglpbnQgbiwgbSwgeDsNCgljaW4gPj4gbiA+PiBtID4+IHg7DQoJdmVjdG9yPGludD4gdjsNCgl2ZWN0b3I8dmVjdG9yPHBhaXI8aW50LCBpbnQ+Pj4gdyhOKTsNCglmb3IgKGludCBpID0gMDsgaSA8IG47ICsrIGkpIHsNCgkJaW50IHQsIGwsIHI7DQoJCWNpbiA+PiB0ID4+IGwgPj4gcjsNCgkJdi5wdXNoX2JhY2sobCk7DQoJCXYucHVzaF9iYWNrKHIpOw0KCQl3W3RdLnB1c2hfYmFjayh7bCwgcn0pOw0KCX0NCgl2ZWN0b3I8aW50PiBhbnMobSk7DQoJdmVjdG9yPHZlY3RvcjxwYWlyPGludCwgaW50Pj4+IHEoTik7DQoJZm9yIChpbnQgaSA9IDA7IGkgPCBtOyArKyBpKSB7DQoJCWludCBjLCBwOw0KCQljaW4gPj4gYyA+PiBwOw0KCQl2LnB1c2hfYmFjayhwKTsNCgkJcVtjXS5wdXNoX2JhY2soe3AsIGl9KTsNCgl9DQoJc29ydCh2LmJlZ2luKCksIHYuZW5kKCkpOw0KCXYuZXJhc2UodW5pcXVlKHYuYmVnaW4oKSwgdi5lbmQoKSksIHYuZW5kKCkpOw0KCWludCBNID0gdi5zaXplKCk7DQoJYXV0byBnZXQgPSBbJl0oaW50IFgpIHsNCgkJcmV0dXJuIGRpc3RhbmNlKHYuYmVnaW4oKSwgbG93ZXJfYm91bmQodi5iZWdpbigpLCB2LmVuZCgpLCBYKSkgKyAxOw0KCX07DQoJeCA9IGdldCh4KTsNCgl1cGQoeCwgMCwgMSwgMSwgTSk7DQoJZm9yIChpbnQgdCA9IE4gLSAxOyB0OyAtLSB0KSB7DQoJCWZvciAoYXV0byBbbCwgcl0gOiB3W3RdKSB7DQoJCQlsID0gZ2V0KGwpLCByID0gZ2V0KHIpOw0KCQkJaWYgKGwgPCByKQ0KCQkJdXBkYXRlKGwsIHIgLSAxLCBxdWUociwgMSwgMSwgTSkgKyAxLCAxLCAxLCBNKTsNCgkJfQ0KCQlmb3IgKGF1dG8gJltwLCBpXSA6IHFbdF0pIHsNCgkJCXAgPSBnZXQocCk7DQoJCQlhbnNbaV0gPSBxdWUocCwgMSwgMSwgTSk7DQoJCX0NCi8vCQljb3V0IDw8IHQgPDwgJ1xuJzsNCi8vCQlmb3IgKGludCBpID0gMTsgaSA8PSBNIDsgKysgaSApIGNvdXQgPDwgcXVlKGksIDEsIDEsIE0pIDw8ICcgJzsNCi8vCQljb3V0IDw8ICdcbic7DQoJfQ0KCWZvciAoYXV0byAmeCA6IGFucykgew0KCQlpZiAoeCA8PSBJTkYgLyAyKSBjb3V0IDw8IHggPDwgJ1xuJzsNCgkJZWxzZSBjb3V0IDw8IC0xIDw8ICdcbic7DQoJfQ0KfQ0Kc2lnbmVkIG1haW4oKSB7DQoJaW50IHQ7DQoJdCA9IDE7DQoJd2hpbGUgKHQgLS0pIHNvbHZlKCk7DQoJcmV0dXJuIDA7DQp9DQovKg0KNiAzIDEwDQoxIDEgMTANCjIgMyA2DQozIDUgOQ0KNCA3IDEwDQo1IDMgOA0KNiA3IDEwDQoxIDENCjIgNA0KNiA1DQoNCg0KKi8="}]