[{"id":"2823","submission_id":"2823","filename":"G.cpp","source":"I3ByYWdtYSBHQ0Mgb3B0aW1pemUoMikNCiNwcmFnbWEgR0NDIG9wdGltaXplKDMsIk9mYXN0IiwiaW5saW5lIikNCiNpbmNsdWRlPGJpdHMvc3RkYysrLmg+DQp1c2luZyBuYW1lc3BhY2Ugc3RkOw0KY29uc3QgaW50IGluZiA9IDFlOTsNCmNvbnN0IGludCBtYXhuID0gM2U1ICsgNzsNCnR5cGVkZWYgbG9uZyBsb25nIGxsOw0KdHlwZWRlZiBwYWlyPGludCxpbnQ+IHBpaTsNCnR5cGVkZWYgcGFpcjxsbCxsbD4gcGxsOw0Kc3RydWN0IERTVQ0Kew0KICAgIHZlY3RvcjxpbnQ+ZixzaXo7DQogICAgRFNVIChpbnQgbik6ZihuKSxzaXoobiwxKSB7aW90YShmLmJlZ2luKCksZi5lbmQoKSwwKTsgfQ0KICAgIGludCBsZWFkZXIgKGludCB4KQ0KICAgIHsNCiAgICAgICAgd2hpbGUgKHggIT0gZlt4XSkNCiAgICAgICAgew0KICAgICAgICAgICAgeCA9IGZbeF0gPSBmW2ZbeF1dOw0KICAgICAgICB9DQogICAgICAgIHJldHVybiB4Ow0KICAgIH0NCiAgICBib29sIHNhbWUgKGludCB4LGludCB5KQ0KICAgIHsNCiAgICAgICAgcmV0dXJuIGxlYWRlcih4KSA9PSBsZWFkZXIoeSk7DQogICAgfQ0KICAgIGJvb2wgbWVyZ2UgKGludCB4LGludCB5KQ0KICAgIHsNCiAgICAgICAgeCA9IGxlYWRlcih4KTsNCiAgICAgICAgeSA9IGxlYWRlcih5KTsNCiAgICAgICAgaWYgKHggPT0geSkgcmV0dXJuIGZhbHNlOw0KICAgICAgICBpZiAoeCA8IHkpDQogICAgICAgICAgICBmW3ldID0geDsNCiAgICAgICAgZWxzZQ0KICAgICAgICAgICAgZlt4XSA9IHk7DQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCiAgICBpbnQgc2l6ZShpbnQgeCkgeyByZXR1cm4gc2l6W2xlYWRlcih4KV07fQ0KfTsNCnZlY3RvcjxpbnQ+aGFbbWF4bl07DQppbnQgZHBbbWF4bl0sd1ttYXhuXSx3aFttYXhuXTsNCnBpaSBwcmVbbWF4bl07DQppbnQgbWFpbiAoKQ0Kew0KICAgIGlvczo6c3luY193aXRoX3N0ZGlvKGZhbHNlKTsNCiAgICBjaW4udGllKDApOw0KICAgIGNvdXQudGllKDApOw0KICAgIGludCB0dCA9IDE7DQogICAgLy9jaW4gPj4gdHQ7DQogICAgd2hpbGUgKHR0LS0pDQogICAgew0KICAgICAgICBpbnQgbixtLHE7DQogICAgICAgIGNpbiA+PiBuID4+IHEgPj4gbTsNCiAgICAgICAgRFNVIGcobioyKzEpOw0KICAgICAgICBpbnQgcGQgPSAxOw0KICAgICAgICBmb3IgKGludCBpID0gMTsgaSA8PSBtOyArK2kpDQogICAgICAgIHsNCiAgICAgICAgICAgIGludCBvcCxhLGI7DQogICAgICAgICAgICBjaW4gPj4gb3AgPj4gYSA+PiBiOw0KICAgICAgICAgICAgaWYgKG9wID09IDApDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgZy5tZXJnZShhLGIpOw0KICAgICAgICAgICAgICAgIGcubWVyZ2UoYStuLGIrbik7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBlbHNlDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgZy5tZXJnZShhK24sYik7DQogICAgICAgICAgICAgICAgZy5tZXJnZShhLGIrbik7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgZm9yIChpbnQgaSA9IDE7IGkgPD0gbjsgKytpKQ0KICAgICAgICB7DQogICAgICAgICAgICBpZiAoZy5zYW1lKGksaStuKSkgcGQgPSAwOw0KICAgICAgICB9DQogICAgICAgIGlmIChwZCkNCiAgICAgICAgew0KICAgICAgICAgICAgZm9yIChpbnQgaSA9IDE7IGkgPD0gbjsgKytpKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGhhW2cubGVhZGVyKGkpXS5wdXNoX2JhY2soaSk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpbnQgdG90ID0gMCxzdW0gPSAwOw0KICAgICAgICAgICAgZm9yIChpbnQgaSA9IDE7IGkgPD0gbjsgKytpKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGlmIChoYVtpXS5zaXplKCkgPiAwKQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgd1srK3RvdF0gPSBoYVtpXS5zaXplKCk7DQogICAgICAgICAgICAgICAgICAgIHdoW3RvdF0gPSBpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGRwWzBdID0gMTsNCiAgICAgICAgICAgIGZvciAoaW50IGkgPSAxOyBpIDw9IHRvdDsgKytpKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIC8vY291dCA8PCBoYVtpXS5zaXplKCkgPDwgIlxuIjsNCiAgICAgICAgICAgICAgICBmb3IgKGludCBqID0gMDsgaiA8PSBzdW07ICsraikNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIGlmIChkcFtqXSAmJiAhZHBbait3W2ldXSkNCiAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgZHBbait3W2ldXSA9IDE7DQogICAgICAgICAgICAgICAgICAgICAgICBwcmVbait3W2ldXSA9IHt3aFtpXSxqfTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBzdW0gKz0gd1tpXTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmIChkcFtxXSkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBjb3V0IDw8ICJZRVNcbiI7DQogICAgICAgICAgICAgICAgaW50IHBvcyA9IHE7DQogICAgICAgICAgICAgICAgd2hpbGUgKHBvcyA+IDApDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICBpbnQgbnAgPSBwcmVbcG9zXS5maXJzdDsNCiAgICAgICAgICAgICAgICAgICAgcG9zID0gcHJlW3Bvc10uc2Vjb25kOw0KICAgICAgICAgICAgICAgICAgICBmb3IgKGF1dG8gaXQ6aGFbbnBdKQ0KICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICBjb3V0IDw8IGl0IDw8ICcgJzsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBjb3V0IDw8ICJcbiI7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBlbHNlDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgY291dCA8PCAiTk9cbiI7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgZWxzZXsNCiAgICAgICAgICAgIGNvdXQgPDwgIk5PXG4iOw0KICAgICAgICB9DQogICAgfQ0KDQp9DQovKg0KNCAyIDQNCjEgMSAzDQoxIDIgNA0KMCAzIDQNCjAgMSAyDQoqLw0K"}]