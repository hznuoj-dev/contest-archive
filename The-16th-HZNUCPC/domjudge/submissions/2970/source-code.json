[{"id":"2970","submission_id":"2970","filename":"G.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+DQoNCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQojZGVmaW5lIGxuICdcbicNCg0KY29uc3QgaW50IE4gPSAxZTUgKyA1Ow0KDQppbnQgZltOXSwgc2l6W05dLCBjb2xbTl0sIHdbTl0sIGlkW05dOw0KaW50IGZpbmQoaW50IHgpIHsNCglpZihmW3hdID09IHgpIHJldHVybiB4Ow0KCWludCBwYXIgPSBmaW5kKGZbeF0pOw0KCWNvbFt4XSA9IGNvbFtmW3hdXSBeIHdbeF07DQoJcmV0dXJuIHBhcjsNCn0NCg0KYm9vbCBhbnMgPSB0cnVlOw0KDQp2b2lkIG1lcmdlKGludCB4LCBpbnQgeSwgaW50IFcpIHsNCi8vCWNvdXQgPDwgeCA8PCAiICIgPDwgeSA8PCBsbjsNCglpbnQgZnggPSBmaW5kKHgpLCBmeSA9IGZpbmQoeSk7DQovLwljb3V0IDw8IHggPDwgIiAiIDw8IHkgPDwgIiAiIDw8IGNvbFt4XSA8PCAiICIgPDwgY29sW3ldIDw8ICIgIiA8PCBXIDw8IGxuOw0KCWlmKGZ4ID09IGZ5KSB7DQoJCWlmKGNvbFt4XSBeIGNvbFt5XSAhPSBXKSBhbnMgPSBmYWxzZTsNCgkJcmV0dXJuOw0KCX0NCglpZihzaXpbZnhdIDwgc2l6W2Z5XSkgc3dhcCh4LCB5KSwgc3dhcChmeCwgZnkpOw0KCQ0KCXNpeltmeF0gKz0gc2l6W2Z5XTsNCglmW2Z5XSA9IGZ4Ow0KCXdbZnldID0gY29sW3hdIF4gY29sW3ldIF4gVzsNCgkNCn0NCg0KaW5saW5lIHZvaWQgc29sdmUoKSB7DQoJaW50IG4sIHEsIG07DQoJY2luID4+IG4gPj4gcSA+PiBtOw0KCWZvcihpbnQgaSA9IDE7IGkgPD0gbjsgaSsrKSANCgkJZltpXSA9IGksIGNvbFtpXSA9IDAsIHNpeltpXSA9IDEsIHdbaV0gPSAwOw0KCWZvcihpbnQgaSA9IDE7IGkgPD0gbTsgaSsrKSB7DQoJCWludCB4LCB5LCB3Ow0KCQljaW4gPj4gdyA+PiB4ID4+IHk7DQoJCW1lcmdlKHgsIHksIHcpOw0KCQlmaW5kKHgpOyBmaW5kKHkpOw0KLy8JCWNvdXQgPDwgY29sW3hdIDw8ICIgIiA8PCBjb2xbeV0gPDwgIiAiIDw8IHcgPDwgbG47DQovLwkJY291dCA8PCBmaW5kKHgpIDw8ICIgIiA8PCBmaW5kKHkpIDw8IGxuOw0KCX0NCglpZihhbnMgPT0gZmFsc2UpIA0KCQlyZXR1cm4gY291dCA8PCAiTk9cbiIsIHZvaWQoKTsNCgllbHNlIA0KCQljb3V0IDw8ICJZRVNcbiI7DQoJDQoJaW50IHRvdCA9IDA7DQoJZm9yKGludCBpID0gMTsgaSA8PSBuOyBpKyspIA0KCQlpZihmW2ldID09IGkpIGlkW2ldID0gKyt0b3Q7CQ0KCWZvcihpbnQgaSA9IDE7IGkgPD0gbjsgaSsrKSANCgkJaWRbaV0gPSBpZFtmaW5kKGkpXTsNCgkJDQoJdmVjdG9yPHZlY3RvcjxpbnQ+PiBnb29kKHRvdCArIDEpLCBiYWQodG90ICsgMSk7DQoJZm9yKGludCBpID0gMTsgaSA8PSBuOyBpKyspIHsNCgkJaWYoY29sW2ldID09IDApIGdvb2RbaWRbaV1dLnB1c2hfYmFjayhpKTsNCgkJZWxzZSBiYWRbaWRbaV1dLnB1c2hfYmFjayhpKTsNCgl9DQoJDQoJaW50IG1uID0gbWluKHEsIG4gLSBxKTsNCgl2ZWN0b3I8Yml0c2V0PDUwMDA1Pj4gcCh0b3QgKyAxKTsNCglwWzBdWzBdID0gMTsNCglmb3IoaW50IGkgPSAxOyBpIDw9IHRvdDsgaSsrKSANCgkJcFtpXSA9IChwW2kgLSAxXSA8PCBnb29kW2ldLnNpemUoKSkgfCAocFtpIC0gMV0gPDwgYmFkW2ldLnNpemUoKSk7DQovLwkJY291dCA8PCBwW2ldIDw8IGxuOw0KDQoJdmVjdG9yPGludD4gYW5zX2dvb2QsIGFuc19iYWQ7DQoJZm9yKGludCBpID0gdG90OyBpOyBpLS0pDQoJCWlmKHBbaSAtIDFdW21uIC0gZ29vZFtpXS5zaXplKCldKSAgew0KCQkJbW4gLT0gZ29vZFtpXS5zaXplKCk7DQoJCQlmb3IoYXV0byB4OiBnb29kW2ldKSBhbnNfZ29vZC5wdXNoX2JhY2soeCk7DQoJCQlmb3IoYXV0byB4OiBiYWRbaV0pIGFuc19iYWQucHVzaF9iYWNrKHgpOw0KCQl9IGVsc2Ugew0KCQkJbW4gLT0gYmFkW2ldLnNpemUoKTsNCgkJCWZvcihhdXRvIHg6IGJhZFtpXSkgYW5zX2dvb2QucHVzaF9iYWNrKHgpOw0KCQkJZm9yKGF1dG8geDogZ29vZFtpXSkgYW5zX2JhZC5wdXNoX2JhY2soeCk7CQ0KCQl9DQoJDQoJc29ydChhbnNfZ29vZC5iZWdpbigpLCBhbnNfZ29vZC5lbmQoKSk7DQoJc29ydChhbnNfYmFkLmJlZ2luKCksIGFuc19iYWQuZW5kKCkpOw0KCWlmKGFuc19nb29kLnNpemUoKSA9PSBxKSB7DQoJCWZvcihhdXRvIHg6IGFuc19nb29kKSBjb3V0IDw8IHggPDwgIiAiOw0KCQljb3V0IDw8IGxuOw0KCX0gZWxzZSB7DQoJCWZvcihhdXRvIHg6IGFuc19iYWQpIGNvdXQgPDwgeCA8PCAiICI7DQoJCWNvdXQgPDwgbG47DQoJfQ0KfQ0KDQppbnQgbWFpbigpIHsNCglpb3M6OnN5bmNfd2l0aF9zdGRpbyhmYWxzZSk7DQoJY2luLnRpZShudWxscHRyKTsNCgkNCglzb2x2ZSgpOw0KfQ0KDQovKg0KMiAxIDINCjEgMSAyDQowIDIgMQ0KDQowIDAgMQ0KMSAwIDANCiovDQo="}]