[{"id":"3210","submission_id":"3210","filename":"i.cpp","source":"I2luY2x1ZGU8Yml0cy9zdGRjKysuaD4NCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQoNCmNvbnN0IGludCBOID0gNWUzICsgMTA7DQoNCmNoYXIgbWFbTiA8PCAyXTsNCmludCBtcFtOIDw8IDJdOw0KaW50IG47DQoNCmNoYXIgc1tOXTsNCg0Kdm9pZCBtYW5hY2hhcihjaGFyIHNbXSwgaW50IGxlbikgew0KCWludCBsID0gMDsNCgltYVtsKytdID0gJyQnOw0KCW1hW2wrK10gPSAnIyc7DQoJZm9yIChpbnQgaSA9IDA7IGkgPCBsZW47IGkrKykgew0KCQltYVtsKytdID0gc1tpXTsNCgkJbWFbbCsrXSA9ICcjJzsNCgl9DQoJbWFbbF0gPSAwOw0KCWludCBteCA9IDAsIGlkID0gMDsNCglmb3IgKGludCBpID0gMDsgaSA8IGw7IGkrKykgew0KCQltcFtpXSA9IG14ID4gaSA/IG1pbihtcFsyICogaWQgLSBpXSwgbXggLSBpKSA6IDE7DQoJCXdoaWxlKG1hW2kgKyBtcFtpXV0gPT0gbWFbaSAtIG1wW2ldXSkgbXBbaV0rKzsNCgkJaWYgKGkgKyBtcFtpXSA+IG14KSB7DQoJCQlteCA9IGkgKyBtcFtpXTsNCgkJCWlkID0gaTsNCgkJfSANCgl9DQp9DQoNCnZvaWQgaW5pdCgpIHsNCglmb3IgKGludCBpID0gMDsgaSA8PSBOICogMiArIDE7IGkrKykgew0KCQltcFtpXSA9IDA7DQoJfQ0KfQ0Kdm9pZCBzb2x2ZSgpIHsNCglpbml0KCk7DQoJc2NhbmYoIiVzIiwgcyk7DQoJaW50IGxlbiA9IHN0cmxlbihzKTsNCgltYW5hY2hhcihzLCBsZW4pOw0KCXZlY3RvcjxpbnQ+IGxfaWR4LCByX2lkeDsNCglmb3IgKGludCBpID0gMjsgaSA8IDIgKiBsZW4gKyAyOyBpKyspIHsNCgkJaW50IGxlbiA9IG1wW2ldIC0gMSwgbCwgcjsNCgkJaWYgKGxlbiA9PSAwKSBjb250aW51ZTsNCgkJaWYgKGkgJiAxKSB7DQoJCQlyID0gaSAvIDIgLSAxICsgbGVuIC8gMjsNCgkJCWwgPSByIC0gKGxlbiAtIDEpOw0KCQl9IGVsc2Ugew0KCQkJaW50IG1pZCA9IGkgLyAyIC0gMTsNCgkJCXIgPSBtaWQgKyBsZW4gLyAyOw0KCQkJbCA9IHIgLSAobGVuIC0gMSk7DQoJCX0NCgkJbF9pZHgucHVzaF9iYWNrKGwpOw0KCQlyX2lkeC5wdXNoX2JhY2socik7DQovLwkJY291dCA8PCBsIDw8ICIgIiA8PCByIDw8IGVuZGw7DQoJfQ0KCWZvciAoaW50IGkgPSAwOyBpIDwgbGVuIC0gMTsgaSsrKSB7DQoJCXJfaWR4LnB1c2hfYmFjayhpKTsNCgkJbF9pZHgucHVzaF9iYWNrKGkgKyAxKTsNCgl9DQoJaW50IGFucyA9IDA7DQoJZm9yIChpbnQgaSA9IDA7IGkgPCBsX2lkeC5zaXplKCk7IGkrKykgew0KCQlpZiAocl9pZHhbaV0gLSBsX2lkeFtpXSArIDEgPj0gMikgew0KCQkJYW5zID0gbWF4KGFucywgcl9pZHhbaV0gLSBsX2lkeFtpXSArIDEpOw0KCQl9DQoJCWludCBsID0gbF9pZHhbaV0gLSAxLCByID0gcl9pZHhbaV0gKyAxOwkNCgkJaW50IHJlcyA9IHIgLSBsICsgMTsNCgkJaWYgKGwgPCAwIHx8IHIgPj0gbGVuKSBjb250aW51ZTsNCgkJZm9yIChpbnQgcCA9IDE7IGwgLSBwID49IDAgJiYgciArIHAgPCBsZW47IHArKykgew0KCQkJaWYgKHNbbCAtIHBdID09IHNbcl0gJiYgc1tsXSA9PSBzW3IgKyBwXSkgew0KLy8JCQkJY291dCA8PCBwIDw8IGVuZGw7DQoJCQkJcmVzICs9IHAgKiAyOw0KCQkJCXArKzsNCgkJCQl3aGlsZSAobCAtIHAgPj0gMCAmJiByICsgcCA8IGxlbiAmJiBzW2wgLSBwXSA9PSBzW3IgKyBwXSkgew0KCQkJCQlyZXMgKz0gMjsNCgkJCQkJcCsrOw0KCQkJCX0NCi8vCQkJCWNvdXQgPDwgcCA8PCAiICIgPDwgcmVzIDw8IGVuZGw7DQoJCQkJYW5zID0gbWF4KGFucywgcmVzKTsNCgkJCQlicmVhazsNCgkJCX0NCgkJCWlmIChzW2wgLSBwXSAhPSBzW3IgKyBwXSkgYnJlYWs7DQoJCX0NCgl9DQoJcHJpbnRmKCIlZFxuIiwgYW5zKTsNCn0NCg0KaW50IG1haW4oKSB7DQoJaW50IFQ7IHNjYW5mKCIlZCIsICZUKTsNCgl3aGlsZSAoVC0tKQ0KCXNvbHZlKCk7DQoJcmV0dXJuIDA7DQp9"}]