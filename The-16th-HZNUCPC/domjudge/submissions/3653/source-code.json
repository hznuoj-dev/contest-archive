[{"id":"3653","submission_id":"3653","filename":"III.cpp","source":"I2luY2x1ZGU8Yml0cy9zdGRjKysuaD4NCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQoNCiNkZWZpbmUgaW50IGxvbmcgbG9uZw0KI2RlZmluZSBjdCh4KSBjb3V0PDx4PDwnXG4nDQojZGVmaW5lIGRnKHgpICBjb3V0PDwjeDw8Jz0nPDx4PDwnXG4nOw0KI2RlZmluZSBwaWkgIHBhaXI8aW50LGludD4gDQojZGVmaW5lIE4gNjAwMA0KI2RlZmluZSBkb3VibGUgbG9uZyBkb3VibGUNCiNkZWZpbmUgaW9zIGlvczo6c3luY193aXRoX3N0ZGlvKDApLGNpbi50aWUoMCksY291dC50aWUoMCkNCiNkZWZpbmUgZW5kbCAnXG4nDQoNCg0KLyoNCjQNCmFiY2NhYg0KaWhpDQpzdGZnZml1dA0KcGFsaW5kcm9tZQ0KDQoNCiovDQoNCmludCBkcFtOXVtOXVszXTsNCnZvaWQgc29sdmUoKXsNCiAgIHN0cmluZyBzO2Npbj4+czsNCiAgIGludCBuPXMuc2l6ZSgpOw0KIA0KICAgZm9yKGludCBpPTA7aTw9bjtpKyspDQogICAgIGZvcihpbnQgaj0wO2o8PW47aisrKQ0KICAgICAgIGZvcihpbnQgaz0wO2s8PTE7aysrKXsNCiAgICAgICAJIGRwW2ldW2pdWzBdPTA7DQogICAgICAgCSAgZHBbaV1bal1bMV09MDsNCiAgICAgICAJICAgZHBbaV1bal1bMl09MDsNCgkgICB9DQogICAgICANCiAgICAgICBtYXA8cGFpcjxpbnQsaW50PixwYWlyPGNoYXIsY2hhcj4+IG1wOw0KICAgDQogICBpbnQgYW5zPTA7DQogICANCiAgIGZvcihpbnQgaT0xO2k8PW47aSsrKXsNCiAgIAlkcFtpXVtpXVswXT0xOw0KICAgCWRwW2ldW2ldWzFdPTE7DQogICAJZHBbaV1baV1bMl09MTsNCiAgIAlpZihzW2ldPT1zW2ktMV0pDQogICAJew0KICAgCQlkcFtpLTFdW2ldWzBdPTE7DQogICAJCWRwW2ktMV1baV1bMV09MTsNCiAgIAkJZHBbaS0xXVtpXVsyXT0xOw0KCX0NCiAgIAllbHNlew0KICAgCSAgIGRwW2ktMV1baV1bMV09MTsNCiAgIAkgICBtcFt7aS0xLGl9XT17c1tpXSxzW2ktMV19Ow0KCQkgaWYobXBbe2ktMSxpfV0uc2Vjb25kLmZpcnN0Pm1wW3tpLTEsaX1dLnNlY29uZC5zZWNvbmQpDQoJCSBzd2FwKG1wW3tpLTEsaX1dLnNlY29uZC5maXJzdCxtcFt7aS0xLGl9XS5zZWNvbmQuc2Vjb25kKTsJICAJDQoJICAgfQ0KICAgCWZvcihpbnQgaj0xO2o8PWktMjtqKyspew0KICAgCQlpZihzW2ldPT1zW2pdKXsNCiAgIAkJCQlkcFtqXVtpXVswXT1kcFtqKzFdW2ktMV1bMF07DQogICAJCQkJZHBbal1baV1bMV09ZHBbaisxXVtpLTFdWzFdOw0KICAgCQkJCWRwW2pdW2ldWzJdPWRwW2orMV1baS0xXVsyXTsNCiAgIAkJCQltcFt7aixpfV09bXBbe2orMSxpLTF9XTsNCgkgICAgfQ0KCSAgICBlbHNlew0KCSAgICAJIGRwW2pdW2ldWzFdPWRwW2orMV1baS0xXVswXTsNCgkgICAgCSBtcFt7aixpfV09e3Nbal0sc1tpXX07DQoJICAgIAkgaWYobXBbe2osaX1dLnNlY29uZC5maXJzdD5tcFt7aixpfV0uc2Vjb25kLnNlY29uZCkNCgkgICAgICAgICAgIHN3YXAoe21wW3tqLGl9XS5zZWNvbmQuZmlyc3QsbXBbe2osaX1dLnNlY29uZC5zZWNvbmR9KTsJICAJDQoJICAgICAgICAgICAgICAgICAgIAkgDQoJICAgIAkgaWYoZHBbaisxXVtpLTFdWzFdKQ0KCSAgICAJIHsNCgkgICAgCSAgICBpZihtcFt7aixpfV09PW1wW3tqKzEsaS0xfV0pDQoJICAgIAkgICAgew0KCSAgICAJICAgIAlkcFtqXVtpXVsyXT0xOw0KCQkJCX0NCgkJCSB9DQoJCX0NCgkgICB9DQogICB9DQogICBpbnQgYW5zPTA7DQogICANCiAgIGZvcihpbnQgaT0xO2k8PW47aSsrKQ0KICAgIGZvcihpbnQgaj1pO2o8PW47aisrKXsNCiAgICAJaWYoZHBbaV1bal1bMF18fGRwW2ldW2pdWzFdfHxkcFtpXVtqXVsyXSkNCiAgICAJYW5zPW1heChhbnMsai1pKzEpOw0KCX0NCi8vCWlmKGFucz09MSkNCi8vCWFucz0wOw0KCWN0KGFucyk7DQp9DQoNCnNpZ25lZCBtYWluKCl7DQoJaW9zOw0KCWludCB0PTE7IA0KCSBjaW4+PnQ7DQoJd2hpbGUodC0tKQ0KCXNvbHZlKCk7DQoJcmV0dXJuIDA7DQp9"}]