[{"id":"3645","submission_id":"3645","filename":"G.cpp","source":"I2luY2x1ZGU8Yml0cy9zdGRjKysuaD4NCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQppbnQgbixkeSxtLHgseSx6LHNzWzEwMDAwMV0sYW5zWzEwMDAwMV1bMl0sc3N1bSxtaVsxMDAwMDFdLG14WzEwMDAwMV07DQp2ZWN0b3I8aW50PiBiaVsxMDAwMDFdLGNpWzEwMDAwMV0sYW5zMlsxMDAwMDFdWzJdLGZbMTAwMDAxXTsNCmJvb2wgdFsxMDAwMDFdOw0Kdm9pZCBkZnMoaW50IHMsaW50IHFzLGludCBsaikNCnsNCi8vCWNvdXQ8PHM8PCcgJzw8cXM8PCcgJzw8bGo8PGVuZGw7DQoJZm9yKGludCBpPTA7aTxiaVtzXS5zaXplKCk7aSsrKQ0KCSAgaWYoYmlbc11baV0hPXFzKQ0KCSAgew0KCQlpZihzc1tiaVtzXVtpXV09PS0xKQ0KCQl7DQoJCQlhbnNbc3N1bV1bKGxqK2NpW3NdW2ldKSUyXSsrOw0KCQkJYW5zMltzc3VtXVsobGorY2lbc11baV0pJTJdLnB1c2hfYmFjayhiaVtzXVtpXSk7DQoJCQlzc1tiaVtzXVtpXV09KGxqK2NpW3NdW2ldKSUyOw0KCQkJZGZzKGJpW3NdW2ldLHMsKGxqK2NpW3NdW2ldKSUyKTsNCgkJfWVsc2UNCgkJew0KCQkJaWYoKGxqK2NpW3NdW2ldKSUyIT1zc1tiaVtzXVtpXV0pDQoJCQl7DQoJCQkJcHJpbnRmKCJOTyIpOw0KCQkJCWV4aXQoMCk7DQoJCQl9DQoJCX0gIA0KCSAgfQ0KfQ0Kdm9pZCBkZnMyKGludCBjcyxpbnQgbGopDQp7DQoJaWYoY3M9PXNzdW0rMSkNCgl7DQoJCWlmKGxqPT1keSkNCgkJew0KCQkJcHJpbnRmKCJZRVNcbiIpOw0KCQkJZm9yKGludCBpPTE7aTw9c3N1bTtpKyspDQoJCQkgIGlmKHRbaV0pDQoJCQkgIHsNCgkJCSAgCWZvcihpbnQgaj0wO2o8YW5zMltpXVswXS5zaXplKCk7aisrKQ0KCQkJICAgICAgcHJpbnRmKCIlZCAiLGFuczJbaV1bMF1bal0pOw0KCQkJICB9ZWxzZQ0KICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgIAlmb3IoaW50IGo9MDtqPGFuczJbaV1bMV0uc2l6ZSgpO2orKykNCiAgICAgICAgICAgICAgCSAgcHJpbnRmKCIlZCAiLGFuczJbaV1bMV1bal0pOw0KCQkJICB9CQ0KCQkJZXhpdCgwKTsJCSAgICANCgkJfQ0KCQlyZXR1cm47DQoJfQ0KCWlmKGxqK21pW2NzXT5keSkNCgkgIHJldHVybjsNCglpZihsaitteFtjc108ZHkpDQoJICByZXR1cm47DQoJdFtjc109dHJ1ZTsNCglkZnMyKGNzKzEsbGorYW5zW2NzXVswXSk7DQoJdFtjc109ZmFsc2U7DQoJZGZzMihjcysxLGxqK2Fuc1tjc11bMV0pOw0KfQ0KaW50IG1haW4oKQ0Kew0KCXNjYW5mKCIlZCVkJWQiLCZuLCZkeSwmbSk7DQoJZm9yKGludCBpPTE7aTw9bTtpKyspDQoJew0KCQlzY2FuZigiJWQlZCVkIiwmeiwmeCwmeSk7DQoJCWJpW3hdLnB1c2hfYmFjayh5KTsNCgkgICAgY2lbeF0ucHVzaF9iYWNrKHopOw0KCSAgICBiaVt5XS5wdXNoX2JhY2soeCk7DQoJICAgIGNpW3ldLnB1c2hfYmFjayh6KTsNCgl9DQoJZm9yKGludCBpPTE7aTw9bjtpKyspDQoJICBzc1tpXT0tMTsNCglmb3IoaW50IGk9MTtpPD1uO2krKykNCgl7DQoJCWlmKHNzW2ldPT0tMSkNCgkJew0KCQkJYW5zWysrc3N1bV1bMF0rKzsNCgkJCWFuczJbc3N1bV1bMF0ucHVzaF9iYWNrKGkpOw0KCQkJc3NbMV09MDsNCgkJCWRmcyhpLDAsMCk7DQoJCQkvKmZvcihpbnQgaj0wO2o8YW5zMltzc3VtXVswXS5zaXplKCk7aisrKQ0KCQkJICBjb3V0PDxhbnMyW3NzdW1dWzBdW2pdPDwnICc7DQoJCQljb3V0PDxlbmRsOw0KCQkJZm9yKGludCBqPTA7ajxhbnMyW3NzdW1dWzFdLnNpemUoKTtqKyspDQoJCQkgIGNvdXQ8PGFuczJbc3N1bV1bMV1bal08PCcgJzsNCgkJCWNvdXQ8PGVuZGw8PGVuZGw7Ki8NCgkJfQ0KCX0NCglmb3IoaW50IGk9c3N1bTtpPj0xO2ktLSkNCgl7DQoJCW1pW2ldPW1pW2krMV0rbWluKGFuc1tpXVswXSxhbnNbaV1bMV0pOw0KCQlteFtpXT1teFtpKzFdK21heChhbnNbaV1bMF0sYW5zW2ldWzFdKTsNCgl9DQoJZGZzMigxLDApOw0KCXByaW50ZigiTk8iKTsNCglyZXR1cm4gMDsNCn0="}]