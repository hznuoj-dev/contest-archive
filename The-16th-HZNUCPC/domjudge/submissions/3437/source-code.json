[{"id":"3437","submission_id":"3437","filename":"i.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+DQp1c2luZyBuYW1lc3BhY2Ugc3RkOw0KI2RlZmluZSBlbmRsICdcbicNCiNkZWZpbmUgeCBmaXJzdA0KI2RlZmluZSB5IHNlY29uZA0KI2RlZmluZSBtcCBtYWtlX3BhaXINCiNkZWZpbmUgaW9zIGlvczo6c3luY193aXRoX3N0ZGlvKGZhbHNlKSxjaW4udGllKDApLGNvdXQudGllKDApDQp0eXBlZGVmIGxvbmcgbG9uZyBsbDsNCnR5cGVkZWYgcGFpcjxpbnQsIGludD4gaGFzaHY7DQpjb25zdCBsbCBtb2QxID0gMWU5ICsgNywgbW9kMiA9IDFlOSArIDk7DQoNCmhhc2h2IG9wZXJhdG9yKyAoY29uc3QgaGFzaHYgJmEsIGNvbnN0IGhhc2h2ICZiKSB7DQoJcmV0dXJuIHsoYS54ICsgYi54KSAlIG1vZDEsIChhLnkgKyBiLnkpICUgbW9kMn07DQp9DQpoYXNodiBvcGVyYXRvci0gKGNvbnN0IGhhc2h2ICZhLCBjb25zdCBoYXNodiAmYikgew0KCXJldHVybiB7KGEueCAtIGIueCArIG1vZDEpICUgbW9kMSwgKGEueSAtIGIueSArIG1vZDIpICUgbW9kMn07DQp9DQpoYXNodiBvcGVyYXRvciogKGNvbnN0IGhhc2h2ICZhLCBjb25zdCBoYXNodiAmYikgew0KCXJldHVybiB7KDFsbCAqIGEueCAqIGIueCAlIG1vZDEpLCAoMWxsICogYS55ICogYi55ICUgbW9kMil9Ow0KfQ0KDQpjb25zdCBpbnQgbWF4biA9IDYwMDA7DQoNCmludCBuLCBhbnM7DQpjaGFyIHN0clttYXhuXTsNCmhhc2h2IHNbbWF4bl0sIHRbbWF4bl0sIHB3W21heG5dOw0KDQpoYXNodiBnZXQxKGludCBsLCBpbnQgcikgew0KCXJldHVybiBzW3JdIC0gc1tsIC0gMV0gKiBwd1tyIC0gbCArIDFdOw0KfQ0KaGFzaHYgZ2V0MihpbnQgbCwgaW50IHIpIHsNCglyZXR1cm4gdFtsXSAtIHRbciArIDFdICogcHdbciAtIGwgKyAxXTsNCn0NCg0Kdm9pZCBjaGVjazEoaW50IG1pZCkgew0KCWludCBsID0gbWlkLCByID0gbWlkLCBwb3NsX2kgPSAtMSwgcG9zbF9qID0gLTEsIHBvc3JfaSA9IC0xLCBwb3NyX2ogPSAtMTsNCgl3aGlsZSh0cnVlKSB7DQoJCWlmKGwgPCAxIHx8IHIgPiBuKSBicmVhazsNCgkJaWYoc3RyW2xdID09IHN0cltyXSkgew0KCQkJaWYocG9zcl9pID09IC0xKSBhbnMgPSBtYXgoYW5zLCByIC0gbCArIDEpOw0KCQkJZWxzZSBpZihwb3NyX2ogIT0gLTEpIGFucyA9IG1heChhbnMsIHIgLSBsICsgMSk7DQoJCQlsLS07DQoJCQlyKys7DQoJCQljb250aW51ZTsNCgkJfQ0KCQlpZihwb3NyX2kgPT0gLTEpIHsNCgkJCXBvc2xfaSA9IGw7DQoJCQlwb3NyX2kgPSByOw0KCQkJbC0tOw0KCQkJcisrOw0KCQkJY29udGludWU7DQoJCX0gZWxzZSBpZihwb3NyX2ogPT0gLTEpICB7DQoJCQlpZigoc3RyW3JdICE9IHN0cltwb3NsX2ldIHx8IHN0cltsXSAhPSBzdHJbcG9zcl9pXSkgJiYgKHN0cltyXSAhPSBzdHJbcG9zcl9pXSB8fCBzdHJbbF0gIT0gc3RyW3Bvc2xfaV0pKSBicmVhazsNCgkJCXBvc3JfaiA9IHI7DQoJCQlwb3NsX2ogPSBsOw0KCQkJYW5zID0gbWF4KGFucywgciAtIGwgKyAxKTsNCgkJCWwtLTsNCgkJCXIrKzsNCgkJfSBlbHNlIHsNCgkJCWJyZWFrOw0KCQl9DQoJfQ0KCWwgPSBtaWQsIHIgPSBtaWQsIHBvc2xfaiA9IC0xLCBwb3NyX2ogPSAtMTsNCgl3aGlsZSh0cnVlKSB7DQoJCWlmKGwgPCAxIHx8IHIgPiBuKSBicmVhazsNCgkJaWYoc3RyW2xdID09IHN0cltyXSkgew0KCQkJYW5zID0gbWF4KGFucywgciAtIGwgKyAxKTsNCgkJCWwtLTsNCgkJCXIrKzsNCgkJCWNvbnRpbnVlOw0KCQl9DQoJCWlmKHBvc3JfaiA9PSAtMSkgIHsNCgkJCWlmKHN0cltsXSAhPSBzdHJbbWlkXSAmJiBzdHJbcl0gIT0gc3RyW21pZF0pIGJyZWFrOw0KCQkJcG9zcl9qID0gcjsNCgkJCXBvc2xfaiA9IGw7DQoJCQlhbnMgPSBtYXgoYW5zLCByIC0gbCArIDEpOw0KCQkJbC0tOw0KCQkJcisrOw0KCQl9IGVsc2Ugew0KCQkJYnJlYWs7DQoJCX0NCgl9DQp9DQp2b2lkIGNoZWNrMihpbnQgbWlkKSB7DQoJaW50IGwgPSBtaWQsIHIgPSBtaWQgKyAxLCBwb3NsX2kgPSAtMSwgcG9zbF9qID0gLTEsIHBvc3JfaSA9IC0xLCBwb3NyX2ogPSAtMTsNCgl3aGlsZSh0cnVlKSB7DQoJCWlmKGwgPCAxIHx8IHIgPiBuKSBicmVhazsNCgkJaWYoc3RyW2xdID09IHN0cltyXSkgew0KCQkJaWYocG9zcl9pID09IC0xKSBhbnMgPSBtYXgoYW5zLCByIC0gbCArIDEpOw0KCQkJZWxzZSBpZihwb3NyX2ogIT0gLTEpIGFucyA9IG1heChhbnMsIHIgLSBsICsgMSk7DQoJCQlsLS07DQoJCQlyKys7DQoJCQljb250aW51ZTsNCgkJfQ0KCQlpZihwb3NyX2kgPT0gLTEpIHsNCgkJCXBvc3JfaSA9IHI7DQoJCQlwb3NsX2kgPSBsOw0KCQkJbC0tOw0KCQkJcisrOw0KCQkJY29udGludWU7DQoJCX0gZWxzZSBpZihwb3NyX2ogPT0gLTEpICB7DQovLwkJCWNvdXQgPDwgciA8PCAnICcgPDwgcG9zX2kgPDwgZW5kbDsNCgkJCWlmKChzdHJbcl0gIT0gc3RyW3Bvc2xfaV0gfHwgc3RyW2xdICE9IHN0cltwb3NyX2ldKSAmJiAoc3RyW3JdICE9IHN0cltwb3NyX2ldIHx8IHN0cltsXSAhPSBzdHJbcG9zbF9pXSkpIGJyZWFrOw0KCQkJcG9zcl9qID0gcjsNCgkJCWFucyA9IG1heChhbnMsIHIgLSBsICsgMSk7DQoJCQlsLS07DQoJCQlyKys7DQoJCX0gZWxzZSB7DQovLwkJCWFucyA9IG1heChhbnMsIHIgLSBsICsgMSk7DQoJCQlicmVhazsNCgkJfQ0KCX0NCi8vCWNvdXQgPDwgcG9zbF9pIDw8ICIgIiA8PCBwb3NyX2kgPDwgIiAiIDw8IHBvc2xfaiA8PCAiICIgPDwgIHBvc3JfaiA8PCBlbmRsOw0KfQ0KDQppbnQgZihzdHJpbmcgcykgew0KCWludCBuID0gcy5zaXplKCk7cyA9ICIgIiArIHM7DQoJaW50IGFucyA9IDA7DQoJZm9yIChpbnQgaSA9IDE7IGkgPD0gbjsgKytpKSB7DQoJCWZvciAoaW50IGogPSBpICsgMTsgaiA8PSBuOyArK2opIHsNCgkJCXN0cmluZyB0ID0gczsNCgkJCWNoYXIgY2ggPSBzW2ldOw0KCQkJdFtpXSA9IHNbal07DQoJCQl0W2pdID0gc1tpXTsNCgkJCQ0KCQkJZm9yIChpbnQgbCA9IDE7IGwgPD0gaTsgKytsKSB7DQoJCQkJZm9yIChpbnQgciA9IGo7IHIgPD0gbjsgKytyKSB7DQoJCQkJCXN0cmluZyB0dCA9ICIiOw0KCQkJCQlmb3IgKGludCBrID0gbDsgayA8PSByOyArK2spIHsNCgkJCQkJCXR0ICs9IHRba107DQoJCQkJCX0NCgkJCQkJc3RyaW5nIHNzID0gdHQ7DQoJCQkJCXJldmVyc2UodHQuYmVnaW4oKSwgdHQuZW5kKCkpOw0KCQkJCQlpZiAoc3MgPT0gdHQpIGFucyA9IG1heChhbnMsIHIgLSBsICsgMSk7DQoJCQkJfQ0KCQkJfQ0KCQl9DQoJfQkNCglyZXR1cm4gYW5zOw0KfQ0KDQp2b2lkIHNvbHZlKCkgew0KCWFucyA9IDA7DQoJc2NhbmYoIiVzIiwgc3RyICsgMSk7DQoJDQoJbiA9IHN0cmxlbihzdHIgKyAxKTsNCgloYXNodiBiYXNlID0gezMxLCAxMzF9Ow0KCQ0KCQ0KCXN0cmluZyB4eCA9ICIiOw0KCWZvciAoaW50IGkgPSAxOyBpIDw9IG47ICsraSl7DQoJCXh4ICs9IHN0cltpXTsNCgl9DQoJDQoJDQoJc1swXSA9IHsxLCAxfTsNCglmb3IoaW50IGkgPSAxOyBpIDw9IG47IGkrKykgew0KCQlzW2ldID0gc1tpIC0gMV0gKiBiYXNlICsgbXAoc3RyW2ldLCBzdHJbaV0pOw0KCQlwd1tpXSA9IHB3W2kgLSAxXSAqIGJhc2U7DQoJfQ0KCXRbbiArIDFdID0gezEsIDF9Ow0KCWZvcihpbnQgaSA9IG47IGkgPj0gMTsgaS0tKSB7DQoJCXRbaV0gPSB0W2kgKyAxXSAqIGJhc2UgKyBtcChzdHJbaV0sIHN0cltpXSk7DQoJfQ0KCQ0KCQ0KCWZvcihpbnQgaSA9IDE7IGkgPD0gbjsgaSsrKSB7DQoJCWNoZWNrMShpKTsNCgkJY2hlY2syKGkpOw0KLy8JCWNvdXQgPDwgaSA8PCAiICIgPDwgYW5zIDw8IGVuZGw7CQ0KCX0NCi8vY2hlY2syKDMpOw0KCWlmKGFucyA9PSAxKSBhbnMgPSAwOw0KCXByaW50ZigiJWRcbiIsIGFucyk7DQoJDQovLwlpZiAoYW5zID09IGYoeHgpKSBjb3V0IDw8ICJ5ZXNcbiI7DQovLwllbHNlIGNvdXQgPDwgIm5vXG4iOw0KfQ0KDQppbnQgbWFpbigpIHsNCglpbnQgXzsNCglzY2FuZigiJWQiLCAmXyk7DQoJd2hpbGUoXy0tKSBzb2x2ZSgpOw0KfQ=="}]