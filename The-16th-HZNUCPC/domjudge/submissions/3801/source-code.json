[{"id":"3801","submission_id":"3801","filename":"G.cpp","source":"I2luY2x1ZGU8Yml0cy9zdGRjKysuaD4NCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQojZGVmaW5lIE4gMTAwMDEwDQojZGVmaW5lIHJlcChpLGwscikgZm9yKGludCBpPShsKTtpPD0ocik7aSsrKQ0KdXNpbmcgbGwgPWxvbmcgbG9uZyA7DQoNCmludCBuLGZhW05dLG0sZ29vZHMsc3pbTl07DQppbnQgRmluZChpbnQgeCl7cmV0dXJuIGZhW3hdPT14P3g6ZmFbeF09RmluZChmYVt4XSk7fQ0KdmVjdG9yPHBhaXI8aW50LGludD4+IGU7DQp2ZWN0b3I8aW50PiBnW05dOw0Kdm9pZCBtZXJnZShpbnQgdSxpbnQgdil7DQogICAgaW50IHB4PUZpbmQodSkscHk9RmluZCh2KTsNCiAgICBpZihweD09cHkpcmV0dXJuOw0KICAgIGZhW3B4XT1weTsNCiAgICBzeltweV0rPXN6W3B4XTsNCn0NCg0KYm9vbCB2aXNbTl07dmVjdG9yPGludD4geHh4W05dOw0KaW50IGNudFsyXSxjb2xbTl0sYVtOXSxiW05dLHBwOw0Kdm9pZCBkZnMoaW50IHUsaW50IHgpew0KICAgIHh4eFtwcF0ucHVzaF9iYWNrKHUpOw0KICAgIGNvbFt1XT14Ow0KICAgIGNudFtjb2xbdV1dKz1zelt1XTsNCiAgICB2aXNbdV09MTsNCiAgICBmb3IoaW50IHY6Z1t1XSl7DQogICAgICAgIGlmKHZpc1t2XT09MClkZnModix4XjEpOw0KICAgICAgICBlbHNlew0KICAgICAgICAgICAgaWYoY29sW3ZdPT14KXsNCiAgICAgICAgICAgICAgICBwdXRzKCJOTyIpOw0KICAgICAgICAgICAgICAgIGV4aXQoMCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQp9DQoNCi8vYml0c2V0PDEwMDAxMD4gdG1wLGRwWzEwMDAxMF0sZ2csaCxmOw0KDQppbnQgY2hvb3NlW05dOw0KDQppbnQgY1tOXSx3W05dLHRbTl0sQ05UW05dOw0KdmVjdG9yPGludD4gX2luW05dOw0KaW50IGRwWzQ1MF1bTl07DQp2ZWN0b3I8aW50PiB5eXlbTl07DQp2b2lkIHNvbHZlKCl7DQogICAgc2NhbmYoIiVkJWQlZCIsJm4sJmdvb2RzLCZtKTsNCiAgICByZXAoaSwxLG4pZmFbaV09aSxzeltpXT0xOw0KICAgIHJlcChpLDEsbSl7DQogICAgICAgIGludCBvLHUsdjsNCiAgICAgICAgc2NhbmYoIiVkJWQlZCIsJm8sJnUsJnYpOw0KICAgICAgICBpZihvPT0wKXsNCiAgICAgICAgICAgIG1lcmdlKHUsdik7DQogICAgICAgIH1lbHNlew0KICAgICAgICAgICAgZS5wdXNoX2JhY2soe3Usdn0pOw0KICAgICAgICB9DQogICAgfQ0KICAgIGZvcihhdXRvIFt1LHZdOmUpew0KICAgICAgICBpZihGaW5kKHUpPT1GaW5kKHYpKXsNCiAgICAgICAgICAgIHB1dHMoIk5PIik7DQogICAgICAgICAgICByZXR1cm47DQogICAgICAgIH0NCiAgICAgICAgZ1tGaW5kKHUpXS5wdXNoX2JhY2soRmluZCh2KSk7DQogICAgICAgIGdbRmluZCh2KV0ucHVzaF9iYWNrKEZpbmQodSkpOw0KICAgICAgICAvL3ByaW50ZigiJWQgJWRcbiIsRmluZCh1KSxGaW5kKHYpKTsNCiAgICB9DQogICAgcmVwKGksMSxuKV9pbltGaW5kKGkpXS5wdXNoX2JhY2soaSk7DQogICAgbT0wOw0KICAgIHJlcChpLDEsbil7DQogICAgICAgIGlmKEZpbmQoaSkhPWkpY29udGludWU7DQogICAgICAgIGlmKHZpc1tpXSljb250aW51ZTsNCiAgICAgICAgY250WzBdPWNudFsxXT0wOw0KICAgIHBwPWk7DQogICAgICAgIGRmcyhpLDApOw0KICAgICAgICBhWysrbV09Y250WzBdOw0KICAgICAgICBiW21dPWNudFsxXTsNCiAgICAgICAgY1ttXT1pOw0KDQogICAgICAgIC8vZm9yKGludCB1Onh4eFtpXSlwcmludGYoIiVkICIsdSk7cHV0cygiIik7DQogICAgfQ0KICAgIGludCBzdW09MDsNCiAgICByZXAoaSwxLG0paWYoYVtpXTxiW2ldKWNob29zZVtpXT0wLHN1bSs9YVtpXSx3W2ldPWJbaV0tYVtpXTtlbHNlIGNob29zZVtpXT0xLHN1bSs9YltpXSx3W2ldPWFbaV0tYltpXTsNCiAgICBzdW09Z29vZHMtc3VtOw0KICAgIGlmKHN1bTwwKXtwdXRzKCJOTyIpO3JldHVybjt9DQoNCiAgICB2ZWN0b3I8cGFpcjxpbnQsaW50Pj4gdG1wOw0KICAgIHJlcChpLDEsbSl0bXAucHVzaF9iYWNrKHt3W2ldLGl9KTsNCiAgICBzb3J0KHRtcC5iZWdpbigpLHRtcC5lbmQoKSk7DQogICAgaW50IFQ9MTt0WzFdPSgqdG1wLmJlZ2luKCkpLmZpcnN0O0NOVFsxXT0xO3l5eVt0WzFdXS5wdXNoX2JhY2soKCp0bXAuYmVnaW4oKSkuc2Vjb25kKTsNCiAgICBhdXRvIGl0PXRtcC5iZWdpbigpOysraXQ7DQogICAgZm9yKDtpdCE9dG1wLmVuZCgpOysraXQpew0KICAgICAgICBpbnQgeD0oKml0KS5maXJzdCx5PSgqaXQpLnNlY29uZDsNCg0KICAgICAgICBpZih4PT10W1RdKSsrQ05UW1RdLHl5eVt0W1RdXS5wdXNoX2JhY2soeSk7DQogICAgZWxzZXsNCiAgICAgICAgKytUOw0KICAgICAgICB0W1RdPXg7DQogICAgICAgIHl5eVt0W1RdXS5wdXNoX2JhY2soeSk7DQogICAgICAgIENOVFtUXT0xOw0KICAgIH0NCiAgICB9DQogICAgcmVwKGksMSxUKXsNCiAgICAgICAgLy9wcmludGYoIiVkICVkICVkXG4iLGksdFtpXSxDTlRbaV0pOw0KICAgICAgICAvL3ByaW50ZigiJWRcbiIsKGludCl5eXlbdFtpXV0uc2l6ZSgpKTsNCiAgICB9DQoNCiAgICBtZW1zZXQoZHAsLTEsc2l6ZW9mKGRwKSk7DQogICAgZHBbMF1bMF09MDsNCiAgICByZXAoaSwxLFQpew0KICAgICAgICByZXAoaiwwLFQpaWYoZHBbaS0xXVtqXSE9LTEpew0KICAgICAgICAgICAgcmVwKGssMCxDTlRbaV0pew0KICAgICAgICAgICAgICAgIGRwW2ldW2orayp0W2ldXT1rOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KICAgIGlmKGRwW1RdW3N1bV09PTApe3B1dHMoIk5PIik7cmV0dXJuO30NCiAgICBlbHNlew0KICAgICAgICBwdXRzKCJZRVMiKTsNCiAgICAgICAgZm9yKGludCBpPVQsaj1zdW07aT4wOyl7DQogICAgICAgICAgICBpbnQgaz1kcFtpXVtqXTsNCiAgICAgICAgICAgIGF1dG8gaXQ9eXl5W3RbaV1dLmJlZ2luKCk7DQogICAgICAgICAgICBmb3IoaW50IG89MTtvPD1rOysrbyl7DQogICAgICAgICAgICAgICAgYXNzZXJ0KGl0IT15eXlbdFtpXV0uZW5kKCkpOw0KICAgICAgICAgICAgICAgIGNob29zZVsoKml0KV1ePTE7DQogICAgICAgICAgICAgICAgKytpdDsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgLS1pLGotPWsqdFtpXTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIHJlcChpLDEsbSl7DQogICAgICAgICAgICAgICAgZm9yKGludCB1Onh4eFtjW2ldXSlpZihjb2xbdV09PWNob29zZVtpXSl7DQogICAgICAgICAgICAgICAgICAgIGZvcihpbnQgeDpfaW5bdV0pcHJpbnRmKCIlZCAiLHgpOw0KICAgICAgICAgICAgICAgIH0NCiAgICB9DQp9DQoNCmludCBtYWluKCkgew0KICAgIC8vZnJlb3BlbigiaW4udHh0IiwiciIsc3RkaW4pOw0KICAgIGludCB0PTE7DQogICAgd2hpbGUodC0tKXNvbHZlKCk7DQoJcmV0dXJuIDA7DQp9DQo="}]