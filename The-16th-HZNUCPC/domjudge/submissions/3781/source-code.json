[{"id":"3781","submission_id":"3781","filename":"b.cpp","source":"I2luY2x1ZGU8Yml0cy9zdGRjKysuaD4NCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQojZGVmaW5lIGludCBsb25nIGxvbmcNCmlubGluZSBpbnQgcmVhZCgpew0KICAgIGludCB4PTAsZj0xO2NoYXIgYz1nZXRjaGFyKCk7DQogICAgd2hpbGUoIWlzZGlnaXQoYykpe2lmKGM9PSctJylmPS0xO2M9Z2V0Y2hhcigpO30NCiAgICB3aGlsZShpc2RpZ2l0KGMpKXg9eCoxMCtjLTQ4LGM9Z2V0Y2hhcigpOw0KICAgIHJldHVybiB4KmY7DQp9DQpjb25zdCBpbnQgTj0xZTUrNTsNCmludCBuLHEsbSxmYVtOPDwxXSxzeltOPDwxXSxmW048PDFdLHZpc1tOPDwxXTsNCmludCBmaW5kKGludCB4KXsNCiAgICByZXR1cm4geD09ZmFbeF0/eDpmYVt4XT1maW5kKGZhW3hdKTsNCn0NCnZvaWQgbWVyZ2UoaW50IHgsaW50IHkpew0KICAgIHg9ZmluZCh4KTt5PWZpbmQoeSk7DQogICAgaWYoeD09eSlyZXR1cm47DQogICAgaWYoeDx5KXN3YXAoeCx5KTsNCiAgICBmYVt4XT15O3N6W3ldKz1zelt4XTtmW3ldKz1mW3hdOw0KfQ0KYml0c2V0PE4+Z1tOXTsNCnZlY3RvcjxpbnQ+YW5zW048PDFdOw0KdmVjdG9yPHBhaXI8aW50LGludD4gPmM7DQp2ZWN0b3I8cGFpcjxpbnQsaW50PiA+djsNCnZvaWQgcHJpbnQoaW50IHgpew0KICAgIC8vIHByaW50ZigiJWxsZDpcbiIseCk7DQogICAgZm9yKGludCBpOmFuc1t4XSlwcmludGYoIiVsbGQgIixpKTsNCiAgICAvLyBwdXRzKCIiKTsNCn0NCnZvaWQgZGZzKGludCB4LGludCBzdW0pDQp7DQogICAgLy9wcmludGYoIiVsbGQgJWxsZFxuIix4LHN1bSk7DQogICAgaWYoeD09MClyZXR1cm47DQogICAgaWYoc3VtLXZbeC0xXS5maXJzdD49MCYmZ1t4LTFdW3N1bS12W3gtMV0uZmlyc3RdKSBkZnMoeC0xLHN1bS12W3gtMV0uZmlyc3QpLHByaW50KGNbeC0xXS5maXJzdCk7DQogICAgZWxzZSBkZnMoeC0xLHN1bS12W3gtMV0uc2Vjb25kKSxwcmludChjW3gtMV0uc2Vjb25kKTsNCn0NCnNpZ25lZCBtYWluKCl7DQogICAgLy9mcmVvcGVuKCJpbi50eHQiLCJyIixzdGRpbik7DQogICAvLyBmcmVvcGVuKCJiLm91dCIsInciLHN0ZG91dCk7DQogICAgbj1yZWFkKCk7cT1yZWFkKCk7bT1yZWFkKCk7DQogICAgZm9yKGludCBpPTE7aTw9KG48PDEpO2krKylmYVtpXT1pLHN6W2ldPTEsZltpXT0oaTw9bik7DQogICAgZm9yKGludCBpPTE7aTw9bTtpKyspew0KICAgICAgICBpbnQgb3A9cmVhZCgpLGE9cmVhZCgpLGI9cmVhZCgpOw0KICAgICAgICBpZihvcD09MSYmYT09Yil7cHV0cygiTk8iKTtyZXR1cm4gMDt9DQogICAgICAgIGlmKG9wPT0wKXsNCiAgICAgICAgICAgIG1lcmdlKGEsYik7DQogICAgICAgICAgICBtZXJnZShhK24sYituKTsNCiAgICAgICAgfWVsc2V7DQogICAgICAgICAgICBtZXJnZShhLGIrbik7DQogICAgICAgICAgICBtZXJnZShiLGErbik7DQogICAgICAgIH0NCiAgICB9DQogICAgZm9yKGludCBpPTE7aTw9bjtpKyspaWYoZmluZChpKT09ZmluZChpK24pKXtwdXRzKCJOTyIpO3JldHVybiAwO30NCiAgIC8vIHB1dHMoInF3cSIpOw0KICAgIGZvcihpbnQgaT0xO2k8PW47aSsrKWlmKGZpbmQoaSk9PWkpew0KICAgICAgICBpZih2aXNbaV18fHZpc1tmaW5kKGkrbildKWNvbnRpbnVlOw0KICAgICAgICB2LnB1c2hfYmFjayh7ZltpXSxmW2ZpbmQoaStuKV19KSxjLnB1c2hfYmFjayh7aSxmaW5kKGkrbil9KTsNCiAgICAgICAgdmlzW2ldPXZpc1tmaW5kKGkrbildPTE7DQogICAgfQ0KICAgIGZvcihpbnQgaT0xO2k8PW47aSsrKWFuc1tmaW5kKGkpXS5wdXNoX2JhY2soaSk7DQogICAgaW50IGNudD12LnNpemUoKTsNCiAgICBnWzBdWzBdPTE7DQogICAgLy9mb3IoaW50IGk9MTtpPD1jbnQ7aSsrKXByaW50ZigiJWxsZCAlbGxkXG4iLHZbaS0xXS5maXJzdCx2W2ktMV0uc2Vjb25kKTtwdXRzKCIiKTsNCiAgICAvL2ZvcihpbnQgaT0xO2k8PWNudDtpKyspcHJpbnRmKCIlbGxkICVsbGRcbiIsY1tpLTFdLmZpcnN0LGNbaS0xXS5zZWNvbmQpO3B1dHMoIiIpOw0KICAgIGZvcihpbnQgaT0xO2k8PWNudDtpKyspZ1tpXT0oZ1tpLTFdPDx2W2ktMV0uZmlyc3QpfChnW2ktMV08PHZbaS0xXS5zZWNvbmQpOw0KICAgIC8vZm9yKGludCBpPTE7aTw9bjtpKyspcHJpbnRmKCIlbGxkICIsZ1tjbnRdW2ldPT0xKTtwdXRzKCIiKTsNCiAgICBpZighZ1tjbnRdW3FdKXtwdXRzKCJOTyIpO3JldHVybiAwO30NCiAgICBwdXRzKCJZRVMiKTsNCiAgICBkZnMoY250LHEpOw0KICAgIHJldHVybiAwOw0KfQ=="}]