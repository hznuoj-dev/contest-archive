[{"id":"3392","submission_id":"3392","filename":"D.cpp","source":"I2luY2x1ZGU8Yml0cy9zdGRjKysuaD4NCi8vI2RlZmluZSBpbnQgbG9uZyBsb25nDQojZGVmaW5lIGxsIGxvbmcgbG9uZw0KI2RlZmluZSB2aSB2ZWN0b3I8aW50Pg0KI2RlZmluZSBwYiBwdXNoX2JhY2sNCg0KdXNpbmcgbmFtZXNwYWNlIHN0ZDsNCmNvbnN0IGludCBtb2QgPSAxZTkgKyA3Ow0KY29uc3QgaW50IElORiA9IDB4M2YzZjNmM2Y7DQpjb25zdCBpbnQgTiA9IDNlNSArIDEwOw0KaW50IHRyW048PDRdLCBsYXp5W04gPDwgNF07DQp2b2lkIHB1c2goaW50IG8pIHsNCglpZiAobGF6eVtvXSA8IElORikgew0KCQl0cltvICogMl0gPSBtaW4odHJbbyAqIDJdLCBsYXp5W29dKTsNCgkJdHJbbyAqIDIgKyAxXSA9IG1pbih0cltvICogMiArIDFdLCBsYXp5W29dKTsNCgkJbGF6eVtvICogMl0gPSBtaW4obGF6eVsyICogb10sIGxhenlbb10pOw0KCQlsYXp5W28gKiAyICsgMV0gPSBtaW4obGF6eVsyICogbyArIDFdLCBsYXp5W29dKTsNCgkJbGF6eVtvXSA9IElORjsNCgl9DQp9DQp2b2lkIHVwZChpbnQgcCwgaW50IHgsIGludCBvLCBpbnQgbCwgaW50IHIpIHsNCglpZiAobCA9PSByKSB7DQoJCXRyW29dID0geDsNCgkJcmV0dXJuOw0KCX0NCglpbnQgbWlkID0gKGwgKyByKSAvIDI7DQoJaWYgKHAgPD0gbWlkKSB1cGQocCwgeCwgbyAqIDIsIGwsIG1pZCk7DQoJZWxzZSB1cGQocCwgeCwgbyAqIDIgKyAxLCBtaWQgKyAxLCByKTsNCgl0cltvXSA9IG1pbih0cltvICogMl0sIHRyW28gKiAyICsgMV0pOw0KfQ0Kdm9pZCB1cGRhdGUoaW50IEwsIGludCBSLCBpbnQgeCwgaW50IG8sIGludCBsLCBpbnQgcikgew0KCWlmIChMIDw9IGwgJiYgciA8PSBSKSB7DQoJCXRyW29dID0gbWluKHRyW29dLCB4KTsNCgkJbGF6eVtvXSA9IG1pbihsYXp5W29dLCB4KTsNCgkJcmV0dXJuOw0KCX0NCglwdXNoKG8pOw0KCWludCBtaWQgPSAobCArIHIpIC8gMjsNCglpZiAoTCA8PSBtaWQpIHVwZGF0ZShMLCBSLCB4LCBvICogMiwgbCwgbWlkKTsNCglpZiAoUiA+IG1pZCkgdXBkYXRlKEwsIFIsIHgsIG8gKiAyICsgMSwgbWlkICsgMSwgcik7DQoJdHJbb10gPSBtaW4odHJbbyAqIDJdLCB0cltvICogMiArIDFdKTsNCn0NCmludCBxdWUoaW50IHAsIGludCBvLCBpbnQgbCwgaW50IHIpIHsNCglpZiAobCA9PSByKSB7DQoJCXJldHVybiB0cltvXTsNCgl9DQoJcHVzaChvKTsNCglpbnQgbWlkID0gKGwgKyByKSAvIDI7DQoJaWYgKHAgPD0gbWlkKSByZXR1cm4gcXVlKHAsIG8gKiAyLCBsLCBtaWQpOw0KCWVsc2UgcmV0dXJuIHF1ZShwLCBvICogMiArIDEsIG1pZCArIDEsIHIpOw0KfQ0KaW50IHJxdWUoaW50IEwsIGludCBSLCBpbnQgbywgaW50IGwsIGludCByKSB7DQoJaWYgKEwgPD0gbCAmJiByIDw9IFIpIHsNCgkJcmV0dXJuIHRyW29dOw0KCX0gZWxzZSBpZihyIDwgTCB8fCBsID4gUikgew0KCQlyZXR1cm4gSU5GOwkNCgl9DQoJcHVzaChvKTsNCglpbnQgbWlkID0gKGwgKyByKSAvIDI7DQoJcmV0dXJuIG1pbihycXVlKEwsIFIsIG8gKiAyLCBsLCBtaWQpLCBycXVlKEwsIFIsIG8gKiAyICsgMSwgbWlkICsgMSwgcikpOw0KfQ0KdXNpbmcgcGlpID0gcGFpcjxpbnQsIGludD47DQp2b2lkIHNvbHZlKCkgew0KCW1lbXNldCh0ciwgMHgzZiwgc2l6ZW9mIHRyKTsNCgltZW1zZXQobGF6eSwgMHgzZiwgc2l6ZW9mIGxhenkpOw0KCWludCBuLCBtLCB4Ow0KCWNpbiA+PiBuID4+IG0gPj4geDsNCgl2ZWN0b3I8aW50PiB2Ow0KCXZlY3Rvcjx2ZWN0b3I8cGFpcjxpbnQsIGludD4+PiB3KE4pOw0KCWZvciAoaW50IGkgPSAwOyBpIDwgbjsgKysgaSkgew0KCQlpbnQgdCwgbCwgcjsNCgkJY2luID4+IHQgPj4gbCA+PiByOw0KCQl2LnB1c2hfYmFjayhsKTsNCgkJdi5wdXNoX2JhY2socik7DQoJCXdbdF0ucHVzaF9iYWNrKHtsLCByfSk7DQoJfQ0KCXZlY3RvcjxpbnQ+IGFucyhtKTsNCgl2ZWN0b3I8dmVjdG9yPHBhaXI8aW50LCBpbnQ+Pj4gcShOKTsNCglmb3IgKGludCBpID0gMDsgaSA8IG07ICsrIGkpIHsNCgkJaW50IGMsIHA7DQoJCWNpbiA+PiBjID4+IHA7DQoJCXYucHVzaF9iYWNrKHApOw0KCQlxW2NdLnB1c2hfYmFjayh7cCwgaX0pOw0KCX0NCglzb3J0KHYuYmVnaW4oKSwgdi5lbmQoKSk7DQoJdi5lcmFzZSh1bmlxdWUodi5iZWdpbigpLCB2LmVuZCgpKSwgdi5lbmQoKSk7DQoJaW50IE0gPSB2LnNpemUoKTsNCglhdXRvIGdldCA9IFsmXShpbnQgWCkgew0KCQlyZXR1cm4gZGlzdGFuY2Uodi5iZWdpbigpLCBsb3dlcl9ib3VuZCh2LmJlZ2luKCksIHYuZW5kKCksIFgpKSArIDE7DQoJfTsNCgl4ID0gZ2V0KHgpOw0KCXVwZCh4LCAwLCAxLCAxLCBNKTsNCglmb3IgKGludCB0ID0gTiAtIDE7IHQ7IC0tIHQpIHsNCgkJc29ydCh3W3RdLmJlZ2luKCksIHdbdF0uZW5kKCksIFsmXShjb25zdCBwaWkgJmEsIGNvbnN0IHBpaSAmYikgew0KCQkJaWYgKGEuc2Vjb25kID09IGIuc2Vjb25kKSByZXR1cm4gYS5maXJzdCA8IGIuZmlyc3Q7DQoJCQlyZXR1cm4gYS5zZWNvbmQgPiBiLnNlY29uZDsJDQoJCX0pOw0KCQlmb3IgKGF1dG8gW2wsIHJdIDogd1t0XSkgew0KCQkJbCA9IGdldChsKSwgciA9IGdldChyKTsNCgkJCWlmIChsIDwgcikgDQoJCQl1cGRhdGUobCwgciwgcnF1ZShsLCByLCAxLCAxLCBNKSArIDEsIDEsIDEsIE0pOw0KCQl9DQoJCWZvciAoYXV0byAmW3AsIGldIDogcVt0XSkgew0KCQkJcCA9IGdldChwKTsNCgkJCWFuc1tpXSA9IHF1ZShwLCAxLCAJMSwgTSk7DQoJCX0NCi8vCQljb3V0IDw8IHQgPDwgJ1xuJzsNCi8vCQlmb3IgKGludCBpID0gMTsgaSA8PSBNIDsgKysgaSApIGNvdXQgPDwgcXVlKGksIDEsIDEsIE0pIDw8ICcgJzsNCi8vCQljb3V0IDw8ICdcbic7DQoJfQ0KCWZvciAoYXV0byAmeCA6IGFucykgew0KCQlpZiAoeCA8PSBJTkYgLyAyKSBjb3V0IDw8IHggPDwgJ1xuJzsNCgkJZWxzZSBjb3V0IDw8IC0xIDw8ICdcbic7DQoJfQ0KfQ0Kc2lnbmVkIG1haW4oKSB7DQoJaW50IHQ7DQoJdCA9IDE7DQoJd2hpbGUgKHQgLS0pIHNvbHZlKCk7DQoJcmV0dXJuIDA7DQp9DQovKg0KNiAzIDEwDQoxIDEgMTANCjIgMyA2DQozIDUgOQ0KNCA3IDEwDQo1IDMgOA0KNiA3IDEwDQoxIDENCjIgNA0KNiA1DQoNCg0KKi8="}]