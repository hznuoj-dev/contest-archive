[{"id":"3675","submission_id":"3675","filename":"A.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+DQp1c2luZyBuYW1lc3BhY2Ugc3RkOw0KI2RlZmluZSBlbmRsICdcbicNCiNkZWZpbmUgSU8gaW9zOjpzeW5jX3dpdGhfc3RkaW8oMCk7Y2luLnRpZSgwKTtjb3V0LnRpZSgwKTsNCiNkZWZpbmUgbGwgbG9uZyBsb25nDQpjb25zdCBsbCBtb2RlPTFlOSs3Ow0KY29uc3QgaW50IG1heG49MWU3Ow0KLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCg0KY2hhciBhW21heG5dOw0KY2hhciBzW21heG5dOw0KaW50IGh3W21heG5dOw0KaW50IGpod1ttYXhuXTsNCnZvaWQgc29sdmUoKQ0Kew0KICAgIGNpbj4+YTsNCiAgICBpbnQgbiA9IHN0cmxlbihhKTsNCiAgICBzWzBdID0gJz4nOw0KICAgIHNbMV0gPSAnIyc7DQogICAgZm9yIChpbnQgaSA9MDtpPG47aSsrKQ0KICAgIHsNCiAgICAgICAgc1tpKjIrMl0gPSBhW2ldOw0KICAgICAgICBzW2kqMiszXSA9ICcjJzsNCiAgICB9DQogICAgc1tuKjIrMl0gPSAnPCc7DQogICAgc1tuKjIrM10gPSAnXDAnOw0KDQoNCg0KICAgIGludCBsZSA9IHN0cmxlbihzKTsNCg0KICAgIGZvciAoaW50IGkgPTA7aTw9bGU7aSsrKQ0KICAgICAgICBod1tpXT1qaHdbaV0gPSAwOw0KDQoNCiAgICBpbnQgbSAgPSAtMSwgciA9IC0xOw0KICAgIGZvciAoaW50IGkgPSAwO2k8PWxlO2krKykNCiAgICB7DQogICAgICAgIGJvb2wgZmxhZyA9IHRydWU7DQogICAgICAgIGJvb2wgZXJjaSA9IHRydWU7DQogICAgICAgIC8vIGppZQ0KICAgICAgICBjaGFyIHN0MSA9ICcuJzsNCiAgICAgICAgLy8gaHVhbg0KICAgICAgICBjaGFyIHN0MiA9ICAnLic7DQoNCg0KICAgICAgICBpbnQgcCA9IDA7DQogICAgICAgIGlmIChyPmkpIHAgPSBtaW4oci1pLGh3W20rbS1pXSk7DQoNCiAgICAgICAgaHdbaV0gPSBwOw0KDQogICAgICAgIHdoaWxlKDEpDQogICAgICAgIHsNCiAgICAgIC8vICAgICAgaWYgKGk9PTcpDQogICAgICAvLyAgICAgIHsNCiAgICAgIC8vICAgICAgICAgIGNvdXQ8PCBtPDwiPT0iPDxyPDwiICAgICI8PCBmbGFnIDw8IiAiPDxlcmNpPDwiICI8PHA8PCI6Ijw8IHN0MTw8c3QyPDxlbmRsOw0KICAgICAgLy8gICAgICB9DQoNCiAgICAgICAgICAgIGlmIChpLXA8PTAgfHwgaStwPj1sZS0xKQ0KICAgICAgICAgICAgICAgIGJyZWFrOw0KDQogICAgICAgICAgIGVsc2UgaWYgIChmbGFnICYmIGVyY2kgJiYgc1tpK3BdPT1zW2ktcF0pDQogICAgICAgICAgIHsNCiAgICAgICAgICAgICAgIGh3W2ldID0gKytwOw0KDQogICAgICAgICAgICAgICBpZiAoIGkrcD5yKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIHIgPSBpK3A7DQogICAgICAgICAgICAgICAgbSA9IGk7DQogICAgICAgICAgICB9DQogICAgICAgICAgIH0NCiAgICAgICAgICAgZWxzZSBpZiAgKCFmbGFnICYmICFlcmNpICYmIHNbaStwXT09c1tpLXBdKQ0KICAgICAgICAgICB7DQogICAgICAgICAgICAgICBqaHdbaV0gPSArK3A7DQogICAgICAgICAgIH0NCiAgICAgICAgICAgZWxzZSBpZiAgKCFmbGFnJiYgZXJjaSYmIHNbaStwXT09c1tpLXBdKQ0KICAgICAgICAgICB7DQogICAgICAgICAgICAgICArK3A7DQogICAgICAgICAgIH0NCiAgICAgICAgICAgZWxzZSBpZiAoZmxhZyAmJmVyY2kpDQogICAgICAgICAgIHsNCiAgICAgICAgICAgICAgIHN0MSA9IHNbaS1wXTsNCiAgICAgICAgICAgICAgIHN0MiA9IHNbaStwXTsNCiAgICAgICAgICAgICAgIGZsYWcgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICArK3A7DQoNCg0KDQogICAgICAgICAgIH1lbHNlIGlmICghZmxhZyAmJiBlcmNpICYmIChzdDE9PXNbaS1wXSAmJiBzdDIgPT0gc1tpK3BdKXx8KHN0MT09c1tpK3BdICYmIHN0MiA9PSBzW2ktcF0pKQ0KICAgICAgICAgICB7DQogICAgICAgICAgICAgICBlcmNpID0gZmFsc2U7DQogICAgICAgICAgICAgICBqaHdbaV0gPSArK3A7DQogICAgICAgICAgIH1lbHNlDQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIH0NCg0KDQogICAgaWYgKCFmbGFnICYmIGVyY2kgJiYgIHNbaV0hPScjJyYmIChzW2ldPT1zdDF8fHNbaV09PXN0MikpDQogICAgICAgIGpod1tpXSA9IHA7DQogICAgfQ0KDQoNCg0KIC8vICAgZm9yIChpbnQgaSA9IDA7aTxsZTtpKyspDQogLy8gICAgIGNvdXQ8PHNbaV08PCIgIjsNCiAvLyAgIGNvdXQ8PGVuZGw7DQogLy8gZm9yIChpbnQgaSA9IDA7aTxsZTtpKyspDQogLy8gICAgICAgY291dDw8aHdbaV08PCIgIjsNCiAvLyAgIGNvdXQ8PGVuZGw7DQogLy8gICBmb3IgKGludCBpID0gMDtpPGxlO2krKykNCiAvLyAgICAgICBjb3V0PDxqaHdbaV08PCIgIjsNCiAvLyAgIGNvdXQ8PGVuZGw7DQoNCiAgICBpbnQgYW5zID0gMCA7DQoNCiAgICBmb3IgKGludCBpID0gMDtpPGxlO2krKykNCiAgICAgICAgYW5zID0gbWF4KGFucyxod1tpXSAtMSk7DQogICAgZm9yIChpbnQgaSA9IDA7aTxsZTtpKyspDQogICAgICAgIGFucyA9IG1heChhbnMsamh3W2ldIC0xKTsNCg0KDQogICAgY291dDw8KChhbnM8PTEpPzA6YW5zKTw8ZW5kbDsNCg0KfQ0KaW50IG1haW4oKQ0Kew0KICAgIElPOw0KICAgIGludCB0bj0xOw0KICAgIGNpbj4+dG47DQogICAgd2hpbGUodG4tLSkNCiAgICB7DQogICAgICAgIHNvbHZlKCk7DQogICAgfQ0KICAgIHJldHVybiAwOw0KfQ0K"}]