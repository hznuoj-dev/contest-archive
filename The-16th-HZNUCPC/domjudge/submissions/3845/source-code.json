[{"id":"3845","submission_id":"3845","filename":"final.cpp","source":"I2luY2x1ZGU8Yml0cy9zdGRjKysuaD4NCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQojZGVmaW5lIGludCBsb25nIGxvbmcgDQpjb25zdCBpbnQgbW9kPTFlOSs3Ow0KaW50IHNbMzBdWzMwXTsNCmludCBzc1szMF1bMzBdOw0KaW50IG51bWFbMzBdOw0KaW50IG51bWJbMzBdOw0KaW50IGRwWzMwXVszMF1bMzBdWzMwXTsNCmludCBhbnM7DQppbnQgZGlzPTA7DQppbnQgbjsNCmludCBjbnRhPTAsY250Yj0wOw0Kdm9pZCBkZnMoaW50IG5vdyxpbnQgYSxpbnQgYixpbnQgYyxpbnQgZCkNCnsNCglpZihub3c9PTQpDQoJew0KLy8JCWNvdXQ8PG5vdzw8ZW5kbDsNCgkJaW50IHpzLHlzLHp4LHl4Ow0KCQlpZihhPT0wKSB6cz0wOw0KCQllbHNlIGlmKGE9PTEpIHpzPS0xOw0KCQllbHNlIGlmKGE9PTIpIHpzPTE7DQoJCQ0KCQlpZihiPT0wKSB5cz0wOw0KCQllbHNlIGlmKGI9PTEpIHlzPS0xOw0KCQllbHNlIGlmKGI9PTIpIHlzPTE7DQoJCQ0KCQlpZihjPT0wKSB6eD0wOw0KCQllbHNlIGlmKGM9PTEpIHp4PTE7DQoJCWVsc2UgaWYoYz09Mikgeng9LTE7DQoJCQ0KCSAJaWYoZD09MCkgeXg9MDsNCgkJZWxzZSBpZihkPT0xKSB5eD0xOw0KCQllbHNlIGlmKGQ9PTIpIHl4PS0xOw0KDQoJCWlmKHpzK3lzK3p4K3l4IT1kaXMpIHJldHVybiA7DQoJCWlmKHpzPT0wJiZ5cz09MCkgDQoJCXsNCi8vCQkJY291dDw8enM8PCIgIjw8eXM8PGVuZGw8PHp4PDwiICI8PHl4PDxlbmRsOw0KCQkNCgkJfQ0KCQlmb3IoaW50IGk9MDtpPDI2O2krKykNCgkJew0KCQkJZm9yKGludCBqPTA7ajwyNjtqKyspDQoJCQl7DQoJCQkJaWYoIXNbaV1bal0pIGNvbnRpbnVlOw0KCQkJCW51bWFbaV0tLTsNCgkJCQludW1iW2pdLS07DQoJCQkJbnVtYVtqXSsrOw0KCQkJCW51bWJbaV0rKzsNCgkJCQlpbnQgYWEsYmI7DQoJCQkJaWYoaT09aikNCgkJCQl7DQoJCQkJCWFhPTA7DQoJCQkJCWJiPTA7DQoJCQkJfQ0KCQkJCWVsc2UgDQoJCQkJew0KCQkJCQlpZihudW1hW2ldPjAmJm51bWFbal09PTEpIGFhPTE7DQoJCQkJCWVsc2UgaWYobnVtYVtpXT09MCYmbnVtYVtqXT4xKSBhYT0yOw0KCQkJCQllbHNlIGFhPTA7DQoJCQkJCQ0KCQkJCQlpZihudW1iW2pdPT0wJiZudW1iW2ldPjEpIGJiPTI7DQoJCQkJCWVsc2UgaWYobnVtYltpXT09MSYmbnVtYltqXT4wKSBiYj0xOw0KCQkJCQllbHNlIGJiPTA7DQoJCQkJfQ0KCQ0KCQkJCQ0KCQkJCWlmKGFhIT1hfHxiYiE9YykNCgkJCQl7DQoJCQkJCW51bWFbaV0rKzsNCgkJCQkJbnVtYltqXSsrOw0KCQkJCQludW1hW2pdLS07DQoJCQkJCW51bWJbaV0tLTsNCgkJCQkJY29udGludWU7DQoJCQkJfQ0KCQkJCWZvcihpbnQgaz0wO2s8MjY7aysrKQ0KCQkJCXsNCgkJCQkJZm9yKGludCBlPTA7ZTwyNjtlKyspDQoJCQkJCXsNCgkJCQkJCWlmKCFzW2tdW2VdfHxkcFtpXVtqXVtrXVtlXSkgY29udGludWU7DQoJCQkJCQludW1hW2tdLS07DQoJCQkJCQludW1iW2VdLS07DQoJCQkJCQludW1hW2VdKys7DQoJCQkJCQludW1iW2tdKys7DQoJCQkJCQlpbnQgY2MsZGQ7DQoJCQkJCQlpZihlPT1rKQ0KCQkJCQkJew0KCQkJCQkJCWNjPTAsZGQ9MDsNCgkJCQkJCX0NCgkJCQkJCWVsc2UgDQoJCQkJCQl7DQoJCQkJCQkJaWYobnVtYVtrXSYmbnVtYVtlXT09MSkgY2M9MTsNCgkJCQkJCQllbHNlIGlmKG51bWFba109PTAmJm51bWFbZV0+MSkgY2M9MjsNCgkJCQkJCQllbHNlIGNjPTA7DQoJCQkJCQkJDQoJCQkJCQkJaWYobnVtYltlXT09MCYmbnVtYltrXT4xKSBkZD0yOw0KCQkJCQkJCWVsc2UgaWYobnVtYltrXT09MSYmbnVtYltlXT4wKSBkZD0xOw0KCQkJCQkJCWVsc2UgZGQ9MDsNCgkJCQkJCX0NCgkJCQkJDQoJCQkJCQ0KCQkJCQkJaWYoY2MhPWJ8fGRkIT1kKQ0KCQkJCQkJew0KCQkJCQkJCW51bWFba10rKzsNCgkJCQkJCQludW1iW2VdKys7DQoJCQkJCQkJbnVtYVtlXS0tOw0KCQkJCQkJCW51bWJba10tLTsNCgkJCQkJCQljb250aW51ZTsNCgkJCQkJCX0NCgkJCQkJCWlmKChpPT1rKSYmKGo9PWUpKQ0KCQkJCQkJew0KCQkJCQkJCWFucz0oYW5zKyhzW2ldW2pdKihzW2ldW2pdLTEpKS8yKSVtb2Q7CQ0KCQkJCQkJfQ0KCQkJCQkJZWxzZSANCgkJCQkJCXsNCgkJCQkJCQlhbnM9KGFucytzW2ldW2pdKnNba11bZV0lbW9kKSVtb2Q7CQ0KCQkJCQkJfQ0KLy8JCQkJCQljb3V0PDxhYTw8IiAiPDxiYjw8IiAiPDxjYzw8IiAiPDxkZDw8ZW5kbDsNCi8vCQkJCQkJY291dDw8KGNoYXIpKGkrJ2EnKTw8IiAiPDwoY2hhcikoaisnYScpPDwiICI8PChjaGFyKShrKydhJyk8PCIgIjw8KGNoYXIpKGUrJ2EnKTw8IiAiPDxzW2ldW2pdPDwiICI8PHNba11bZV08PGVuZGw7DQoJCQkJCQlkcFtpXVtqXVtrXVtlXT1kcFtrXVtlXVtpXVtqXT0xOw0KCQkJCQkJbnVtYVtrXSsrOw0KCQkJCQkJbnVtYltlXSsrOw0KCQkJCQkJbnVtYVtlXS0tOw0KCQkJCQkJbnVtYltrXS0tOw0KCQkJCQl9DQoJCQkJfQ0KCQkJCW51bWFbaV0rKzsNCgkJCQludW1iW2pdKys7DQoJCQkJbnVtYVtqXS0tOw0KCQkJCW51bWJbaV0tLTsNCgkJCX0NCgkJfQ0KCQlyZXR1cm47DQoJfQ0KCWlmKG5vdz09MCkNCgl7DQoJCWRmcygxLDAsLTEsLTEsLTEpOw0KCQlkZnMoMSwxLC0xLC0xLC0xKTsNCgkJZGZzKDEsMiwtMSwtMSwtMSk7DQoJfQ0KCWVsc2UgaWYobm93PT0xKQ0KCXsNCgkJZGZzKDIsYSwwLC0xLC0xKTsNCgkJZGZzKDIsYSwxLC0xLC0xKTsNCgkJZGZzKDIsYSwyLC0xLC0xKTsNCgl9DQoJZWxzZSBpZihub3c9PTIpDQoJew0KCQlkZnMoMyxhLGIsMCwtMSk7DQoJCWRmcygzLGEsYiwxLC0xKTsNCgkJZGZzKDMsYSxiLDIsLTEpOw0KCX0NCgllbHNlIA0KCXsNCgkJZGZzKDQsYSxiLGMsMCk7DQoJCWRmcyg0LGEsYixjLDEpOw0KCQlkZnMoNCxhLGIsYywyKTsNCgl9DQp9DQpzdHJpbmcgYSxiOw0KaW50IGdldChzdHJpbmcgeCkNCnsNCgltYXA8Y2hhcixpbnQ+bXA7DQoJZm9yKGF1dG8gZTp4KQ0KCXsNCgkJbXBbZV0rKzsNCgl9DQoJcmV0dXJuIG1wLnNpemUoKTsNCn0NCnZvaWQgc29sdmUoKQ0Kew0KCWFucz0wOw0KCQ0KCWNpbj4+YT4+YjsNCi8vaW50IHNbMzBdWzMwXTsNCi8vaW50IHNzWzMwXVszMF07DQovL2ludCBudW1hWzMwXTsNCi8vaW50IG51bWJbMzBdOw0KLy9pbnQgZHBbMzBdWzMwXVszMF1bMzBdOw0KLy9pbnQgYW5zOw0KLy9pbnQgZGlzPTA7DQoJbWVtc2V0KHMsMCxzaXplb2Ygcyk7CQ0KCW1lbXNldChzcywwLHNpemVvZiBzcyk7DQoJbWVtc2V0KG51bWEsMCxzaXplb2YgbnVtYSk7DQoJbWVtc2V0KG51bWIsMCxzaXplb2YgbnVtYik7DQoJbWVtc2V0KGRwLDAsc2l6ZW9mIGRwKTsNCglkaXM9MDsNCgljbnRhPTAsY250Yj0wOw0KCW49YS5zaXplKCk7DQoJZm9yKGludCBpPTA7aTxuO2krKykNCgl7DQoJCW51bWFbYVtpXS0nYSddKys7DQoJCW51bWJbYltpXS0nYSddKys7DQoJCXNbYVtpXS0nYSddW2JbaV0tJ2EnXSsrOw0KCQlzc1tiW2ldLSdhJ11bYVtpXS0nYSddKys7DQoJfQ0KCWZvcihpbnQgaT0wO2k8MjY7aSsrKQ0KCXsNCgkJaWYobnVtYVtpXSljbnRhKys7DQoJCWlmKG51bWJbaV0pIGNudGIrKzsNCgl9DQoJaWYoY250Yj5jbnRhKQ0KCXsNCgkJc3dhcChjbnRiLGNudGEpOw0KCQlzd2FwKGEsYik7DQoJCXN3YXAobnVtYSxudW1iKTsNCgkJc3dhcChzcyxzKTsNCgl9DQovLwlkaXM9YWJzKGdldChhKS1nZXQoYikpOw0KCWRpcz1hYnMoY250YS1jbnRiKTsNCi8vCWNvdXQ8PGRpczw8ZW5kbDsNCglkZnMoMCwtMSwtMSwtMSwtMSk7DQoJDQoJY291dDw8YW5zPDxlbmRsOw0KfQ0KLy9ib29sIGNoZWNrKHN0cmluZyB4LHN0cmluZyB5KQ0KLy97DQovLwltYXA8Y2hhcixpbnQ+bXBhOw0KLy8JbWFwPGNoYXIsaW50Pm1wYjsNCi8vCWZvcihhdXRvIGU6eCkNCi8vCXsNCi8vCQltcGFbZV0rKzsJDQovLwl9CQ0KLy8JZm9yKGF1dG8gZTp5KQ0KLy8Jew0KLy8JCW1wYltlXSsrOw0KLy8JfQ0KLy8JcmV0dXJuIG1wYS5zaXplKCk9PW1wYi5zaXplKCk7DQovL30NCi8vaW50IGZ1bigpDQovL3sNCi8vDQovLwlpbnQgYW5zPTA7DQovLwlmb3IoaW50IGk9MDtpPG47aSsrKQ0KLy8Jew0KLy8JCXN3YXAoYVtpXSxiW2ldKTsNCi8vCQkNCi8vCQlmb3IoaW50IGo9aSsxO2o8bjtqKyspDQovLwkJew0KLy8JCQlzd2FwKGFbal0sYltqXSk7DQovLwkJCWlmKGNoZWNrKGEsYikpDQovLwkJCXsNCi8vCQkJCWFucysrOw0KLy8JCQkJYW5zJT1tb2Q7CQ0KLy8JCQl9DQovLwkJCXN3YXAoYVtqXSxiW2pdKTsNCi8vCQl9DQovLwkJc3dhcChhW2ldLGJbaV0pOw0KLy8JfQ0KLy8JcmV0dXJuIGFuczsNCi8vfQ0Kc2lnbmVkIG1haW4oKQ0Kew0KCWlvczo6c3luY193aXRoX3N0ZGlvKDApOw0KCWNpbi50aWUoMCk7DQoJY291dC50aWUoMCk7DQoJc29sdmUoKTsNCgkNCglyZXR1cm4gMDsNCn0NCi8qDQpqaGVoZg0KbnFlZXENCg0KKi8="}]