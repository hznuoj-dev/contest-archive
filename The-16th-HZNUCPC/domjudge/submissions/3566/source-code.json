[{"id":"3566","submission_id":"3566","filename":"G.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+DQp1c2luZyBuYW1lc3BhY2Ugc3RkOw0KDQpjb25zdCBpbnQgTiA9IDJlNSArIDEwOw0KDQppbnQgbiwgcSwgbTsNCmludCBwW05dOw0KaW50IHNpeltOXTsNCmludCBjW05dOw0KaW50IGdbTl07DQppbnQgcmU7DQpib29sIGYgPSB0cnVlOw0KaW50IGZpbmQoaW50IHgpDQp7DQogICAgaWYoeCA9PSBwW3hdKSByZXR1cm4geDsNCiAgICByZXR1cm4gcFt4XSA9IGZpbmQocFt4XSk7DQp9DQoNCnZvaWQgZ2V0KGludCBvcCwgaW50IGEsIGludCBiKXsNCiAgICBpZihvcCA9PSAwKQ0KICAgIHsNCiAgICAgICAgaW50IHggPSBmaW5kKGEpOw0KICAgICAgICBpbnQgeSA9IGZpbmQoYik7DQogICAgICAgIGlmKHggIT0geSl7DQogICAgICAgIHBbeF0gPSB5Ow0KICAgICAgICBzaXpbeV0gKz0gc2l6W3hdOw0KICAgICAgICB9DQogICAgICAgIHggPSBmaW5kKGEgKyBuKTsNCiAgICAgICAgeSA9IGZpbmQoYiArIG4pOw0KICAgICAgICAgaWYoeCAhPSB5KXsNCiAgICAgICAgcFt4XSA9IHk7DQogICAgICAgIHNpelt5XSArPSBzaXpbeF07DQogICAgICAgIH0NCiAgICB9DQogICAgZWxzZXsNCiAgICAgICAgIGludCB4ID0gZmluZChhICsgbik7DQogICAgICAgIGludCB5ID0gZmluZChiKTsNCiAgICAgICAgaWYoeCAhPSB5KXsNCiAgICAgICAgcFt4XSA9IHk7DQogICAgICAgIHNpelt5XSArPSBzaXpbeF07DQogICAgICAgIH0NCiAgICAgICAgeCA9IGZpbmQoYSk7DQogICAgICAgIHkgPSBmaW5kKGIgKyBuKTsNCiAgICAgICAgIGlmKHggIT0geSl7DQogICAgICAgIHBbeF0gPSB5Ow0KICAgICAgICBzaXpbeV0gKz0gc2l6W3hdOw0KICAgICAgICB9DQogICAgfQ0KfQ0KDQppbnQgZHBbTl07DQppbnQgZmZbTl07DQppbnQgbWFpbigpew0KDQogICAgc2NhbmYoIiVkJWQlZCIsICZuLCAmcSwgJm0pOw0KICAgIGZvciAoaW50IGkgPSAxOyBpIDw9IG4gKyBuOyBpICsrKSBwW2ldID0gaTsNCiAgICBmb3IgKGludCBpID0gMTsgaSA8PSBuOyBpICsrKSBzaXpbaV0gPSAxOw0KDQogICAgd2hpbGUobSAtLSkNCiAgICB7DQogICAgICAgIGludCBvcCwgYSwgYjsNCiAgICAgICAgc2NhbmYoIiVkJWQlZCIsICZvcCwgJmEsICZiKTsNCiAgICAgICAgZ2V0KG9wLCBhLCBiKTsNCiAgICB9DQogICAgZm9yIChpbnQgaSA9IDE7IGkgPD0gbjsgaSArKykNCiAgICB7DQogICAgICAgIGlmKGZpbmQoaSkgPT0gZmluZChpICsgbikpDQogICAgICAgIHsNCiAgICAgICAgICAgIGYgPSBmYWxzZTsNCiAgICAgICAgfQ0KICAgIH0NCiAgICBpZihmID09IGZhbHNlKQ0KICAgIHsNCiAgICAgICAgcHV0cygiTk8iKTsNCiAgICB9DQogICAgZWxzZXsNCg0KICAgICAgICB2ZWN0b3I8cGFpcjxpbnQsaW50Pj5wb3M7DQogICAgICAgIGZvciAoaW50IGkgPSAxOyBpIDw9IG47IGkgKyspew0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGlmKGZpbmQoaSkgIT0gaSkgY29udGludWU7DQogICAgICAgICAgICAgICAgaWYoY1tzaXpbaV1dID09IDApDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICBnWysrcmVdID0gc2l6W2ldOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBjW3NpeltpXV0rKzsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIGZvciAoaW50IGkgPSAxOyBpIDw9IHJlOyBpICsrKQ0KICAgICAgICB7DQogICAgICAgICAgICBpbnQgbnVtID0gY1tnW2ldXTsNCiAgICAgICAgICAgIGludCB2YWwgPSBnW2ldOw0KICAgICAgICAgICAgaW50IHRtcCA9IDE7DQogICAgICAgICAgICB3aGlsZSh0bXAgPD0gbnVtKQ0KICAgICAgICAgICAgew0KICAgICAgICAgLy8gICAgICAgY291dCA8PCB0bXAgPDwiICIgPDwgbnVtIDw8IiAiPDx2YWwgKiB0bXAgPDwiICIgPDwgdmFsIDw8J1xuJzsNCiAgICAgICAgICAgICAgICBwb3MucHVzaF9iYWNrKHt2YWwgKiB0bXAsIHZhbH0pOw0KICAgICAgICAgICAgICAgIG51bSAtPSB0bXA7DQogICAgICAgICAgICAgICAgdG1wICo9IDI7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZihudW0pDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgcG9zLnB1c2hfYmFjayh7dmFsICogbnVtLCB2YWx9KTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICBkcFswXSA9IDE7DQogICAgICAgIGZvciAoaW50IGkgPSBwb3Muc2l6ZSgpIC0gMTsgaSA+PSAwOyBpIC0tKQ0KICAgICAgICB7DQogICAgICAgICAgICAvL2NvdXQgPDwgcG9zW2ldLmZpcnN0IDw8IiAiIDw8IHBvc1tpXS5zZWNvbmQgPDwgJ1xuJzsNCiAgICAgICAgICAgIGZvciAoaW50IGogPSBxOyBqID49IHBvc1tpXS5maXJzdDsgaiAtLSkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBkcFtqXSB8PSBkcFtqIC0gcG9zW2ldLmZpcnN0XTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIGlmKCFkcFtxXSkNCiAgICAgICAgew0KICAgICAgICAgICAgcHV0cygiTk8iKTsNCg0KICAgICAgICB9DQogICAgICAgIGVsc2V7DQogICAgICAgICAgICAgaW50IHFxID0gcTsNCiAgICAgICAgICAgICB2ZWN0b3I8aW50PnJldDsNCiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgcG9zLnNpemUoKTsgaSArKykNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBpZihkcFtxcV0gJiYgZHBbcXEgLSBwb3NbaV0uZmlyc3RdICYmIHFxID49IHBvc1tpXS5maXJzdCkNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgLy8gICAgY291dCA8PCBwb3NbaV0uc2Vjb25kIDw8ICIgIiA8PCBwb3NbaV0uZmlyc3QgPDwgJ1xuJzsNCiAgICAgICAgICAgICAgICAgICAgZmZbcG9zW2ldLnNlY29uZF0gKz0gcG9zW2ldLmZpcnN0Ow0KICAgICAgICAgICAgICAgICAgICBxcSAtPSBwb3NbaV0uZmlyc3Q7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgZm9yIChpbnQgaSA9IDE7IGkgPD0gbjsgaSArKykNCiAgICAgICAgICAgIHsNCg0KICAgICAgICAgICAgICAgIGlmKGZmW3NpeltmaW5kKGkpXV0gPj0gMSkNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIGZmW3NpeltmaW5kKGkpXV0tLTsNCiAgICAgICAgICAgICAgICAgICAgcmV0LnB1c2hfYmFjayhpKTsNCg0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHB1dHMoIllFUyIpOw0KICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCByZXQuc2l6ZSgpOyBpICsrKQ0KICAgICAgICAgICAgew0KDQogICAgICAgICAgICAgICAgcHJpbnRmKCIlZCVjIiwgcmV0W2ldLCAiIFxuIltpID09IHJldC5zaXplKCkgLSAxXSk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgIH0NCn0NCg=="}]