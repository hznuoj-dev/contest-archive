[{"id":"3573","submission_id":"3573","filename":"G.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+DQoNCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQojZGVmaW5lIGxuICdcbicNCg0KY29uc3QgaW50IE4gPSAyZTUgKyA1Ow0KDQppbnQgZltOXSwgc2l6W05dLCBjb2xbTl0sIHdbTl0sIGlkW05dOw0KDQppbnQgZmluZChpbnQgeCkgew0KCWlmKGZbeF0gPT0geCkgcmV0dXJuIHg7DQoJaW50IHBhciA9IGZpbmQoZlt4XSk7DQoJY29sW3hdID0gY29sW2ZbeF1dIF4gd1t4XTsNCglyZXR1cm4gcGFyOw0KfQ0KDQpib29sIGFucyA9IHRydWU7DQoNCnZvaWQgbWVyZ2UoaW50IHgsIGludCB5LCBpbnQgVykgew0KCWludCBmeCA9IGZpbmQoeCksIGZ5ID0gZmluZCh5KTsNCglpZihmeCA9PSBmeSkgew0KCQlpZihjb2xbeF0gXiBjb2xbeV0gIT0gVykgYW5zID0gZmFsc2U7DQoJCXJldHVybjsNCgl9DQoJaWYoc2l6W2Z4XSA8IHNpeltmeV0pIA0KCQlzd2FwKHgsIHkpLCBzd2FwKGZ4LCBmeSk7DQoJDQoJc2l6W2Z4XSArPSBzaXpbZnldOw0KCWZbZnldID0gZng7DQoJd1tmeV0gPSBjb2xbeF0gXiBjb2xbeV0gXiBXOw0KCQ0KfQ0KDQppbmxpbmUgdm9pZCBzb2x2ZSgpIHsNCglpbnQgbiwgcSwgbTsNCi8vCWNpbiA+PiBuID4+IHEgPj4gbTsNCglzY2FuZigiJWQlZCVkIiwgJm4sICZxLCAmbSk7DQoJZm9yKGludCBpID0gMTsgaSA8PSBuOyBpKyspIA0KCQlmW2ldID0gaSwgY29sW2ldID0gMCwgc2l6W2ldID0gMSwgd1tpXSA9IDA7DQoJZm9yKGludCBpID0gMTsgaSA8PSBtOyBpKyspIHsNCgkJaW50IHgsIHksIHc7DQoJCXNjYW5mKCIlZCVkJWQiLCAmdywgJngsICZ5KTsNCi8vCQljaW4gPj4gdyA+PiB4ID4+IHk7DQoJCW1lcmdlKHgsIHksIHcpOw0KCX0NCglpZihhbnMgPT0gZmFsc2UpIA0KCQlyZXR1cm4gcHV0cygiTk8iKSwgdm9pZCgpOw0KLy8JZWxzZSANCi8vCQljb3V0IDw8ICJZRVNcbiI7DQoJDQoJaW50IHRvdCA9IDA7DQoJZm9yKGludCBpID0gMTsgaSA8PSBuOyBpKyspIA0KCQlpZihmaW5kKGkpID09IGkpIGlkW2ldID0gKyt0b3Q7CQ0KCWZvcihpbnQgaSA9IDE7IGkgPD0gbjsgaSsrKSANCgkJaWRbaV0gPSBpZFtmaW5kKGkpXTsNCgkJDQoJdmVjdG9yPHZlY3RvcjxpbnQ+PiBnb29kKHRvdCArIDEpLCBiYWQodG90ICsgMSk7DQoJZm9yKGludCBpID0gMTsgaSA8PSBuOyBpKyspIHsNCgkJaWYoY29sW2ldID09IDApDQoJCQlnb29kW2lkW2ldXS5wdXNoX2JhY2soaSk7DQoJCWVsc2UNCgkJCWJhZFtpZFtpXV0ucHVzaF9iYWNrKGkpOw0KCX0NCgkNCi8vCWludCBtbiA9IG1pbihxLCBuIC0gcSk7DQoJDQovLwljb3V0IDw8IG1uIDw8IGxuOw0KCQ0KCXZlY3RvcjxiaXRzZXQ8MTAwMDA1Pj4gcCh0b3QgKyAxKTsNCglwWzBdWzBdID0gMTsNCglmb3IoaW50IGkgPSAxOyBpIDw9IHRvdDsgaSsrKSB7DQovLwkJY291dCA8PCBnb29kW2ldLnNpemUoKSA8PCAiICIgPDwgYmFkW2ldLnNpemUoKSA8PCBsbjsNCgkJcFtpXSA9IHBbaSAtIDFdIDw8IGdvb2RbaV0uc2l6ZSgpOw0KCQlwW2ldID0gcFtpXSB8IChwW2kgLSAxXSA8PCBiYWRbaV0uc2l6ZSgpKTsNCi8vCQljb3V0IDw8IHBbaV0gPDwgbG47DQoJCQ0KCX0NCg0KCWlmKHEgPiAxMDAwMDAgfHwgcFt0b3RdW3FdID09IDApIHJldHVybiBwdXRzKCJOTyIpLCB2b2lkKCk7DQoJcHV0cygiWUVTIik7DQoNCgl2ZWN0b3I8aW50PiBhbnNfZ29vZCwgYW5zX2JhZDsNCgkNCglmb3IoaW50IGkgPSB0b3Q7IGk7IGktLSkNCgkJaWYocSA+PSBnb29kW2ldLnNpemUoKSAmJiBwW2kgLSAxXVtxIC0gZ29vZFtpXS5zaXplKCldKSAgew0KCQkJcSAtPSBnb29kW2ldLnNpemUoKTsgDQoJCQlmb3IoYXV0byB4OiBnb29kW2ldKSBhbnNfZ29vZC5wdXNoX2JhY2soeCk7DQovLwkJCWZvcihhdXRvIHg6IGJhZFtpXSkgYW5zX2JhZC5wdXNoX2JhY2soeCk7DQoJCX0gZWxzZSBpZihxID49IGJhZFtpXS5zaXplKCkgJiYgcFtpIC0gMV1bcSAtIGJhZFtpXS5zaXplKCldKXsNCgkJCXEgLT0gYmFkW2ldLnNpemUoKTsNCgkJCWZvcihhdXRvIHg6IGJhZFtpXSkgYW5zX2dvb2QucHVzaF9iYWNrKHgpOw0KLy8JCQlmb3IoYXV0byB4OiBnb29kW2ldKSBhbnNfYmFkLnB1c2hfYmFjayh4KTsJDQoJCX0gZWxzZSB7DQoJCQlyZXR1cm4gcHV0cygiTk8iKSwgdm9pZCgpOw0KCQl9DQoJDQovLwlmb3IoaW50IGkgPSB0b3Q7IGk7IGktLSkNCi8vCQlpZihtbiA+PSBnb29kW2ldLnNpemUoKSAmJiBwW2kgLSAxXVttbiAtIGdvb2RbaV0uc2l6ZSgpXSkgIHsNCi8vCQkJbW4gLT0gZ29vZFtpXS5zaXplKCk7DQovLwkJCWZvcihhdXRvIHg6IGdvb2RbaV0pIGFuc19nb29kLnB1c2hfYmFjayh4KTsNCi8vCQkJZm9yKGF1dG8geDogYmFkW2ldKSBhbnNfYmFkLnB1c2hfYmFjayh4KTsNCi8vCQl9IGVsc2Ugew0KLy8JCQltbiAtPSBiYWRbaV0uc2l6ZSgpOw0KLy8JCQlmb3IoYXV0byB4OiBiYWRbaV0pIGFuc19nb29kLnB1c2hfYmFjayh4KTsNCi8vCQkJZm9yKGF1dG8geDogZ29vZFtpXSkgYW5zX2JhZC5wdXNoX2JhY2soeCk7CQ0KLy8JCX0NCgkNCglzb3J0KGFuc19nb29kLmJlZ2luKCksIGFuc19nb29kLmVuZCgpKTsNCi8vCXNvcnQoYW5zX2JhZC5iZWdpbigpLCBhbnNfYmFkLmVuZCgpKTsNCi8vCWlmKGFuc19nb29kLnNpemUoKSA9PSBxKSB7DQoJZm9yKGF1dG8geDogYW5zX2dvb2QpIA0KCQlwcmludGYoIiVkICIsIHgpOw0KLy8JY291dCA8PCBsbjsNCglwdXRzKCIiKTsNCi8vCX0gZWxzZSB7DQovLwkJZm9yKGF1dG8geDogYW5zX2JhZCkgY291dCA8PCB4IDw8ICIgIjsNCi8vCQljb3V0IDw8IGxuOw0KLy8JfQ0KfQ0KDQppbnQgbWFpbigpIHsNCgkNCi8vCWZyZW9wZW4oIjEudHh0IiwgInIiLCBzdGRpbik7DQoJDQovLwlpb3M6OnN5bmNfd2l0aF9zdGRpbyhmYWxzZSk7DQovLwljaW4udGllKG51bGxwdHIpOw0KCQ0KCXNvbHZlKCk7DQp9DQoNCi8qDQoyIDEgMg0KMSAxIDINCjAgMiAxDQoNCjAgMCAxDQoxIDAgMA0KKi8NCg=="}]