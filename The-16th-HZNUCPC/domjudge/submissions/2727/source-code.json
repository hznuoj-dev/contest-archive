[{"id":"2727","submission_id":"2727","filename":"G.cpp","source":"I2luY2x1ZGU8Yml0cy9zdGRjKysuaD4NCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQoNCmNvbnN0IGludCBOID0gMmU1ICsgNTsNCmludCBuLCBtLCBxOw0Kc3RydWN0IERhdGEgew0KCWludCB4LCBpZDsNCn07DQppbnQgdmlzW05dLCBzdW1bMl0sIGNvbFtOXTsNCnZlY3RvciA8RGF0YT4gZVtOXTsNCnZlY3RvciA8aW50PiB2WzJdW05dOw0KaW50IGNudDsNCmludCBkZnMoaW50IHgsIGludCBjKSB7DQoJdmlzW3hdID0gMTsgY29sW3hdID0gYzsNCglzdW1bY10rKzsNCgl2W2NdW2NudF0ucHVzaF9iYWNrKHgpOw0KCWZvcihhdXRvIHkgOiBlW3hdKSB7DQoJCWlmKCF2aXNbeS54XSkgew0KCQkJaWYoIWRmcyh5LngsIGMgXiB5LmlkKSkgcmV0dXJuIDA7DQoJCX1lbHNlIGlmKChjb2xbeF0gXiBjb2xbeS54XSkgIT0geS5pZCkgcmV0dXJuIDA7DQoJfQ0KCXJldHVybiAxOw0KfQ0Kc3RydWN0IHF1ZSB7DQoJaW50IHgsIGlkOw0KCWJvb2wgb3BlcmF0b3IgPCAoY29uc3QgcXVlICZhKWNvbnN0IHsNCgkJcmV0dXJuIHggPCBhLng7DQoJfQ0KfWFbTl07DQpzdHJ1Y3QgRFAgew0KCWludCB2YWwsIHksIGxhc3Q7DQp9ZHBbTl07DQppbnQgdmFsW05dOw0KaW50IG1haW4oKSB7DQoJaW9zIDo6IHN5bmNfd2l0aF9zdGRpbyhmYWxzZSk7DQoJY2luID4+IG4gPj4gcSA+PiBtOw0KCWZvcihpbnQgaSA9IDE7IGkgPD0gbTsgaSsrKSB7DQoJCWludCBrLCB4LCB5OyBjaW4gPj4gayA+PiB4ID4+IHk7DQoJCWVbeF0ucHVzaF9iYWNrKChEYXRhKXt5LCBrfSk7DQoJCWVbeV0ucHVzaF9iYWNrKChEYXRhKXt4LCBrfSk7DQoJfQ0KCWZvcihpbnQgaSA9IDE7IGkgPD0gbjsgaSsrKQ0KCQlpZighdmlzW2ldKSB7DQoJCQkrK2NudDsNCgkJCXN1bVswXSA9IHN1bVsxXSA9IDA7DQoJCQlpZighZGZzKGksIDApKSB7DQoJCQkJY291dCA8PCAiTk9cbiI7DQoJCQkJcmV0dXJuIDA7DQoJCQl9DQoJCQlpZihzdW1bMF0gPiBzdW1bMV0pIHsNCgkJCQlzd2FwKHZbMF1bY250XSwgdlsxXVtjbnRdKTsNCgkJCX0NCgkJfQ0KCWZvcihpbnQgaSA9IDE7IGkgPD0gY250OyBpKyspDQoJCWFbaV0ueCA9IHZbMV1baV0uc2l6ZSgpIC0gdlswXVtpXS5zaXplKCksIGFbaV0uaWQgPSBpOw0KCXNvcnQoYSArIDEsIGEgKyAxICsgY250KTsNCglmb3IoaW50IGkgPSAxOyBpIDw9IG47IGkrKykNCgkJdmlzW2ldID0gMDsNCglmb3IoaW50IGkgPSAxOyBpIDw9IGNudDsgaSsrKSB7DQoJCXEgLT0gdlswXVtpXS5zaXplKCk7DQoJfQ0KCWlmKHEgPCAwKSB7DQoJCWNvdXQgPDwgIk5PXG4iOw0KCQlyZXR1cm4gMDsJDQoJfQ0KCWRwWzBdLnZhbCA9IDE7DQoJZm9yKGludCBpID0gMSwgaiA9IDE7IGkgPD0gY250OyBpID0gaikgew0KCQlpZihhW2ldLnggPT0gMCkgew0KCQkJaisrOw0KCQkJY29udGludWU7DQoJCX0NCgkJZm9yKDsgaiA8PSBjbnQgJiYgYVtqXS54ID09IGFbaV0ueDsgaisrKTsNCgkJaW50IHRvdCA9IGogLSBpLCBmbGFnID0gMTsNCgkJZm9yKGludCBwID0gMTsgZmxhZzsgcCAqPSAyKSB7DQoJCQlpZihwID49IHRvdCkgew0KCQkJCWZsYWcgPSAwOw0KCQkJCXAgPSB0b3Q7DQoJCQl9DQoJCQl0b3QgLT0gcDsNCi8vCQkJY291dCA8PCBxIC0gcCAqIGFbaV0ueCA8PCAiXG4iOw0KCQkJZm9yKGludCBrID0gcTsgayAtIHAgKiBhW2ldLnggPj0gMDsgay0tKQ0KCQkJCWlmKCFkcFtrXS52YWwgJiYgZHBbayAtIHAgKiBhW2ldLnhdLnZhbCkgew0KCQkJCQlkcFtrXS52YWwgPSAxOw0KLy8JCQkJCWNvdXQgPDwgYVtpXS54IDw8ICJkZnNcbiI7DQoJCQkJCWRwW2tdLmxhc3QgPSBrIC0gcCAqIGFbaV0ueDsNCgkJCQkJZHBba10ueSA9IGFbaV0ueDsNCgkJCQl9DQoJCX0NCgl9DQovLwljb3V0IDw8IHEgPDwgImRkXG4iOw0KCWlmKGRwW3FdLnZhbCA9PSAwKSB7DQoJCWNvdXQgPDwgIk5PXG4iOw0KCQlyZXR1cm4gMDsNCgl9DQoJY291dCA8PCAiWUVTXG4iOw0KCWZvcihpbnQgaSA9IHE7IGk7IGkgPSBkcFtpXS5sYXN0KSB7DQoJCWludCBxeiA9IGkgLSBkcFtpXS5sYXN0Ow0KCQl2YWxbZHBbaV0ueV0gKz0gcXogLyBkcFtpXS55Ow0KCX0NCglmb3IoaW50IGkgPSAxOyBpIDw9IGNudDsgaSsrKSB7DQoJCWlmKGFbaV0ueCA9PSAwIHx8IHZhbFthW2ldLnhdKSB7DQoJCQlmb3IoYXV0byB5IDogdlsxXVthW2ldLmlkXSkgDQoJCQkJdmlzW3ldID0gMTsNCgkJCXZhbFthW2ldLnhdLS07DQoJCX1lbHNlIHsNCgkJCWZvcihhdXRvIHkgOiB2WzBdW2FbaV0uaWRdKSANCgkJCQl2aXNbeV0gPSAxOw0KCQl9DQoJfQ0KLy8JY291dCA8PCBfIDw8ICJcbiI7DQoJZm9yKGludCBpID0gMTsgaSA8PSBuOyBpKyspDQoJCWlmKHZpc1tpXSkgY291dCA8PCBpIDw8ICIgIjsNCgljb3V0IDw8ICJcbiI7DQoJcmV0dXJuIDA7DQp9DQovKg0KNCAyIDQNCjEgMSAzDQoxIDIgNA0KMCAzIDQNCjAgMSAyDQoNCjIgMSAyDQoxIDEgMg0KMCAyIDENCnVUZU1Td0FFcE5kcA0KDQoxMyA3IDExDQowIDEgMg0KMCAxIDMNCjAgMSA0DQowIDEgNQ0KMSAxIDYNCjEgMSA3DQowIDggOQ0KMCA4IDEwDQowIDggMTENCjEgMTMgMTINCjEgMTIgMTMNCg0KMTIgNiA4DQoxIDEgMg0KMSA0IDUNCjEgNyA4DQoxIDEwIDExDQowIDIgMw0KMCA1IDYNCjAgOCA5DQowIDExIDEyDQoNCjE4IDkgMTQNCjAgMSAyDQowIDEgMw0KMCAxIDQNCjAgNSA2DQowIDUgNw0KMCA1IDgNCjEgNSA5DQoxIDUgMTANCjAgMTEgMTINCjAgMTEgMTMNCjAgMTEgMTQNCjEgMTEgMTUNCjAgMTYgMTcNCjEgMTYgMTgNCiov"}]