[{"id":"4230","submission_id":"4230","filename":"G.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+DQp1c2luZyBuYW1lc3BhY2Ugc3RkOw0KDQpjb25zdCBpbnQga01heE4gPSAxZTUgKyA1Ow0KaW50IG4sIHEsIG0sIGNvbFtrTWF4Tl0sIGNudFsyXSwgYmVsb25nW2tNYXhOXSwgdGFnW2tNYXhOXTsNCmJvb2wgdmlzW2tNYXhOXTsNCnZlY3RvcjxwYWlyPGludCwgaW50Pj4gR1trTWF4Tl07DQpib29sIHZhbGlkOw0KDQp2b2lkIGRmcyhpbnQgY3VyLCBpbnQgc2NjKSB7DQoJKytjbnRbY29sW2N1cl1dOw0KCWJlbG9uZ1tjdXJdID0gc2NjOw0KCWZvciAoYXV0byAmaiA6IEdbY3VyXSkgew0KCQlpbnQgdG8gPSBqLmZpcnN0LCB0eXAgPSBqLnNlY29uZDsNCgkJaWYgKCF2aXNbdG9dKSB7DQoJCQl2aXNbdG9dID0gdHJ1ZTsNCgkJCWNvbFt0b10gPSBjb2xbY3VyXSBeIHR5cDsNCgkJCWRmcyh0bywgc2NjKTsNCgkJfSBlbHNlIHsNCgkJCWlmIChjb2xbdG9dICE9IGNvbFtjdXJdIF4gdHlwKSB7DQoJCQkJY291dCA8PCAiTk8iIDw8ICJcbiI7DQoJCQkJZXhpdCgwKTsNCgkJCX0NCgkJfQ0KCX0NCn0NCg0Kc3RydWN0IE5vZGUgew0KCWludCBpZCwgbW4sIG14LCBteHRhZzsNCn07DQp2ZWN0b3I8Tm9kZT4gYmFnOw0KaW50IHNteFtrTWF4Tl0sIHNtbltrTWF4Tl07DQppbnQgc2NjID0gMDsNCg0Kdm9pZCBkZnMxKGludCBwb3MsIGludCBzdW0pIHsNCglpZiAoY2xvY2soKSA+IDEuNDUgKiBDTE9DS1NfUEVSX1NFQykgew0KCQljb3V0IDw8ICJOT1xuIjsNCgkJZXhpdCgwKTsNCgl9DQoJaWYgKHBvcyA9PSBzY2MpIHsNCgkJaWYgKHN1bSA9PSBxKSB7DQoJCQljb3V0IDw8ICJZRVNcbiI7DQoJCQl2ZWN0b3I8aW50PiBhbnM7DQoJCQlmb3IgKGludCBpID0gMTsgaSA8PSBuOyArK2kpIHsNCgkJCQlpZiAoKHRhZ1tiZWxvbmdbaV1dIF4gY29sW2ldKSA9PSAwKSB7DQoJCQkJCWFucy5wdXNoX2JhY2soaSk7DQoJCQkJfQ0KCQkJfQ0KCQkJZm9yIChpbnQgaSA9IDE7IGkgPD0gKGludClhbnMuc2l6ZSgpOyArK2kpIHsNCgkJCQljb3V0IDw8IGFuc1tpIC0gMV0gPDwgIiBcbiJbaSA9PSAoaW50KWFucy5zaXplKCldOw0KCQkJfQ0KCQkJZXhpdCgwKTsNCgkJfSBlbHNlIHsNCgkJCXJldHVybjsJDQoJCX0NCgl9DQoJaWYgKHN1bSArIHNteFtwb3NdIDwgcSkgcmV0dXJuOw0KCWlmIChzdW0gKyBzbW5bcG9zXSA+IHEpIHJldHVybjsNCgkNCgl0YWdbcG9zXSA9IGJhZ1twb3NdLm14dGFnOw0KCWRmczEocG9zICsgMSwgc3VtICsgYmFnW3Bvc10ubXgpOw0KCQ0KCXRhZ1twb3NdID0gYmFnW3Bvc10ubXh0YWcgXiAxOw0KCWRmczEocG9zICsgMSwgc3VtICsgYmFnW3Bvc10ubW4pOw0KfQ0KDQppbnQgbWFpbigpIHsNCglpb3M6OnN5bmNfd2l0aF9zdGRpbyhmYWxzZSk7DQoJDQoJdmFsaWQgPSB0cnVlOw0KCWNpbiA+PiBuID4+IHEgPj4gbTsNCglmb3IgKGludCBpID0gMTsgaSA8PSBtOyArK2kpIHsNCgkJaW50IG9wdCwgYSwgYjsNCgkJY2luID4+IG9wdCA+PiBhID4+IGI7DQoJCUdbYV0ucHVzaF9iYWNrKG1ha2VfcGFpcihiLCBvcHQpKTsNCgkJR1tiXS5wdXNoX2JhY2sobWFrZV9wYWlyKGEsIG9wdCkpOw0KCX0NCgkNCgltZW1zZXQoY29sLCAweGZmLCBzaXplb2YgY29sKTsNCglmb3IgKGludCBpID0gMTsgaSA8PSBuOyArK2kpIHsNCgkJaWYgKCF2aXNbaV0pIHsNCgkJCSsrc2NjOw0KCQkJdGFnW3NjY10gPSAwOw0KCQkJY250WzBdID0gY250WzFdID0gY29sW2ldID0gMDsNCgkJCXZpc1tpXSA9IHRydWU7DQoJCQlkZnMoaSwgc2NjKTsNCgkJCWJhZy5wdXNoX2JhY2soKE5vZGUpIHtzY2MsIG1pbihjbnRbMF0sIGNudFsxXSksIG1heChjbnRbMF0sIGNudFsxXSksIGNudFswXSA8IGNudFsxXX0pOw0KCQl9DQoJfQ0KCQ0KCWZvciAoaW50IGkgPSBzY2MgLSAxOyBpID49IDA7IC0taSkgew0KCQlzbXhbaV0gPSBzbXhbaSArIDFdICsgYmFnW2ldLm14Ow0KCQlzbW5baV0gPSBzbW5baSArIDFdICsgYmFnW2ldLm1uOw0KCX0NCgkNCglkZnMxKDAsIDApOw0KCQ0KCWNvdXQgPDwgIk5PXG4iOw0KCQ0KCXJldHVybiAwOw0KfQ=="}]