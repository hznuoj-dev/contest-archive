[{"id":"2963","submission_id":"2963","filename":"E.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+DQp1c2luZyBuYW1lc3BhY2Ugc3RkOw0KaW50IG51bVsxMDBdWzEwMF07DQppbnQgbWFpbigpDQp7DQogICAgbWVtc2V0KG51bSwtMSxzaXplb2YobnVtKSk7DQogICAgaW50IG47DQogICAgY2luID4+IG47DQogICAgaW50IHhbMTEwXSwgeVsxMTBdOw0KICAgIGludCBhbnMgPSAzLCBtYSA9IDA7DQogICAgaW50IGR4LGR5Ow0KICAgIGludCBkZTsNCiAgICBmb3IgKGludCBpID0gMDsgaSA8IG47IGkgKyspIGNpbiA+PiB4W2ldID4+IHlbaV07DQogICAgZm9yIChpbnQgaSA9IDA7IGkgPCBuOyBpICsrKQ0KICAgIHsNCiAgICAgICAgZm9yIChpbnQgaiA9IGkgKyAxOyBqIDwgbjsgaiArKykNCiAgICAgICAgew0KICAgICAgICAgICAgZm9yIChpbnQgayA9IGogKyAxOyBrIDwgbjsgayArKykNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBpbnQgeDEgPSB4W2ldLCB4Mj0geFtqXSwgeDMgPSB4W2tdLCB5MSA9IHlbaV0sIHkyID0geVtqXSwgeTMgPSB5W2tdOw0KICAgICAgICAgICAgICAgLy8gY291dDw8IGk8PCBqPDwgazsNCiAgICAgICAgICAgICAgICBpZih4MSA9PSB4MiB8fCB4MiA9PSB4MyB8fCB4MSA9PSB4MyApew0KICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgaWYoeTEgPT0geTIgfHwgeTIgPT0geTMgfHwgeTEgPT0geTMpew0KICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZG91YmxlIGsxID0gKHkxIC0geTIpIC8gKHgxIC0geDIpOw0KICAgICAgICAgICAgICAgIGRvdWJsZSBrMiA9KHkzIC0geTIpIC8gKHgzIC0geDIpOw0KICAgICAgICAgICAgICAgIGRvdWJsZSBrMyA9ICh5MSAtIHkzKSAvICh4MSAtIHgzKTsNCiAgICAgICAgICAgICAgICBpZiAoazEgPT0gazIgfHwgazEgPT0gazMgfHwgazIgPT0gazMpIGNvbnRpbnVlOw0KDQogICAgICAgICAgICAgICAgaWYobnVtW2ldW2pdID09IC0xKXsNCiAgICAgICAgICAgICAgICAgICAgZHkgPSBhYnMoeTEgLSB5MiksIGR4ID0gYWJzKHgxIC0geDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgLy9jb3V0IDw8IHgxIDw8ICcgJyA8PCB5MSA8PCAnICcgPDwgeDIgPDwgJyAnIDw8IHkyIDw8ICcgJyA8PHgzIDw8ICcgJyA8PCB5Mzw8JyAnOw0KICAgICAgICAgICAgICAgICAgICBudW1baV1bal0gPSAwOw0KICAgICAgICAgICAgICAgICAgICBkZSA9IHNxcnQoZHgpOw0KICAgICAgICAgICAgICAgICAgICBmb3IgKGludCBsID0gMTsgbCA8PSBkZTsgbCArKykNCiAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKChkeSAqIGwpICUgZHggPT0gMCl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbnVtW2ldW2pdICs9IChkeCAtIDEpIC8gbDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZihudW1bal1ba10gPT0gLTEpew0KICAgICAgICAgICAgICAgICAgICBkeSA9IGFicyh5MyAtIHkyKSwgZHggPSBhYnMoeDMgLSB4Mik7DQogICAgICAgICAgICAgICAgICAgIG51bVtqXVtrXSA9IDA7DQogICAgICAgICAgICAgICAgICAgIGRlID0gc3FydChkeCk7DQogICAgICAgICAgICAgICAgICAgIGZvciAoaW50IGwgPSAxOyBsIDw9IGRlOyBsICsrKQ0KICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoKGR5ICogbCkgJSBkeCA9PSAwKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBudW1bal1ba10gKz0gKGR4IC0gMSkgLyBsOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGlmKG51bVtpXVtrXSA9PSAtMSl7DQogICAgICAgICAgICAgICAgICAgIGR5ID0gYWJzKHkxIC0geTMpLCBkeCA9IGFicyh4MSAtIHgzKTsNCiAgICAgICAgICAgICAgICAgICAgbnVtW2ldW2tdID0gMDsNCiAgICAgICAgICAgICAgICAgICAgZGUgPSBzcXJ0KGR4KTsNCiAgICAgICAgICAgICAgICAgICAgZm9yIChpbnQgbCA9IDE7IGwgPD0gZGU7IGwgKyspDQogICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoZHkgKiBsKSAlIGR4ID09IDApew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG51bVtpXVtrXSArPSAoZHggLSAxKSAvIGw7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgLy9jb3V0PDxudW1baV1bal08PCIgIjw8bnVtW2pdW2tdPDwiICI8PG51bVtpXVtrXTw8ZW5kbDsNCiAgICAgICAgICAgICAgICBhbnMgPSAzICsgbnVtW2ldW2pdK251bVtpXVtrXStudW1bal1ba107DQogICAgICAgICAgICAgICAgaWYgKG1hIDwgYW5zKQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgbWEgPSBhbnM7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICB9DQogICAgY291dCA8PCBtYSA8PCBlbmRsOw0KICAgIHJldHVybiAwOw0KDQp9DQo="}]