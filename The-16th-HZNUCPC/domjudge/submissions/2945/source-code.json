[{"id":"2945","submission_id":"2945","filename":"D.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+DQoNCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQoNCg0KY29uc3QgaW50IE4gPSAzZTUgKyAxMDsNCmNvbnN0IGludCBJTkYgPSAweDNmM2YzZjNmOw0KaW50IGJbTl07DQppbnQgY250Ow0KDQppbnQgbiwgbSwgeDsNCmludCBtbltOIDw8IDJdOw0KaW50IG14W04gPDwgMl07DQppbnQgbGF6eVtOIDw8IDJdOw0KDQpzdHJ1Y3Qgbm9kZXsNCiAgICBpbnQgdDsNCiAgICBpbnQgbCwgcjsNCn1hW05dLCBxW05dOw0KDQppbnQgYW5zW05dOw0KDQpib29sIGNtcChub2RlICZhLCBub2RlICZiKXsNCiAgICBpZihhLnQgPT0gYi50KXsNCiAgICAgICAgcmV0dXJuIGEuciA8IGIucjsNCiAgICB9DQogICAgcmV0dXJuIGEudCA8IGIudDsNCn0NCg0Kdm9pZCBidWlsZChpbnQgcnQsIGludCBsLCBpbnQgcil7DQogICAgbW5bcnRdID0gSU5GOw0KICAgIG14W3J0XSA9IElORjsNCiAgICBsYXp5W3J0XSA9IElORjsNCiAgICBpZihsID09IHIpIHJldHVybiA7DQogICAgaW50IG1pZCA9IGwgKyByID4+IDE7DQogICAgYnVpbGQocnQgPDwgMSwgbCwgbWlkKTsNCiAgICBidWlsZChydCA8PCAxIHwgMSwgbWlkICsgMSwgcik7DQp9DQoNCnZvaWQgcHVzaHVwKGludCBydCl7DQogICAgbXhbcnRdID0gbWF4KG14W3J0IDw8IDFdLCBteFtydCA8PCAxIHwgMV0pOw0KICAgIG1uW3J0XSA9IG1pbihtbltydCA8PCAxXSwgbW5bcnQgPDwgMSB8IDFdKTsNCn0NCg0Kdm9pZCBwdXNoZG93bihpbnQgcnQpDQp7DQogICAgaWYobGF6eVtydF0gIT0gSU5GKQ0KICAgIHsNCg0KICAgICAgICBsYXp5W3J0IDw8IDFdID0gbGF6eVtydF07DQogICAgICAgIGxhenlbcnQgPDwgMSB8IDFdID0gbGF6eVtydF07DQogICAgICAgIG1uW3J0IDw8IDFdID0gbGF6eVtydF07DQogICAgICAgIG1uW3J0IDw8IDEgfCAxXSA9IGxhenlbcnRdOw0KICAgICAgICBteFtydCA8PCAxXSA9IGxhenlbcnRdOw0KICAgICAgICBteFtydCA8PCAxXSA9IGxhenlbcnRdOw0KDQogICAgICAgIGxhenlbcnRdID0gSU5GOw0KICAgIH0NCn0NCg0KDQp2b2lkIHNob3coaW50IHJ0LCBpbnQgbCwgaW50IHIpDQp7DQogICAgaWYobCA9PSByKXJldHVybiA7DQogICAgcHJpbnRmKCI/ICVkICVkICVkICVkICVkXG4iLGwsIHIsIG1uW3J0XSwgbXhbcnRdLCBsYXp5W3J0XSk7DQogICAgICAgIGlmKGwgPT0gcikgcmV0dXJuIDsNCiAgICBpbnQgbWlkID0gbCArIHIgPj4gMTsNCiAgICBwdXNoZG93bihydCk7DQogICAgc2hvdyhydCA8PCAxLCBsLCBtaWQpOw0KICAgIHNob3cocnQgPDwgMSB8IDEsIG1pZCArIDEsIHIpOw0KfQ0Kdm9pZCB1cGRhdGUoaW50IHJ0LCBpbnQgTCwgaW50IFIsIGludCBsLCBpbnQgciwgaW50IEMpDQp7DQovLyAgICBjb3V0IDw8IGwgPDwiICIgPDwgciA8PCIgIiA8PCBDIDw8ICdcbic7DQogICAgaWYobXhbcnRdIDw9IEMpIHJldHVybiA7DQogICAgaWYoTCA8PSBsICYmIFI+PSByICYmIG1uW3J0XSA+PSBDKQ0KICAgIHsNCiAvLyAgICAgICBjb3V0IDw8Ij8/PyI8PCBsIDw8IiAiIDw8IHIgPDwgIiAiIDw8IEM8PCdcbic7DQogICAgICAgIG1uW3J0XSA9IEM7DQogICAgICAgIG14W3J0XSA9IEM7DQogICAgICAgIGxhenlbcnRdID0gQzsNCiAgICAgICAgcmV0dXJuIDsNCiAgICB9DQogICAgaW50IG1pZCA9IGwgKyByID4+IDE7DQogICAgcHVzaGRvd24ocnQpOw0KICAgIGlmKEwgPD0gbWlkKSB1cGRhdGUocnQgPDwgMSwgTCwgUiwgbCwgbWlkLCBDKTsNCiAgICBpZihSID4gbWlkKSB1cGRhdGUocnQgPDwgMSB8IDEsIEwsIFIsIG1pZCArIDEsIHIsIEMpOw0KICAgIHB1c2h1cChydCk7DQp9DQoNCg0KaW50IHF1ZXJ5KGludCBydCwgaW50IEwsIGludCBSLCBpbnQgbCwgaW50IHIpDQp7DQogICAgaWYoTCA8PSBsICYmIFIgPj0gcil7DQogICAgICAgIHJldHVybiBtbltydF07DQogICAgfQ0KICAgIGludCBhbnMgPSBJTkY7DQogICAgaW50IG1pZCA9IGwgKyByID4+IDE7DQogICAgcHVzaGRvd24ocnQpOw0KICAgIGlmKEwgPD0gbWlkKSBhbnMgPSBtaW4oYW5zLCBxdWVyeShydCA8PCAxLCBMLCBSLCBsLCBtaWQpKTsNCiAgICBpZihSID4gbWlkKSBhbnMgPSBtaW4oYW5zLCBxdWVyeShydCA8PCAxIHwgMSwgTCwgUiwgbWlkICsgMSwgcikpOw0KICAgIHJldHVybiBhbnM7DQp9DQoNCmludCBtYWluKCl7DQogICAgc2NhbmYoIiVkJWQlZCIsICZuLCAmbSwgJngpOw0KICAgIGJbKysgY250XSA9IHg7DQogICAgZm9yIChpbnQgaSA9IDE7IGkgPD0gbjsgaSArKykNCiAgICB7DQogICAgICAgIHNjYW5mKCIlZCVkJWQiLCAmYVtpXS50LCAmYVtpXS5sLCAmYVtpXS5yKTsNCiAgICAgICAgYlsrKyBjbnRdID0gYVtpXS5sOw0KICAgICAgICBiWysrIGNudF0gPSBhW2ldLnI7DQogICAgfQ0KICAgIGZvciAoaW50IGkgPSAxOyBpIDw9IG07IGkgKyspDQogICAgew0KICAgICAgICBxW2ldLnQgPSBpOw0KICAgICAgICBzY2FuZigiJWQlZCIsICZxW2ldLmwsICZxW2ldLnIpOw0KICAgICAgICBiWysrIGNudF0gPSBxW2ldLnI7DQogICAgfQ0KICAgIHNvcnQoYiArIDEsIGIgKyBjbnQgKyAxKTsNCiAgICBjbnQgPSB1bmlxdWUoYiArIDEsIGIgKyBjbnQgKyAxKSAtIChiICsgMSk7DQogICAgeCA9IGxvd2VyX2JvdW5kKGIgKyAxLCBiICsgY250ICsgMSwgeCkgLSBiOw0KICAgIGZvciAoaW50IGkgPSAxOyBpIDw9IG47IGkgKyspDQogICAgew0KICAgICAgICBhW2ldLmwgPSBsb3dlcl9ib3VuZChiICsgMSwgYiArIGNudCArIDEsIGFbaV0ubCkgLSBiOw0KICAgICAgICBhW2ldLnIgPSBsb3dlcl9ib3VuZChiICsgMSwgYiArIGNudCArIDEsIGFbaV0ucikgLSBiOw0KICAgIH0NCiAgICBmb3IgKGludCBpID0gMTsgaSA8PSBtOyBpICsrKQ0KICAgIHsNCiAgICAgICAgcVtpXS5yID0gbG93ZXJfYm91bmQoYiArIDEsIGIgKyBjbnQgKyAxLCBxW2ldLnIpIC0gYjsNCiAgICB9DQoNCiAgICBzb3J0KGEgKyAxLCBhICsgbiArIDEsIGNtcCk7DQogICAgc29ydChxICsgMSwgcSArIG0gKyAxLCBjbXApOw0KICAgIGJ1aWxkKDEsIDEsIGNudCk7DQogICAgdXBkYXRlKDEsIHgsIHgsIDEsIGNudCwgMCk7DQogICAgaW50IGogPSBuOw0KICAgIGZvciAoaW50IGkgID0gbTsgaSA+PSAxOyBpIC0tKQ0KICAgIHsNCiAgICAgICAgd2hpbGUoaiA+PSAxICYmIGFbal0udCA+PSBxW2ldLmwpDQogICAgICAgIHsNCg0KICAgICAgICAgICAgaW50IG5lZWQgPSBxdWVyeSgxLCBhW2pdLmwsIGFbal0uciwgMSwgY250KTsNCiAgICAgICAgIC8vICAgY291dCA8PCAibmVlZCAiIDw8IiAiPDwgbmVlZCA8PCAnXG4nOw0KICAgICAgICAgICAgdXBkYXRlKDEsIGFbal0ubCwgYVtqXS5yLCAxLCBjbnQsIG5lZWQgKyAxKTsNCiAgICAgICAgICAgIGogLS07DQogICAgICAgIH0NCiAgICAgIC8vICBzaG93KDEsIDEsIGNudCk7DQogICAgIC8vICAgY291dCA8PCJxdWVyeSIgPDwgJ1xuJzsNCiAgICAgICAgYW5zW3FbaV0udF0gPSBxdWVyeSgxLCBxW2ldLmwsIHFbaV0uciwgMSwgY250KTsNCiAgICB9DQogICAgZm9yIChpbnQgaSA9IDE7IGkgPD0gbTsgaSArKykNCiAgICB7DQogICAgICAgIGlmKGFuc1tpXSA9PSBJTkYpIGFuc1tpXSA9IC0xOw0KICAgICAgICBjb3V0IDw8IGFuc1tpXSA8PCAnXG4nOw0KICAgIH0NCn0NCg0K"}]