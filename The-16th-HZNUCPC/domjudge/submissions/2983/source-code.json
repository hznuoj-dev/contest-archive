[{"id":"2983","submission_id":"2983","filename":"c.cpp","source":"I2luY2x1ZGUgPGlvc3RyZWFtPg0KI2luY2x1ZGUgPGFsZ29yaXRobT4NCiNpbmNsdWRlIDxtYXA+DQp1c2luZyBuYW1lc3BhY2Ugc3RkOw0KY29uc3QgaW50IE4gPSA1ZTUgKyAxMCwgaW5mID0gMHgzZjNmM2YzZjsNCnN0cnVjdCBub2RldCB7DQogICAgaW50IHRpbWU7DQogICAgaW50IGtpbmQ7IC8vIDEgOiBidXMsIDIgOnBlb3BsZQ0KICAgIGludCBsLCByOyAvLyBidXMNCiAgICBpbnQgcG9zOyAvLyBwZW9wbGUNCiAgICBpbnQgaWR4OyAvLyBxcnkNCiAgICBib29sIG9wZXJhdG9yPChjb25zdCBub2RldCAmbykgew0KICAgICAgICBpZiAodGltZSA9PSBvLnRpbWUpIHsNCiAgICAgICAgICAgIGlmIChraW5kICE9IG8ua2luZCkgcmV0dXJuIGtpbmQgPCBvLmtpbmQ7DQogICAgICAgICAgICByZXR1cm4gKHIgPiBvLnIpOw0KICAgICAgICB9DQogICAgICAgIHJldHVybiB0aW1lID4gby50aW1lOw0KICAgIH0NCn1xcnlzW04gLyAyXTsNCiNkZWZpbmUgbHMgdSA8PCAxDQojZGVmaW5lIHJzIHUgPDwgMSB8MQ0KI2RlZmluZSBsc29uIHRyW2xzXQ0KI2RlZmluZSByc29uIHRyW3JzXQ0Kc3RydWN0IG5vZGUgew0KICAgIGludCBmbGFnOw0KICAgIGludCBtbjsNCn10cltOIDw8IDJdOw0Kdm9pZCBidWlsZChpbnQgdSwgaW50IGwsIGludCByKSB7DQogICAgdHJbdV0ubW4gPSBpbmY7DQogICAgaWYgKGwgPT0gcikgew0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIGludCBtaWQgPSAobCArIHIpID4+IDE7DQogICAgYnVpbGQobHMsIGwsIG1pZCk7DQogICAgYnVpbGQocnMsIG1pZCArIDEsIHIpOw0KfQ0KDQp2b2lkIHB1c2h1cChpbnQgdSkgew0KICAgIHRyW3VdLm1uID0gbWluKHJzb24ubW4sIGxzb24ubW4pOw0KfQ0Kdm9pZCBwdXNoZG93bihpbnQgdSkgew0KICAgIGlmICh0clt1XS5mbGFnKSB7DQogICAgICAgIGxzb24ubW4gPSBtaW4odHJbdV0uZmxhZywgbHNvbi5tbik7DQogICAgICAgIHJzb24ubW4gPSBtaW4odHJbdV0uZmxhZywgcnNvbi5tbik7DQogICAgICAgIGxzb24uZmxhZyA9IHRyW3VdLmZsYWc7DQogICAgICAgIHJzb24uZmxhZyA9IHRyW3VdLmZsYWc7DQogICAgICAgIHRyW3VdLmZsYWcgPSAwOw0KICAgIH0NCn0NCmludCBxcnkoaW50IHUsIGludCBsLCBpbnQgciwgaW50IEwsIGludCBSKSB7DQogICAgaWYgKGwgPD0gTCAmJiBSIDw9IHIpIHsNCiAgICAgICAgcmV0dXJuIHRyW3VdLm1uOw0KICAgIH0NCiAgICBwdXNoZG93bih1KTsNCiAgICBpbnQgbWlkID0gKEwgKyBSKSA+PiAxOw0KICAgIGludCBtbiA9IGluZjsNCiAgICBpZiAobCA8PSBtaWQpIG1uID0gbWluKG1uLCBxcnkobHMsIGwsIHIsIEwsIG1pZCkpOw0KICAgIGlmIChyID4gbWlkKSBtbiA9IG1pbihtbiwgcXJ5KHJzLCBsLCByLCBtaWQgKzEsIFIpKTsNCiAgICByZXR1cm4gbW47DQp9DQp2b2lkIG1vZGlmeShpbnQgdSwgaW50IGwsIGludCByLCBpbnQgTCwgaW50IFIsIGludCB4KSB7DQogICAgaWYgKGwgPD0gTCAmJiBSIDw9IHIpIHsNCiAgICAgICAgdHJbdV0ubW4gPSBtaW4oeCwgdHJbdV0ubW4pOw0KICAgICAgICB0clt1XS5mbGFnID0geDsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCiAgICBwdXNoZG93bih1KTsNCiAgICBpbnQgbWlkID0gKEwgKyBSKSA+PiAxOw0KICAgIGlmIChsIDw9IG1pZCkgbW9kaWZ5KGxzLCBsLCByLCBMLCBtaWQsIHgpOw0KICAgIGlmIChyID5taWQpIG1vZGlmeShycywgbCwgciwgbWlkICsgMSwgUiwgeCk7DQogICAgcHVzaHVwKHUpOw0KfQ0KaW50IHJlc1tOXTsNCmludCBtYWluKCl7DQogICAgaW50IG4sIG0sIHg7DQogICAgY2luID4+IG4gPj4gbSA+Png7DQogICAgbWFwPGludCwgaW50PiBoYXNoXzsNCiAgICBpbnQgaGFzaGlkeCA9IDA7DQogICAgZm9yIChpbnQgaSA9IDE7IGkgPD0gbjsgaSsrKSB7DQogICAgICAgIGNpbiA+PiBxcnlzW2ldLnRpbWUgPj5xcnlzW2ldLmwgPj4gcXJ5c1tpXS5yOw0KICAgICAgICBxcnlzW2ldLmtpbmQgPSAxOw0KICAgICAgICBoYXNoX1txcnlzW2ldLmxdOw0KICAgICAgICBoYXNoX1txcnlzW2ldLnJdOw0KICAgIH0NCiAgICBoYXNoX1t4XTsNCiAgICBmb3IgKGludCBpID1uICsgMTsgaSA8PSBuICsgbTsgaSsrKSB7DQogICAgICAgIGNpbiA+PiBxcnlzW2ldLnRpbWUgPj5xcnlzW2ldLnBvczsNCiAgICAgICAgcXJ5c1tpXS5raW5kID0gMjsNCiAgICAgICAgcXJ5c1tpXS5pZHggPSBpIC0gbjsNCiAgICAgICAgaGFzaF9bcXJ5c1tpXS5wb3NdOw0KICAgIH0NCiAgICBmb3IgKGF1dG8gJltfLCB5XSA6IGhhc2hfKSB7DQogICAgICAgIHkgPSArK2hhc2hpZHg7DQogICAgICAgIGNvdXQgPDwgXyA8PCAnICc7DQogICAgfQ0KICAgIGNvdXQgPDwgJ1xuJzsNCiAgICBidWlsZCgxLCAxLCBoYXNoaWR4KTsNCiAgICBtb2RpZnkoMSwgaGFzaF9beF0sIGhhc2hfW3hdLCAxLCBoYXNoaWR4LCAwKTsNCiAgICAvLyBmb3IgKGludCBpID0gMTsgaSA8PSBoYXNoaWR4OyBpKyspIHsNCiAgICAvLyAgICAgICAgICAgICBjb3V0IDw8IHFyeSgxLCBpLCBpLCAxLCBoYXNoaWR4KSA8PCAnICc7DQogICAgLy8gICAgICAgICB9DQogICAgLy8gICAgICAgICBjb3V0IDw8ICdcbic7DQogICAgc29ydChxcnlzICsxLCBxcnlzICtuICsgbSArMSk7DQogICAgZm9yIChpbnQgaSA9IDE7IGkgPD0gbiArIG07IGkrKykgew0KICAgICAgICBpZiAocXJ5c1tpXS5raW5kID09IDEpIHsNCiAgICAgICAgICAgIGludCBsID0gaGFzaF9bcXJ5c1tpXS5sXSwgciA9IGhhc2hfW3FyeXNbaV0ucl07DQogICAgICAgICAgICBpbnQgbW4gPSBxcnkoMSwgbCwgciwgMSwgaGFzaGlkeCk7DQogICAgICAgICAgICBtb2RpZnkoMSwgbCwgciwgMSwgaGFzaGlkeCwgbW4gKyAxKTsNCiAgICAgICAgICAgIC8vIGZvciAoaW50IGkgPSAxOyBpIDw9IGhhc2hpZHg7IGkrKykgew0KICAgICAgICAgICAgLy8gICAgIGNvdXQgPDwgcXJ5KDEsIGksIGksIDEsIGhhc2hpZHgpIDw8ICcgJzsNCiAgICAgICAgICAgIC8vIH0NCiAgICAgICAgICAgIC8vIGNvdXQgPDwgJ1xuJzsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIGludCBwb3MgPSBoYXNoX1txcnlzW2ldLnBvc107DQogICAgICAgICAgICBpbnQgb2sgPSBxcnkoMSwgcG9zLCBwb3MsIDEsIGhhc2hpZHgpOw0KICAgICAgICAgICAgaWYgKG9rID09IGluZikgew0KICAgICAgICAgICAgICAgIG9rID0gLTE7DQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXNbcXJ5c1tpXS5pZHhdID0gb2s7DQogICAgICAgIH0NCiAgICB9DQogICAgZm9yIChpbnQgaSA9IDE7IGkgPD0gbTsgaSsrKSB7DQogICAgICAgIGNvdXQgPDwgcmVzW2ldIDw8J1xuJzsNCiAgICB9DQp9DQo="}]