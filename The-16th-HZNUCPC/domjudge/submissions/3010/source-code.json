[{"id":"3010","submission_id":"3010","filename":"D.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+DQp1c2luZyBuYW1lc3BhY2Ugc3RkOw0KDQpjb25zdCBpbnQga01heE4gPSAzZTUgKyA1LCBrSW5mID0gMHgzZjNmM2YzZjsNCmludCBuLCBtLCB4LCBhbnNba01heE5dLCBpbmZ0ID0gMHgzZjNmM2YzZjsNCnN0cnVjdCBOb2RlIHsNCglpbnQgcWlkLCB0LCBsLCByLCBkcDsNCn0gYVtrTWF4Tl07DQp2ZWN0b3I8aW50PiBiLCBjOw0KdmVjdG9yPGludD4gYWRkW2tNYXhOXSwgcXJ5W2tNYXhOXTsNCmludCBjYVtrTWF4Tl0sIGNiW2tNYXhOXTsNCg0KaW5saW5lIGludCBsb3diaXQoaW50IHgpIHsNCglyZXR1cm4geCAmIC14Ow0KfQ0KDQp2b2lkIGNkcShpbnQgbCwgaW50IHIpIHsNCglpZiAobCA9PSByKSByZXR1cm47DQoJDQoJaW50IG1pZCA9IChsICsgcikgPj4gMTsNCgljZHEobWlkICsgMSwgcik7DQoJDQoJZm9yIChpbnQgaSA9IG1pZCArIDE7IGkgPD0gcjsgKytpKSB7DQoJCWlmIChhW2ldLnFpZCA+IDApIGNvbnRpbnVlOw0KCQljYlsrK2NiWzBdXSA9IGk7DQoJfQ0KCWZvciAoaW50IGkgPSBsOyBpIDw9IG1pZDsgKytpKSB7DQoJCWNhWysrY2FbMF1dID0gaTsNCgl9DQoJc29ydChjYSArIDEsIGNhICsgY2FbMF0gKyAxLCBbJl0oaW50IHgsIGludCB5KSB7DQoJCXJldHVybiBhW3hdLnQgPiBhW3ldLnQgfHwgKGFbeF0udCA9PSBhW3ldLnQgJiYgYVt4XS5yIDwgYVt5XS5yKTsNCgl9KTsNCglzb3J0KGNiICsgMSwgY2IgKyBjYlswXSArIDEsIFsmXShpbnQgeCwgaW50IHkpIHsNCgkJcmV0dXJuIGFbeF0udCA+IGFbeV0udCB8fCAoYVt4XS50ID09IGFbeV0udCAmJiBhW3hdLmwgPCBhW3ldLmwpOw0KCX0pOw0KCXZlY3RvcjxpbnQ+IHRtcDsNCglmb3IgKGludCBpID0gMTsgaSA8PSBjYlswXTsgKytpKSB7DQoJCXRtcC5wdXNoX2JhY2soYVtjYltpXV0ubCk7DQoJfQ0KCWZvciAoaW50IGkgPSAxOyBpIDw9IGNhWzBdOyArK2kpIHsNCgkJdG1wLnB1c2hfYmFjayhhW2NhW2ldXS5yKTsNCgl9DQoJc29ydCh0bXAuYmVnaW4oKSwgdG1wLmVuZCgpKTsNCgl0bXAucmVzaXplKHVuaXF1ZSh0bXAuYmVnaW4oKSwgdG1wLmVuZCgpKSAtIHRtcC5iZWdpbigpKTsNCgkNCglhdXRvIGlkeCA9IFsmXShpbnQgdmFsKSB7DQoJCXJldHVybiBsb3dlcl9ib3VuZCh0bXAuYmVnaW4oKSwgdG1wLmVuZCgpLCB2YWwpIC0gdG1wLmJlZ2luKCkgKyAxOw0KCX07DQoJDQoJaW50IGxpbSA9IChpbnQpdG1wLnNpemUoKSArIDE7DQoJdmVjdG9yPGludD4gYml0KGxpbSwga0luZik7DQoJYXV0byBxdWVyeSA9IFsmXShpbnQgeCkgew0KCQl4ID0gaWR4KHgpOw0KCQlpbnQgYW5zID0ga0luZjsNCgkJd2hpbGUgKHggPiAwKSB7DQoJCQlhbnMgPSBtaW4oYW5zLCBiaXRbeF0pOw0KCQkJeCAtPSBsb3diaXQoeCk7DQoJCX0NCgkJcmV0dXJuIGFuczsNCgl9Ow0KCQ0KCWF1dG8gYWRkID0gWyZdKGludCB4LCBpbnQgdmFsKSB7DQoJCXggPSBpZHgoeCk7DQoJCXdoaWxlICh4IDw9IGxpbSkgew0KCQkJYml0W3hdID0gbWluKGJpdFt4XSwgdmFsKTsNCgkJCXggKz0gbG93Yml0KHgpOw0KCQl9DQoJfTsNCgkNCgkvLyBkZWNyZWFzaW5nbHkgZW51bWVyYXRlIHQNCglmb3IgKGludCBpID0gMSwgaiA9IDA7IGkgPD0gY2FbMF07ICsraSkgew0KCQl3aGlsZSAoaiArIDEgPD0gY2JbMF0gJiYgYVtjYVtpXV0udCA8PSBhW2NiW2ogKyAxXV0udCAmJiBhW2NhW2ldXS5yID49IGFbY2JbaiArIDFdXS5sKSB7DQoJCQlhZGQoYVtjYltqICsgMV1dLmwsIGFbY2JbaiArIDFdXS5kcCk7DQoJCQkrK2o7DQoJCX0NCgkJDQoJCWFbY2FbaV1dLmRwID0gbWluKGFbY2FbaV1dLmRwLCBxdWVyeShhW2NhW2ldXS5yKSArIDEpOw0KCX0NCgkNCgljZHEobCwgbWlkKTsNCn0NCg0KaW50IG1haW4oKSB7DQoJaW9zOjpzeW5jX3dpdGhfc3RkaW8oZmFsc2UpOw0KCWNpbiA+PiBuID4+IG0gPj4geDsNCglmb3IgKGludCBpID0gMTsgaSA8PSBuOyArK2kpIHsNCgkJYVtpXS5xaWQgPSAwOw0KCQljaW4gPj4gYVtpXS50ID4+IGFbaV0ubCA+PiBhW2ldLnI7DQoJCWIucHVzaF9iYWNrKGFbaV0udCk7DQoJCWMucHVzaF9iYWNrKGFbaV0ubCk7DQoJCWMucHVzaF9iYWNrKGFbaV0ucik7DQoJfQ0KCQ0KCWZvciAoaW50IGkgPSAxOyBpIDw9IG07ICsraSkgew0KCQlpbnQgdGEsIHRiOw0KCQljaW4gPj4gdGEgPj4gdGI7DQoJCWFbaSArIG5dLnFpZCA9IGk7DQoJCWFbaSArIG5dLnQgPSB0YTsNCgkJYVtpICsgbl0ubCA9IGFbaSArIG5dLnIgPSB0YjsNCgkJYi5wdXNoX2JhY2sodGEpOw0KCQljLnB1c2hfYmFjayh0Yik7DQoJfQ0KCQ0KCWIucHVzaF9iYWNrKGluZnQpOw0KCWMucHVzaF9iYWNrKHgpOw0KCXNvcnQoYi5iZWdpbigpLCBiLmVuZCgpKTsNCgliLnJlc2l6ZSh1bmlxdWUoYi5iZWdpbigpLCBiLmVuZCgpKSAtIGIuYmVnaW4oKSk7DQoJc29ydChjLmJlZ2luKCksIGMuZW5kKCkpOw0KCWMucmVzaXplKHVuaXF1ZShjLmJlZ2luKCksIGMuZW5kKCkpIC0gYy5iZWdpbigpKTsNCgkNCglpbmZ0ID0gbG93ZXJfYm91bmQoYi5iZWdpbigpLCBiLmVuZCgpLCBpbmZ0KSAtIGIuYmVnaW4oKTsNCgl4ID0gbG93ZXJfYm91bmQoYy5iZWdpbigpLCBjLmVuZCgpLCB4KSAtIGMuYmVnaW4oKTsNCglmb3IgKGludCBpID0gMTsgaSA8PSBuICsgbTsgKytpKSB7DQoJCWFbaV0udCA9IGxvd2VyX2JvdW5kKGIuYmVnaW4oKSwgYi5lbmQoKSwgYVtpXS50KSAtIGIuYmVnaW4oKSArIDE7DQoJCWFbaV0ubCA9IGxvd2VyX2JvdW5kKGMuYmVnaW4oKSwgYy5lbmQoKSwgYVtpXS5sKSAtIGMuYmVnaW4oKSArIDE7DQoJCWFbaV0uciA9IGxvd2VyX2JvdW5kKGMuYmVnaW4oKSwgYy5lbmQoKSwgYVtpXS5yKSAtIGMuYmVnaW4oKSArIDE7DQoJCWFbaV0uZHAgPSBrSW5mOw0KCX0NCglhW24gKyBtICsgMV0udCA9IGluZnQ7DQoJYVtuICsgbSArIDFdLmwgPSB4Ow0KCWFbbiArIG0gKyAxXS5yID0geDsNCglhW24gKyBtICsgMV0ucWlkID0gLTE7DQoJYVtuICsgbSArIDFdLmRwID0gMDsNCgkNCglzb3J0KGEgKyAxLCBhICsgKG4gKyBtICsgMSkgKyAxLCBbJl0oY29uc3QgTm9kZSAmbGhzLCBjb25zdCBOb2RlICZyaHMpIHsNCgkJcmV0dXJuIGxocy5yIDwgcmhzLnI7CQ0KCX0pOw0KCWludCBCID0gKGludCliLnNpemUoKSwgQyA9IChpbnQpYy5zaXplKCk7DQoJY2RxKDEsIG4gKyBtICsgMSk7DQoJDQoJZm9yIChpbnQgaSA9IDE7IGkgPD0gbiArIG0gKyAxOyArK2kpIHsNCgkJaWYgKGFbaV0ucWlkID4gMCkgYW5zW2FbaV0ucWlkXSA9IGFbaV0uZHA7DQoJfQ0KCQ0KCWZvciAoaW50IGkgPSAxOyBpIDw9IG07ICsraSkgew0KCQlpZiAoYW5zW2ldIDwga0luZikgew0KCQkJY291dCA8PCBhbnNbaV0gLSAxIDw8ICJcbiI7DQoJCX0gZWxzZSB7DQoJCQljb3V0IDw8IC0xIDw8ICJcbiI7DQoJCX0NCgl9DQoJDQoJcmV0dXJuIDA7DQp9"}]