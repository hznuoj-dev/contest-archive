[{"id":"3903","submission_id":"3903","filename":"B.cpp","source":"I2RlZmluZSBfR0xJQkNYWF9ERUJVR19BU1NFUlQNCg0KI2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+DQp1c2luZyBuYW1lc3BhY2Ugc3RkOw0KdXNpbmcgbGwgPSBsb25nIGxvbmc7DQoNCnVzaW5nIHBsbCA9IHBhaXI8bGwsIGxsPjsNCg0KI2RlZmluZSB4IGZpcnN0DQojZGVmaW5lIHkgc2Vjb25kDQoNCmlubGluZSBwbGwgb3BlcmF0b3IrKGNvbnN0IHBsbCAmbCwgY29uc3QgcGxsICZyKSB7DQogICAgcmV0dXJuIHtsLnggKyByLngsIGwueSArIHIueX07DQp9DQppbmxpbmUgcGxsIG9wZXJhdG9yLShjb25zdCBwbGwgJmwsIGNvbnN0IHBsbCAmcikgew0KICAgIHJldHVybiB7bC54IC0gci54LCBsLnkgLSByLnl9Ow0KfQ0KaW5saW5lIGxsIGRvdChjb25zdCBwbGwgJmwsIGNvbnN0IHBsbCAmcikgew0KICAgIHJldHVybiBsLnggKiByLnggKyBsLnkgKiByLnk7DQp9DQoNCmxsIGRpczIoY29uc3QgcGxsICZwKSB7DQogICAgcmV0dXJuIHAueCAqIHAueCArIHAueSAqIHAueTsNCn0NCg0KDQp0ZW1wbGF0ZSA8aW50IEIsIGludCBQPg0Kc3RydWN0IEhhIHsNCiAgICBpbnQgbjsNCiAgICBzdGQ6OnZlY3RvcjxpbnQ+IHB3Ow0KICAgIHN0ZDo6dmVjdG9yPGludD4gaDsNCiAgICBIYShjb25zdCB2ZWN0b3I8bGw+ICZ2KSA6IG4odi5zaXplKCkpLCBwdyhuICsgMSksIGgobiArIDEpIHsNCiAgICAgICAgbGwgeCA9IDA7DQogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDw9IG47IGkrKykgew0KICAgICAgICAgICAgcHdbaV0gPSBpID09IDAgPyAxIDogMWxsICogcHdbaSAtIDFdICogQiAlIFA7DQogICAgICAgIH0NCiAgICAgICAgZm9yIChpbnQgaSA9IG4gLSAxOyBpID49IDA7IGktLSkgew0KICAgICAgICAgICAgaFtpXSA9ICgxbGwgKiBoW2kgKyAxXSAqIEIgKyB2W2ldKSAlIFA7DQogICAgICAgIH0NCiAgICB9DQogICAgbGwgY2FsYyhpbnQgbCwgaW50IHIpIGNvbnN0IHsgLy8gW2wsIHIpDQogICAgICAgIHJldHVybiAobGwoUCkgKiBQICsgaFtsXSAtIGhbcl0gKiBsbChwd1tyIC0gbF0pKSAlIFA7DQogICAgfQ0KICAgIGF1dG8gZ2V0KCkgY29uc3Qgew0KICAgICAgICBzdGQ6OnZlY3RvcjxpbnQ+IHYobiAvIDIpOw0KICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IG4gLyAyOyBpKyspIHsNCiAgICAgICAgICAgIHZbaV0gPSBjYWxjKGksIGkgKyBuIC8gMik7DQogICAgICAgICAgICAvLy8vLy8gc3RkOjpjb3V0IDw8IHZbaV0gPDwgIiBcbiJbaSA9PSBuIC8gMiAtIDFdOw0KICAgICAgICB9DQogICAgICAgIHJldHVybiB2Ow0KICAgIH0NCn07DQoNCmNvbnN0ZXhwciBpbnQgUDEgPSA5OTgyNDQzNTM7DQoNCmludCBtYWluICgpew0KICAgIGNpbi50aWUoMCktPnN5bmNfd2l0aF9zdGRpbygxKTsgLy8gMTExMTExDQogICAgaW50IFQ7DQogICAgY2luID4+VDsNCiAgICBzdGQ6Om1hcDxsbCwgbGw+IG1wOw0KICAgIHdoaWxlIChULS0pIHsNCiAgICAgICAgaW50IG47DQogICAgICAgIGNpbiA+PiBuOw0KICAgICAgICBzdGQ6OnZlY3RvcjxwbGw+IEMobik7DQogICAgICAgIGZvciAoYXV0byAmW3gsIHldIDogQykgew0KICAgICAgICAgICAgY2luID4+IHggPj4geTsNCiAgICAgICAgfQ0KICAgICAgICBzdGQ6OnZlY3RvcjxsbD4gbGVuKG4gKiAyKSwgYXJnKG4gKiAyKTsNCiAgICAgICAgbGwgZzEgPSAwLCBnMiA9IDA7DQogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbjsgKytpKSB7DQogICAgICAgICAgICBwbGwgY2kgPSBDW2ldOw0KICAgICAgICAgICAgcGxsIGNpMCA9IGkgPT0gMCA/IEMuYmFjaygpIDogQ1tpIC0gMV07DQogICAgICAgICAgICBwbGwgY2kxID0gaSA9PSBuIC0gMSA/IEMuZnJvbnQoKSA6IENbaSArIDFdOw0KICAgICAgICAgICAgbGVuW2ldID0gZGlzMihjaTEgLSBjaSk7DQogICAgICAgICAgICBhcmdbaV0gPSBkb3QoY2kxIC0gY2ksIGNpMCAtIGNpKTsNCiAgICAgICAgICAgIGxlbltpICsgbl0gPSBsZW5baV07DQogICAgICAgICAgICBhcmdbaSArIG5dID0gYXJnW2ldOw0KICAgICAgICAgICAgZzEgPSBfX2djZChsZW5baV0sIGcxKTsNCiAgICAgICAgICAgIGcyID0gX19nY2QoYXJnW2ldLCBnMik7DQogICAgICAgIH0NCiAgICAgICAgaWYgKGcxICE9IDApIHsNCiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbjsgaSsrKSB7DQogICAgICAgICAgICAgICAgbGVuW2ldID0gbGVuW2kgKyBuXSA9IGxlbltpXSAvIGcxOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIGlmIChnMiAhPSAwKSB7DQogICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IG47IGkrKykgew0KICAgICAgICAgICAgICAgIGFyZ1tpXSA9IGFyZ1tpICsgbl0gPSBhcmdbaV0gLyBnMjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICAvLy8vLy8gZm9yIChpbnQgaSA9IDA7IGkgPCBuOyBpKyspDQogICAgICAgICAvLy8vLy8gICAgIHN0ZDo6Y291dCA8PCBsZW5baV0gPDwgIiBcbiJbaSA9PSBuIC0gMV07DQogICAgICAgICAvLy8vLy8gZm9yIChpbnQgaSA9IDA7IGkgPCBuOyBpKyspDQogICAgICAgICAvLy8vLy8gICAgIHN0ZDo6Y291dCA8PCBhcmdbaV0gPDwgIiBcbiJbaSA9PSBuIC0gMV07DQogICAgICAgIGF1dG8gaCA9IFsmXSgpIHsNCiAgICAgICAgICAgIHN0ZDo6dmVjdG9yPGxsPiBoMShuICogMik7DQogICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IG4gKiAyOyBpKyspIHsNCiAgICAgICAgICAgICAgICBoMVtpXSA9IGxlbltpXSBeIGFyZ1tpXTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGF1dG8gdiA9IEhhPDEzMSwgUDE+KGgxKS5nZXQoKTsNCiAgICAgICAgICAgIGludCB4MSA9ICpzdGQ6Om1pbl9lbGVtZW50KHYuYmVnaW4oKSwgdi5lbmQoKSk7DQogICAgICAgICAgICBzdGQ6OnJldmVyc2UoaDEuYmVnaW4oKSwgaDEuZW5kKCkpOw0KDQogICAgICAgICAgICB2ID0gSGE8MTMxLCBQMT4oaDEpLmdldCgpOw0KICAgICAgICAgICAgaW50IHgyID0gKnN0ZDo6bWluX2VsZW1lbnQodi5iZWdpbigpLCB2LmVuZCgpKTsNCg0KICAgICAgICAgICAgcmV0dXJuIHN0ZDo6bWluKHgxLCB4Mik7DQogICAgICAgIH07DQogICAgICAgIGxsIGNoID0gaCgpOw0KICAgICAgICAvL3N0ZDo6Y291dCA8PCBjaCA8PCAnXG4nOw0KICAgICAgICBzdGQ6OmNvdXQgPDwgbXBbY2hdIDw8ICdcbic7DQogICAgICAgIG1wW2NoXSsrOw0KDQogICAgfQ0KfQ0KDQo="}]