[{"id":"4307","submission_id":"4307","filename":"G.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+DQoNCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQojZGVmaW5lIGxuICdcbicNCg0KY29uc3QgaW50IE49MWU1KzU7DQoNCmludCBmW05dLHNpeltOXSxjb2xbTl0sd1tOXSxpZFtOXTsNCg0KaW50IGZpbmQoaW50IHgpIHsNCglpZihmW3hdID09IHgpIHJldHVybiB4Ow0KCWludCBwYXIgPSBmaW5kKGZbeF0pOw0KCWNvbFt4XSA9IGNvbFtmW3hdXSBeIHdbeF07DQoJcmV0dXJuIHBhcjsNCn0NCg0KYm9vbCBhbnMgPSB0cnVlOw0KDQp2b2lkIG1lcmdlKGludCB4LCBpbnQgeSwgaW50IFcpIHsNCglpbnQgZnggPSBmaW5kKHgpLCBmeSA9IGZpbmQoeSk7DQoJaWYoZnggPT0gZnkpIHsNCgkJaWYoKGNvbFt4XSBeIGNvbFt5XSkgIT0gVykgYW5zID0gZmFsc2U7DQoJCXJldHVybjsNCgl9DQoJaWYoc2l6W2Z4XSA8IHNpeltmeV0pIA0KCQlzd2FwKHgsIHkpLCBzd2FwKGZ4LCBmeSk7DQoJDQoJc2l6W2Z4XSArPSBzaXpbZnldOw0KCWZbZnldID0gZng7DQoJd1tmeV0gPSBjb2xbeF0gXiBjb2xbeV0gXiBXOw0KCQ0KfQ0KDQppbnQgY2hvb3NlW05dOw0KdmVjdG9yPGludD4gYW5zX2dvb2Q7DQp2ZWN0b3I8aW50PiBnb29kW05dLCBiYWRbTl07DQpiaXRzZXQ8MTAwMDA1PiBwW05dOw0KDQppbmxpbmUgdm9pZCBzb2x2ZSgpIHsNCglpbnQgbixxLG07DQoJc2NhbmYoIiVkJWQlZCIsICZuLCAmcSwgJm0pOw0KCWZvcihpbnQgaSA9IDE7IGkgPD0gbjsgaSsrKSANCgkJZltpXSA9IGksIGNvbFtpXSA9IDAsIHNpeltpXSA9IDEsIHdbaV0gPSAwLCBjaG9vc2VbaV0gPSAtMTsNCglmb3IoaW50IGkgPSAxOyBpIDw9IG07IGkrKykgew0KCQlpbnQgeCwgeSwgdzsNCgkJc2NhbmYoIiVkJWQlZCIsICZ3LCAmeCwgJnkpOw0KCQlpZiAoeD09eSl7DQoJCQljb250aW51ZTsNCgkJfQ0KCQltZXJnZSh4LCB5LCB3KTsNCgl9DQoJDQoJaWYgKGFucyA9PSBmYWxzZSl7DQoJCXB1dHMoIk5PIik7DQoJCXJldHVybjsNCgl9DQoNCglpbnQgdG90ID0gMDsNCglmb3IoaW50IGkgPSAxOyBpIDw9IG47IGkrKykgDQoJCWlmKGZpbmQoaSkgPT0gaSkgaWRbaV0gPSArK3RvdDsJDQoJZm9yKGludCBpID0gMTsgaSA8PSBuOyBpKyspIA0KCQlpZFtpXSA9IGlkW2ZpbmQoaSldOw0KCQkNCg0KCWZvcihpbnQgaSA9IDE7IGkgPD0gbjsgaSsrKSB7DQoJCWlmKGNvbFtpXSA9PSAwKQ0KCQkJZ29vZFtpZFtpXV0ucHVzaF9iYWNrKGkpOw0KCQllbHNlDQoJCQliYWRbaWRbaV1dLnB1c2hfYmFjayhpKTsNCgl9DQoJDQoJcFswXVswXSA9IDE7DQoJZm9yKGludCBpID0gMTsgaSA8PSB0b3Q7IGkrKykNCgkJcFtpXSA9ICggKHBbaSAtIDFdIDw8IGdvb2RbaV0uc2l6ZSgpKSB8IChwW2kgLSAxXSA8PCBiYWRbaV0uc2l6ZSgpKSApOw0KDQoJaWYocSA+IDEwMDAwMCB8fCBwW3RvdF1bcV0gPT0gMCl7DQoJCXB1dHMoIk5PIik7DQoJCXJldHVybjsNCgl9DQoJDQoJDQoJZm9yKGludCBpID0gdG90OyBpOyBpLS0pDQoJCWlmKHEgPj0gKGludClnb29kW2ldLnNpemUoKSAmJiBwW2kgLSAxXVtxIC0gZ29vZFtpXS5zaXplKCldKSAgew0KCQkJcSAtPSBnb29kW2ldLnNpemUoKTsgDQoJCQlmb3IoYXV0byB4OiBnb29kW2ldKSBhbnNfZ29vZC5wdXNoX2JhY2soeCk7DQoJCX0gZWxzZSBpZiAocSA+PSAoaW50KWJhZFtpXS5zaXplKCkgJiYgcFtpIC0gMV1bcSAtIGJhZFtpXS5zaXplKCldKXsNCgkJCXEgLT0gYmFkW2ldLnNpemUoKTsNCgkJCWZvcihhdXRvIHg6IGJhZFtpXSkgYW5zX2dvb2QucHVzaF9iYWNrKHgpOw0KCQl9IGVsc2Ugew0KCQkJcHV0cygiTk8iKTsNCgkJCXJldHVybjsNCgkJfQ0KCXB1dHMoIllFUyIpOw0KCXNvcnQoYW5zX2dvb2QuYmVnaW4oKSwgYW5zX2dvb2QuZW5kKCkpOw0KCWZvcihhdXRvIHg6IGFuc19nb29kKSANCgkJcHJpbnRmKCIlZCAiLCB4KTsNCn0NCg0KaW50IG1haW4oKSB7DQoJc29sdmUoKTsNCglyZXR1cm4gMDsNCn0="}]