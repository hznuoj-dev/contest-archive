[{"id":"3213","submission_id":"3213","filename":"G.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+DQoNCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQojZGVmaW5lIGxuICdcbicNCg0KY29uc3QgaW50IE4gPSAyZTUgKyA1Ow0KDQppbnQgZltOXSwgc2l6W05dLCBjb2xbTl0sIHdbTl0sIGlkW05dOw0KDQppbnQgZmluZChpbnQgeCkgew0KCWlmKGZbeF0gPT0geCkgcmV0dXJuIHg7DQoJaW50IHBhciA9IGZpbmQoZlt4XSk7DQoJY29sW3hdID0gY29sW2ZbeF1dIF4gd1t4XTsNCglyZXR1cm4gcGFyOw0KfQ0KDQpib29sIGFucyA9IHRydWU7DQoNCnZvaWQgbWVyZ2UoaW50IHgsIGludCB5LCBpbnQgVykgew0KLy8JY291dCA8PCB4IDw8ICIgIiA8PCB5IDw8IGxuOw0KCWludCBmeCA9IGZpbmQoeCksIGZ5ID0gZmluZCh5KTsNCi8vCWNvdXQgPDwgeCA8PCAiICIgPDwgeSA8PCAiICIgPDwgY29sW3hdIDw8ICIgIiA8PCBjb2xbeV0gPDwgIiAiIDw8IFcgPDwgbG47DQoJaWYoZnggPT0gZnkpIHsNCgkJaWYoY29sW3hdIF4gY29sW3ldICE9IFcpIGFucyA9IGZhbHNlOw0KCQlyZXR1cm47DQoJfQ0KCWlmKHNpeltmeF0gPCBzaXpbZnldKSANCgkJc3dhcCh4LCB5KSwgc3dhcChmeCwgZnkpOw0KCQ0KCXNpeltmeF0gKz0gc2l6W2Z5XTsNCglmW2Z5XSA9IGZ4Ow0KCXdbZnldID0gY29sW3hdIF4gY29sW3ldIF4gVzsNCgkNCn0NCg0KaW5saW5lIHZvaWQgc29sdmUoKSB7DQoJaW50IG4sIHEsIG07DQoJY2luID4+IG4gPj4gcSA+PiBtOw0KCWZvcihpbnQgaSA9IDE7IGkgPD0gbjsgaSsrKSANCgkJZltpXSA9IGksIGNvbFtpXSA9IDAsIHNpeltpXSA9IDEsIHdbaV0gPSAwOw0KCWZvcihpbnQgaSA9IDE7IGkgPD0gbTsgaSsrKSB7DQoJCWludCB4LCB5LCB3Ow0KCQljaW4gPj4gdyA+PiB4ID4+IHk7DQoJCW1lcmdlKHgsIHksIHcpOw0KCX0NCglpZihhbnMgPT0gZmFsc2UpIA0KCQlyZXR1cm4gY291dCA8PCAiTk9cbiIsIHZvaWQoKTsNCi8vCWVsc2UgDQovLwkJY291dCA8PCAiWUVTXG4iOw0KCQ0KCWludCB0b3QgPSAwOw0KCWZvcihpbnQgaSA9IDE7IGkgPD0gbjsgaSsrKSANCgkJaWYoZmluZChpKSA9PSBpKSBpZFtpXSA9ICsrdG90OwkNCglmb3IoaW50IGkgPSAxOyBpIDw9IG47IGkrKykgDQoJCWlkW2ldID0gaWRbZmluZChpKV07DQoJCQ0KCXZlY3Rvcjx2ZWN0b3I8aW50Pj4gZ29vZCh0b3QgKyAxKSwgYmFkKHRvdCArIDEpOw0KCWZvcihpbnQgaSA9IDE7IGkgPD0gbjsgaSsrKSB7DQoJCWlmKGNvbFtpXSA9PSAwKQ0KCQkJZ29vZFtpZFtpXV0ucHVzaF9iYWNrKGkpOw0KCQllbHNlDQoJCQliYWRbaWRbaV1dLnB1c2hfYmFjayhpKTsNCgl9DQoJDQoJaW50IG1uID0gbWluKHEsIG4gLSBxKTsNCgkNCi8vCWNvdXQgPDwgbW4gPDwgbG47DQoJDQoJdmVjdG9yPGJpdHNldDwxMDAwMDU+PiBwKHRvdCArIDEpOw0KCXBbMF1bMF0gPSAxOw0KCWZvcihpbnQgaSA9IDE7IGkgPD0gdG90OyBpKyspIA0KCQlwW2ldID0gKHBbaSAtIDFdIDw8IGdvb2RbaV0uc2l6ZSgpKSB8IChwW2kgLSAxXSA8PCBiYWRbaV0uc2l6ZSgpKTsNCi8vCQljb3V0IDw8IHBbaV0gPDwgbG47DQoNCglpZihwW3RvdF1bcV0gPT0gMCkgcmV0dXJuIGNvdXQgPDwgIk5PXG4iLCB2b2lkKCk7DQoJY291dCA8PCAiWUVTXG4iOw0KDQoJdmVjdG9yPGludD4gYW5zX2dvb2QsIGFuc19iYWQ7DQoJDQoJZm9yKGludCBpID0gdG90OyBpOyBpLS0pDQoJCWlmKHEgPj0gZ29vZFtpXS5zaXplKCkgJiYgcFtpIC0gMV1bcSAtIGdvb2RbaV0uc2l6ZSgpXSkgIHsNCgkJCXEgLT0gZ29vZFtpXS5zaXplKCk7IA0KCQkJZm9yKGF1dG8geDogZ29vZFtpXSkgYW5zX2dvb2QucHVzaF9iYWNrKHgpOw0KLy8JCQlmb3IoYXV0byB4OiBiYWRbaV0pIGFuc19iYWQucHVzaF9iYWNrKHgpOw0KCQl9IGVsc2Ugew0KCQkJcSAtPSBiYWRbaV0uc2l6ZSgpOw0KCQkJZm9yKGF1dG8geDogYmFkW2ldKSBhbnNfZ29vZC5wdXNoX2JhY2soeCk7DQovLwkJCWZvcihhdXRvIHg6IGdvb2RbaV0pIGFuc19iYWQucHVzaF9iYWNrKHgpOwkNCgkJfQ0KCQ0KLy8JZm9yKGludCBpID0gdG90OyBpOyBpLS0pDQovLwkJaWYobW4gPj0gZ29vZFtpXS5zaXplKCkgJiYgcFtpIC0gMV1bbW4gLSBnb29kW2ldLnNpemUoKV0pICB7DQovLwkJCW1uIC09IGdvb2RbaV0uc2l6ZSgpOw0KLy8JCQlmb3IoYXV0byB4OiBnb29kW2ldKSBhbnNfZ29vZC5wdXNoX2JhY2soeCk7DQovLwkJCWZvcihhdXRvIHg6IGJhZFtpXSkgYW5zX2JhZC5wdXNoX2JhY2soeCk7DQovLwkJfSBlbHNlIHsNCi8vCQkJbW4gLT0gYmFkW2ldLnNpemUoKTsNCi8vCQkJZm9yKGF1dG8geDogYmFkW2ldKSBhbnNfZ29vZC5wdXNoX2JhY2soeCk7DQovLwkJCWZvcihhdXRvIHg6IGdvb2RbaV0pIGFuc19iYWQucHVzaF9iYWNrKHgpOwkNCi8vCQl9DQoJDQoJc29ydChhbnNfZ29vZC5iZWdpbigpLCBhbnNfZ29vZC5lbmQoKSk7DQoJc29ydChhbnNfYmFkLmJlZ2luKCksIGFuc19iYWQuZW5kKCkpOw0KLy8JaWYoYW5zX2dvb2Quc2l6ZSgpID09IHEpIHsNCgkJZm9yKGF1dG8geDogYW5zX2dvb2QpIGNvdXQgPDwgeCA8PCAiICI7DQoJCWNvdXQgPDwgbG47DQovLwl9IGVsc2Ugew0KLy8JCWZvcihhdXRvIHg6IGFuc19iYWQpIGNvdXQgPDwgeCA8PCAiICI7DQovLwkJY291dCA8PCBsbjsNCi8vCX0NCn0NCg0KaW50IG1haW4oKSB7DQoJDQovLwlmcmVvcGVuKCIxLnR4dCIsICJyIiwgc3RkaW4pOw0KCQ0KCWlvczo6c3luY193aXRoX3N0ZGlvKGZhbHNlKTsNCgljaW4udGllKG51bGxwdHIpOw0KCQ0KCXNvbHZlKCk7DQp9DQoNCi8qDQoyIDEgMg0KMSAxIDINCjAgMiAxDQoNCjAgMCAxDQoxIDAgMA0KKi8NCg=="}]