[{"id":"3808","submission_id":"3808","filename":"2.cpp","source":"I2luY2x1ZGUgPGlvc3RyZWFtPg0KI2luY2x1ZGUgPHF1ZXVlPg0KI2luY2x1ZGUgPHZlY3Rvcj4NCiNpbmNsdWRlIDxjc3RyaW5nPg0KI2luY2x1ZGUgPHN0YWNrPg0KI2luY2x1ZGUgPGJpdHNldD4NCiNpbmNsdWRlIDxhbGdvcml0aG0+DQojaW5jbHVkZSA8Y21hdGg+DQojZGVmaW5lIG1heG4gMjAwMDEwDQojZGVmaW5lIG1heG0gMjAwMDEwDQojZGVmaW5lIGxsIGxvbmcgbG9uZw0KdXNpbmcgbmFtZXNwYWNlIHN0ZDsNCg0KaW50IG4sIG0sIGs7DQoNCmlubGluZSBpbnQgdHJhbnMoaW50IHgpIHsgcmV0dXJuIHggPiBuID8geCAtIG4gOiB4ICsgbjsgfQ0KDQppbnQgZmFbbWF4bl07DQp2b2lkIGluaXRfZmEoaW50IG4pIHsgZm9yIChpbnQgaSA9IDE7IGkgPD0gbjsgKytpKSBmYVtpXSA9IGk7IH0gDQppbnQgZmluZChpbnQgeCkgeyANCgl2ZWN0b3I8aW50PiB2ZWM7DQoJd2hpbGUgKGZhW3hdICE9IHgpIHsgDQoJCXZlYy5wdXNoX2JhY2soeCk7DQoJCXggPSBmYVt4XTsNCgl9DQoJZm9yIChhdXRvIHUgOiB2ZWMpIGZhW3VdID0geDsNCglyZXR1cm4geDsNCn0NCnZvaWQgbWVyZ2UoaW50IHgsIGludCB5KSB7IA0KCXggPSBmaW5kKHgpLCB5ID0gZmluZCh5KTsNCglpZiAoeCA9PSB5KSByZXR1cm4gOw0KCWZhW3hdID0geTsNCn0NCg0KYm9vbCB2aXNbbWF4bl07DQp2ZWN0b3I8aW50PiBBW21heG5dOyBpbnQgYVttYXhuXSwgYlttYXhuXTsNCg0KY29uc3QgaW50IE4gPSAxMDAwMDEsIHNxdG4gPSA0MDA7DQpiaXRzZXQ8Tj4gZltzcXRuXSwgZ1tzcXRuXSwgaDsNCmludCBsW3NxdG5dLCByW3NxdG5dOw0KDQp2b2lkIHdvcmsoKSB7IA0KCWZvciAoaW50IGkgPSAxOyBpIDw9IDIgKiBuOyArK2kpIA0KCQlBW2ZpbmQoaSldLnB1c2hfYmFjayhpKSwgYVtmaW5kKGkpXSArPSBpIDw9IG47DQoJdmVjdG9yPGludD4gdmVjOyB2ZWMucHVzaF9iYWNrKDApOw0KCWZvciAoaW50IGkgPSAxOyBpIDw9IDIgKiBuOyArK2kpIHsgDQoJCWlmICh2aXNbaV0gfHwgIUFbaV0uc2l6ZSgpKSBjb250aW51ZTsNCgkJdmVjLnB1c2hfYmFjayhpKTsNCgkJdmlzW2ZpbmQodHJhbnMoaSkpXSA9IDE7DQoJfSANCgkNCgkNCglpbnQgdG9wID0gdmVjLnNpemUoKSAtIDEsIEIgPSBzcXJ0KHRvcCksIG51bSA9ICh0b3AgKyBCIC0gMSkgLyBCOw0KCWZvciAoaW50IGkgPSAxOyBpIDw9IG51bTsgKytpKSANCgkJbFtpXSA9IChpIC0gMSkgKiBCICsgMSwgcltpXSA9IGkgKiBCOw0KCQkNCglmWzBdWzBdID0gMTsgcltudW1dID0gdG9wOw0KCWZvciAoaW50IGkgPSAxOyBpIDw9IG51bTsgKytpKSB7IA0KCQlmW2ldID0gZltpIC0gMV07DQoJCWZvciAoaW50IGogPSBsW2ldOyBqIDw9IHJbaV07ICsraikgDQoJCQlmW2ldID0gZltpXSA8PCBhW3ZlY1tqXV0gfCBmW2ldIDw8IEFbdmVjW2pdXS5zaXplKCkgLSBhW3ZlY1tqXV07DQoJfQ0KCQ0KCWlmICghZltudW1dW2tdKSByZXR1cm4gY291dCA8PCAiTk8iIDw8ICJcbiIsIHZvaWQoKTsNCgkNCgl2ZWN0b3I8aW50PiBhbnM7DQoJZm9yIChpbnQgaSA9IG51bTsgaTsgLS1pKSB7IA0KCQlnWzBdID0gZltpIC0gMV07DQoJCWZvciAoaW50IGogPSBsW2ldLCBrID0gMDsgaiA8IHJbaV07ICsraiwgKytrKSANCgkJCWdbayArIDFdID0gZ1trXSA8PCBhW3ZlY1tqXV0gfCBnW2tdIDw8IEFbdmVjW2pdXS5zaXplKCkgLSBhW3ZlY1tqXV07DQoJCWZvciAoaW50IGogPSByW2ldLCB0ID0gcltpXSAtIGxbaV07IGogPj0gbFtpXTsgLS1qLCAtLXQpIHsNCgkJCWludCB2MSA9IGFbdmVjW2pdXSwgdjIgPSBBW3ZlY1tqXV0uc2l6ZSgpIC0gdjE7DQoJCQlpZiAoayA+PSB2MSAmJiBnW3RdW2sgLSB2MV0pIHsNCgkJCQlrIC09IHYxOw0KCQkJCWZvciAoYXV0byB1IDogQVt2ZWNbal1dKQ0KCQkJCQlpZiAodSA8PSBuKSBhbnMucHVzaF9iYWNrKHUpOw0KCQkJfSBlbHNlIGlmIChrID49IHYyICYmIGdbdF1bayAtIHYyXSkgeyANCgkJCQlrIC09IHYyOw0KCQkJCWZvciAoYXV0byB1IDogQVt2ZWNbal1dKQ0KCQkJCQlpZiAodSA+IG4pIGFucy5wdXNoX2JhY2sodSAtIG4pOw0KCQkJfQ0KCQl9DQoJfQ0KCQ0KCWNvdXQgPDwgIllFUyIgPDwgIlxuIjsNCglzb3J0KGFucy5iZWdpbigpLCBhbnMuZW5kKCkpOw0KCWZvciAoYXV0byB1IDogYW5zKSBjb3V0IDw8IHUgPDwgIiAiOyBjb3V0IDw8ICJcbiI7DQp9DQoNCmludCBtYWluKCkgeyANCglpb3M6OnN5bmNfd2l0aF9zdGRpbyhmYWxzZSk7DQoJY2luLnRpZShudWxscHRyKTsgY291dC50aWUobnVsbHB0cik7IA0KCQ0KCS8vZnJlb3BlbigiMS5pbiIsICJyIiwgc3RkaW4pOw0KCS8vZnJlb3BlbigiMS5vdXQiLCAidyIsIHN0ZG91dCk7DQoJDQoJY2luID4+IG4gPj4gayA+PiBtOyBpbml0X2ZhKDIgKiBuKTsNCglmb3IgKGludCBpID0gMTsgaSA8PSBtOyArK2kpIHsgDQoJCWludCBvLCB4LCB5OyBjaW4gPj4gbyA+PiB4ID4+IHk7DQoJCW1lcmdlKHgsIHkgKyBvICogbiksIG1lcmdlKHggKyBuLCB5ICsgKG8gXiAxKSAqIG4pOw0KCX0NCglmb3IgKGludCBpID0gMTsgaSA8PSBuOyArK2kpDQoJCWlmIChmaW5kKGkpID09IGZpbmQoaSArIG4pKSByZXR1cm4gY291dCA8PCAiTk8iIDw8ICJcbiIsIDA7DQoJd29yaygpOw0KCXJldHVybiAwOyANCn0g"}]