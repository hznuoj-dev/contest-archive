[{"id":"4316","submission_id":"4316","filename":"I.cpp","source":"I2luY2x1ZGU8Yml0cy9zdGRjKysuaD4NCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQp1c2luZyBsbCA9IGxvbmcgbG9uZzsNCg0KdXNpbmcgaGFzaHYgPSBwYWlyPGludCxpbnQ+Ow0KDQptdDE5OTM3IG1yYW5kKHJhbmRvbV9kZXZpY2V7fSgpKTsNCg0KaW50IHJuZChpbnQgeCkgew0KCXJldHVybiBtcmFuZCgpICUgeDsNCn0NCmNvbnN0IGxsIG1vZDEgPSAxZTkrNzsNCmNvbnN0IGxsIG1vZDIgPSAxZTkrOTsNCg0KY29uc3QgaW50IG1heG4gPSA1ZTU7DQoNCmhhc2h2IG9wZXJhdG9yKyhoYXNodiBhLGhhc2h2IGIpIHsNCglpbnQgYzEgPSBhLmZpcnN0ICsgYi5maXJzdCxjMiA9IGEuc2Vjb25kICsgYi5zZWNvbmQ7DQoJaWYoYzEgPj0gbW9kMSkNCgkJYzEgLT0gbW9kMTsNCglpZihjMiA+PSBtb2QyKQ0KCQljMiAtPSBtb2QyOw0KCXJldHVybiBtYWtlX3BhaXIoYzEsYzIpOw0KfQ0KDQpoYXNodiBvcGVyYXRvci0oaGFzaHYgYSxoYXNodiBiKSB7DQoJaW50IGMxID0gYS5maXJzdCAtIGIuZmlyc3QsYzIgPSBhLnNlY29uZCAtIGIuc2Vjb25kOw0KCWlmKGMxIDwgMCkNCgkJYzEgKz0gbW9kMTsNCglpZihjMiA8IDApDQoJCWMyICs9IG1vZDI7DQoJcmV0dXJuIG1ha2VfcGFpcihjMSxjMik7DQp9DQoNCmhhc2h2IG9wZXJhdG9yKihoYXNodiBhLGhhc2h2IGIpIHsNCglyZXR1cm4gbWFrZV9wYWlyKDFMTCAqIGEuZmlyc3QgKiBiLmZpcnN0ICUgbW9kMSwxTEwgICogYS5zZWNvbmQgKiBiLnNlY29uZCAlIG1vZDIpOw0KfQ0KaW50IG47DQpzdHJpbmcgczsNCmhhc2h2IHB3W21heG4rMTBdLGJhc2U7DQpoYXNodiBoW21heG4gKyAxMF07DQpoYXNodiBoMlttYXhuKyAxMF07DQoNCmhhc2h2IGdldGgxKGludCBsLGludCByKSB7DQoJcmV0dXJuIGhbcl0gLSBoW2wgLSAxXSAqIHB3W3IgLSBsICsgMV07DQp9DQpoYXNodiBnZXRoMihpbnQgbCxpbnQgcikgew0KCXJldHVybiBoMltsXSAtIGgyW3IgKyAxXSAqIHB3W3IgLSBsICsgMV07DQp9DQoNCnZvaWQgc29sdmUoKSB7DQoJY2luID4+IHM7DQoJbiA9IHMubGVuZ3RoKCk7DQoJcyA9ICIgIiArIHMgKyAiKiI7DQoJaFswXSA9IG1ha2VfcGFpcigwLDApOw0KCWgyW24gKyAxXSA9IG1ha2VfcGFpcigwLDApOw0KCWZvcihpbnQgaSA9IDE7IGk8PW47IGkrKykgew0KCQloW2ldID0gaFtpIC0gMV0gKiBiYXNlICsgaGFzaHYoc1tpXSxzW2ldKTsNCgl9DQoJDQoJZm9yKGludCBpID0gbjsgaT49MTsgaS0tKSB7DQoJCWgyW2ldID0gaDJbaSArIDFdICogYmFzZSArIGhhc2h2KHNbaV0sc1tpXSk7DQoJfQ0KCWludCBhbnMgPSAwOw0KCWZvcihpbnQgaSA9IDE7IGk8PW47IGkrKykgew0KCQkNCgkJaW50IGwgPSAxLHIgPSBtaW4oaSAtIDEsbiAtIGkpOw0KCQlpbnQgcmVzID0gMDsNCgkJd2hpbGUobCA8PSByKSB7DQoJCQlpbnQgbWlkID0gKGwgK3IgKSAvIDI7DQoJCQlpZihnZXRoMShpIC0gbWlkLGkgLSAxKSA9PSBnZXRoMihpICsgMSxpICsgbWlkKSkgew0KCQkJCWwgPSBtaWQgKyAxOw0KCQkJCXJlcyA9IG1pZDsNCgkJCX0gZWxzZQ0KCQkJCXIgPSBtaWQgLSAxOw0KCQl9DQoJCS8vY291dCA8PCAicmVzMSAiIDw8IHJlczw8IlxuIjsNCgkJYW5zID0gbWF4KGFucyxyZXMgKiAyICsgMSk7DQoJCWlmKGkgLSByZXMgLSAxID49IDEgJiYgaSArIHJlcyArIDEgPD0gbil7DQoJCQljaGFyIHggPSBzW2kgLSByZXMgLSAxXTsNCgkJCWNoYXIgeSA9IHNbaSArIHJlcyArIDFdOw0KCQkJbCA9IHJlcyArIDIsciA9IG1pbihpIC0gMSxuIC0gaSk7DQoJCQlpbnQgcmVzMiA9IHIgKyAxOw0KCQkJd2hpbGUobCA8PSByKSB7DQoJCQkJaW50IG1pZCA9IChsICsgcikgLyAyOw0KCQkJCWlmKGdldGgxKGkgLSBtaWQsaSAtIHJlcyAtIDIpICE9IGdldGgyKGkgKyByZXMgKyAyLGkgKyBtaWQpKSB7DQoJCQkJCXIgPSBtaWQgLSAxOw0KCQkJCQlyZXMyID0gbWlkOw0KCQkJCX0gZWxzZQ0KCQkJCQlsID0gbWlkICsgMTsNCgkJCX0NCgkJCWlmKHJlczIgPD0gbWluKGkgLSAxLG4gLSBpKSAmJiBzW2kgLSByZXMyXSA9PSB5ICYmIHNbaSArIHJlczJdID09IHgpDQoJCQkJYW5zID0gbWF4KGFucywocmVzMikgKiAyICsgMSk7DQoJCQlpZigoKHNbaV0gPT0geCkgfHwgKHNbaV0gPT0geSkpKXsNCgkJCQlpZigoaSAtIHJlczIgPT0gMSB8fCBpICsgcmVzMiA9PSBuKSAmJiBzW2kgLSByZXMyXSA9PSBzW2kgKyByZXMyXSkNCgkJCQkJcmVzMisrOw0KCQkJCWFucyA9IG1heChhbnMsKHJlczIgLSAxKSAqIDIgKyAxKTsNCgkJCX0NCgkJfQ0KCQkNCgkJLy8ybmQgcGFydA0KCQlpZihpID4gMSkgew0KCQkJbCA9IDEsciA9IG1pbihpIC0gMSxuIC0gaSArIDEpOw0KCQkJcmVzID0gMDsNCgkJCXdoaWxlKGwgPD0gcikgew0KCQkJCWludCBtaWQgPSAobCArIHIpIC8gMjsNCgkJCQlpZihnZXRoMShpIC0gbWlkLGkgLSAxKSA9PSBnZXRoMihpLGkgKyBtaWQgLSAxKSkgew0KCQkJCQlsID0gbWlkICsgMTsNCgkJCQkJcmVzID0gbWlkOw0KCQkJCX0gZWxzZQ0KCQkJCQlyID0gbWlkIC0gMTsNCgkJCX0NCgkJCS8vY291dCA8PCAicmVzMSAiIDw8IHJlczw8IlxuIjsNCgkJCWFucyA9IG1heChhbnMscmVzICogMik7DQoJCQkNCgkJCWlmKGkgLSByZXMgLSAxID49IDEgJiYgaSArIHJlcyA8PSBuKXsNCgkJCQljaGFyIHggPSBzW2kgLSByZXMgLSAxXTsNCgkJCQljaGFyIHkgPSBzW2kgKyByZXNdOw0KCQkJCWwgPSByZXMgKyAyLHIgPSBtaW4oaSAtIDEsbiAtIGkgKyAxKTsNCgkJCQlpbnQgcmVzMjsNCgkJCQlyZXMyID0gciArIDE7DQoJCQkJd2hpbGUobCA8PSByKSB7DQoJCQkJCWludCBtaWQgPSAobCArIHIpIC8gMjsNCgkJCQkJaWYoZ2V0aDEoaSAtIG1pZCxpIC0gcmVzIC0gMikgIT0gZ2V0aDIoaSArIHJlcyArIDEsaSArIG1pZCAtIDEpKSB7DQoJCQkJCQlyID0gbWlkIC0gMTsNCgkJCQkJCXJlczIgPSBtaWQ7DQoJCQkJCX0gZWxzZQ0KCQkJCQkJbCA9IG1pZCArIDE7DQoJCQkJfQ0KCQkJCWlmKHJlczIgPD0gbWluKGkgLSAxLG4gLSBpICsgMSkgJiYgc1tpIC0gcmVzMl0gPT0geSAmJiB4ID09IHNbaSArIHJlczIgLSAxXSkNCgkJCQkJYW5zID0gbWF4KGFucywocmVzMikgKiAyKTsJDQoJCQl9DQoJCQkNCgkJfQ0KCX0NCglpZihhbnMgPT0gMSkNCgkJYW5zID0gMDsNCgljb3V0IDw8IGFucyA8PCJcbiI7DQp9DQoNCmludCBtYWluKCkgew0KCWlvczo6c3luY193aXRoX3N0ZGlvKGZhbHNlKTsNCglpbnQgdDsNCgliYXNlID0gaGFzaHYocm5kKG1vZDEpLHJuZChtb2QyKSk7DQoJcHdbMF0gPSBtYWtlX3BhaXIoMSwxKTsNCglmb3IoaW50IGkgPSAxOyBpPD1tYXhuOyBpKyspIHsNCgkJcHdbaV0gPSBwd1tpIC0gMV0gKiBiYXNlOw0KCX0NCgljaW4gPj4gdDsNCgl3aGlsZSh0LS0pIHsNCgkJc29sdmUoKTsNCgl9DQoJcmV0dXJuIDA7DQp9DQoNCg0KLyoNCjQNCmFiY2NhYg0KaWhpDQpzdGZnZml1dA0KcGFsaW5kcm9tDQoNCiov"}]