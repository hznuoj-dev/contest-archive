[{"id":"3602","submission_id":"3602","filename":"D.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+DQp1c2luZyBuYW1lc3BhY2Ugc3RkOw0Kc3RydWN0IHBvaW50ew0KCWludCBsLHIsdDsNCglpbnQgc3RlcCxpZDsNCglwb2ludCgpe3N0ZXA9MDt9DQoJcG9pbnQoaW50IF9pZCxpbnQgX3IsaW50IF90KTpsKC0xKSxyKF9yKSx0KF90KSxzdGVwKDApLGlkKF9pZCl7fQ0KfWFbMjAwMDEwXTsNCmludCBuLCBtLHgsYW5zWzIwMDAxMF07DQpib29sIGNtcDEocG9pbnQgeCxwb2ludCB5KXtyZXR1cm4geC5yPHkucjt9DQpib29sIGNtcDIocG9pbnQgeCxwb2ludCB5KXtyZXR1cm4geC5sPHkubDt9DQppbnQgdFsxMDAwMDEwXTsNCnZvaWQgdXBkKGludCBwLGludCBsLGludCByLGludCBycixpbnQgc3VtKXsNCglpZihsPnJyKXJldHVybjsNCglpZihyPD1ycil7DQoJCXRbcF09IXRbcF0/c3VtOm1pbih0W3BdLHN1bSk7DQoJCXJldHVybjsNCgl9DQoJaW50IG1pZD0obCtyKT4+MTsNCgl1cGQocDw8MSxsLG1pZCxycixzdW0pLHVwZChwPDwxfDEsbWlkKzEscixycixzdW0pOw0KfQ0Kdm9pZCBjbHIoaW50IHAsaW50IGwsaW50IHIsaW50IHJyKXsNCglpZihsPnJyKXJldHVybjsNCglpZihyPD1ycil7DQoJCXRbcF09MDsNCgkJcmV0dXJuOw0KCX0NCglpbnQgbWlkPShsK3IpPj4xOw0KCWNscihwPDwxLGwsbWlkLHJyKSxjbHIocDw8MXwxLG1pZCsxLHIscnIpOw0KfQ0KaW50IHF1ZXJ5KGludCBwLGludCBsLGludCByLGludCBrKXsNCglpZihsPT1yKXJldHVybiB0W3BdOw0KCWludCBtaWQ9KGwrcik+PjE7DQoJaW50IHJlcz1rPD1taWQ/cXVlcnkocDw8MSxsLG1pZCxrKTpxdWVyeShwPDwxfDEsbWlkKzEscixrKTsNCglpZih0W3BdKXsNCgkJcmVzPXJlcz9taW4ocmVzLHRbcF0pOnRbcF07DQoJfQ0KCXJldHVybiByZXM7DQp9DQp2b2lkIGNkcShpbnQgbCxpbnQgcil7DQoJaWYobD09cil7DQoJCWlmKGFbbF0uaWQpew0KCQkJYW5zW2FbbF0uaWRdPWFbbF0uc3RlcDsNCgkJfQ0KCQlyZXR1cm47DQoJfQ0KCWludCBtaWQ9KGwrcik+PjE7DQoJY2RxKG1pZCsxLHIpOw0KLy8JcHV0cygiIik7DQovLwlwcmludGYoIiVkICVkOlxuIixsLHIpOw0KCXNvcnQoYSttaWQrMSxhK3IsY21wMik7DQoJaW50IHBvczE9bWlkKzE7DQoJZm9yKGludCBpPWw7aTw9bWlkO2krKyl7DQoJCXdoaWxlKHBvczE8PXImJmFbcG9zMV0ubDw9YVtpXS5yKXsNCgkJCWlmKCFhW3BvczFdLmlkKXVwZCgxLDEsMTAwMDAwLGFbcG9zMV0udCxhW3BvczFdLnN0ZXApOw0KCQkJcG9zMSsrOw0KCQl9DQovLwkJcHJpbnRmKCIlZFxuIixwb3MxKTsNCgkJaW50IHQ9cXVlcnkoMSwxLDEwMDAwMCxhW2ldLnQpOw0KLy8JCXByaW50ZigiJWRcbiIsdCk7DQoJCWlmKCFhW2ldLmlkJiZ0KXQrKzsNCgkJaWYodCl7DQoJCQlhW2ldLnN0ZXA9YVtpXS5zdGVwP21pbihhW2ldLnN0ZXAsdCk6dDsNCgkJfQ0KCX1wb3MxLS07DQoJd2hpbGUocG9zMT5taWQpY2xyKDEsMSwxMDAwMDAsYVtwb3MxXS50KSxwb3MxLS07DQoJY2RxKGwsbWlkKTsNCn0NCmludCBtYWluKCkgew0KCXNjYW5mKCIlZCVkJWQiICwmbiwmbSwmeCk7DQoJZm9yKGludCBpPTE7aTw9bjtpKyspc2NhbmYoIiVkJWQlZCIsJmFbaV0udCwmYVtpXS5sLCZhW2ldLnIpOw0KCWZvcihpbnQgaT0xO2k8PW07aSsrKXsNCgkJaW50IGMscDsNCgkJc2NhbmYoIiVkJWQiLCZjLCZwKTsNCgkJYVsrK25dPXBvaW50KGkscCxjKTsNCgl9DQoJc29ydChhKzEsYSsxK24sY21wMSk7DQoJZm9yKGludCBpPTE7aTw9bjtpKyspaWYoYVtpXS5yPT14KWFbaV0uc3RlcD0xOw0KCWNkcSgxLG4pOw0KCWZvcihpbnQgaT0xO2k8PW07aSsrKXByaW50ZigiJWRcbiIsYW5zW2ldP2Fuc1tpXTotMSk7DQoJcmV0dXJuIDA7DQp9DQovKg0KNiAzIDEwDQoxIDEgMTANCjIgMyA2DQozIDUgOQ0KNCA3IDEwDQo1IDMgOA0KNiA3IDEwDQoxIDENCjIgNA0KNiA1DQoqLw=="}]