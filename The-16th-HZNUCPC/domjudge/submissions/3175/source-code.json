[{"id":"3175","submission_id":"3175","filename":"D2.cpp","source":"I2luY2x1ZGU8Yml0cy9zdGRjKysuaD4NCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQojZGVmaW5lIE0gMzAwMDA1DQppbnQgbixtLGNudCxjbnQyLHgsYW5zW01dLHdoZXJlW01dLHdoZXJlMltNXTsNCnN0cnVjdCBoemx7DQogICAgaW50IHQsbCxyOw0KfUFbMTAwMDA1XSxhc2tbMTAwMDA1XTsNCmJvb2wgY21wKGh6bCBhLGh6bCBiKXsNCiAgICByZXR1cm4gYS50PGIudDsNCn0NCnN0cnVjdCBUcmVlDQp7DQogICAgaW50IG1pbmE7DQogICAgaW50IGxhenk7DQp9U2VnVHJlZVsxMjAwMDA1XTsNCnZvaWQgcHVzaGRvd24oaW50IHJ0KXsNCiAgICBTZWdUcmVlW3J0KjJdLmxhenk9bWluKFNlZ1RyZWVbcnRdLmxhenksU2VnVHJlZVtydCoyXS5sYXp5KTsNCiAgICBTZWdUcmVlW3J0KjJdLm1pbmE9bWluKFNlZ1RyZWVbcnQqMl0ubWluYSxTZWdUcmVlW3J0XS5sYXp5KTsNCiAgICBTZWdUcmVlW3J0KjIrMV0ubGF6eT1taW4oU2VnVHJlZVtydF0ubGF6eSxTZWdUcmVlW3J0KjIrMV0ubGF6eSk7DQogICAgU2VnVHJlZVtydCoyKzFdLm1pbmE9bWluKFNlZ1RyZWVbcnQqMisxXS5taW5hLFNlZ1RyZWVbcnRdLmxhenkpOw0KICAgIFNlZ1RyZWVbcnRdLmxhenk9MWU2Ow0KICAgIHJldHVybiA7DQp9DQp2b2lkIHB1c2h1cChpbnQgcnQpDQp7DQogICAgU2VnVHJlZVtydF0ubWluYT1taW4oU2VnVHJlZVtydCoyXS5taW5hLFNlZ1RyZWVbcnQqMisxXS5taW5hKTsNCiAgICBTZWdUcmVlW3J0XS5taW5hPW1pbihTZWdUcmVlW3J0XS5taW5hLFNlZ1RyZWVbcnRdLmxhenkpOw0KICAgIHJldHVybjsNCn0NCnZvaWQgYnVpbGQoaW50IGwsaW50IHIsaW50IHJ0KQ0Kew0KICAgIFNlZ1RyZWVbcnRdLmxhenk9MWU2Ow0KICAgIGlmKGw9PXIpDQogICAgew0KICAgICAgICBTZWdUcmVlW3J0XS5taW5hPVNlZ1RyZWVbcnRdLmxhenk9MWU2Ow0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIGludCBtaWQ9KGwrcikvMjsNCiAgICBidWlsZChsLG1pZCxydCoyKTsNCiAgICBidWlsZChtaWQrMSxyLHJ0KjIrMSk7DQogICAgcHVzaHVwKHJ0KTsNCn0NCnZvaWQgVXBkYXRlKGludCBsLGludCByLGludCBMLGludCBSLGludCBDLGludCBydCkNCnsNCiAgICBpZihsIT1yKSBwdXNoZG93bihydCk7DQogICAgaWYoTD5yKSByZXR1cm47DQogICAgaWYoUjxsKSByZXR1cm47DQogICAgaWYoTDw9bCYmUj49cikNCiAgICB7DQogICAgICAgIFNlZ1RyZWVbcnRdLmxhenk9bWluKFNlZ1RyZWVbcnRdLmxhenksQyk7DQogICAgICAgIFNlZ1RyZWVbcnRdLm1pbmE9bWluKFNlZ1RyZWVbcnRdLm1pbmEsU2VnVHJlZVtydF0ubGF6eSk7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgaW50IG1pZD0obCtyKS8yOw0KICAgIGlmKEw8PW1pZCkgVXBkYXRlKGwsbWlkLEwsUixDLHJ0KjIpOw0KICAgIGlmKG1pZDxSKSBVcGRhdGUobWlkKzEscixMLFIsQyxydCoyKzEpOw0KICAgIHB1c2h1cChydCk7DQp9DQppbnQgcXVlcnkoaW50IGwsaW50IHIsaW50IEwsaW50IHJ0KQ0Kew0KICAgIGlmKGwhPXIpcHVzaGRvd24ocnQpOw0KICAgIGlmKGw9PXIpDQogICAgew0KICAgICAgICByZXR1cm4gbWluKFNlZ1RyZWVbcnRdLm1pbmEsU2VnVHJlZVtydF0ubGF6eSk7DQogICAgfQ0KICAgIGludCBtaWQ9KGwrcikvMjsNCiAgICBpZihtaWQ+PUwpIHJldHVybiBxdWVyeShsLG1pZCxMLHJ0KjIpOw0KICAgIGVsc2UgcmV0dXJuIHF1ZXJ5KG1pZCsxLHIsTCxydCoyKzEpOw0KfQ0Kdm9pZCBQcmludCgpew0KICAgIGZvcihpbnQgaT0xO2k8PWNudDI7aSsrKXByaW50ZigiJWQgIixxdWVyeSgxLGNudDIsaSwxKSk7DQogICAgcHV0cygiIik7DQp9DQppbnQgbWFpbigpew0KICAgIHNjYW5mKCIlZCVkJWQiLCZuLCZtLCZ4KTsNCiAgICB3aGVyZVsrK2NudF09eDsNCiAgICBmb3IoaW50IGk9MTtpPD1uO2krKyl7DQogICAgICAgIHNjYW5mKCIlZCVkJWQiLCZBW2ldLnQsJkFbaV0ubCwmQVtpXS5yKTsNCiAgICAgICAgd2hlcmVbKytjbnRdPUFbaV0ubDsNCiAgICAgICAgd2hlcmVbKytjbnRdPUFbaV0ucjsNCiAgICB9DQogICAgc29ydChBKzEsQStuKzEsY21wKTsNCiAgICBmb3IoaW50IGk9MTtpPD1tO2krKyl7DQogICAgICAgIHNjYW5mKCIlZCVkIiwmYXNrW2ldLnQsJmFza1tpXS5sKTsNCiAgICAgICAgd2hlcmVbKytjbnRdPWFza1tpXS5sOw0KICAgICAgICBhc2tbaV0ucj1pOw0KICAgIH0NCiAgICBzb3J0KHdoZXJlKzEsd2hlcmUrY250KzEpOw0KICAgIGZvcihpbnQgaT0xO2k8PWNudDtpKyspDQogICAgICAgIGlmKHdoZXJlW2ldIT13aGVyZVtpLTFdKXdoZXJlMlsrK2NudDJdPXdoZXJlW2ldOw0KICAgIHg9bG93ZXJfYm91bmQod2hlcmUyKzEsd2hlcmUyK2NudDIrMSx4KS13aGVyZTI7DQogICAgZm9yKGludCBpPTE7aTw9bTtpKyspYXNrW2ldLmw9bG93ZXJfYm91bmQod2hlcmUyKzEsd2hlcmUyK2NudDIrMSxhc2tbaV0ubCktd2hlcmUyOw0KICAgIGJ1aWxkKDEsY250MiwxKTsNCiAgICBVcGRhdGUoMSxjbnQyLHgseCwwLDEpOw0KICAgIC8vcHV0cygiISEhIik7DQogICAgLy9QcmludCgpOw0KICAgIHNvcnQoYXNrKzEsYXNrK20rMSxjbXApOw0KICAgIGludCBub3c9bjsNCiAgICBmb3IoaW50IGk9bTtpPj0xO2ktLSl7IA0KICAgICAgICB3aGlsZShBW25vd10udD49YXNrW2ldLnQmJm5vdz49MSl7DQogICAgICAgICAgICBpbnQgcz1xdWVyeSgxLGNudDIsQVtub3ddLnIsMSk7DQogICAgICAgICAgICBVcGRhdGUoMSxjbnQyLEFbbm93XS5sLEFbbm93XS5yLHMrMSwxKTsNCiAgICAgICAgICAgIC8vcHJpbnRmKCIlZCAlZCAlZFxuIixBW25vd10ubCxBW25vd10ucixzKTsNCiAgICAgICAgICAgIC8vUHJpbnQoKTsNCiAgICAgICAgICAgIG5vdy0tOw0KICAgICAgICB9DQogICAgICAgIGFuc1thc2tbaV0ucl09cXVlcnkoMSxjbnQyLGFza1tpXS5sLDEpOw0KICAgICAgICBpZihhbnNbYXNrW2ldLnJdPT0xZTYpYW5zW2Fza1tpXS5yXT0tMTsNCiAgICB9DQogICAgZm9yKGludCBpPTE7aTw9bTtpKyspcHJpbnRmKCIlZFxuIixhbnNbaV0pOw0KICAgIHJldHVybiAwOw0KfQ=="}]