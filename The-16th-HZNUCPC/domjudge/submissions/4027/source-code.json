[{"id":"4027","submission_id":"4027","filename":"F.cpp","source":"I2luY2x1ZGU8Yml0cy9zdGRjKysuaD4NCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQpjb25zdCBpbnQgTj0yZTUrMTAwMDsNCi8vY29uc3QgaW50IGluZiA9IDFlNTsNCmludCBuLHEsbTsNCmludCBmYVtOXSxzeltOXTsNCmludCBmaW5kKGludCB4KSB7DQoJcmV0dXJuIGZhW3hdPT14P3g6ZmFbeF09ZmluZChmYVt4XSk7DQp9DQp2b2lkIHVuaShpbnQgeCxpbnQgeSkgew0KCWludCBmeD1maW5kKHgpLGZ5PWZpbmQoeSk7DQoJaWYoZng9PWZ5KXJldHVybjsNCglzeltmeV0rPXN6W2Z4XTsNCglzeltmeF09MDsNCglmYVtmeF09Znk7DQp9DQpib29sIGZsYWc9dHJ1ZTsNCnN0cnVjdCBub2RlIHsNCglpbnQgZmYsdmFsLHZhbG47DQp9Ow0KdmVjdG9yPG5vZGU+bWVzczsNCmJpdHNldDxOPmRwW05dOw0KYm9vbCB2aXNbTl0sZ29vZFtOXTsNCmludCBtYWluKCkgew0KLy8JY291dDw8c2l6ZW9mKGRwKS8xMDI0LzEwMjQvODw8J1xuJzsNCglpb3M6OnN5bmNfd2l0aF9zdGRpbyhmYWxzZSk7DQovLwlzcmFuZCh0aW1lKE5VTEwpKTsNCgljaW4+Pm4+PnE+Pm07DQovLwluID0gMWU1LCBxID0gcmFuZCgpICUgbiArIDEsIG0gPSByYW5kKCkgJSBpbmYgKyAxOw0KLy8JbiA9IDFlNSAsIG0gPSAwLCBxID0gMWU1Ow0KCWZvcihpbnQgaT0xOyBpPD1uKjI7IGkrKykgew0KCQlmYVtpXT1pOw0KCQlpZihpPD1uKXN6W2ldPTE7DQoJCWVsc2Ugc3pbaV09MDsNCgl9DQoJZm9yKGludCBpPTEsayxhLGI7IGk8PW07IGkrKykgew0KCQljaW4+Pms+PmE+PmI7DQoNCi8vCQlrID0gcmFuZCgpICUgMjsNCi8vCQlhID0gcmFuZCgpICUgbiArIDE7DQovLwkJYiA9IHJhbmQoKSAlIG4gKyAxOw0KCQkNCgkJaWYoIWZsYWcpY29udGludWU7DQoJCWlmKGs9PTApIHsNCgkJCS8vYSBiICBhK24gYituDQoJCQlpZihmaW5kKGEpPT1maW5kKGIrbikgfHwgZmluZChiKT09ZmluZChhK24pKSB7DQoJCQkJZmxhZz1mYWxzZTsNCgkJCX0gZWxzZSB7DQoJCQkJdW5pKGEsYik7DQoJCQkJdW5pKGErbixiK24pOw0KCQkJfQ0KCQl9IGVsc2Ugew0KCQkJLy9hIGIrbiAgYiBhK24NCgkJCWlmKGZpbmQoYSk9PWZpbmQoYikgfHwgZmluZChhK24pPT1maW5kKGIrbikpIHsNCgkJCQlmbGFnPWZhbHNlOw0KCQkJfSBlbHNlIHsNCgkJCQl1bmkoYSxiK24pOw0KCQkJCXVuaShiLGErbik7DQoJCQl9DQoJCX0NCgl9DQoJaWYoZmxhZykgew0KCQlmb3IoaW50IGk9MTsgaTw9bjsgaSsrKSB7DQoJCQlpZighdmlzW2ZpbmQoaSldKSB7DQoJCQkvL2NvdXQ8PGk8PCcgJzw8ZmluZChpKTw8JyAnPDxzeltmaW5kKGkpXTw8JyAnPDxzeltmaW5kKGkrbildPDwnXG4nOwkNCgkJCQltZXNzLnB1c2hfYmFjayh7aSxzeltmaW5kKGkpXSxzeltmaW5kKGkrbildfSk7DQoJCQkJdmlzW2ZpbmQoaSldPXZpc1tmaW5kKGkrbildPXRydWU7DQoJCQl9DQoJCX0NCgkJaW50IHRvdD1tZXNzLnNpemUoKTsNCi8vCQlmb3IoaW50IGk9MDtpPHRvdDtpKyspew0KLy8JCQljb3V0PDxtZXNzW2ldLmZmPDwnICc8PHN6W2ZpbmQobWVzc1tpXS5mZildPDwnICc8PHN6W2ZpbmQobWVzc1tpXS5mZituKV08PCdcbic7DQovLwkJfQ0KLy8JCWZvcihpbnQgaT0wO2k8PXRvdDtpKyspew0KLy8JCQlkcFtpXS5yZXNldCgpOw0KLy8JCX0NCgkJZHBbMF1bMF09MTsNCgkJZm9yKGludCBpPTE7aTw9dG90O2krKyl7DQoJCQkvL2ktMQ0KCQkJZHBbaV18PShkcFtpLTFdPDxtZXNzW2ktMV0udmFsKTsNCgkJCWRwW2ldfD0oZHBbaS0xXTw8bWVzc1tpLTFdLnZhbG4pOw0KCQl9DQoJCWlmKGRwW3RvdF1bcV0pew0KCQkJY291dDw8IllFU1xuIjsNCgkJCWludCBtcT1xOw0KCQkJZm9yKGludCBpPXRvdC0xO2k+PTA7aS0tKXsNCgkJCQlpZihtcS1tZXNzW2ldLnZhbD49MCAmJiBkcFtpXVttcS1tZXNzW2ldLnZhbF0pew0KCQkJCQkvL2Fuc1tpXT1maW5kKG1lc3NbaV0uZmYpOw0KCQkJCQlnb29kW2ZpbmQobWVzc1tpXS5mZildPXRydWU7DQoJCQkJCW1xLT1tZXNzW2ldLnZhbDsNCgkJCQl9ZWxzZSBpZihtcS1tZXNzW2ldLnZhbG4+PTAgJiYgZHBbaV1bbXEtbWVzc1tpXS52YWxuXSl7DQoJCQkJCS8vYW5zW2ldPWZpbmQobWVzc1tpXS5mZituKTsNCgkJCQkJZ29vZFtmaW5kKG1lc3NbaV0uZmYrbildPXRydWU7DQoJCQkJCW1xLT1tZXNzW2ldLnZhbG47DQoJCQkJfQ0KCQkJfQ0KCQkJZm9yKGludCBpPTE7aTw9bjtpKyspew0KCQkJCWlmKGdvb2RbZmluZChpKV0pew0KCQkJCQljb3V0PDxpPDwnICc7DQoJCQkJfQ0KCQkJfQ0KCQkJY291dDw8J1xuJzsNCgkJfWVsc2V7DQoJCQljb3V0PDwiTk9cbiI7DQoJCX0NCgl9IGVsc2Ugew0KCQljb3V0PDwiTk9cbiI7DQoJfQ0KCXJldHVybiAwOw0KfQ=="}]