[{"id":"3804","submission_id":"3804","filename":"d.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+DQoNCnVzaW5nIGk2NCA9IGxvbmcgbG9uZzsNCg0KY29uc3QgaW50IGluZiA9IDEwMDAwMDAwMDsNCg0KDQpzdHJ1Y3QgTm9kZXsNCglpbnQgbCxyOw0KCWludCBtaW47DQoJTm9kZShpbnQgeCA9IGluZil7DQoJCW1pbiA9IHg7DQoJfQ0KCWZyaWVuZCBOb2RlIG1lcmdlKGNvbnN0IE5vZGUgJmxoLGNvbnN0IE5vZGUgJnJoKXsNCgkJTm9kZSBhbnM7DQoJCWFucy5sID0gbGgubDsNCgkJYW5zLnIgPSByaC5yOw0KCQlhbnMubWluID0gc3RkOjptaW4obGgubWluLHJoLm1pbik7DQoJCXJldHVybiBhbnM7DQoJfQ0KCXZvaWQgYXBwbHkoaW50IHkpew0KCQlpZiAoeSA9PSBpbmYpIHsNCgkJCXJldHVybjsNCgkJfQ0KCQltaW4gID0geTsNCgl9DQp9Ow0KDQp2b2lkIGFwcGx5KGludCAmeCwgaW50IHkpIHsNCglpZiAoeSA9PSBpbmYpIHsNCgkJcmV0dXJuOw0KCX0NCgl4ID0geTsNCn0NCg0Kc3RydWN0IHNlZyB7DQoJY29uc3QgaW50IG47DQoJc3RkOjp2ZWN0b3I8Tm9kZT4gaW5mbzsNCglzdGQ6OnZlY3RvcjxpbnQ+IHRhZzsNCglzZWcoaW50IG4pOm4obiksaW5mbyhuKjQpLHRhZyg0ICogbixpbmYpe30NCglzZWcoc3RkOjp2ZWN0b3I8aW50PiBhKSA6IHNlZyhpbnQoYS5zaXplKCkpIC0gMSkgew0KCQlhdXRvIGRmcyA9IFsmXShhdXRvIHNlbGYsIGludCBwLCBpbnQgbCwgaW50IHIpIC0+IHZvaWQgew0KCQkJaWYobCA9PSByKXsNCgkJCQlpbmZvW3BdLmwgPSBsOw0KCQkJCWluZm9bcF0uciA9IHI7DQoJCQkJaW5mb1twXS5taW4gPSBhW2xdOw0KLy8JCQkJc3RkOjpjZXJyIDw8IHAgPDwgJyAnIDw8IGwgPDwgJyAnIDw8IHIgPDwgJyAnIDw8IGluZm9bcF0ubWluPDwnXG4nOw0KLy8JCQkJc3RkOjpjZXJyICA8PCBwIDw8ICcgJzw8IGwgPDwnICcgPDwgaW5mb1twXS5taW48PCdcbic7DQoJCQkJcmV0dXJuOw0KCQkJfQ0KCQkJaW50IG0gPSAobCArIHIpID4+IDE7DQoJCQlzZWxmKHNlbGYsIDIqcCxsLG0pOw0KCQkJc2VsZihzZWxmLCAyKnArMSxtKzEscik7DQoJCQkNCgkJCXB1bGwocCk7DQovLwkJCXN0ZDo6Y2VyciA8PCBwICA8PCAnICcgPDwgbCA8PCAnICcgPDwgciA8PCAnICcgPDwgaW5mb1twXS5taW48PCdcbic7DQoJCX07DQoJCWRmcyhkZnMsIDEsIDEsIG4pOw0KCX0NCgl2b2lkIHB1bGwoaW50IHApIHsNCgkJaW5mb1twXSA9IG1lcmdlKGluZm9bMiAqIHBdLCBpbmZvWzIgKiBwICsgMV0pOw0KCX0NCgl2b2lkIHB1c2goaW50IHApIHsNCgkJYXBwbHkoMiAqIHAsIHRhZ1twXSk7DQoJCWFwcGx5KDIgKiBwICsgMSwgdGFnW3BdKTsNCgkJdGFnW3BdID0gaW5mOw0KCX0NCgl2b2lkIGFwcGx5KGludCBwLCBpbnQgdCkgew0KCQlpbmZvW3BdLmFwcGx5KHQpOw0KCQk6OmFwcGx5KHRhZ1twXSwgdCk7DQoJfQ0KCXZvaWQgcmFuZ2VNb2RpZnkoaW50IHAsaW50IGwsaW50IHIsaW50IHgsaW50IHksaW50IHYpew0KCQlpZiggeCA8PSBsICYmIHIgPD0geSl7DQoJCQlhcHBseShwLCB2KTsNCgkJCXJldHVybjsNCgkJfQ0KCQlwdXNoKHApOw0KCQlpbnQgbSA9IChsK3IpPj4xOw0KCQlpZihtID49IHgpcmFuZ2VNb2RpZnkocCoyLGwsbSx4LHksdik7DQoJCWlmKG0gPCB5KXJhbmdlTW9kaWZ5KDIqcCsxLG0rMSxyLHgseSx2KTsNCgkJcHVsbChwKTsNCgl9DQoJTm9kZSByYW5nZVFyeShpbnQgcCxpbnQgbCxpbnQgcixpbnQgeCxpbnQgeSl7DQoJCWlmKHggPiByfHwgeSA8IGwpew0KCQkJcmV0dXJuIE5vZGUoKTsNCgkJfQ0KCQlpZih4IDw9IGwgJiYgciA8PSB5KXsNCgkJCXJldHVybiBpbmZvW3BdOw0KCQl9DQoJCXB1c2gocCk7DQoJCWludCBtID0gKGwgKyByKSA+PiAxOw0KCQlyZXR1cm4gbWVyZ2UocmFuZ2VRcnkoMipwLGwsbSx4LHkpLHJhbmdlUXJ5KDIqcCsxLG0rMSxyLHgseSkpOw0KCX0NCgkNCglpbnQgZmluZChpbnQgcCxpbnQgbCxpbnQgcixpbnQgeCl7DQoJCWlmIChsID09IHIpIHsNCgkJCXJldHVybiBsOw0KCQl9DQoJCWlmIChpbmZvW3BdLm1pbiA+IHgpIHsNCgkJCXJldHVybiByOw0KCQl9DQoJCWludCBtID0gKGwgKyByKSA+PiAxOw0KCQlpZihpbmZvW3AqMl0ubWluIDw9IHgpcmV0dXJuIGZpbmQocCoyLGwsbSx4KTsNCgkJZWxzZSByZXR1cm4gZmluZChwKjIsbSsxLHIseCk7DQoJfQ0KfTsNCg0Kc3RydWN0IGJ1c3sNCglpbnQgdCxsLHI7DQoJYnVzKGludCB0LGludCBsLGludCByKTp0KHQpLGwobCkscihyKXt9DQoJYnVzKCl7CX0NCglib29sIG9wZXJhdG9yIDwgKGNvbnN0IGJ1cyZyaHMpY29uc3R7DQoJCXJldHVybiB0ID09IHJocy50ID8gIHIgPiByaHMuciA6IHQgPiByaHMudDsNCgl9DQp9Ow0Kc3RydWN0IHBlcnNvbnsNCglpbnQgdCxwLGlkOw0KCXBlcnNvbihpbnQgdCxpbnQgcCxpbnQgaWQpOnAocCksdCh0KSxpZChpZCl7fQ0KCXBlcnNvbigpewl9DQoJYm9vbCBvcGVyYXRvciA8IChjb25zdCBwZXJzb24mcmhzKWNvbnN0ew0KCQlyZXR1cm4gdCA+IHJocy50Ow0KCX0NCn07DQoNCnZvaWQgc29sdmUoKSB7DQoJaW50IG4sIG0gLHg7DQoJc3RkOjpjaW4gPj4gbiA+PiBtID4+IHg7DQoJc3RkOjp2ZWN0b3I8YnVzPmJ1c2VzKG4pOw0KCXN0ZDo6dmVjdG9yPHBlcnNvbj5wZXJzb25zKG0pOw0KCXN0ZDo6dmVjdG9yPGludD5jbnQ7DQoJY250LnB1c2hfYmFjayh4KTsNCgljbnQucHVzaF9iYWNrKDApOw0KCWZvcihhdXRvICZbdCxsLHJdOiBidXNlcyl7DQoJCXN0ZDo6Y2luID4+IHQgPj4gbCA+PiByOw0KCQljbnQucHVzaF9iYWNrKGwpOw0KCQljbnQucHVzaF9iYWNrKHIpOw0KCX0NCgkNCgkNCglmb3IoaW50IHRvdCA9IDA7YXV0byAmW3QscCxpZF06cGVyc29ucyl7DQoJCXN0ZDo6Y2luID4+IHQgPj4gcDsNCgkJaWQgPSB0b3QrKzsNCgkJY250LnB1c2hfYmFjayhwKTsNCgl9DQoNCg0KCXN0ZDo6c29ydChjbnQuYmVnaW4oKSxjbnQuZW5kKCkpOw0KCWNudC5lcmFzZShzdGQ6OnVuaXF1ZShjbnQuYmVnaW4oKSxjbnQuZW5kKCkpLGNudC5lbmQoKSk7DQoNCg0KCWZvcihhdXRvICZbdCxsLHJdOmJ1c2VzKXsNCgkJbCA9IHN0ZDo6bG93ZXJfYm91bmQoY250LmJlZ2luKCksY250LmVuZCgpLGwpIC0gY250LmJlZ2luKCk7DQoJCXIgPSBzdGQ6Omxvd2VyX2JvdW5kKGNudC5iZWdpbigpLGNudC5lbmQoKSxyKSAtIGNudC5iZWdpbigpOw0KCX0NCglmb3IoYXV0byAmW3QscCxpZF06cGVyc29ucyl7DQoJCXAgPSBzdGQ6Omxvd2VyX2JvdW5kKGNudC5iZWdpbigpLGNudC5lbmQoKSxwKSAtIGNudC5iZWdpbigpOw0KCX0NCgl4ID0gc3RkOjpsb3dlcl9ib3VuZChjbnQuYmVnaW4oKSxjbnQuZW5kKCkseCkgLSBjbnQuYmVnaW4oKTsNCgkNCglzdGQ6OnNvcnQoYnVzZXMuYmVnaW4oKSxidXNlcy5lbmQoKSk7DQoJc3RkOjpzb3J0KHBlcnNvbnMuYmVnaW4oKSxwZXJzb25zLmVuZCgpKTsNCgkNCglzdGQ6OnZlY3RvcjxpbnQ+YShjbnQuc2l6ZSgpLGluZik7DQoJYVt4XSA9IDA7DQoJaW50IGxlbiA9IGNudC5zaXplKCkgLSAxOw0KLy8Jc3RkOjpjb3V0PDxjbnQuc2l6ZSgpIDw8ICcgJzsNCi8vCXN0ZDo6Y291dCA8PCB4IDw8ICdcbic7DQoJDQoJaW50IHB0ciA9IDA7DQoJc2VnIFRyZWUoYSk7DQovLwlzdGQ6OmNlcnIgPDwgbGVuIDw8ICIhXG4iOw0KLy8JZm9yIChpbnQgaSA9IDE7IGkgPD0gbGVuOyBpKyspIHsNCi8vCQlzdGQ6OmNvdXQgPDwgVHJlZS5yYW5nZVFyeSgxLCAxLCBsZW4sIGksIGkpLm1pbiA8PCAiIFxuIltpID09IGxlbl07DQovLwl9DQovLwlzdGQ6OmNlcnIgPDwgTm9kZSgpLm1pbjw8J1xuJzsNCglhdXRvIGFkZD1bJl0oaW50IHgpew0KCQlhdXRvIFt0LGwscl0gPSBidXNlc1t4XTsNCgkJYXV0byBub3cgPSBUcmVlLnJhbmdlUXJ5KDEsMSxsZW4sbCxyKTsNCiAJCWludCBtaW50ID0gbm93Lm1pbiArIDE7DQoJCWludCBwb3MgPSBUcmVlLmZpbmQoMSwxLGxlbixtaW50KTsNCgkJcG9zIC0tIDsNCgkJaWYocG9zID49IGwpVHJlZS5yYW5nZU1vZGlmeSgxLDEsbGVuLGwscG9zLG1pbnQpOw0KCX07DQoJc3RkOjp2ZWN0b3I8aW50PnJlcyhtKTsNCglmb3IoaW50IGkgPSAwOyBpIDwgbTsgKytpKXsNCgkJYXV0byBbdGltLHBvcyxpZF0gPSBwZXJzb25zW2ldOw0KLy8JCXN0ZDo6Y291dDw8dGltIDw8JyAnIDw8IHBvcyA8PCJSUlJcbiI7DQoJCXdoaWxlKHB0ciA8IG4gJiYgYnVzZXNbcHRyXS50ID49IHRpbSl7DQoJCQlhZGQocHRyKTsNCgkJCXB0cisrOw0KCQl9DQovLwkJc3RkOjpjZXJyIDw8IGxlbiA8PCAiIVxuIjsNCi8vCQlmb3IgKGludCBpID0gMTsgaSA8PSBsZW47IGkrKykgew0KLy8JCQlzdGQ6OmNvdXQgPDwgVHJlZS5yYW5nZVFyeSgxLCAxLCBsZW4sIGksIGkpLm1pbiA8PCAiIFxuIltpID09IGxlbl07DQovLwkJfQ0KLy8JCXN0ZDo6Y291dCA8PCBwb3MgPDwgIkFBQSI7DQoJCWF1dG8gYW5zID0gVHJlZS5yYW5nZVFyeSgxLDEsbGVuLHBvcyxwb3MpOw0KCQlpZihhbnMubWluID09IGluZilyZXNbaWRdPS0xIDsNCgkJZWxzZSByZXNbaWRdPWFucy5taW47DQoJfQ0KCWZvcihhdXRvIHggOnJlcylzdGQ6OmNvdXQ8PHggPDwnXG4nOw0KLy8Jc3RkOjpjb3V0PDxUcmVlLmluZm9bMV0ubWluOw0KLy8Jc3RkOjp2ZWN0b3I8aW50PmEobisxKQ0KfQ0KDQppbnQgbWFpbigpIHsNCglmcmVvcGVuKCJpbi50eHQiLCAiciIsIHN0ZGluKTsNCgkNCglzdGQ6Omlvczo6c3luY193aXRoX3N0ZGlvKGZhbHNlKTsNCglzdGQ6OmNpbi50aWUobnVsbHB0cik7DQoJDQoJaW50IHQ7DQovLwlzdGQ6OmNpbiA+PiB0Ow0KCXQgPSAxOw0KCXdoaWxlICh0LS0pIHsNCgkJc29sdmUoKTsNCgl9DQoNCglyZXR1cm4gMDsNCn0NCg0KLyoNCjYgMyAxMA0KMSAxIDEwDQoyIDMgNg0KMyA1IDkNCjQgNyAxMA0KNSAzIDgNCjYgNyAxMA0KMSAxDQoyIDQNCjYgNQ0KKi8NCg=="}]