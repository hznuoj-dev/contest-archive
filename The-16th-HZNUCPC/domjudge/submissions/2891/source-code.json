[{"id":"2891","submission_id":"2891","filename":"main.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+DQoNCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQp0eXBlZGVmIGxvbmcgbG9uZyBsbDsNCmNvbnN0IGxsIG1vZCA9IDFlOSs3Ow0KY29uc3QgbGwgTiA9IDFlNisxMDsNCg0KYml0c2V0PDEwMDAwMT4gYnMsYWRkLHRtcDsNCmludCBwYVtOXSxzaXpbTl07DQppbnQgZmluZChpbnQgYSl7DQogICAgcmV0dXJuIHBhW2FdPT1hP2E6cGFbYV0gPSBmaW5kKHBhW2FdKTsNCn0NCg0Kdm9pZCBtZXJnZShpbnQgYSxpbnQgYil7DQogICAgYSA9IGZpbmQoYSksYiA9IGZpbmQoYik7DQogICAgaWYoYT09YikgcmV0dXJuOw0KICAgIHNpeltiXSArPSBzaXpbYV07DQogICAgcGFbYV0gPSBiOw0KfQ0KaW50IG9wW05dLHhbTl0seVtOXTsNCnZlY3RvcjxpbnQ+IGdbTl07DQpzdHJ1Y3QgeHVhbnsNCiAgICBpbnQgbnVtOw0KICAgIGludCBiYXRjaDsNCn07DQp2ZWN0b3I8eHVhbj4gdng7DQppbnQgY29sb3JbTl07DQppbnQgYzEsYzI7DQppbnQgb2s7DQp2ZWN0b3I8aW50PiBidWZmZXI7DQppbnQgcnRiYXRjaFtOXTsNCnZvaWQgZGZzKGludCB1LGludCBjb2wsaW50IGJhdGNoKXsNCiAgICBpZihjb2w9PTEpIGMxKz1zaXpbdV07DQogICAgZWxzZSBjMis9c2l6W3VdOw0KICAgIHJ0YmF0Y2hbdV0gPSBiYXRjaDsNCiAgICBidWZmZXIucHVzaF9iYWNrKHUpOw0KICAgIGNvbG9yW3VdID0gY29sOw0KICAgIGZvcihhdXRvIHg6Z1t1XSl7DQogICAgICAgIGlmKCFjb2xvclt4XSl7DQogICAgICAgICAgICBkZnMoeCwzLWNvbCxiYXRjaCk7DQogICAgICAgIH1lbHNlIGlmKGNvbG9yW3hdPT1jb2xvclt1XSl7DQogICAgICAgICAgICBvayA9IDA7DQogICAgICAgIH0NCiAgICB9DQp9DQoNCnZlY3RvcjxpbnQ+IGIxW05dLGIyW05dOw0KaW50IHhsW05dOw0KaW50IGxhc3RbTl07DQoNCnNpZ25lZCBtYWluKCkNCnsNCiAgICBpb3M6OnN5bmNfd2l0aF9zdGRpbygwKTsNCiAgICBjaW4udGllKDApOw0KICAgIGNvdXQudGllKDApOw0KDQogICAgaW50IG4scSxtOw0KICAgIGNpbj4+bj4+cT4+bTsNCiAgICBmb3IoaW50IGk9MTtpPD1uO2krKykgcGFbaV0gPSBpLHNpeltpXSA9IDE7DQogICAgZm9yKGludCBpPTE7aTw9bTtpKyspew0KICAgICAgICBjaW4+Pm9wW2ldPj54W2ldPj55W2ldOw0KICAgIH0NCiAgICBmb3IoaW50IGk9MTtpPD1tO2krKyl7DQogICAgICAgIGlmKG9wW2ldPT0wKSBtZXJnZSh4W2ldLHlbaV0pOw0KICAgIH0NCiAgICBmb3IoaW50IGk9MTtpPD1tO2krKyl7DQogICAgICAgIGlmKG9wW2ldPT0xKSB7DQogICAgICAgICAgICBpbnQgeHggPSBmaW5kKHhbaV0pOw0KICAgICAgICAgICAgaW50IHl5ID0gZmluZCh5W2ldKTsNCiAgICAgICAgICAgIGdbeHhdLnB1c2hfYmFjayh5eSk7DQogICAgICAgICAgICBnW3l5XS5wdXNoX2JhY2soeHgpOw0KICAgICAgICB9DQogICAgfQ0KICAgIGludCBiY250ID0gMDsNCiAgICAvL2NvdXQ8PCJydCAiOw0KICAgIGZvcihpbnQgaT0xO2k8PW47aSsrKXsNCiAgICAgICAgaWYoZmluZChpKSE9aSkgY29udGludWU7DQogICAgICAgIGlmKGNvbG9yW2ldKSBjb250aW51ZTsNCiAgICAgICAgYmNudCsrOw0KICAgICAgICAvL2NvdXQ8PGk8PCcgJzsNCiAgICAgICAgYzEgPSBjMiA9IDA7DQogICAgICAgIGJ1ZmZlci5jbGVhcigpOw0KICAgICAgICBvayA9IDE7DQogICAgICAgIGRmcyhpLDEsYmNudCk7DQogICAgICAgIGlmKCFvayl7DQogICAgICAgICAgICBjb3V0PDwiTk8iPDxlbmRsOw0KICAgICAgICAgICAgcmV0dXJuIDA7DQogICAgICAgIH0NCiAgICAgICAgaWYoYzE+YzIpew0KICAgICAgICAgICAgc3dhcChjMSxjMik7DQogICAgICAgICAgICBmb3IoYXV0byB4OmJ1ZmZlcil7DQogICAgICAgICAgICAgICAgY29sb3JbeF0gPSAzLWNvbG9yW3hdOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIHEgLT0gYzE7DQogICAgICAgIHZ4LnB1c2hfYmFjayh7YzItYzEsYmNudH0pOw0KICAgIH0NCiAgICAvL2NvdXQ8PGVuZGw7DQogICAgZm9yKGludCBpPTE7aTw9bjtpKyspew0KICAgICAgICBpbnQgYnQgPSBydGJhdGNoW2ZpbmQoaSldOw0KICAgICAgICBpZihjb2xvcltmaW5kKGkpXT09MSkgYjFbYnRdLnB1c2hfYmFjayhpKTsNCiAgICAgICAgZWxzZSBiMltidF0ucHVzaF9iYWNrKGkpOw0KICAgIH0NCiAgICBpZihxPDApew0KICAgICAgICBjb3V0PDwiTk8iPDxlbmRsOw0KICAgICAgICByZXR1cm4gMDsNCiAgICB9DQogICAgLy9jb3V0PDwiYWFhYSI8PGVuZGw7DQogICAgYnMuc2V0KDApOw0KICAgIGxhc3RbMF0gPSAtMTsNCiAgICBmb3IoaW50IGk9MDtpPHZ4LnNpemUoKTtpKyspew0KICAgICAgICBpZih2eFtpXS5udW09PTApIGNvbnRpbnVlOw0KICAgICAgICB0bXAgPShic3woYnM8PHZ4W2ldLm51bSkpOw0KICAgICAgICBhZGQgPSAodG1wXmJzKTsNCiAgICAgICAgZm9yKGludCBqID0gYWRkLl9GaW5kX2ZpcnN0KCk7aiE9YWRkLnNpemUoKTtqPWFkZC5fRmluZF9uZXh0KGopKXsNCiAgICAgICAgICAgIGxhc3Rbal0gPSB2eFtpXS5iYXRjaDsNCiAgICAgICAgfQ0KICAgICAgICBicyA9IHRtcDsNCiAgICB9DQogICAgaWYoIWJzW3FdKXsNCiAgICAgICAgY291dDw8Ik5PIjw8ZW5kbDsNCiAgICAgICAgcmV0dXJuIDA7DQogICAgfQ0KICAgIC8vY291dDw8InEgIjw8cTw8ZW5kbDsNCiAgICAvL2NvdXQ8PCJ2eCAiPDxlbmRsOw0KICAgIC8vZm9yKGF1dG8geDp2eCl7DQogICAgLy8gICAgY291dDw8eC5udW08PCcgJzw8eC5iYXRjaDw8ZW5kbDsNCiAgICAvL30NCiAgICAvL2NvdXQ8PCJsYXN0ICI7DQogICAgLy9mb3IoaW50IGk9MDtpPD1xO2krKykgY291dDw8bGFzdFtpXTw8JyAnOw0KICAgLy8gY291dDw8ZW5kbDsNCiAgICB3aGlsZShsYXN0W3FdIT0tMSl7DQogICAgICAgIC8vY291dDw8InEgbGFzdHEgIjw8cTw8JyAnPDxsYXN0W3FdPDxlbmRsOw0KICAgICAgICAvL2NvdXQ8PCJ2eFtsYXN0W3FdXS5udW0gIjw8dnhbbGFzdFtxXV0ubnVtPDxlbmRsOw0KICAgICAgICB4bFtsYXN0W3FdXSA9IDE7DQogICAgICAgIHEgLT0gdnhbbGFzdFtxXS0xXS5udW07DQogICAgfQ0KICAgIC8vY291dDw8ImJiYmIiPDxlbmRsOw0KICAgIHZlY3RvcjxpbnQ+IGFuczsNCiAgICBmb3IoaW50IGk9MTtpPD1iY250O2krKyl7DQogICAgICAgIGlmKHhsW2ldKXsNCiAgICAgICAgICAgIGZvcihhdXRvIHg6YjJbaV0pIGFucy5wdXNoX2JhY2soeCk7DQogICAgICAgIH1lbHNlIHsNCiAgICAgICAgICAgIGZvcihhdXRvIHg6YjFbaV0pIGFucy5wdXNoX2JhY2soeCk7DQogICAgICAgIH0NCiAgICB9DQogICAgc29ydChhbnMuYmVnaW4oKSxhbnMuZW5kKCkpOw0KICAgIGNvdXQ8PCJZRVMiPDxlbmRsOw0KICAgIGZvcihhdXRvIHg6YW5zKXsNCiAgICAgICAgY291dDw8eDw8JyAnOw0KICAgIH0NCg0KfQ0KLyoNCjEzIDcgMTENCjAgMSAyDQowIDEgMw0KMCAxIDQNCjAgMSA1DQoxIDEgNg0KMSAxIDcNCjAgOCA5DQowIDggMTANCjAgOCAxMQ0KMSAxMyAxMg0KMSAxMiAxMw0KKi8NCg=="}]