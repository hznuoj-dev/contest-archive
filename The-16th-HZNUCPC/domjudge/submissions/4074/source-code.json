[{"id":"4074","submission_id":"4074","filename":"G.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+DQoNCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQojZGVmaW5lIGxuICdcbicNCg0KY29uc3QgaW50IE49MWU1KzU7DQoNCmludCBmW05dLHNpeltOXSxjb2xbTl0sd1tOXSxpZFtOXTsNCg0KaW50IGZpbmQoaW50IHgpIHsNCglpZihmW3hdID09IHgpIHJldHVybiB4Ow0KCWludCBwYXIgPSBmaW5kKGZbeF0pOw0KCWNvbFt4XSA9IGNvbFtmW3hdXSBeIHdbeF07DQoJcmV0dXJuIHBhcjsNCn0NCg0KYm9vbCBhbnMgPSB0cnVlOw0KDQp2b2lkIG1lcmdlKGludCB4LCBpbnQgeSwgaW50IFcpIHsNCglpbnQgZnggPSBmaW5kKHgpLCBmeSA9IGZpbmQoeSk7DQoJaWYoZnggPT0gZnkpIHsNCgkJaWYoKGNvbFt4XSBeIGNvbFt5XSkgIT0gVykgYW5zID0gZmFsc2U7DQoJCXJldHVybjsNCgl9DQoJaWYoc2l6W2Z4XSA8IHNpeltmeV0pIA0KCQlzd2FwKHgsIHkpLCBzd2FwKGZ4LCBmeSk7DQoJDQoJc2l6W2Z4XSArPSBzaXpbZnldOw0KCWZbZnldID0gZng7DQoJd1tmeV0gPSBjb2xbeF0gXiBjb2xbeV0gXiBXOw0KCQ0KfQ0KDQp2ZWN0b3I8aW50PiBhbnNfZ29vZDsNCnZlY3RvcjxpbnQ+IGdvb2RbTl0sIGJhZFtOXTsNCmJpdHNldDwxMDAwMDU+IHBbTl07DQoNCmlubGluZSB2b2lkIHNvbHZlKCkgew0KCWludCBuLHEsbTsNCglzY2FuZigiJWQlZCVkIiwgJm4sICZxLCAmbSk7DQoJZm9yKGludCBpID0gMTsgaSA8PSBuOyBpKyspIA0KCQlmW2ldID0gaSwgY29sW2ldID0gMCwgc2l6W2ldID0gMSwgd1tpXSA9IDA7DQoJZm9yKGludCBpID0gMTsgaSA8PSBtOyBpKyspIHsNCgkJaW50IHgsIHksIHc7DQoJCXNjYW5mKCIlZCVkJWQiLCAmdywgJngsICZ5KTsNCgkJaWYgKHg9PXkpew0KCQkJaWYgKHcpew0KCQkJCXB1dHMoIk5PIik7DQoJCQkJcmV0dXJuOw0KCQkJfQ0KCQl9DQoJCW1lcmdlKHgsIHksIHcpOw0KCX0NCgkNCglpZiAoYW5zID09IGZhbHNlKXsNCgkJcHV0cygiTk8iKTsNCgkJcmV0dXJuOw0KCX0NCg0KCWludCB0b3QgPSAwOw0KCWZvcihpbnQgaSA9IDE7IGkgPD0gbjsgaSsrKSANCgkJaWYoZmluZChpKSA9PSBpKSBpZFtpXSA9ICsrdG90OwkNCglmb3IoaW50IGkgPSAxOyBpIDw9IG47IGkrKykgDQoJCWlkW2ldID0gaWRbZmluZChpKV07DQoJCQ0KDQoJZm9yKGludCBpID0gMTsgaSA8PSBuOyBpKyspIHsNCgkJaWYoY29sW2ldID09IDApDQoJCQlnb29kW2lkW2ldXS5wdXNoX2JhY2soaSk7DQoJCWVsc2UNCgkJCWJhZFtpZFtpXV0ucHVzaF9iYWNrKGkpOw0KCX0NCgkNCglwWzBdWzBdID0gMTsNCglmb3IoaW50IGkgPSAxOyBpIDw9IHRvdDsgaSsrKQ0KCQlwW2ldID0gKCAocFtpIC0gMV0gPDwgZ29vZFtpXS5zaXplKCkpIHwgKHBbaSAtIDFdIDw8IGJhZFtpXS5zaXplKCkpICk7DQoNCglpZihxID4gMTAwMDAwIHx8IHBbdG90XVtxXSA9PSAwKXsNCgkJcHV0cygiTk8iKTsNCgkJcmV0dXJuOw0KCX0NCgkNCgkNCglmb3IoaW50IGkgPSB0b3Q7IGk7IGktLSkNCgkJaWYocSA+PSAoaW50KWdvb2RbaV0uc2l6ZSgpICYmIHBbaSAtIDFdW3EgLSBnb29kW2ldLnNpemUoKV0pICB7DQoJCQlxIC09IGdvb2RbaV0uc2l6ZSgpOyANCgkJCWZvcihhdXRvIHg6IGdvb2RbaV0pIGFuc19nb29kLnB1c2hfYmFjayh4KTsNCgkJfSBlbHNlIGlmIChxID49IChpbnQpYmFkW2ldLnNpemUoKSAmJiBwW2kgLSAxXVtxIC0gYmFkW2ldLnNpemUoKV0pew0KCQkJcSAtPSBiYWRbaV0uc2l6ZSgpOw0KCQkJZm9yKGF1dG8geDogYmFkW2ldKSBhbnNfZ29vZC5wdXNoX2JhY2soeCk7DQoJCX0gZWxzZSB7DQoJCQlwdXRzKCJOTyIpOw0KCQkJcmV0dXJuOw0KCQl9DQoJcHV0cygiWUVTIik7DQoJc29ydChhbnNfZ29vZC5iZWdpbigpLCBhbnNfZ29vZC5lbmQoKSk7DQoJZm9yKGF1dG8geDogYW5zX2dvb2QpIA0KCQlwcmludGYoIiVkICIsIHgpOw0KfQ0KDQppbnQgbWFpbigpIHsNCglzb2x2ZSgpOw0KCXJldHVybiAwOw0KfQ=="}]