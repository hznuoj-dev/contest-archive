[{"id":"3025","submission_id":"3025","filename":"D.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+DQojZGVmaW5lIGxsIGludA0KI2RlZmluZSBNYSAxMDAwMDA1DQojZGVmaW5lIG1vZCAxMDAwMDAwMDA3DQojZGVmaW5lIE4gMjYNCiNkZWZpbmUgUExMIHBhaXI8bGwsbGw+DQojZGVmaW5lIGxzIHA8PDENCiNkZWZpbmUgcnMgcDw8MXwxDQojZGVmaW5lIGluZiAxZTkNCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQoNCmxsIG4sbSx4Ow0KbGwgcHBbTWFdOw0KDQoNCnN0cnVjdCBub2Rlew0KCWxsIHRpLGwscixudW07DQoJYm9vbCBvcGVyYXRvciA8KGNvbnN0IG5vZGUgJkEpY29uc3R7DQoJCWlmICh0aT09QS50aSkNCgkJCXJldHVybiBudW08QS5udW07DQoJCXJldHVybiB0aT5BLnRpOw0KCX0NCn1hW01hXTsNCmxsIHRvdD0wLGNudD0wOw0KDQpzdHJ1Y3Qgc2VndHJlZQ0Kew0KCWxsIGwscixtYSxtaSxhZGQ7DQp9dFtNYTw8Ml07DQoNCnZvaWQgYnVpbGQobGwgcCxsbCBsLGxsIHIpDQp7DQoJdFtwXS5sPWwsdFtwXS5yPXIsdFtwXS5tYT10W3BdLm1pPXRbcF0uYWRkPWluZjsNCglpZiAobD09cikNCgkJcmV0dXJuOw0KCWxsIG1pZD0obCtyKT4+MTsNCglidWlsZChscyxsLG1pZCksYnVpbGQocnMsbWlkKzEscik7DQoJcmV0dXJuOw0KfQ0KDQp2b2lkIHVwKGxsIHApDQp7DQoJaWYgKHRbcF0uYWRkPT1pbmYpDQoJCXRbcF0ubWE9bWF4KHRbbHNdLm1hLHRbcnNdLm1hKTsNCgl0W3BdLm1pPW1pbih0W2xzXS5taSx0W3JzXS5taSk7DQoJcmV0dXJuOw0KfQ0KDQp2b2lkIHNwcmVhZChsbCBwKQ0Kew0KCWlmICh0W3BdLmFkZCE9aW5mKQ0KCXsNCgkJdFtsc10ubWE9bWluKHRbbHNdLm1hLHRbcF0uYWRkKTsNCgkJdFtyc10ubWE9bWluKHRbcnNdLm1hLHRbcF0uYWRkKTsNCgkJdFtsc10ubWk9bWluKHRbbHNdLm1pLHRbcF0uYWRkKTsNCgkJdFtyc10ubWk9bWluKHRbcnNdLm1pLHRbcF0uYWRkKTsNCgkJdFtsc10uYWRkPW1pbih0W2xzXS5hZGQsdFtwXS5hZGQpOw0KCQl0W3JzXS5hZGQ9bWluKHRbcnNdLmFkZCx0W3BdLmFkZCk7DQoJCXRbcF0uYWRkPWluZjsNCgl9DQoJcmV0dXJuOw0KfQ0KDQp2b2lkIGNoYW5nZShsbCBwLGxsIGwsbGwgcixsbCBkKQ0Kew0KCWlmIChsPD10W3BdLmwmJnRbcF0ucjw9cikNCgl7DQoJCXRbcF0ubWE9bWluKHRbcF0ubWEsZCk7DQoJCXRbcF0ubWk9bWluKHRbcF0ubWksZCk7DQoJCXRbcF0uYWRkPW1pbih0W3BdLmFkZCxkKTsNCgkJcmV0dXJuOw0KCX0NCglzcHJlYWQocCk7DQoJbGwgbWlkPSh0W3BdLmwrdFtwXS5yKT4+MTsNCglpZiAobDw9bWlkJiZ0W2xzXS5tYT5kKSBjaGFuZ2UobHMsbCxyLGQpOw0KCWlmIChyPm1pZCYmdFtyc10ubWE+ZCkgY2hhbmdlKHJzLGwscixkKTsNCgl1cChwKTsNCglyZXR1cm47DQp9DQoNCmxsIGFzayhsbCBwLGxsIGwsbGwgcikNCnsNCglpZiAobDw9dFtwXS5sJiZ0W3BdLnI8PXIpIHJldHVybiB0W3BdLm1pOw0KCXNwcmVhZChwKTsNCglsbCBtaWQ9KHRbcF0ubCt0W3BdLnIpPj4xOw0KCWxsIHZhbD1pbmY7DQoJaWYgKGw8PW1pZCkgdmFsPW1pbih2YWwsYXNrKGxzLGwscikpOw0KCWlmIChyPm1pZCkgdmFsPW1pbih2YWwsYXNrKHJzLGwscikpOw0KCXJldHVybiB2YWw7DQp9DQoNCmxsIGFuc1tNYV07DQoNCnZvaWQgc29sKCkNCnsNCglzY2FuZigiJWQlZCVkIiwmbiwmbSwmeCk7DQoJZm9yIChsbCBpPTE7aTw9bjtpKyspDQoJCXRvdCsrLHNjYW5mKCIlZCVkJWQiLCZhW3RvdF0udGksJmFbdG90XS5sLCZhW3RvdF0ucikscHBbKytjbnRdPWFbdG90XS5sLHBwWysrY250XT1hW3RvdF0ucjsNCglmb3IgKGxsIGk9MTtpPD1tO2krKykNCgkJdG90Kyssc2NhbmYoIiVkJWQiLCZhW3RvdF0udGksJmFbdG90XS5sKSxwcFsrK2NudF09YVt0b3RdLmwsYVt0b3RdLnI9YVt0b3RdLmwsYVt0b3RdLm51bT1pOw0KCXBwWysrY250XT14Ow0KCQ0KCXNvcnQocHArMSxwcCtjbnQrMSk7DQoJc29ydChhKzEsYSt0b3QrMSk7DQoJY250PXVuaXF1ZShwcCsxLHBwK2NudCsxKS0ocHArMSk7DQoJYnVpbGQoMSwxLGNudCk7DQoJLy9wcmludGYoImNudD0lZCBwbWE9JWRcbiIsY250LHBwW2NudF0pOw0KCWNoYW5nZSgxLGNudCxjbnQsMCk7DQoJLy9wcmludGYoIk9LOiVkXG4iLGFzaygxLGNudCxjbnQpKTsNCglmb3IgKGxsIGk9MTtpPD1jbnQ7aSsrKQ0KCXsNCgkJaWYgKGFbaV0ubnVtKQ0KCQl7DQoJCQlsbCBsPWxvd2VyX2JvdW5kKHBwKzEscHArY250KzEsYVtpXS5sKS1wcCxyPWxvd2VyX2JvdW5kKHBwKzEscHArY250KzEsYVtpXS5yKS1wcDsNCgkJCS8vcHJpbnRmKCJnbyBsPSVkIHI9JWRcbiIscHBbbF0scHBbcl0pOw0KCQkJbGwgdz1hc2soMSxsLHIpOw0KCQkJaWYgKHc9PWluZikNCgkJCQlhbnNbYVtpXS5udW1dPS0xOw0KCQkJZWxzZQ0KCQkJCWFuc1thW2ldLm51bV09dzsNCgkJfQ0KCQllbHNlDQoJCXsNCgkJCWxsIGw9bG93ZXJfYm91bmQocHArMSxwcCtjbnQrMSxhW2ldLmwpLXBwLHI9bG93ZXJfYm91bmQocHArMSxwcCtjbnQrMSxhW2ldLnIpLXBwOw0KCQkJLy9wcmludGYoImNoYW5nZSBsPSVkIHI9JWRcbiIscHBbbF0scHBbcl0pOw0KCQkJbGwgdz1hc2soMSxsLHIpKzE7DQoJCQkvL3ByaW50Zigidz0lZFxuIix3KTsNCgkJCWNoYW5nZSgxLGwscix3KTsNCgkJfQ0KCX0NCglmb3IgKGxsIGk9MTtpPD1tO2krKykNCgkJcHJpbnRmKCIlZFxuIixhbnNbaV0pOw0KCXJldHVybjsNCn0NCg0KaW50IG1haW4gKCkNCnsNCglzb2woKTsNCglyZXR1cm4gMDsNCn0="}]