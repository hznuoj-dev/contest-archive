[{"id":"2854","submission_id":"2854","filename":"E.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+DQp1c2luZyBuYW1lc3BhY2Ugc3RkOw0KaW50IG51bVsxMDBdWzEwMF07DQppbnQgbWFpbigpDQp7DQogICAgbWVtc2V0KG51bSwtMSxzaXplb2YobnVtKSk7DQogICAgaW50IG47DQogICAgY2luID4+IG47DQogICAgaW50IHhbMTEwXSwgeVsxMTBdOw0KICAgIGludCBhbnMgPSAzLCBtYSA9IDA7DQogICAgaW50IGR4LGR5Ow0KICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbjsgaSArKykgY2luID4+IHhbaV0gPj4geVtpXTsNCiAgICBmb3IgKGludCBpID0gMDsgaSA8IG47IGkgKyspDQogICAgew0KICAgICAgICBmb3IgKGludCBqID0gaSArIDE7IGogPCBuOyBqICsrKQ0KICAgICAgICB7DQogICAgICAgICAgICBmb3IgKGludCBrID0gaiArIDE7IGsgPCBuOyBrICsrKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGFucyA9IDM7DQogICAgICAgICAgICAgICAgaW50IHgxID0geFtpXSwgeDI9IHhbal0sIHgzID0geFtrXSwgeTEgPSB5W2ldLCB5MiA9IHlbal0sIHkzID0geVtrXTsNCiAgICAgICAgICAgICAgIC8vIGNvdXQ8PCBpPDwgajw8IGs7DQogICAgICAgICAgICAgICAgaWYoeDEgPT0geDIgfHwgeDIgPT0geDMgfHwgeDEgPT0geDMgKXsNCiAgICAgICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGlmKHkxID09IHkyIHx8IHkyID09IHkzIHx8IHkxID09IHkzKXsNCiAgICAgICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGRvdWJsZSBrMSA9ICh5MSAtIHkyKSAvICh4MSAtIHgyKTsNCiAgICAgICAgICAgICAgICBkb3VibGUgazIgPSh5MyAtIHkyKSAvICh4MyAtIHgyKTsNCiAgICAgICAgICAgICAgICBkb3VibGUgazMgPSAoeTEgLSB5MykgLyAoeDEgLSB4Myk7DQogICAgICAgICAgICAgICAgaWYgKGsxID09IGsyKSBjb250aW51ZTsNCg0KICAgICAgICAgICAgICAgIGlmKG51bVtpXVtqXSA9PSAtMSl7DQogICAgICAgICAgICAgICAgICAgIGR5ID0gYWJzKHkxIC0geTIpLCBkeCA9IGFicyh4MSAtIHgyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vY291dCA8PCB4MSA8PCAnICcgPDwgeTEgPDwgJyAnIDw8IHgyIDw8ICcgJyA8PCB5MiA8PCAnICcgPDx4MyA8PCAnICcgPDwgeTM8PCcgJzsNCiAgICAgICAgICAgICAgICAgICAgbnVtW2ldW2pdID0gMDsNCiAgICAgICAgICAgICAgICAgICAgZm9yIChpbnQgbCA9IDE7IGwgPCBkeDsgbCArKykNCiAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKChkeSAqIGwpICUgZHggPT0gMCl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbnVtW2ldW2pdICs9IChkeCAtIDEpIC8gbDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZihudW1bal1ba10gPT0gLTEpew0KICAgICAgICAgICAgICAgICAgICBkeSA9IGFicyh5MyAtIHkyKSwgZHggPSBhYnMoeDMgLSB4Mik7DQogICAgICAgICAgICAgICAgICAgIG51bVtqXVtrXSA9IDA7DQogICAgICAgICAgICAgICAgICAgIGZvciAoaW50IGwgPSAxOyBsIDwgZHg7IGwgKyspDQogICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoZHkgKiBsKSAlIGR4ID09IDApew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG51bVtqXVtrXSArPSAoZHggLSAxKSAvIGw7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgaWYobnVtW2ldW2tdID09IC0xKXsNCiAgICAgICAgICAgICAgICAgICAgZHkgPSBhYnMoeTEgLSB5MyksIGR4ID0gYWJzKHgxIC0geDMpOw0KICAgICAgICAgICAgICAgICAgICBudW1baV1ba10gPSAwOw0KICAgICAgICAgICAgICAgICAgICBmb3IgKGludCBsID0gMTsgbCA8IGR4OyBsICsrKQ0KICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoKGR5ICogbCkgJSBkeCA9PSAwKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBudW1baV1ba10gKz0gKGR4IC0gMSkgLyBsOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIC8vY291dDw8bnVtW2ldW2pdPDwiICI8PG51bVtqXVtrXTw8IiAiPDxudW1baV1ba108PGVuZGw7DQogICAgICAgICAgICAgICAgYW5zID0gMyArIG51bVtpXVtqXStudW1baV1ba10rbnVtW2pdW2tdOw0KICAgICAgICAgICAgICAgIGlmIChtYSA8IGFucykNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIG1hID0gYW5zOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgfQ0KICAgIGNvdXQgPDwgbWEgPDwgZW5kbDsNCiAgICByZXR1cm4gMDsNCg0KfQ0K"}]