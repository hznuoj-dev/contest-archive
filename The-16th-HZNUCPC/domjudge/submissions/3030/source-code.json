[{"id":"3030","submission_id":"3030","filename":"Gv3.cpp","source":"I2luY2x1ZGU8Yml0cy9zdGRjKysuaD4NCiNkZWZpbmUgTSAxMDAwMDUNCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQp0ZW1wbGF0ZTxjbGFzcyBULGNsYXNzLi4uIEE+IHZvaWQgb2RuKFQmJiB4LCBBJiYuLi4gYSkge2NvdXQ8PHg7IChpbnRbXSl7KGNvdXQ8PCcgJzw8YSwwKS4uLn07IGNvdXQ8PCdcbic7fQ0KaW50IGZsYWcsY250LG4scSxtLGNvbFtNXSxiZWxvbmdbTV07DQpzdHJ1Y3QgaHpsew0KICAgIGludCBhLGI7DQp9Ow0KdmVjdG9yPGh6bD5FW01dOw0Kc3RydWN0IGh6bDJ7DQogICAgdmVjdG9yPGludD5hLGI7DQp9YmxvY2tbTV07DQp2b2lkIGRmcyhpbnQgeCxpbnQgYyl7DQogICAgY29sW3hdPWM7DQogICAgaWYoZmxhZylyZXR1cm4gOw0KICAgIGZvcihpbnQgaT0wO2k8RVt4XS5zaXplKCk7aSsrKXsNCiAgICAgICAgaW50IHY9RVt4XVtpXS5hOw0KICAgICAgICBpZihjb2xbdl09PS0xKWRmcyh2LGNeRVt4XVtpXS5iKTsNCiAgICAgICAgZWxzZSBpZihjb2xbdl0hPWNeRVt4XVtpXS5iKWZsYWc9MTsNCiAgICB9DQogICAgcmV0dXJuIDsNCn0NCnZvaWQgZmluZChpbnQgeCl7DQogICAgaWYoY29sW3hdPT0xKWJsb2NrW2NudF0uYS5wdXNoX2JhY2soeCk7DQogICAgZWxzZSBibG9ja1tjbnRdLmIucHVzaF9iYWNrKHgpOw0KICAgIGNvbFt4XT0zOw0KICAgIGZvcihpbnQgaT0wO2k8RVt4XS5zaXplKCk7aSsrKXsNCiAgICAgICAgaW50IHY9RVt4XVtpXS5hOw0KICAgICAgICBpZihjb2xbdl09PTMpY29udGludWU7DQogICAgICAgIGZpbmQodik7DQogICAgfQ0KICAgIHJldHVybiA7DQp9DQp2ZWN0b3I8aW50PiBnb29kbltNXTsNCmludCB1c2VudW1bTV07DQppbnQgbHN0WzUwMF1bTSoyXTsNCmludCBtYWluKCl7DQogICAgLy8gZnJlb3BlbigiaSIsICJyIiwgc3RkaW4pOw0KICAgIG1lbXNldChjb2wsLTEsc2l6ZW9mKGNvbCkpOw0KICAgIHNjYW5mKCIlZCVkJWQiLCZuLCZxLCZtKTsNCiAgICBmb3IoaW50IGk9MTtpPD1tO2krKyl7DQogICAgICAgIGludCBmLGEsYjsNCiAgICAgICAgc2NhbmYoIiVkJWQlZCIsJmYsJmEsJmIpOw0KICAgICAgICBFW2FdLnB1c2hfYmFjaygoaHpsKXtiLGZ9KTsNCiAgICAgICAgRVtiXS5wdXNoX2JhY2soKGh6bCl7YSxmfSk7DQogICAgfQ0KICAgIGZvcihpbnQgaT0xO2k8PW47aSsrKXsNCiAgICAgICAgaWYoY29sW2ldPT0tMSl7DQogICAgICAgICAgICBkZnMoaSwxKTsNCiAgICAgICAgICAgIGNudCsrOw0KICAgICAgICAgICAgZmluZChpKTsNCiAgICAgICAgfQ0KICAgIH0NCiAgICBpZihmbGFnKXsNCiAgICAgICAgcHV0cygiTk8iKTsNCiAgICAgICAgcmV0dXJuIDA7DQogICAgfQ0KICAgIC8vIG9kbihjbnQpOw0KICAgIGZvciAoaW50IGkgPSAxOyBpIDw9IGNudDsgaSsrKSB7DQogICAgICAgIGlmIChibG9ja1tpXS5hLnNpemUoKSA8IGJsb2NrW2ldLmIuc2l6ZSgpKSBzd2FwKGJsb2NrW2ldLmIsIGJsb2NrW2ldLmEpOw0KICAgICAgICAvLyBvZG4oaSwgYmxvY2tbaV0uYS5zaXplKCksIGJsb2NrW2ldLmIuc2l6ZSgpKTsNCiAgICAgICAgZ29vZG5bYmxvY2tbaV0uYS5zaXplKCkgLSBibG9ja1tpXS5iLnNpemUoKV0ucHVzaF9iYWNrKGkpOw0KICAgIH0NCiAgICBpbnQgbW92ID0gTTsNCiAgICBpbnQgY2NudCA9IDA7IA0KICAgIC8vIGxzdFswXVswK21vdl0gPSAtMTsNCiAgICBsc3RbMF1bbW92XSA9IDE7DQogICAgdmVjdG9yPHBhaXI8aW50LGludD4+IG4wcHt7MCwwfX07IA0KICAgIGZvciAoaW50IGkgPSAwOyBpIDwgTTsgaSsrKSBpZiAoZ29vZG5baV0uc2l6ZSgpKSB7DQogICAgICAgIC8vIG9kbihpLCBnb29kbltpXS5zaXplKCkpOw0KICAgICAgICAvLyBmb3IgKGludCBrID0gMDsgayA8PSAyKk07IGsrKykgbHN0W2NjbnRdW2tdID0gbHN0W2NjbnQtMV1ba107DQogICAgICAgIHZlY3RvcjxpbnQ+IHNwOw0KICAgICAgICBpbnQgcmVtID0gZ29vZG5baV0uc2l6ZSgpOw0KICAgICAgICBmb3IgKGludCBqID0gMTsgaiA8PSByZW07IGogPSBqICogMikgew0KICAgICAgICAgICAgcmVtIC09IGo7DQogICAgICAgICAgICBzcC5wdXNoX2JhY2soaik7DQogICAgICAgIH0NCiAgICAgICAgaWYgKHJlbSkgc3AucHVzaF9iYWNrKHJlbSk7DQogICAgICAgIGZvciAoaW50IGogOiBzcCkgew0KICAgICAgICAgICAgY2NudCsrOw0KICAgICAgICAgICAgYXNzZXJ0KGNjbnQgPCA1MDApOw0KICAgICAgICAgICAgbjBwLnB1c2hfYmFjayh7aSwgan0pOw0KICAgICAgICAgICAgaW50IGEgPSBqICogaTsNCiAgICAgICAgICAgIGZvciAoaW50IGsgPSAwOyBrIDwgMipNOyBrKyspIGlmIChsc3RbY2NudC0xXVtrXSAhPSAwKSB7DQogICAgICAgICAgICAgICAgaWYgKGsrYSA8IDIqTSkgbHN0W2NjbnRdW2srYV0gPSBqOw0KICAgICAgICAgICAgICAgIGlmIChrLWEgPj0gMCkgbHN0W2NjbnRdW2stYV0gPSAtajsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCiAgICBpbnQgbmVlZHEgPSBxIC0gKG4gLSBxKTsNCiAgICBpZiAoIWxzdFtjY250XVtuZWVkcSArIE1dKXsNCiAgICAgICAgcHV0cygiTk8iKTsNCiAgICAgICAgcmV0dXJuIDA7DQogICAgfQ0KICAgIHB1dHMoIllFUyIpOw0KICAgIGludCBwID0gbmVlZHEgKyBNOw0KICAgIC8vIG9kbihwKTsNCiAgICBmb3IgKGludCBpID0gY2NudDsgaSA+PSAxOyBpLS0pIHsNCiAgICAgICAgaW50IGVsZWlkID0gaTsNCiAgICAgICAgdXNlbnVtW24wcFtlbGVpZF0uZmlyc3RdICs9IGxzdFtpXVtwXTsNCiAgICAgICAgcCAtPSBuMHBbZWxlaWRdLmZpcnN0ICogbHN0W2ldW3BdOw0KICAgIH0NCiAgICAvLyBvZG4ocCk7DQogICAgYXNzZXJ0KHAgPT0gTSk7DQoNCiAgICAvLyBmb3IgKGF1dG8gaSA6IGJsb2NrWzFdLmEpIG9kbihpKTsgDQogICAgLy8gZm9yIChhdXRvIGkgOiBibG9ja1sxXS5iKSBvZG4oaSk7IA0KICAgIHZlY3RvcjxpbnQ+IGFuczsNCiAgICBmb3IgKGludCBpID0gMDsgaSA8IE07IGkrKykgew0KICAgICAgICAvLyBpZih1c2VudW1baV0pIG9kbih1c2VudW1baV0pOw0KICAgICAgICAvLyBvZG4odXNlbnVtW2ldKTsNCiAgICAgICAgaW50IHN0ID0gMDsNCiAgICAgICAgZm9yIChpbnQgaiA9IDA7IGogPCB1c2VudW1baV07IGorKykgew0KICAgICAgICAgICAgZm9yIChpbnQgayA6IGJsb2NrW2dvb2RuW2ldW3N0KytdXS5hKQ0KICAgICAgICAgICAgICAgIGFucy5wdXNoX2JhY2soayk7DQogICAgICAgICAgICAgICAgLy8gcHJpbnRmKCIlZCAiLCBrKTsNCiAgICAgICAgfQ0KICAgICAgICBmb3IgKGludCBqID0gMDsgaiA8IC11c2VudW1baV07IGorKykgew0KICAgICAgICAgICAgZm9yIChpbnQgayA6IGJsb2NrW2dvb2RuW2ldW3N0KytdXS5iKQ0KICAgICAgICAgICAgICAgIGFucy5wdXNoX2JhY2soayk7DQogICAgICAgICAgICAgICAgLy8gcHJpbnRmKCIlZCAiLCBrKTsNCiAgICAgICAgfQ0KICAgIH0NCiAgICBhc3NlcnQoYW5zLnNpemUoKSA9PSBxKTsNCiAgICBzb3J0KGJlZ2luKGFucyksIGVuZChhbnMpKTsNCiAgICBmb3IoYXV0byBpOiBhbnMpIHByaW50ZigiJWQgIiwgaSk7DQogICAgcHV0cygiIik7DQogICAgcmV0dXJuIDA7DQp9"}]