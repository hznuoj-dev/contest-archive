[{"id":"3999","submission_id":"3999","filename":"i.cpp","source":"I2luY2x1ZGU8Yml0cy9zdGRjKysuaD4NCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQoNCmNvbnN0IGludCBOID0gNWUzICsgMTA7DQoNCmNoYXIgbWFbTiA8PCAyXTsNCmludCBtcFtOIDw8IDJdOw0KaW50IG47DQoNCmNoYXIgc1tOXTsNCg0Kdm9pZCBtYW5hY2hhcihjaGFyIHNbXSwgaW50IGxlbikgew0KCWludCBsID0gMDsNCgltYVtsKytdID0gJyQnOw0KCW1hW2wrK10gPSAnIyc7DQoJZm9yIChpbnQgaSA9IDA7IGkgPCBsZW47IGkrKykgew0KCQltYVtsKytdID0gc1tpXTsNCgkJbWFbbCsrXSA9ICcjJzsNCgl9DQoJbWFbbF0gPSAwOw0KCWludCBteCA9IDAsIGlkID0gMDsNCglmb3IgKGludCBpID0gMDsgaSA8IGw7IGkrKykgew0KCQltcFtpXSA9IG14ID4gaSA/IG1pbihtcFsyICogaWQgLSBpXSwgbXggLSBpKSA6IDE7DQoJCXdoaWxlKG1hW2kgKyBtcFtpXV0gPT0gbWFbaSAtIG1wW2ldXSkgbXBbaV0rKzsNCgkJaWYgKGkgKyBtcFtpXSA+IG14KSB7DQoJCQlteCA9IGkgKyBtcFtpXTsNCgkJCWlkID0gaTsNCgkJfSANCgl9DQp9DQoNCnZvaWQgaW5pdCgpIHsNCglmb3IgKGludCBpID0gMDsgaSA8PSBOICogMiArIDE7IGkrKykgew0KCQltcFtpXSA9IDA7DQoJfQ0KfQ0Kdm9pZCBzb2x2ZSgpIHsNCglpbml0KCk7DQoJc2NhbmYoIiVzIiwgcyk7DQoJaW50IGxlbiA9IHN0cmxlbihzKTsNCgltYW5hY2hhcihzLCBsZW4pOw0KCXZlY3RvcjxpbnQ+IGxfaWR4LCByX2lkeDsNCglmb3IgKGludCBpID0gMjsgaSA8IDIgKiBsZW4gKyAyOyBpKyspIHsNCgkJaW50IGxlbiA9IG1wW2ldIC0gMSwgbCwgcjsNCi8vCQlpZiAobGVuID09IDApIGNvbnRpbnVlOw0KCQlpZiAoaSAmIDEpIHsNCgkJCXIgPSBpIC8gMiAtIDEgKyBsZW4gLyAyOw0KCQkJbCA9IHIgLSAobGVuIC0gMSk7DQoJCX0gZWxzZSB7DQoJCQlpbnQgbWlkID0gaSAvIDIgLSAxOw0KCQkJciA9IG1pZCArIGxlbiAvIDI7DQoJCQlsID0gciAtIChsZW4gLSAxKTsNCgkJfQ0KCQlsX2lkeC5wdXNoX2JhY2sobCk7DQoJCXJfaWR4LnB1c2hfYmFjayhyKTsNCi8vCQljb3V0IDw8IGwgPDwgIiAiIDw8IHIgPDwgZW5kbDsNCgl9DQovLwlmb3IgKGludCBpID0gMDsgaSA8IGxlbiAtIDE7IGkrKykgew0KLy8JCXJfaWR4LnB1c2hfYmFjayhpKTsNCi8vCQlsX2lkeC5wdXNoX2JhY2soaSArIDEpOw0KLy8JfQ0KCWludCBhbnMgPSAwOw0KCWZvciAoaW50IGkgPSAwOyBpIDwgbF9pZHguc2l6ZSgpOyBpKyspIHsNCgkJaWYgKHJfaWR4W2ldIC0gbF9pZHhbaV0gKyAxID49IDIpIHsNCgkJCWFucyA9IG1heChhbnMsIHJfaWR4W2ldIC0gbF9pZHhbaV0gKyAxKTsNCgkJfQ0KCQlpbnQgbCA9IGxfaWR4W2ldIC0gMSwgciA9IHJfaWR4W2ldICsgMTsJDQoJCWludCByZXMgPSByIC0gbCArIDE7DQoJCWlmIChsIDwgMCB8fCByID49IGxlbikgY29udGludWU7DQoJCWZvciAoaW50IHAgPSAxOyBsIC0gcCA+PSAwICYmIHIgKyBwIDwgbGVuOyBwKyspIHsNCgkJCWlmIChzW2wgLSBwXSA9PSBzW3JdICYmIHNbbF0gPT0gc1tyICsgcF0pIHsNCi8vCQkJCWNvdXQgPDwgcCA8PCBlbmRsOw0KCQkJCXJlcyArPSBwICogMjsNCgkJCQlwKys7DQoJCQkJd2hpbGUgKGwgLSBwID49IDAgJiYgciArIHAgPCBsZW4gJiYgc1tsIC0gcF0gPT0gc1tyICsgcF0pIHsNCgkJCQkJcmVzICs9IDI7DQoJCQkJCXArKzsNCgkJCQl9DQovLwkJCQljb3V0IDw8IHAgPDwgIiAiIDw8IHJlcyA8PCBlbmRsOw0KCQkJCWFucyA9IG1heChhbnMsIHJlcyk7DQoJCQkJYnJlYWs7DQoJCQl9DQoJCQlpZiAoc1tsIC0gcF0gIT0gc1tyICsgcF0pIGJyZWFrOw0KCQl9DQoJfQ0KLy8JZm9yIChpbnQgaSA9IDE7IGkgPCBsZW4gLSAxOyBpKyspIHsNCi8vCQlpbnQgbWlkID0gaTsNCi8vCQlpbnQgbCA9IG1pZCAtIDEsIHIgPSBtaWQgKyAxOw0KLy8JCWludCByZXMgPSAzOw0KLy8JCWlmIChsIDwgMCB8fCByID49IGxlbikgY29udGludWU7DQovLwkJZm9yIChpbnQgcCA9IDA7IGwgLSBwID49IDAgJiYgciArIHAgPCBsZW47IHArKykgew0KLy8JCQlpZiAoc1ttaWRdID09IHNbciArIHBdIHx8IHNbbWlkXSA9PSBzW2wgLSBwXSkgew0KLy8JCQkJaW50IG5vd19yZXMgPSByZXM7DQovLwkJCQlub3dfcmVzICs9IHAgKiAyOw0KLy8JCQkJcCsrOw0KLy8JCQkJd2hpbGUgKGwgLSBwID49IDAgJiYgciArIHAgPCBsZW4gJiYgc1tsIC0gcF0gPT0gc1tyICsgcF0pIHsNCi8vCQkJCQlub3dfcmVzICs9IDI7DQovLwkJCQkJcCsrOw0KLy8JCQkJfQ0KLy8JCQkJYW5zID0gbWF4KGFucywgbm93X3Jlcyk7DQovLwkJCQljb3V0IDw8IG5vd19yZXMgPDwgIiAiIDw8IGwgPDwgIiAiIDw8IHIgPDwgIiAiIDw8IHAgPDwgZW5kbDsNCi8vLy8JCQkJYnJlYWs7DQovLwkJCX0NCi8vCQkJZWxzZSBpZiAoc1tsIC0gcF0gIT0gc1tyICsgcF0gKSAgYnJlYWs7DQovLwkJfQ0KLy8JfQ0KLy8JDQoJDQoJZm9yIChpbnQgaSA9IDE7IGkgPCBsZW4gLSAxOyBpKyspIHsNCgkJaW50IG1pZCA9IGk7DQoJCWludCBsID0gbWlkIC0gMSwgciA9IG1pZCArIDE7DQoJCWludCByZXMgPSAxOw0KCQl3aGlsZShsID49IDAgJiYgciA8IGxlbiAmJiBzW2xdID09IHNbcl0pIHsNCgkJCXJlcyArPSAyOw0KCQkJbC0tOyByKys7DQoJCX0NCgkJaWYgKGwgPCAwIHx8IHIgPj0gbGVuKSB7DQoJCQlpZiAocmVzID4gMSkgDQoJCQlhbnMgPSBtYXgoYW5zLCByZXMpOw0KCQkJY29udGludWU7DQoJCX0NCgkJaWYgKHNbbWlkXSA9PSBzW3JdIHx8IHNbbWlkXSA9PSBzW2xdKSB7DQoJCQlyZXMgKz0gMjsNCgkJCWwtLSwgcisrOw0KCQkJd2hpbGUobCA+PSAwICYmIHIgPCBsZW4gJiYgc1tsXSA9PSBzW3JdKSB7DQoJCQkJcmVzICs9IDI7DQoJCQkJbC0tOyByKys7DQoJCQl9DQoJCQlhbnMgPSBtYXgoYW5zLCByZXMpOw0KCQl9DQoJCQ0KLy8JCQ0KLy8JCWludCByZXMgPSAzOw0KLy8JCWlmIChsIDwgMCB8fCByID49IGxlbikgY29udGludWU7DQovLwkJZm9yIChpbnQgcCA9IDA7IGwgLSBwID49IDAgJiYgciArIHAgPCBsZW47IHArKykgew0KLy8JCQlpZiAoc1ttaWRdID09IHNbciArIHBdIHx8IHNbbWlkXSA9PSBzW2wgLSBwXSkgew0KLy8JCQkJaW50IG5vd19yZXMgPSByZXM7DQovLwkJCQlub3dfcmVzICs9IHAgKiAyOw0KLy8JCQkJcCsrOw0KLy8JCQkJd2hpbGUgKGwgLSBwID49IDAgJiYgciArIHAgPCBsZW4gJiYgc1tsIC0gcF0gPT0gc1tyICsgcF0pIHsNCi8vCQkJCQlub3dfcmVzICs9IDI7DQovLwkJCQkJcCsrOw0KLy8JCQkJfQ0KLy8JCQkJYW5zID0gbWF4KGFucywgbm93X3Jlcyk7DQovLwkJCQljb3V0IDw8IG5vd19yZXMgPDwgIiAiIDw8IGwgPDwgIiAiIDw8IHIgPDwgIiAiIDw8IHAgPDwgZW5kbDsNCi8vLy8JCQkJYnJlYWs7DQovLwkJCX0NCi8vCQkJZWxzZSBpZiAoc1tsIC0gcF0gIT0gc1tyICsgcF0gKSAgYnJlYWs7DQovLwkJfQ0KCX0NCglwcmludGYoIiVkXG4iLCBhbnMpOw0KfQ0KDQppbnQgbWFpbigpIHsNCi8vCWZyZW9wZW4oInN0ZC5pbiIsICJyIiwgc3RkaW4pOw0KLy8JZnJlb3BlbigiaS5vdXQiLCAidyIsIHN0ZG91dCk7DQoJaW50IFQ7IHNjYW5mKCIlZCIsICZUKTsNCgl3aGlsZSAoVC0tKQ0KCXNvbHZlKCk7DQoJcmV0dXJuIDA7DQp9"}]