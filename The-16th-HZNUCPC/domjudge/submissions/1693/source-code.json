[{"id":"1693","submission_id":"1693","filename":"D.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+DQp1c2luZyBuYW1lc3BhY2Ugc3RkOw0KDQpjb25zdCBpbnQgaW5mID0gMHgzZjNmM2YzZjsNCmNvbnN0IGludCBNYXhuID0gMzAwMDAwICsgMTA7DQoNCnN0cnVjdCBzZWdtZW50X3RyZWUgew0KCWludCB0cmVlW01heG4gPDwgMl0sIGxhenlbTWF4biA8PCAyXTsNCgl2b2lkIHB1c2hfdXAoaW50IHApIHsNCgkJdHJlZVtwXSA9IG1pbih0cmVlW3AgPDwgMV0sIHRyZWVbcCA8PCAxIHwgMV0pOw0KCX0NCgl2b2lkIGJ1aWxkKGludCBsLCBpbnQgciwgaW50IHApIHsNCgkJbGF6eVtwXSA9IGluZjsNCgkJaWYgKGwgPT0gcikgew0KCQkJdHJlZVtwXSA9IGluZjsNCgkJCXJldHVybjsNCgkJfQ0KCQlpbnQgbWlkID0gKGwgKyByKSA+PiAxOw0KCQlidWlsZChsLCBtaWQsIHAgPDwgMSk7DQoJCWJ1aWxkKG1pZCArIDEsIHIsIHAgPDwgMSB8IDEpOw0KCQlwdXNoX3VwKHApOw0KCX0NCgl2b2lkIGYoaW50IGwsIGludCByLCBpbnQgcCwgaW50IGspIHsNCgkJdHJlZVtwXSA9IG1pbih0cmVlW3BdLCBrKTsNCgkJbGF6eVtwXSA9IG1pbihsYXp5W3BdLCBrKTsNCgl9DQoJdm9pZCBwdXNoX2Rvd24oaW50IGwsIGludCByLCBpbnQgcCkgew0KCQlpZiAobCA9PSByKSByZXR1cm47DQoJCWludCBtaWQgPSAobCArIHIpID4+IDE7DQoJCWYobCwgbWlkLCBwIDw8IDEsIGxhenlbcF0pOw0KCQlmKG1pZCArIDEsIHIsIHAgPDwgMSB8IDEsIGxhenlbcF0pOw0KCQlsYXp5W3BdID0gaW5mOw0KCX0NCgl2b2lkIG1vZGlmeShpbnQgbmwsIGludCBuciwgaW50IGwsIGludCByLCBpbnQgcCwgaW50IHgpIHsNCgkJaWYgKG5sIDw9IGwgJiYgciA8PSBucikgew0KCQkJZihsLCByLCBwLCB4KTsNCgkJCXJldHVybjsNCgkJfQ0KCQlwdXNoX2Rvd24obCwgciwgcCk7DQoJCWludCBtaWQgPSAobCArIHIpID4+IDE7DQoJCWlmIChubCA8PSBtaWQpIG1vZGlmeShubCwgbnIsIGwsIG1pZCwgcCA8PCAxLCB4KTsNCgkJaWYgKG1pZCA8IG5yKSBtb2RpZnkobmwsIG5yLCBtaWQgKyAxLCByLCBwIDw8IDEgfCAxLCB4KTsNCgkJcHVzaF91cChwKTsNCi8vCQljb3V0IDw8IHAgPDwgIiAiIDw8IGxhenlbcF0gPDwgIiAiIDw8IHRyZWVbcF0gPDwgIm5ubiIgPDwgZW5kbDsNCgl9DQoJaW50IHF1ZXJ5KGludCB4LCBpbnQgbCwgaW50IHIsIGludCBwKSB7DQovLwkJY291dCA8PCBsIDw8ICIgIiA8PCByIDw8ICIgIiA8PCBwIDw8ICIgIiA8PCB0cmVlW3BdIDw8IGVuZGw7DQoJCWlmIChsID09IHIpIHJldHVybiB0cmVlW3BdOw0KCQlwdXNoX2Rvd24obCwgciwgcCk7DQoJCWludCBtaWQgPSAobCArIHIpID4+IDEsIGFucyA9IGluZjsNCgkJaWYgKHggPD0gbWlkKSBhbnMgPSBxdWVyeSh4LCBsLCBtaWQsIHAgPDwgMSk7DQoJCWVsc2UgYW5zID0gcXVlcnkoeCwgbWlkICsgMSwgciwgcCA8PCAxIHwgMSk7DQovLwkJY291dCA8PCBsIDw8ICIgIiA8PCByIDw8ICIgIiA8PCBwIDw8ICIgIiA8PCBhbnMgPDwgZW5kbDsNCgkJcmV0dXJuIGFuczsNCgl9DQoJaW50IHF1ZXJ5KGludCBubCwgaW50IG5yLCBpbnQgbCwgaW50IHIsIGludCBwKSB7DQoJCWlmIChubCA8PSBsICYmIHIgPD0gbnIpIHJldHVybiB0cmVlW3BdOw0KCQlwdXNoX2Rvd24obCwgciwgcCk7DQoJCWludCBtaWQgPSAobCArIHIpID4+IDEsIGFucyA9IGluZjsNCgkJaWYgKG5sIDw9IG1pZCkgYW5zID0gbWluKGFucywgcXVlcnkobmwsIG5yLCBsLCBtaWQsIHAgPDwgMSkpOw0KCQlpZiAobWlkIDwgbnIpIGFucyA9IG1pbihhbnMsIHF1ZXJ5KG5sLCBuciwgbWlkICsgMSwgciwgcCA8PCAxIHwgMSkpOw0KCQlyZXR1cm4gYW5zOw0KCX0NCn10Ow0KDQpzdHJ1Y3QgYnVzIHsNCglpbnQgdCwgbCwgcjsNCglib29sIG9wZXJhdG9yIDwgKGNvbnN0IGJ1cyYgcmhzKSBjb25zdCB7DQoJCWlmICh0ICE9IHJocy50KSByZXR1cm4gdCA8IHJocy50Ow0KCQlpZiAociAhPSByaHMucikgcmV0dXJuIHIgPCByaHMucjsNCgkJcmV0dXJuIGwgPCByaHMubDsNCgl9DQp9IGJbTWF4bl07DQoNCnN0cnVjdCBodW1hbiB7DQoJaW50IHQsIHBvcywgYW5zLCBsb2M7DQp9IGhbTWF4bl07DQoNCmludCBjbXBfdChodW1hbiBhLCBodW1hbiBiKSB7DQoJcmV0dXJuIGEudCA8IGIudDsNCn0NCg0KaW50IGNtcF9sb2MoaHVtYW4gYSwgaHVtYW4gYikgew0KCXJldHVybiBhLmxvYyA8IGIubG9jOw0KfQ0KDQppbnQgY250ID0gMDsNCmludCBjW01heG5dOw0KDQpzaWduZWQgbWFpbigpIHsNCglpb3M6OnN5bmNfd2l0aF9zdGRpbyhmYWxzZSk7DQoJDQoJaW50IG4sIG0sIHg7IGNpbiA+PiBuID4+IG0gPj4geDsNCgljWysrY250XSA9IHg7DQoJZm9yKGludCBpID0gMTsgaSA8PSBuOyArK2kpIHsNCgkJY2luID4+IGJbaV0udCA+PiBiW2ldLmwgPj4gYltpXS5yOw0KCQljWysrY250XSA9IGJbaV0ubDsNCgkJY1srK2NudF0gPSBiW2ldLnI7DQoJfQ0KCWZvcihpbnQgaSA9IDE7IGkgPD0gbTsgKytpKSB7DQoJCWNpbiA+PiBoW2ldLnQgPj4gaFtpXS5wb3M7DQoJCWhbaV0uYW5zID0gLTE7DQoJCWhbaV0ubG9jID0gaTsNCgkJY1srK2NudF0gPSBoW2ldLnBvczsNCgl9DQoJc29ydChiICsgMSwgYiArIG4gKyAxKTsNCglzb3J0KGggKyAxLCBoICsgbSArIDEsIGNtcF90KTsNCgkNCglzb3J0KGMgKyAxLCBjICsgY250ICsgMSk7DQoJY250ID0gdW5pcXVlKGMgKyAxLCBjICsgY250ICsgMSkgLSBjIC0gMTsNCglmb3IoaW50IGkgPSAxOyBpIDw9IG47ICsraSkgew0KCQliW2ldLmwgPSBsb3dlcl9ib3VuZChjICsgMSwgYyArIGNudCArIDEsIGJbaV0ubCkgLSBjOw0KCQliW2ldLnIgPSBsb3dlcl9ib3VuZChjICsgMSwgYyArIGNudCArIDEsIGJbaV0ucikgLSBjOw0KCX0NCglmb3IoaW50IGkgPSAxOyBpIDw9IG07ICsraSkgew0KCQloW2ldLnBvcyA9IGxvd2VyX2JvdW5kKGMgKyAxLCBjICsgY250ICsgMSwgaFtpXS5wb3MpIC0gYzsNCgl9DQoJeCA9IGxvd2VyX2JvdW5kKGMgKyAxLCBjICsgY250ICsgMSwgeCkgLSBjOw0KCQ0KCWludCBodW1hbl9wb2ludCA9IG07DQoNCi8vCWZvcihpbnQgaSA9IDE7IGkgPD0gbjsgKytpKSBjb3V0IDw8IGJbaV0ubCA8PCAiICIgPDwgYltpXS5yIDw8IGVuZGw7DQovLwlmb3IoaW50IGkgPSAxOyBpIDw9IG07ICsraSkgY291dCA8PCBoW2ldLnBvcyA8PCBlbmRsOw0KCQ0KCXQuYnVpbGQoMSwgY250LCAxKTsNCgl0Lm1vZGlmeSh4LCB4LCAxLCBjbnQsIDEsIDApOw0KCQ0KLy8JZm9yIChpbnQgaSA9IDE7IGkgPD0geCAqIDQ7ICsraSkgew0KLy8JCWNvdXQgPDwgdC50cmVlW2ldIDw8ICIgIjsNCi8vCX1jb3V0IDw8IGVuZGw7DQoJDQovLwljb3V0IDw8IGhbbV0ucG9zIDw8ICIgIiA8PCB0LnF1ZXJ5KGhbbV0ucG9zLCAxLCBjbnQsIDEpOw0KCWZvciAoaW50IGkgPSBuOyBpID49IDE7IC0taSkgew0KCQl3aGlsZShodW1hbl9wb2ludCA+PSAxICYmIGhbaHVtYW5fcG9pbnRdLnQgPiBiW2ldLnQpIHsNCgkJCWludCBhbnMgPSB0LnF1ZXJ5KGhbaHVtYW5fcG9pbnRdLnBvcywgMSwgY250LCAxKTsNCgkJCWlmIChhbnMgPT0gaW5mKSBhbnMgPSAtMTsNCgkJCWhbaHVtYW5fcG9pbnRdLmFucyA9IGFuczsNCgkJCWh1bWFuX3BvaW50IC0tOw0KCQl9DQoJCWludCBtaW5uID0gdC5xdWVyeShiW2ldLmwsIGJbaV0uciwgMSwgY250LCAxKTsNCgkJdC5tb2RpZnkoYltpXS5sLCBiW2ldLnIsIDEsIGNudCwgMSwgbWlubiArIDEpOw0KCX0NCgkNCgl3aGlsZShodW1hbl9wb2ludCA+PSAxKSB7DQoJCWludCBhbnMgPSB0LnF1ZXJ5KGhbaHVtYW5fcG9pbnRdLnBvcywgMSwgY250LCAxKTsNCgkJaWYgKGFucyA9PSBpbmYpIGFucyA9IC0xOw0KCQloW2h1bWFuX3BvaW50XS5hbnMgPSBhbnM7DQoJCWh1bWFuX3BvaW50IC0tOw0KCX0NCgkNCglzb3J0KGggKyAxLCBoICsgbSArIDEsIGNtcF9sb2MpOw0KCWZvcihpbnQgaSA9IDE7IGkgPD0gbTsgKytpKSB7DQoJCWNvdXQgPDwgaFtpXS5hbnMgPDwgIlxuIjsNCgl9DQoJcmV0dXJuIDA7DQp9"}]