[{"id":"3330","submission_id":"3330","filename":"A.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+DQp1c2luZyBuYW1lc3BhY2Ugc3RkOw0KI2RlZmluZSBlbmRsICdcbicNCiNkZWZpbmUgSU8gaW9zOjpzeW5jX3dpdGhfc3RkaW8oMCk7Y2luLnRpZSgwKTtjb3V0LnRpZSgwKTsNCiNkZWZpbmUgbGwgbG9uZyBsb25nDQpjb25zdCBsbCBtb2RlPTFlOSs3Ow0KY29uc3QgaW50IG1heG49NyoxZTM7DQovLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KDQpjaGFyIGFbbWF4bl07DQpjaGFyIHNbbWF4bl07DQppbnQgaHdbbWF4bl07DQppbnQgamh3W21heG5dOw0Kdm9pZCBzb2x2ZSgpDQp7DQogICAgY2luPj5hOw0KICAgIGludCBuID0gc3RybGVuKGEpOw0KICAgIHNbMF0gPSAnPic7DQogICAgc1sxXSA9ICcjJzsNCiAgICBmb3IgKGludCBpID0wO2k8bjtpKyspDQogICAgew0KICAgICAgICBzW2kqMisyXSA9IGFbaV07DQogICAgICAgIHNbaSoyKzNdID0gJyMnOw0KICAgIH0NCiAgICBzW24qMisyXSA9ICc8JzsNCiAgICBzW24qMiszXSA9ICdcMCc7DQoNCg0KDQogICAgaW50IGxlID0gc3RybGVuKHMpOw0KDQogICAgZm9yIChpbnQgaSA9MDtpPD1sZTtpKyspDQogICAgICAgIGh3W2ldPWpod1tpXSA9IDA7DQoNCg0KICAgIGludCBtICA9IC0xLCByID0gLTE7DQogICAgZm9yIChpbnQgaSA9IDA7aTw9bGU7aSsrKQ0KICAgIHsNCiAgICAgICAgYm9vbCBmbGFnID0gdHJ1ZTsNCiAgICAgICAgYm9vbCBlcmNpID0gdHJ1ZTsNCiAgICAgICAgLy8gamllDQogICAgICAgIGNoYXIgc3QxID0gJy4nOw0KICAgICAgICAvLyBodWFuDQogICAgICAgIGNoYXIgc3QyID0gICcuJzsNCg0KDQogICAgICAgIGludCBwID0gMDsNCiAgICAgICAgaWYgKHI+aSkgcCA9IG1pbihyLWksaHdbbSttLWldKTsNCg0KICAgICAgICBod1tpXSA9IHA7DQoNCiAgICAgICAgd2hpbGUoMSkNCiAgICAgICAgew0KICAgICAgLy8gICAgICBpZiAoaT09NykNCiAgICAgIC8vICAgICAgew0KICAgICAgLy8gICAgICAgICAgY291dDw8IG08PCI9PSI8PHI8PCIgICAgIjw8IGZsYWcgPDwiICI8PGVyY2k8PCIgIjw8cDw8IjoiPDwgc3QxPDxzdDI8PGVuZGw7DQogICAgICAvLyAgICAgIH0NCg0KICAgICAgICAgICAgaWYgKGktcDwwIHx8IGkrcD5sZSkNCiAgICAgICAgICAgICAgICBicmVhazsNCg0KICAgICAgICAgICBlbHNlIGlmICAoZmxhZyYmIHNbaStwXT09c1tpLXBdKQ0KICAgICAgICAgICB7DQogICAgICAgICAgICAgICBod1tpXSA9ICsrcDsNCg0KICAgICAgICAgICAgICAgaWYgKCBpK3A+cikNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICByID0gaStwOw0KICAgICAgICAgICAgICAgIG0gPSBpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICB9DQogICAgICAgICAgIGVsc2UgaWYgICghZXJjaSYmIHNbaStwXT09c1tpLXBdKQ0KICAgICAgICAgICB7DQogICAgICAgICAgICAgICBqaHdbaV0gPSArK3A7DQogICAgICAgICAgIH0NCiAgICAgICAgICAgZWxzZSBpZiAgKCFmbGFnJiYgc1tpK3BdPT1zW2ktcF0pDQogICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICsrcDsNCiAgICAgICAgICAgfQ0KICAgICAgICAgICBlbHNlIGlmIChmbGFnKQ0KICAgICAgICAgICB7DQogICAgICAgICAgICAgICBzdDEgPSBzW2ktcF07DQogICAgICAgICAgICAgICBzdDIgPSBzW2krcF07DQogICAgICAgICAgICAgICBmbGFnID0gZmFsc2U7DQogICAgICAgICAgICAgICAgKytwOw0KDQoNCg0KICAgICAgICAgICB9ZWxzZSBpZiAoZXJjaSAmJiAoc3QxPT1zW2ktcF0gJiYgc3QyID09IHNbaStwXSl8fChzdDE9PXNbaStwXSAmJiBzdDIgPT0gc1tpLXBdKSkNCiAgICAgICAgICAgew0KICAgICAgICAgICAgICAgZXJjaSA9IGZhbHNlOw0KICAgICAgICAgICAgICAgamh3W2ldID0gKytwOw0KICAgICAgICAgICB9ZWxzZQ0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICB9DQoNCg0KICAgIGlmIChlcmNpICYmICFmbGFnICYmIHNbaV0hPScjJyYmIChzW2ldPT1zdDF8fHNbaV09PXN0MikpDQogICAgICAgIGpod1tpXSA9IHA7DQogICAgfQ0KDQoNCg0KICAvLyAgZm9yIChpbnQgaSA9IDA7aTxsZTtpKyspDQogIC8vICAgIGNvdXQ8PHNbaV08PCIgIjsNCiAgLy8gIGNvdXQ8PGVuZGw7DQogIC8vICBmb3IgKGludCBpID0gMDtpPGxlO2krKykNCiAgLy8gICAgICBjb3V0PDxod1tpXTw8IiAiOw0KICAvLyAgY291dDw8ZW5kbDsNCiAgLy8gIGZvciAoaW50IGkgPSAwO2k8bGU7aSsrKQ0KICAvLyAgICAgIGNvdXQ8PGpod1tpXTw8IiAiOw0KICAvLyAgY291dDw8ZW5kbDsNCg0KICAgIGludCBhbnMgPSAwIDsNCg0KICAgIGZvciAoaW50IGkgPSAwO2k8bGU7aSsrKQ0KICAgICAgICBhbnMgPSBtYXgoYW5zLGh3W2ldIC0xKTsNCiAgICBmb3IgKGludCBpID0gMDtpPGxlO2krKykNCiAgICAgICAgYW5zID0gbWF4KGFucyxqaHdbaV0gLTEpOw0KDQoNCiAgICBjb3V0PDwoKGFucz09MSk/MDphbnMpPDxlbmRsOw0KDQp9DQppbnQgbWFpbigpDQp7DQogICAgSU87DQogICAgaW50IHRuPTE7DQogICAgY2luPj50bjsNCiAgICB3aGlsZSh0bi0tKQ0KICAgIHsNCiAgICAgICAgc29sdmUoKTsNCiAgICB9DQogICAgcmV0dXJuIDA7DQp9DQo="}]