[{"id":"2851","submission_id":"2851","filename":"i.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+DQoNCmNvbnN0IGludCBtYXhuID0gNTAwNTsNCg0KdW5zaWduZWQgbG9uZyBsb25nIGZbbWF4bl1bMl0sIHBbbWF4bl1bMl07DQoNCmNvbnN0IGludCBiYXNlID0gMTMzMzE7DQoNCmJvb2wgY2hlY2soaW50IEEsIGludCBCLCBpbnQgQywgaW50IEQpIHsNCglyZXR1cm4gZltCXVswXSAtIGZbQSAtIDFdWzBdICogcFtCIC0gQSArIDFdWzBdDQoJCQkJPT0gZltDXVsxXSAtIGZbRCArIDFdWzFdICogcFtCIC0gQSArIDFdWzBdOw0KfQ0KDQppbnQgbWFpbiAoKSB7DQoJc3RkOjppb3M6OnN5bmNfd2l0aF9zdGRpbyhmYWxzZSk7DQoJaW50IF87DQoJc3RkOjpzdHJpbmcgczsNCglzdGQ6OmNpbiA+PiBfOw0KCXdoaWxlIChfLS0pIHsNCgkJaW50IGFucyA9IDA7DQoJCXN0ZDo6Y2luID4+IHM7DQoJCWZbMF1bMF0gPSAwLCBwWzBdWzBdID0gMTsNCgkJaW50IG4gPSBzLnNpemUoKTsNCgkJZltuICsgMV1bMV0gPSAwLCBwW24gKyAxXVsxXSA9IDE7DQoJCWZvciAoaW50IGkgPSAxOyBpIDw9IG47IGkrKykgew0KCQkJZltpXVswXSA9IGZbaSAtIDFdWzBdICogYmFzZSArIHNbaSAtIDFdIC0gJ2EnICsgMTsNCgkJCXBbaV1bMF0gPSBwW2kgLSAxXVswXSAqIGJhc2U7DQoJCX0NCgkJZm9yIChpbnQgaSA9IG47IGkgPj0gMTsgaS0tKSB7DQoJCQlmW2ldWzFdID0gZltpICsgMV1bMV0gKiBiYXNlICsgc1tpIC0gMV0gLSAnYScgKyAxOw0KCQkJcFtpXVsxXSA9IHBbaSArIDFdWzFdICogYmFzZTsNCgkJfQ0KCQlmb3IgKGludCBpID0gMTsgaSA8PSBuOyBpKyspIHsNCgkJCWludCBMID0gMSwgUiA9IG4sIHAxID0gMDsNCgkJCXdoaWxlIChMIDw9IFIpIHsNCgkJCQlpbnQgbWlkID0gKEwgKyBSKSA+PiAxOw0KCQkJCWlmIChpIC0gbWlkIDwgMSB8fCBpICsgbWlkID4gbikgew0KCQkJCQlSID0gbWlkIC0gMTsNCgkJCQkJY29udGludWU7DQoJCQkJfQ0KCQkJCWlmIChjaGVjayhpIC0gbWlkLCBpIC0gMSwgaSArIDEsIGkgKyBtaWQpKSB7DQoJCQkJCXAxID0gbWlkOw0KCQkJCQlMID0gbWlkICsgMTsNCgkJCQl9DQoJCQkJZWxzZSB7DQoJCQkJCVIgPSBtaWQgLSAxOw0KCQkJCX0NCgkJCX0NCgkJCWlmIChwMSA+IDApIHsNCgkJCQlhbnMgPSBzdGQ6Om1heChhbnMsIHAxICogMiArIDEpOw0KCQkJfQ0KCQkJaWYgKGkgLSBwMSAtIDEgPCAxIHx8IGkgKyBwMSArIDEgPiBuKSB7DQoJCQkJY29udGludWU7DQoJCQl9DQoJCQlzdGQ6OnNldDxpbnQ+IHMxOw0KCQkJczEuaW5zZXJ0KHNbaSAtIHAxIC0gMl0gLSAnYScpOw0KCQkJczEuaW5zZXJ0KHNbaSArIHAxXSAtICdhJyk7DQoJCQlMID0gMSwgUiA9IG47DQoJCQlpbnQgcDIgPSAwOw0KCQkJd2hpbGUgKEwgPD0gUikgew0KCQkJCWludCBtaWQgPSAoTCArIFIpID4+IDE7DQoJCQkJaWYgKGkgLSBwMSAtIDEgLSBtaWQgPCAxIHx8IGkgKyBwMSArIDEgKyBtaWQgPiBuKSB7DQoJCQkJCVIgPSBtaWQgLSAxOw0KCQkJCQljb250aW51ZTsNCgkJCQl9DQoJCQkJaWYgKGNoZWNrKGkgLSBwMSAtIDEgLSBtaWQsIGkgLSBwMSAtIDIsIGkgKyBwMSArIDIsIGkgKyBwMSArIDEgKyBtaWQpKSB7DQoJCQkJCXAyID0gbWlkOw0KCQkJCQlMID0gbWlkICsgMTsNCgkJCQl9DQoJCQkJZWxzZSB7DQoJCQkJCVIgPSBtaWQgLSAxOw0KCQkJCX0NCgkJCX0NCgkJCWludCBmID0gMDsNCgkJCWZvciAoYXV0byBpdCA6IHMxKSBpZiAoc1tpIC0gMV0gLSAnYScgPT0gaXQpIGYgPSAxOw0KCQkJaWYgKGYpIHsNCgkJCQlhbnMgPSBzdGQ6Om1heChhbnMsIChwMSArIHAyICsgMSkgKiAyICsgMSk7DQoJCQl9DQoJCQlpZiAoaSAtIHAxIC0gcDIgLSAyIDwgMSB8fCBpICsgcDEgKyBwMiArIDIgPiBuKSB7DQoJCQkJY29udGludWU7DQoJCQl9DQoJCQlzdGQ6OnNldDxpbnQ+IHMyOw0KCQkJczIuaW5zZXJ0KHNbaSAtIHAxIC0gcDIgLSAzXSAtICdhJyk7DQoJCQlzMi5pbnNlcnQoc1tpICsgcDEgKyBwMiArIDFdIC0gJ2EnKTsNCgkJCWlmIChzMSAhPSBzMikgY29udGludWU7DQoJCQlMID0gMSwgUiA9IG47DQoJCQlpbnQgcDMgPSAwOw0KCQkJd2hpbGUgKEwgPD0gUikgew0KCQkJCWludCBtaWQgPSAoTCArIFIpID4+IDE7DQoJCQkJaWYgKGkgLSBwMSAtIHAyIC0gMiAtIG1pZCA8IDEgfHwgaSArIHAxICsgcDIgKyAyICsgbWlkID4gbikgew0KCQkJCQlSID0gbWlkIC0gMTsNCgkJCQkJY29udGludWU7DQoJCQkJfQ0KCQkJCWlmIChjaGVjayhpIC0gcDEgLSBwMiAtIDIgLSBtaWQsIGkgLSBwMSAtIHAyIC0gMywgaSArIHAxICsgcDIgKyAzLCBpICsgcDEgKyBwMiArIDIgKyBtaWQpKSB7DQoJCQkJCXAzID0gbWlkOw0KCQkJCQlMID0gbWlkICsgMTsNCgkJCQl9DQoJCQkJZWxzZSB7DQoJCQkJCVIgPSBtaWQgLSAxOw0KCQkJCX0NCgkJCX0NCgkJCWFucyA9IHN0ZDo6bWF4KGFucywgKHAxICsgcDIgKyBwMyArIDIpICogMiArIDEpOw0KCQl9DQoJDQoJCWZvciAoaW50IGkgPSAxOyBpIDw9IG47IGkrKykgew0KCQkJaW50IEwgPSAxLCBSID0gbiwgcDEgPSAwOw0KCQkJd2hpbGUgKEwgPD0gUikgew0KCQkJCWludCBtaWQgPSAoTCArIFIpID4+IDE7DQoJCQkJaWYgKGkgLSBtaWQgKyAxIDwgMSB8fCBpICsgbWlkID4gbikgew0KCQkJCQlSID0gbWlkIC0gMTsNCgkJCQkJY29udGludWU7DQoJCQkJfQ0KCQkJCWlmIChjaGVjayhpIC0gbWlkICsgMSwgaSwgaSArIDEsIGkgKyBtaWQpKSB7DQoJCQkJCXAxID0gbWlkOw0KCQkJCQlMID0gbWlkICsgMTsNCgkJCQl9DQoJCQkJZWxzZSB7DQoJCQkJCVIgPSBtaWQgLSAxOw0KCQkJCX0NCgkJCX0NCgkJCWlmIChwMSA+IDApIHsNCgkJCQlhbnMgPSBzdGQ6Om1heChhbnMsIHAxICogMik7DQoJCQl9DQoJCQlpZiAoaSAtIHAxIDwgMSB8fCBpICsgcDEgKyAxID4gbikgew0KCQkJCWNvbnRpbnVlOw0KCQkJfQ0KCQkJc3RkOjpzZXQ8aW50PiBzMTsNCgkJCXMxLmluc2VydChzW2kgLSBwMSAtIDFdIC0gJ2EnKTsNCgkJCXMxLmluc2VydChzW2kgKyBwMV0gLSAnYScpOw0KCQkJTCA9IDEsIFIgPSBuOw0KCQkJaW50IHAyID0gMDsNCgkJCXdoaWxlIChMIDw9IFIpIHsNCgkJCQlpbnQgbWlkID0gKEwgKyBSKSA+PiAxOw0KCQkJCWlmIChpIC0gcDEgLSBtaWQgPCAxIHx8IGkgKyBwMSArIDEgKyBtaWQgPiBuKSB7DQoJCQkJCVIgPSBtaWQgLSAxOw0KCQkJCQljb250aW51ZTsNCgkJCQl9DQoJCQkJaWYgKGNoZWNrKGkgLSBwMSAtIG1pZCwgaSAtIHAxIC0gMSwgaSArIHAxICsgMiwgaSArIHAxICsgMSArIG1pZCkpIHsNCgkJCQkJcDIgPSBtaWQ7DQoJCQkJCUwgPSBtaWQgKyAxOw0KCQkJCX0NCgkJCQllbHNlIHsNCgkJCQkJUiA9IG1pZCAtIDE7DQoJCQkJfQ0KCQkJfQ0KCQkJaWYgKGkgLSBwMSAtIHAyIC0gMSA8IDEgfHwgaSArIHAxICsgcDIgKyAyID4gbikgew0KCQkJCWNvbnRpbnVlOw0KCQkJfQ0KCQkJc3RkOjpzZXQ8aW50PiBzMjsNCgkJCXMyLmluc2VydChzW2kgLSBwMSAtIHAyIC0gMl0gLSAnYScpOw0KCQkJczIuaW5zZXJ0KHNbaSArIHAxICsgcDIgKyAxXSAtICdhJyk7DQoJCQlpZiAoczEgIT0gczIpIGNvbnRpbnVlOw0KCQkJTCA9IDEsIFIgPSBuOw0KCQkJaW50IHAzID0gMDsNCgkJCXdoaWxlIChMIDw9IFIpIHsNCgkJCQlpbnQgbWlkID0gKEwgKyBSKSA+PiAxOw0KCQkJCWlmIChpIC0gcDEgLSBwMiAtIDEgLSBtaWQgPCAxIHx8IGkgKyBwMSArIHAyICsgMiArIG1pZCA+IG4pIHsNCgkJCQkJUiA9IG1pZCAtIDE7DQoJCQkJCWNvbnRpbnVlOw0KCQkJCX0NCgkJCQlpZiAoY2hlY2soaSAtIHAxIC0gcDIgLSAxIC0gbWlkLCBpIC0gcDEgLSBwMiAtIDIsIGkgKyBwMSArIHAyICsgMywgaSArIHAxICsgcDIgKyAyICsgbWlkKSkgew0KCQkJCQlwMyA9IG1pZDsNCgkJCQkJTCA9IG1pZCArIDE7DQoJCQkJfQ0KCQkJCWVsc2Ugew0KCQkJCQlSID0gbWlkIC0gMTsNCgkJCQl9DQoJCQl9DQoJCQlhbnMgPSBzdGQ6Om1heChhbnMsIChwMSArIHAyICsgcDMgKyAyKSAqIDIpOw0KCQl9DQoJCXN0ZDo6Y291dCA8PCBhbnMgPDwgIlxuIjsNCgl9DQp9DQo="}]