[{"id":"4091","submission_id":"4090","filename":"D.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+DQoNCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQoNCg0KY29uc3QgaW50IE4gPSAzZTUgKyAxMDsNCmNvbnN0IGludCBJTkYgPSAweDNmM2YzZjNmOw0KaW50IGJbTl07DQppbnQgY250Ow0KDQppbnQgbiwgbSwgeDsNCmludCBtbltOIDw8IDJdOw0KaW50IG14W04gPDwgMl07DQppbnQgbGF6eVtOIDw8IDJdOw0KDQpzdHJ1Y3Qgbm9kZXsNCiAgICBpbnQgdDsNCiAgICBpbnQgbCwgcjsNCn1hW05dLCBxW05dOw0KDQppbnQgYW5zW05dOw0KDQpib29sIGNtcChub2RlICZhLCBub2RlICZiKXsNCg0KICAgIHJldHVybiBhLnQgPCBiLnQ7DQp9DQoNCnZvaWQgYnVpbGQoaW50IHJ0LCBpbnQgbCwgaW50IHIpew0KICAgIG1uW3J0XSA9IElORjsNCiAgICBteFtydF0gPSBJTkY7DQogICAgbGF6eVtydF0gPSBJTkY7DQogICAgaWYobCA9PSByKSByZXR1cm4gOw0KICAgIGludCBtaWQgPSBsICsgciA+PiAxOw0KICAgIGJ1aWxkKHJ0IDw8IDEsIGwsIG1pZCk7DQogICAgYnVpbGQocnQgPDwgMSB8IDEsIG1pZCArIDEsIHIpOw0KfQ0KDQp2b2lkIHB1c2h1cChpbnQgcnQpew0KICAgIG14W3J0XSA9IG1heChteFtydCA8PCAxXSwgbXhbcnQgPDwgMSB8IDFdKTsNCiAgICBtbltydF0gPSBtaW4obW5bcnQgPDwgMV0sIG1uW3J0IDw8IDEgfCAxXSk7DQp9DQoNCnZvaWQgcHVzaGRvd24oaW50IHJ0KQ0Kew0KICAgIGlmKGxhenlbcnRdICE9IElORikNCiAgICB7DQoNCiAgICAgICAgbGF6eVtydCA8PCAxXSA9IGxhenlbcnRdOw0KICAgICAgICBsYXp5W3J0IDw8IDEgfCAxXSA9IGxhenlbcnRdOw0KICAgICAgICBtbltydCA8PCAxXSA9IGxhenlbcnRdOw0KICAgICAgICBtbltydCA8PCAxIHwgMV0gPSBsYXp5W3J0XTsNCiAgICAgICAgbXhbcnQgPDwgMV0gPSBsYXp5W3J0XTsNCiAgICAgICAgbXhbcnQgPDwgMV0gPSBsYXp5W3J0XTsNCg0KICAgICAgICBsYXp5W3J0XSA9IElORjsNCiAgICB9DQp9DQoNCg0Kdm9pZCB1cGRhdGUoaW50IHJ0LCBpbnQgTCwgaW50IFIsIGludCBsLCBpbnQgciwgaW50IEMpDQp7DQovLyAgICBjb3V0IDw8IGwgPDwiICIgPDwgciA8PCIgIiA8PCBDIDw8ICdcbic7DQogICAgaWYoTCA8PSBsICYmIFI+PSByICYmIG1uW3J0XSA+PSBDKQ0KICAgIHsNCiAvLyAgICAgICBjb3V0IDw8Ij8/PyI8PCBsIDw8IiAiIDw8IHIgPDwgIiAiIDw8IEM8PCdcbic7DQogICAgICAgIG1uW3J0XSA9IEM7DQogICAgICAgIG14W3J0XSA9IEM7DQogICAgICAgIGxhenlbcnRdID0gQzsNCiAgICAgICAgcmV0dXJuIDsNCiAgICB9DQogICAgaW50IG1pZCA9IGwgKyByID4+IDE7DQogICAgcHVzaGRvd24ocnQpOw0KICAgIGlmKEwgPD0gbWlkKSB1cGRhdGUocnQgPDwgMSwgTCwgUiwgbCwgbWlkLCBDKTsNCiAgICBpZihSID4gbWlkKSB1cGRhdGUocnQgPDwgMSB8IDEsIEwsIFIsIG1pZCArIDEsIHIsIEMpOw0KICAgIHB1c2h1cChydCk7DQp9DQoNCg0KaW50IHF1ZXJ5KGludCBydCwgaW50IEwsIGludCBSLCBpbnQgbCwgaW50IHIpDQp7DQogICAgaWYoTCA8PSBsICYmIFIgPj0gcil7DQogICAgICAgIHJldHVybiBtbltydF07DQogICAgfQ0KICAgIGludCBhbnMgPSBJTkY7DQogICAgaW50IG1pZCA9IGwgKyByID4+IDE7DQogICAgcHVzaGRvd24ocnQpOw0KICAgIGlmKEwgPD0gbWlkKSBhbnMgPSBtaW4oYW5zLCBxdWVyeShydCA8PCAxLCBMLCBSLCBsLCBtaWQpKTsNCiAgICBpZihSID4gbWlkKSBhbnMgPSBtaW4oYW5zLCBxdWVyeShydCA8PCAxIHwgMSwgTCwgUiwgbWlkICsgMSwgcikpOw0KICAgIHJldHVybiBhbnM7DQp9DQoNCmludCBtYWluKCl7DQogICAgc2NhbmYoIiVkJWQlZCIsICZuLCAmbSwgJngpOw0KICAgIGJbKysgY250XSA9IHg7DQogICAgZm9yIChpbnQgaSA9IDE7IGkgPD0gbjsgaSArKykNCiAgICB7DQogICAgICAgIHNjYW5mKCIlZCVkJWQiLCAmYVtpXS50LCAmYVtpXS5sLCAmYVtpXS5yKTsNCiAgICAgICAgYlsrKyBjbnRdID0gYVtpXS5sOw0KICAgICAgICBiWysrIGNudF0gPSBhW2ldLnI7DQogICAgfQ0KICAgIGZvciAoaW50IGkgPSAxOyBpIDw9IG07IGkgKyspDQogICAgew0KICAgICAgICBxW2ldLnQgPSBpOw0KICAgICAgICBzY2FuZigiJWQlZCIsICZxW2ldLmwsICZxW2ldLnIpOw0KICAgICAgICBiWysrIGNudF0gPSBxW2ldLnI7DQogICAgfQ0KICAgIHNvcnQoYiArIDEsIGIgKyBjbnQgKyAxKTsNCiAgICBjbnQgPSB1bmlxdWUoYiArIDEsIGIgKyBjbnQgKyAxKSAtIChiICsgMSk7DQogICAgeCA9IGxvd2VyX2JvdW5kKGIgKyAxLCBiICsgY250ICsgMSwgeCkgLSBiOw0KICAgIGZvciAoaW50IGkgPSAxOyBpIDw9IG47IGkgKyspDQogICAgew0KICAgICAgICBhW2ldLmwgPSBsb3dlcl9ib3VuZChiICsgMSwgYiArIGNudCArIDEsIGFbaV0ubCkgLSBiOw0KICAgICAgICBhW2ldLnIgPSBsb3dlcl9ib3VuZChiICsgMSwgYiArIGNudCArIDEsIGFbaV0ucikgLSBiOw0KICAgIH0NCiAgICBmb3IgKGludCBpID0gMTsgaSA8PSBtOyBpICsrKQ0KICAgIHsNCiAgICAgICAgcVtpXS5yID0gbG93ZXJfYm91bmQoYiArIDEsIGIgKyBjbnQgKyAxLCBxW2ldLnIpIC0gYjsNCiAgICB9DQoNCiAgICBzb3J0KGEgKyAxLCBhICsgbiArIDEsIGNtcCk7DQogICAgc29ydChxICsgMSwgcSArIG0gKyAxLCBjbXApOw0KICAgIGJ1aWxkKDEsIDEsIGNudCk7DQogICAgdXBkYXRlKDEsIHgsIHgsIDEsIGNudCwgMCk7DQogICAgaW50IGogPSBuOw0KICAgIHByaW9yaXR5X3F1ZXVlPHBhaXI8aW50LGludD4+IHF1ZTsNCiAgICBmb3IgKGludCBpICA9IG07IGkgPj0gMTsgaSAtLSkNCiAgICB7DQogICAgICAgIHdoaWxlKGogPj0gMSAmJiBhW2pdLnQgPj0gcVtpXS5sKQ0KICAgICAgICB7DQogICAgICAgICAgICBxdWUucHVzaCh7YVtqXS5yLCBhW2pdLmx9KTsNCiAgICAgICAgICAgIGogLS07DQogICAgICAgIH0NCiAgICAgICAgYm9vbCBmID0gdHJ1ZTsNCiAgICAgICAgd2hpbGUoMSl7DQogICAgICAgICAgICBpZihxdWUuc2l6ZSgpID09IDApIGJyZWFrOw0KICAgICAgICAgICAgaWYoZiA9PSBmYWxzZSkgYnJlYWs7DQogICAgICAgICAgICBhdXRvIHRtcCA9IHF1ZS50b3AoKTsNCiAgICAgICAgICAgIGludCBuZWVkID0gcXVlcnkoMSwgdG1wLnNlY29uZCwgdG1wLnNlY29uZCwgMSwgY250KTsNCiAgICAgICAgICAgIGlmKG5lZWQgPT1JTkYpew0KICAgICAgICAgICAgICAgIGYgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGVsc2V7DQogICAgICAgICAgICAgICAgcXVlLnBvcCgpOw0KICAgICAgICAgICAgICAgIHVwZGF0ZSgxLCB0bXAuc2Vjb25kLCB0bXAuZmlyc3QsIDEsIGNudCwgbmVlZCArIDEpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIGFuc1txW2ldLnRdID0gcXVlcnkoMSwgcVtpXS5yLCBxW2ldLnIsIDEsIGNudCk7DQogICAgfQ0KICAgIGZvciAoaW50IGkgPSAxOyBpIDw9IG07IGkgKyspDQogICAgew0KICAgICAgICBpZihhbnNbaV0gPT0gSU5GKSBhbnNbaV0gPSAtMTsNCiAgICAgICAgY291dCA8PCBhbnNbaV0gPDwgJ1xuJzsNCiAgICB9DQp9DQoNCg=="}]