[{"id":"3851","submission_id":"3851","filename":"G.cpp","source":"I2luY2x1ZGU8Yml0cy9zdGRjKysuaD4NCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQp2ZWN0b3I8cGFpcjxpbnQsYm9vbD4+IGVbMTAwMDA1XTsvLzAgZ29vZCAxIGJhZA0KYm9vbCBnb29kWzEwMDAwNV0sdmlzWzEwMDAwNV07DQppbnQgc2NjWzEwMDAwNV0sY250LG51bVsxMDAwMDVdLGZmWzEwMDAwNV0scHBbMTAwMDA1XSx0b3RbMTAwMDA1XTsNCmJvb2wgd29jYW9uaW1hOw0KdmVjdG9yPGludD4gYVsxMDAwMDVdLGJbMTAwMDA1XTsNCnN0cnVjdCBOb2Rlew0KCWludCB4LHA7DQp9Y1syMDAwMDA1XTsNCnZvaWQgZGZzKGludCB4LGludCBmYSkNCnsNCglpZih2aXNbeF0pIHJldHVybjsNCgl2aXNbeF09MTsNCglzY2NbeF09Y250Ow0KCWZvcihhdXRvJiBpOmVbeF0pew0KCQlpZihpLmZpcnN0PT14JiYoIWkuc2Vjb25kKSE9Z29vZFtpLmZpcnN0XSkgd29jYW9uaW1hPXRydWU7DQoJCWlmKGkuZmlyc3Q9PXgpIGNvbnRpbnVlOw0KCQlpZihpLmZpcnN0PT1mYSkgY29udGludWU7DQoJCWJvb2wgcD0haS5zZWNvbmQ7DQoJCWlmKCFnb29kW3hdKSBwPSFwOw0KCQlpZih2aXNbaS5maXJzdF0mJmdvb2RbaS5maXJzdF0hPXApew0KCQkJd29jYW9uaW1hPXRydWU7DQoJCX0NCgkJZ29vZFtpLmZpcnN0XT1wOw0KCQlkZnMoaS5maXJzdCx4KTsNCgl9DQp9DQp2b2lkIHNvbHZlKCkNCnsNCglpbnQgbixxLG07DQoJY2luPj5uPj5xPj5tOw0KCWZvcihpbnQgaT0xO2k8PW07aSsrKXsNCgkJaW50IG9wLHUsdjsNCgkJY2luPj5vcD4+dT4+djsNCgkJZVt1XS5wdXNoX2JhY2soe3Ysb3B9KTsNCgkJZVt2XS5wdXNoX2JhY2soe3Usb3B9KTsNCgl9DQoJZm9yKGludCBpPTE7aTw9bjtpKyspew0KCQlpZih2aXNbaV0pIGNvbnRpbnVlOw0KCQlnb29kW2ldPXRydWU7DQoJCWNudCsrOw0KCQlkZnMoaSwwKTsNCgl9DQoJdmVjdG9yPHBhaXI8aW50LGludD4+IHNpeihjbnQrMSk7DQoJZm9yKGludCBpPTE7aTw9bjtpKyspew0KCQlpZihnb29kW2ldKSBzaXpbc2NjW2ldXS5maXJzdCsrOy8vMA0KCQllbHNlIHNpeltzY2NbaV1dLnNlY29uZCsrOy8vMQ0KCX0NCi8vCWNvdXQ8PCItLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4iOw0KLy8JZm9yIChpbnQgaT0xOyBpPD1uOyBpKyspIGNvdXQ8PGk8PCIgIjw8Z29vZFtpXTw8IiAiPDxzY2NbaV08PCJcbiI7DQoJaWYod29jYW9uaW1hKXsNCgkJY291dDw8Ik5PXG4iOw0KCQlyZXR1cm47DQoJfQ0KCXZlY3RvcjxpbnQ+IGRpcyhjbnQrMSwwKTsNCgltZW1zZXQobnVtLDAsc2l6ZW9mKG51bSkpOw0KCW1lbXNldCh0b3QsMCxzaXplb2YodG90KSk7DQoJaW50IHN1bT0wOw0KCWZvcihpbnQgaT0xO2k8PWNudDtpKyspIGRpc1tpXT1hYnMoc2l6W2ldLmZpcnN0LXNpeltpXS5zZWNvbmQpLG51bVtkaXNbaV1dKyssc3VtKz1taW4oc2l6W2ldLmZpcnN0LHNpeltpXS5zZWNvbmQpOw0KCWZvcihpbnQgaT0xO2k8PWNudDtpKyspIGlmIChkaXNbaV09PTApIHRvdFswXSsrOw0KCXZlY3RvcjxpbnQ+IGRwKG4rMSwwKTsNCglkcFtzdW1dPTE7IGludCBsbD0wOw0KCWZvciAoaW50IGk9MTsgaTw9MTAwMDAwOyBpKyspDQoJIGlmIChudW1baV0+MCkNCgkgIHsNCgkgIAlpbnQgaj1udW1baV0saz0yMDsNCgkgIAl3aGlsZSAoaj4wJiZrPj0wKQ0KCSAgCXsNCgkgIAkJaWYgKCgxPDxrKTw9aikgY1srK2xsXT0oTm9kZSl7KDE8PGspKmksaX0sai09KDE8PGspOw0KCSAgCQktLWs7DQoJCX0NCgkgIH0NCgltZW1zZXQoZmYsMCxzaXplb2YoZmYpKTsNCgltZW1zZXQocHAsMCxzaXplb2YocHApKTsNCglmb3IgKGludCBpPTE7IGk8PWxsOyBpKyspDQoJIGZvciAoaW50IGo9cTsgaj49c3VtOyBqLS0pDQoJICBpZiAoaitjW2ldLng8PXEpDQoJICAgaWYgKGRwW2pdKQ0KCSAgICB7DQoJICAgIAlkcFtqK2NbaV0ueF09MTsNCgkgICAgCWZmW2orY1tpXS54XT1qOw0KCSAgICAJcHBbaitjW2ldLnhdPWk7DQoJCX0NCglpZihkcFtxXT09MCl7DQoJCWNvdXQ8PCJOT1xuIjsNCgkJcmV0dXJuOw0KCX0NCglpbnQgdD1xOw0KCXdoaWxlICh0PnN1bSkNCgl7DQoJCWludCB4PXBwW3RdOw0KCQlpbnQgcD1jW3hdLngvY1t4XS5wOw0KCQl0b3RbY1t4XS5wXSs9cDsNCgkJdD1mZlt0XTsNCgl9DQoJdmVjdG9yPGludD4gYW5zOw0KCWJvb2wgaXN1c2VbMTAwMDA1XTsNCglmb3IgKGludCBpPTE7IGk8PWNudDsgaSsrKQ0KCSBpZiAodG90W2Rpc1tpXV0+MCkNCgkgIHsNCgkgIAl0b3RbZGlzW2ldXS0tOw0KCSAgCWlzdXNlW2ldPXRydWU7DQoJICB9DQoJZm9yKGludCBpPTE7aTw9bjtpKyspew0KCQlpZihnb29kW2ldKXsNCgkJCWlmKHNpeltzY2NbaV1dLmZpcnN0Pj1zaXpbc2NjW2ldXS5zZWNvbmQmJmlzdXNlW3NjY1tpXV0pIGFucy5wdXNoX2JhY2soaSk7DQoJCQlpZihzaXpbc2NjW2ldXS5maXJzdDw9c2l6W3NjY1tpXV0uc2Vjb25kJiYhaXN1c2Vbc2NjW2ldXSkgYW5zLnB1c2hfYmFjayhpKTsNCgkJfQ0KCQllbHNlDQoJCXsNCgkJCWlmKHNpeltzY2NbaV1dLmZpcnN0PnNpeltzY2NbaV1dLnNlY29uZCYmIWlzdXNlW3NjY1tpXV0pIGFucy5wdXNoX2JhY2soaSk7DQoJCQlpZihzaXpbc2NjW2ldXS5maXJzdDxzaXpbc2NjW2ldXS5zZWNvbmQmJmlzdXNlW3NjY1tpXV0pIGFucy5wdXNoX2JhY2soaSk7DQoJCX0NCgl9DQoJc29ydChhbnMuYmVnaW4oKSxhbnMuZW5kKCkpOw0KCWNvdXQ8PCJZRVNcbiI7DQoJZm9yKGF1dG8mIGk6YW5zKXsNCgkJY291dDw8aTw8IiAiOw0KCX0NCgljb3V0PDwiXG4iOw0KfQ0KaW50IG1haW4oKQ0Kew0KCWlvczo6c3luY193aXRoX3N0ZGlvKDApOw0KCWNpbi50aWUoMCk7Y291dC50aWUoMCk7DQoJc29sdmUoKTsNCglyZXR1cm4gMDsJDQp9"}]