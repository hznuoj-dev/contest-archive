[{"id":"2982","submission_id":"2982","filename":"G.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+DQoNCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQojZGVmaW5lIGxuICdcbicNCg0KY29uc3QgaW50IE4gPSAxZTUgKyA1Ow0KDQppbnQgZltOXSwgc2l6W05dLCBjb2xbTl0sIHdbTl0sIGlkW05dOw0KDQovL2JpdHNldDw1MDAwMD4NCmludCBmaW5kKGludCB4KSB7DQoJaWYoZlt4XSA9PSB4KSByZXR1cm4geDsNCglpbnQgcGFyID0gZmluZChmW3hdKTsNCgljb2xbeF0gPSBjb2xbZlt4XV0gXiB3W3hdOw0KCXJldHVybiBwYXI7DQp9DQoNCmJvb2wgYW5zID0gdHJ1ZTsNCg0Kdm9pZCBtZXJnZShpbnQgeCwgaW50IHksIGludCBXKSB7DQovLwljb3V0IDw8IHggPDwgIiAiIDw8IHkgPDwgbG47DQoJaW50IGZ4ID0gZmluZCh4KSwgZnkgPSBmaW5kKHkpOw0KLy8JY291dCA8PCB4IDw8ICIgIiA8PCB5IDw8ICIgIiA8PCBjb2xbeF0gPDwgIiAiIDw8IGNvbFt5XSA8PCAiICIgPDwgVyA8PCBsbjsNCglpZihmeCA9PSBmeSkgew0KCQlpZihjb2xbeF0gXiBjb2xbeV0gIT0gVykgYW5zID0gZmFsc2U7DQoJCXJldHVybjsNCgl9DQoJaWYoc2l6W2Z4XSA8IHNpeltmeV0pIHN3YXAoeCwgeSksIHN3YXAoZngsIGZ5KTsNCgkNCglzaXpbZnhdICs9IHNpeltmeV07DQoJZltmeV0gPSBmeDsNCgl3W2Z5XSA9IGNvbFt4XSBeIGNvbFt5XSBeIFc7DQoJDQp9DQoNCmlubGluZSB2b2lkIHNvbHZlKCkgew0KCWludCBuLCBxLCBtOw0KCWNpbiA+PiBuID4+IHEgPj4gbTsNCglmb3IoaW50IGkgPSAxOyBpIDw9IG47IGkrKykgDQoJCWZbaV0gPSBpLCBjb2xbaV0gPSAwLCBzaXpbaV0gPSAxLCB3W2ldID0gMDsNCglmb3IoaW50IGkgPSAxOyBpIDw9IG07IGkrKykgew0KCQlpbnQgeCwgeSwgdzsNCgkJY2luID4+IHcgPj4geCA+PiB5Ow0KCQltZXJnZSh4LCB5LCB3KTsNCgkJZmluZCh4KTsgZmluZCh5KTsNCi8vCQljb3V0IDw8IGNvbFt4XSA8PCAiICIgPDwgY29sW3ldIDw8ICIgIiA8PCB3IDw8IGxuOw0KLy8JCWNvdXQgPDwgZmluZCh4KSA8PCAiICIgPDwgZmluZCh5KSA8PCBsbjsNCgl9DQoJaWYoYW5zID09IGZhbHNlKSANCgkJcmV0dXJuIGNvdXQgPDwgIk5PXG4iLCB2b2lkKCk7DQoJZWxzZSANCgkJY291dCA8PCAiWUVTXG4iOw0KCQ0KCWludCB0b3QgPSAwOw0KCWZvcihpbnQgaSA9IDE7IGkgPD0gbjsgaSsrKSANCgkJaWYoZltpXSA9PSBpKSBpZFtpXSA9ICsrdG90OwkNCglmb3IoaW50IGkgPSAxOyBpIDw9IG47IGkrKykgDQoJCWlkW2ldID0gaWRbZmluZChpKV07DQoJCQ0KCXZlY3Rvcjx2ZWN0b3I8aW50Pj4gZ29vZCh0b3QgKyAxKSwgYmFkKHRvdCArIDEpOw0KCWZvcihpbnQgaSA9IDE7IGkgPD0gbjsgaSsrKSB7DQoJCWlmKGNvbFtpXSA9PSAwKSBnb29kW2lkW2ldXS5wdXNoX2JhY2soaSk7DQoJCWVsc2UgYmFkW2lkW2ldXS5wdXNoX2JhY2soaSk7DQoJfQ0KCQ0KCWludCBtbiA9IG1pbihxLCBuIC0gcSk7DQoJdmVjdG9yPGJpdHNldDwxMDAwMDU+PiBwKHRvdCArIDEpOw0KCXBbMF1bMF0gPSAxOw0KCWZvcihpbnQgaSA9IDE7IGkgPD0gdG90OyBpKyspIA0KCQlwW2ldID0gKHBbaSAtIDFdIDw8IGdvb2RbaV0uc2l6ZSgpKSB8IChwW2kgLSAxXSA8PCBiYWRbaV0uc2l6ZSgpKTsNCi8vCQljb3V0IDw8IHBbaV0gPDwgbG47DQoNCgl2ZWN0b3I8aW50PiBhbnNfZ29vZCwgYW5zX2JhZDsNCglmb3IoaW50IGkgPSB0b3Q7IGk7IGktLSkNCgkJaWYocFtpIC0gMV1bbW4gLSBnb29kW2ldLnNpemUoKV0pICB7DQoJCQltbiAtPSBnb29kW2ldLnNpemUoKTsNCgkJCWZvcihhdXRvIHg6IGdvb2RbaV0pIGFuc19nb29kLnB1c2hfYmFjayh4KTsNCgkJCWZvcihhdXRvIHg6IGJhZFtpXSkgYW5zX2JhZC5wdXNoX2JhY2soeCk7DQoJCX0gZWxzZSB7DQoJCQltbiAtPSBiYWRbaV0uc2l6ZSgpOw0KCQkJZm9yKGF1dG8geDogYmFkW2ldKSBhbnNfZ29vZC5wdXNoX2JhY2soeCk7DQoJCQlmb3IoYXV0byB4OiBnb29kW2ldKSBhbnNfYmFkLnB1c2hfYmFjayh4KTsJDQoJCX0NCgkNCglzb3J0KGFuc19nb29kLmJlZ2luKCksIGFuc19nb29kLmVuZCgpKTsNCglzb3J0KGFuc19iYWQuYmVnaW4oKSwgYW5zX2JhZC5lbmQoKSk7DQoJaWYoYW5zX2dvb2Quc2l6ZSgpID09IHEpIHsNCgkJZm9yKGF1dG8geDogYW5zX2dvb2QpIGNvdXQgPDwgeCA8PCAiICI7DQoJCWNvdXQgPDwgbG47DQoJfSBlbHNlIHsNCgkJZm9yKGF1dG8geDogYW5zX2JhZCkgY291dCA8PCB4IDw8ICIgIjsNCgkJY291dCA8PCBsbjsNCgl9DQp9DQoNCmludCBtYWluKCkgew0KCWlvczo6c3luY193aXRoX3N0ZGlvKGZhbHNlKTsNCgljaW4udGllKG51bGxwdHIpOw0KCQ0KCXNvbHZlKCk7DQp9DQoNCi8qDQoyIDEgMg0KMSAxIDINCjAgMiAxDQoNCjAgMCAxDQoxIDAgMA0KKi8NCg=="}]