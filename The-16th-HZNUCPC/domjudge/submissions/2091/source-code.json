[{"id":"2091","submission_id":"2091","filename":"a.cpp","source":"Ly8gI2RlZmluZSBERUJVRw0KI2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+DQoNCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQpjb25zdCBpbnQgTU9EID0gMTAwMDAwMDAwNzsNCmNvbnN0IGludCBJTlYyID0gNTAwMDAwMDA0Ow0KY29uc3QgaW50IE1BWE4gPSAxZTUgKyA1Ow0KI2RlZmluZSBpbnQgbG9uZyBsb25nDQojZGVmaW5lIGVuZGwgJ1xuJw0KDQppbnQgcV9wb3coaW50IGEsIGludCBiKSB7DQogICAgaW50IHJlcyA9IDE7DQogICAgZm9yICg7IGI7IGIgPj49IDEpIHsNCiAgICAgICAgaWYgKGIgJiAxKSByZXMgPSByZXMgKiBhICUgTU9EOw0KICAgICAgICBhID0gYSAqIGEgJSBNT0Q7DQogICAgfQ0KICAgIHJldHVybiByZXM7DQp9DQoNCmludCBkaXNbMjZdWzI2XVtNQVhOXTsNCmludCBmdWNrWzI2XVsyNl1bNV07DQoNCnZvaWQgc29sdmUoKSB7DQogICAgc3RyaW5nIGEsIGI7IGNpbiA+PiBhID4+IGI7DQogICAgaW50IG4gPSAoaW50KWEuc2l6ZSgpOw0KICAgIHZlY3RvcjxpbnQ+IGNudEEoMjYpOw0KICAgIHZlY3RvcjxpbnQ+IGNudEIoMjYpOw0KICAgIGludCBzekEgPSAwLCBzekIgPSAwOw0KICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbjsgaSArKyApIHsNCiAgICAgICAgY250QVthW2ldIC0gJ2EnXSArKzsNCiAgICAgICAgY250QltiW2ldIC0gJ2EnXSArKzsNCiAgICB9DQogICAgZm9yIChpbnQgaSA9IDA7IGkgPCAyNjsgaSArKyApIHsNCiAgICAgICAgaWYgKGNudEFbaV0gPiAwKSBzekEgKys7DQogICAgICAgIGlmIChjbnRCW2ldID4gMCkgc3pCICsrOw0KICAgIH0NCiAgICBhdXRvIGNhbGMgPSBbJl0oaW50IGkgKSB7DQogICAgICAgIGludCByZXMgPSAwOw0KICAgICAgICBpZiAoY250QVthW2ldIC0gJ2EnXSA9PSAxKSByZXMgKys7DQogICAgICAgIGlmIChjbnRBW2JbaV0gLSAnYSddID09IDApIHJlcyAtLTsNCiAgICAgICAgaWYgKGNudEJbYVtpXSAtICdhJ10gPT0gMCkgcmVzICsrOw0KICAgICAgICBpZiAoY250QltiW2ldIC0gJ2EnXSA9PSAxKSByZXMgLS07DQogICAgICAgIC8vIGlmIChjbnRBW2FbaV0gLSAnYSddID09IDEpIGRpc1tsXVtrXVtpXSArKzsNCiAgICAgICAgLy8gaWYgKGNudEFbYltpXSAtICdhJ10gPT0gMCkgZGlzW2xdW2tdW2ldIC0tOw0KICAgICAgICAvLyBpZiAoY250QlthW2ldIC0gJ2EnXSA9PSAwKSBkaXNbbF1ba11baV0gKys7DQogICAgICAgIC8vIGlmIChjbnRCW2JbaV0gLSAnYSddID09IDEpIGRpc1tsXVtrXVtpXSAtLTsNCiAgICAgICAgcmV0dXJuIHJlczsNCiAgICB9Ow0KICAgIGZvciAoaW50IGwgPSAwOyBsIDwgMjY7ICsrbCkgew0KICAgICAgICBmb3IgKGludCBrID0gMDsgayA8IDI2OyArK2spIHsNCiAgICAgICAgICAgIGlmIChjbnRBW2xdID09IDAgfHwgY250QltrXSA9PSAwKSBjb250aW51ZTsNCiAgICAgICAgICAgIGNudEFbbF0tLSwgY250QltrXS0tLGNudEFba10rKywgY250QltsXSsrOw0KICAgICAgICAgICAgaW50IHBvcyA9IDA7DQogICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IG47ICsraSkgew0KICAgICAgICAgICAgICAgIGlmIChhW2ldIC0gJ2EnID09IGwgJiYgYltpXSAtICdhJyA9PSBrKSB7cG9zID0gaTsgYnJlYWs7fQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgc3dhcChhW3Bvc10sIGJbcG9zXSk7DQogICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IG47IGkgKysgKSB7DQogICAgICAgICAgICAgICAgaWYgKHBvcyA9PSBpKSBjb250aW51ZTsNCiAgICAgICAgICAgICAgICBkaXNbbF1ba11baV0gPSBjYWxjKGkpOw0KICAgICAgICAgICAgICAgIGZ1Y2tbbF1ba11bZGlzW2xdW2tdW2ldICsgMl0gKys7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBzd2FwKGFbcG9zXSwgYltwb3NdKTsNCiAgICAgICAgICAgIGNudEFbbF0rKywgY250QltrXSsrLGNudEFba10tLSwgY250QltsXS0tOw0KICAgICAgICB9DQogICAgfQ0KICAgIC8vIGZvciAoaW50IGkgPSAwOyBpIDwgbjsgaSArKyApIGNvdXQgPDwgZGlzW2ldIDw8ICcgJzsNCiAgICAvLyBjb3V0IDw8IGVuZGw7DQogICAgLy8gZm9yIChpbnQgaSA9IDA7IGkgPCA1OyBpICsrICkgY291dCA8PCBmdWNrW2ldIDw8ICcgJzsNCiAgICAvLyBjb3V0IDw8IGVuZGw7DQogICAgaW50IHJlcyA9IDA7DQogICAgZm9yIChpbnQgaSA9IDA7IGkgPCBuOyBpICsrICkgew0KICAgICAgICBpbnQgZCA9IHN6QiAtIHN6QSArIGNhbGMoaSk7DQogICAgICAgIGlmIChhYnMoZCkgPiAyKSBjb250aW51ZTsNCiAgICAgICAgaW50IHggPSBhW2ldIC0gJ2EnLCB5ID0gYltpXSAtICdhJzsNCiAgICAgICAgZCA9IC1kOw0KICAgICAgICByZXMgPSAocmVzICsgZnVja1t4XVt5XVtkICsgMl0pICUgTU9EOw0KICAgICAgICAvLyBjb3V0IDw8IGkgPDwgIjoiIDw8IHJlcyA8PCBlbmRsOw0KICAgIH0NCiAgICAvLyBjb3V0IDw8IHFfcG93KDIsIE1PRCAtIDIpIDw8IGVuZGw7DQogICAgY291dCA8PCAocmVzICsgTU9EKSAlIE1PRCAqIElOVjIgJSBNT0QgPDwgZW5kbDsNCn0NCg0Kc2lnbmVkIG1haW4odm9pZCkgew0KI2lmZGVmIERFQlVHDQogICAgZnJlb3BlbigiYS5pbiIsICJyIiwgc3RkaW4pOw0KICAgIGZyZW9wZW4oImEub3V0IiwgInciLCBzdGRvdXQpOw0KICAgIGF1dG8gbm93ID0gY2xvY2soKTsNCiNlbmRpZg0KICAgIGlvczo6c3luY193aXRoX3N0ZGlvKGZhbHNlKTsgY2luLnRpZSgwKTsgY291dC50aWUoMCk7DQogICAgY291dCA8PCBmaXhlZCA8PCBzZXRwcmVjaXNpb24oNik7DQogICAgLy8gY2luID4+IFQ7DQogICAgLy8gd2hpbGUgKFQtLSkNCiAgICB7c29sdmUoKTsgfQ0KI2lmZGVmIERFQlVHDQogICAgY2VyciA8PCBkb3VibGUoY2xvY2soKSAtIG5vdykgLyAoZG91YmxlKUNMT0NLU19QRVJfU0VDICogMTAwMCA8PCAiIG1zLiIgPDwgZW5kbDsNCiNlbmRpZg0KICAgIHJldHVybiAwOw0KfQ=="}]