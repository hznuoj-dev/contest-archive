[{"id":"3369","submission_id":"3369","filename":"A.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+DQp1c2luZyBuYW1lc3BhY2Ugc3RkOw0KI2RlZmluZSBlbmRsICdcbicNCiNkZWZpbmUgSU8gaW9zOjpzeW5jX3dpdGhfc3RkaW8oMCk7Y2luLnRpZSgwKTtjb3V0LnRpZSgwKTsNCiNkZWZpbmUgbGwgbG9uZyBsb25nDQpjb25zdCBsbCBtb2RlPTFlOSs3Ow0KY29uc3QgaW50IG1heG49MWU1Ow0KLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCg0KY2hhciBhW21heG5dOw0KY2hhciBzW21heG5dOw0KaW50IGh3W21heG5dOw0KaW50IGpod1ttYXhuXTsNCnZvaWQgc29sdmUoKQ0Kew0KICAgIGNpbj4+YTsNCiAgICBpbnQgbiA9IHN0cmxlbihhKTsNCiAgICBzWzBdID0gJz4nOw0KICAgIHNbMV0gPSAnIyc7DQogICAgZm9yIChpbnQgaSA9MDtpPG47aSsrKQ0KICAgIHsNCiAgICAgICAgc1tpKjIrMl0gPSBhW2ldOw0KICAgICAgICBzW2kqMiszXSA9ICcjJzsNCiAgICB9DQogICAgc1tuKjIrMl0gPSAnPCc7DQogICAgc1tuKjIrM10gPSAnXDAnOw0KDQoNCg0KICAgIGludCBsZSA9IHN0cmxlbihzKTsNCg0KICAgIGZvciAoaW50IGkgPTA7aTw9bGU7aSsrKQ0KICAgICAgICBod1tpXT1qaHdbaV0gPSAwOw0KDQoNCiAgICBpbnQgbSAgPSAtMSwgciA9IC0xOw0KICAgIGZvciAoaW50IGkgPSAwO2k8PWxlO2krKykNCiAgICB7DQogICAgICAgIGJvb2wgZmxhZyA9IHRydWU7DQogICAgICAgIGJvb2wgZXJjaSA9IHRydWU7DQogICAgICAgIC8vIGppZQ0KICAgICAgICBjaGFyIHN0MSA9ICcuJzsNCiAgICAgICAgLy8gaHVhbg0KICAgICAgICBjaGFyIHN0MiA9ICAnLic7DQoNCg0KICAgICAgICBpbnQgcCA9IDA7DQogICAgICAgIGlmIChyPmkpIHAgPSBtaW4oci1pLGh3W20rbS1pXSk7DQoNCiAgICAgICAgaHdbaV0gPSBwOw0KDQogICAgICAgIHdoaWxlKDEpDQogICAgICAgIHsNCiAgICAgIC8vICAgICAgaWYgKGk9PTcpDQogICAgICAvLyAgICAgIHsNCiAgICAgIC8vICAgICAgICAgIGNvdXQ8PCBtPDwiPT0iPDxyPDwiICAgICI8PCBmbGFnIDw8IiAiPDxlcmNpPDwiICI8PHA8PCI6Ijw8IHN0MTw8c3QyPDxlbmRsOw0KICAgICAgLy8gICAgICB9DQoNCiAgICAgICAgICAgIGlmIChpLXA8MCB8fCBpK3A+bGUpDQogICAgICAgICAgICAgICAgYnJlYWs7DQoNCiAgICAgICAgICAgZWxzZSBpZiAgKGZsYWcmJiBzW2krcF09PXNbaS1wXSkNCiAgICAgICAgICAgew0KICAgICAgICAgICAgICAgaHdbaV0gPSArK3A7DQoNCiAgICAgICAgICAgICAgIGlmICggaStwPnIpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgciA9IGkrcDsNCiAgICAgICAgICAgICAgICBtID0gaTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgfQ0KICAgICAgICAgICBlbHNlIGlmICAoIWVyY2kmJiBzW2krcF09PXNbaS1wXSkNCiAgICAgICAgICAgew0KICAgICAgICAgICAgICAgamh3W2ldID0gKytwOw0KICAgICAgICAgICB9DQogICAgICAgICAgIGVsc2UgaWYgICghZmxhZyYmIHNbaStwXT09c1tpLXBdKQ0KICAgICAgICAgICB7DQogICAgICAgICAgICAgICArK3A7DQogICAgICAgICAgIH0NCiAgICAgICAgICAgZWxzZSBpZiAoZmxhZykNCiAgICAgICAgICAgew0KICAgICAgICAgICAgICAgc3QxID0gc1tpLXBdOw0KICAgICAgICAgICAgICAgc3QyID0gc1tpK3BdOw0KICAgICAgICAgICAgICAgZmxhZyA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICsrcDsNCg0KDQoNCiAgICAgICAgICAgfWVsc2UgaWYgKGVyY2kgJiYgKHN0MT09c1tpLXBdICYmIHN0MiA9PSBzW2krcF0pfHwoc3QxPT1zW2krcF0gJiYgc3QyID09IHNbaS1wXSkpDQogICAgICAgICAgIHsNCiAgICAgICAgICAgICAgIGVyY2kgPSBmYWxzZTsNCiAgICAgICAgICAgICAgIGpod1tpXSA9ICsrcDsNCiAgICAgICAgICAgfWVsc2UNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgfQ0KDQoNCiAgICBpZiAoZXJjaSAmJiAhZmxhZyAmJiBzW2ldIT0nIycmJiAoc1tpXT09c3QxfHxzW2ldPT1zdDIpKQ0KICAgICAgICBqaHdbaV0gPSBwOw0KICAgIH0NCg0KDQoNCiAgLy8gIGZvciAoaW50IGkgPSAwO2k8bGU7aSsrKQ0KICAvLyAgICBjb3V0PDxzW2ldPDwiICI7DQogIC8vICBjb3V0PDxlbmRsOw0KICAvLyAgZm9yIChpbnQgaSA9IDA7aTxsZTtpKyspDQogIC8vICAgICAgY291dDw8aHdbaV08PCIgIjsNCiAgLy8gIGNvdXQ8PGVuZGw7DQogIC8vICBmb3IgKGludCBpID0gMDtpPGxlO2krKykNCiAgLy8gICAgICBjb3V0PDxqaHdbaV08PCIgIjsNCiAgLy8gIGNvdXQ8PGVuZGw7DQoNCiAgICBpbnQgYW5zID0gMCA7DQoNCiAgICBmb3IgKGludCBpID0gMDtpPGxlO2krKykNCiAgICAgICAgYW5zID0gbWF4KGFucyxod1tpXSAtMSk7DQogICAgZm9yIChpbnQgaSA9IDA7aTxsZTtpKyspDQogICAgICAgIGFucyA9IG1heChhbnMsamh3W2ldIC0xKTsNCg0KDQogICAgY291dDw8KChhbnM9PTEpPzA6YW5zKTw8ZW5kbDsNCg0KfQ0KaW50IG1haW4oKQ0Kew0KICAgIElPOw0KICAgIGludCB0bj0xOw0KICAgIGNpbj4+dG47DQogICAgd2hpbGUodG4tLSkNCiAgICB7DQogICAgICAgIHNvbHZlKCk7DQogICAgfQ0KICAgIHJldHVybiAwOw0KfQ0K"}]