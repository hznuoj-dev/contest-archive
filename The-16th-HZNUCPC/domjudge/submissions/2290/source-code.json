[{"id":"2290","submission_id":"2290","filename":"2.cpp","source":"I2luY2x1ZGUgPGlvc3RyZWFtPg0KI2luY2x1ZGUgPHF1ZXVlPg0KI2luY2x1ZGUgPHZlY3Rvcj4NCiNpbmNsdWRlIDxjc3RyaW5nPg0KI2luY2x1ZGUgPHN0YWNrPg0KI2luY2x1ZGUgPGFsZ29yaXRobT4NCiNkZWZpbmUgbWF4biAyMDAwMTANCiNkZWZpbmUgbWF4bSAyMDAwMTANCiNkZWZpbmUgbGwgbG9uZyBsb25nDQp1c2luZyBuYW1lc3BhY2Ugc3RkOw0KDQppbnQgbiwgbSwgazsNCg0KaW5saW5lIGludCB0cmFucyhpbnQgeCkgeyByZXR1cm4geCA+IG4gPyB4IC0gbiA6IHggKyBuOyB9DQoNCmludCBmYVttYXhuXTsNCnZvaWQgaW5pdF9mYShpbnQgbikgeyBmb3IgKGludCBpID0gMTsgaSA8PSBuOyArK2kpIGZhW2ldID0gaTsgfSANCmludCBmaW5kKGludCB4KSB7IHJldHVybiBmYVt4XSA9PSB4ID8geCA6IGZhW3hdID0gZmluZChmYVt4XSk7IH0gDQp2b2lkIG1lcmdlKGludCB4LCBpbnQgeSkgeyANCgl4ID0gZmluZCh4KSwgeSA9IGZpbmQoeSk7DQoJaWYgKHggPT0geSkgcmV0dXJuIDsNCglmYVt4XSA9IHk7DQp9DQoNCmJvb2wgdmlzW21heG5dOw0KdmVjdG9yPGludD4gQVttYXhuXTsgaW50IGFbbWF4bl07DQoNCmludCBmW21heG5dLCBnW21heG5dLCB0cFttYXhuXTsNCnN0cnVjdCBub2RlIHsgDQoJaW50IHByZSwgaWQsIGZsYWc7DQp9IGJbbWF4bl07DQp2b2lkIHdvcmsoKSB7IA0KCWZvciAoaW50IGkgPSAxOyBpIDw9IDIgKiBuOyArK2kpIEFbZmluZChpKV0ucHVzaF9iYWNrKGkpLCBhW2ZpbmQoaSldICs9IGkgPD0gbjsNCgl2ZWN0b3I8aW50PiB2ZWM7DQoJZm9yIChpbnQgaSA9IDE7IGkgPD0gMiAqIG47ICsraSkgeyANCgkJaWYgKHZpc1tpXSB8fCAhQVtpXS5zaXplKCkpIGNvbnRpbnVlOw0KCQl2ZWMucHVzaF9iYWNrKGkpOw0KCQl2aXNbZmluZCh0cmFucyhpKSldID0gMTsNCgl9IA0KCXNvcnQodmVjLmJlZ2luKCksIHZlYy5lbmQoKSwgW10oY29uc3QgaW50ICZ1LCBjb25zdCBpbnQgJnYpIHsNCgkJcmV0dXJuIEFbdV0uc2l6ZSgpIDwgQVt2XS5zaXplKCk7IA0KCX0pOw0KCWZbMF0gPSAxOyBpbnQgc3VtID0gMDsgIA0KCWZvciAoYXV0byBpIDogdmVjKSB7IA0KCQlmb3IgKGludCBqID0gMDsgaiA8PSBzdW07ICsraikgZ1tqXSA9IGZbal07DQoJCWludCB2ID0gYVtpXTsNCgkJZm9yIChpbnQgaiA9IDA7IGogPD0gc3VtOyArK2opIHsgIA0KCQkJaWYgKCFnW2pdIHx8IGZbaiArIHZdKSBjb250aW51ZTsgDQoJCQlmW2ogKyB2XSA9IDE7DQoJCQliW2ogKyB2XSA9IHsgaiwgaSwgMCB9Ow0KCQl9IHYgPSBBW2ldLnNpemUoKSAtIGFbaV07DQoJCWZvciAoaW50IGogPSAwOyBqIDw9IHN1bTsgKytqKSB7ICANCgkJCWlmICghZ1tqXSB8fCBmW2ogKyB2XSkgY29udGludWU7IA0KCQkJZltqICsgdl0gPSAxOw0KCQkJYltqICsgdl0gPSB7IGosIGksIDEgfTsNCgkJfQ0KCQlzdW0gKz0gQVtpXS5zaXplKCk7DQoJfQ0KCQ0KCWlmICghZltrXSkgcmV0dXJuIGNvdXQgPDwgIk5PIiA8PCAiXG4iLCB2b2lkKCk7DQoJaW50IG5vdyA9IGs7IHZlY3RvcjxpbnQ+IGFuczsNCgl3aGlsZSAobm93KSB7IA0KCQlub2RlIHQgPSBiW25vd107DQoJCWZvciAoYXV0byB1IDogQVt0LmlkXSkgDQoJCQlpZiAoIXQuZmxhZyAmJiB1IDw9IG4gfHwgdC5mbGFnICYmIHUgPiBuKSANCgkJCQlhbnMucHVzaF9iYWNrKHUgPiBuID8gdSAtIG4gOiB1KTsNCgkJbm93ID0gdC5wcmU7DQoJfQ0KCWNvdXQgPDwgIllFUyIgPDwgIlxuIjsNCglzb3J0KGFucy5iZWdpbigpLCBhbnMuZW5kKCkpOw0KCWZvciAoYXV0byB1IDogYW5zKSBjb3V0IDw8IHUgPDwgIiAiOyBjb3V0IDw8ICJcbiI7DQp9DQoNCmludCBtYWluKCkgeyANCglpb3M6OnN5bmNfd2l0aF9zdGRpbyhmYWxzZSk7DQoJY2luLnRpZShudWxscHRyKTsgY291dC50aWUobnVsbHB0cik7IA0KCQ0KCQ0KCWNpbiA+PiBuID4+IGsgPj4gbTsgaW5pdF9mYSgyICogbik7DQoJZm9yIChpbnQgaSA9IDE7IGkgPD0gbTsgKytpKSB7IA0KCQlpbnQgbywgeCwgeTsgY2luID4+IG8gPj4geCA+PiB5Ow0KCQltZXJnZSh4LCB5ICsgbyAqIG4pLCBtZXJnZSh4ICsgbiwgeSArIChvIF4gMSkgKiBuKTsNCgl9DQoJZm9yIChpbnQgaSA9IDE7IGkgPD0gbjsgKytpKQ0KCQlpZiAoZmluZChpKSA9PSBmaW5kKGkgKyBuKSkgcmV0dXJuIGNvdXQgPDwgIk5PIiA8PCAiXG4iLCAwOw0KCXdvcmsoKTsNCglyZXR1cm4gMDsgDQp9IA=="}]