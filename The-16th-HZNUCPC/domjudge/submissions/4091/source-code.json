[{"id":"4090","submission_id":"4091","filename":"G.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+DQojZGVmaW5lIGludCBpbnQ2NF90DQojZGVmaW5lIGVuZGwgJ1xuJw0KdXNpbmcgbmFtZXNwYWNlIHN0ZDsNCmNvbnN0IGludCBNQVggPSAyZTUrMTA7DQojZGVmaW5lIHBiIHB1c2hfYmFjaw0KDQppbnQgbm9kZXNbTUFYXTsNCmludCBmYXRbTUFYXTsNCg0KaW50IHJvb3QoaW50IHgpIHsNCglpZiAoZmF0W3hdID09IHgpIHJldHVybiB4Ow0KCXJldHVybiBmYXRbeF0gPSByb290KGZhdFt4XSk7IA0KfQ0KDQp2b2lkIG1lcmdlKGludCB4LCBpbnQgeSkgew0KCXggPSByb290KHgpOw0KCXkgPSByb290KHkpOw0KCWlmICh4ICE9IHkpIHsNCgkJbm9kZXNbeV0gKz0gbm9kZXNbeF07DQoJCWZhdFt4XSA9eTsNCgl9DQp9DQoNCnZlY3RvcjxpbnQ+IGFbTUFYXTsNCmludCBiW01BWF0gPSB7MH07DQppbnQgY1tNQVhdID0gezB9Ow0KYm9vbCBkcFtNQVhdID0gezB9Ow0KaW50IHByZVtNQVhdID0gezB9Ow0KaW50IG5vd1tNQVhdID0gezB9Ow0KaW50IGNudCA9IDA7DQoNCnZvaWQgc29sdmUoKSB7DQoJaW50IG4sIG0sIHE7DQoJY2luID4+IG4gPj4gcSA+PiBtOw0KCWZvciAoaW50IGkgPSAxOyBpIDw9IG47IGkrKykgew0KCQlmYXRbaV0gPSBpOw0KCQlub2Rlc1tpXSA9IDE7DQoJfQ0KCWZvciAoaW50IGkgPSBuICsgMTsgaSA8PSBuICogMjsgaSsrKSB7DQoJCWZhdFtpXSA9IGk7DQoJCW5vZGVzW2ldID0gMDsNCgl9DQoJZm9yIChpbnQgaSA9IDA7IGkgPCBtOyBpKyspIHsNCgkJaW50IGssIGEsIGI7DQoJCWNpbiA+PiBrID4+IGEgPj4gYjsNCgkJaWYgKGsgPT0gMCkgew0KCQkJbWVyZ2UoYSwgYik7DQoJCX0gZWxzZSB7DQoJCQltZXJnZShhICsgbiwgYik7DQoJCX0NCgl9DQoJZm9yIChpbnQgaSA9IDE7IGkgPD0gbjsgaSsrKSB7DQoJCWlmIChyb290KGkpID09IHJvb3QoaSArIG4pKSB7DQoJCQljb3V0IDw8ICJOTyIgPDwgZW5kbDsNCgkJCXJldHVybjsNCgkJfQ0KCX0NCglmb3IgKGludCBpID0gMTsgaSA8PSBuOyBpKyspIHsNCgkJaWYgKHJvb3QoaSkgPT0gaSkgew0KCQkJYVtub2Rlc1tpXV0ucGIoaSk7DQoJCX0NCgl9DQoJZm9yIChpbnQgaSA9IDE7IGkgPD0gbjsgaSsrKSB7DQoJCWludCBsZW4gPSBhW2ldLnNpemUoKTsNCgkJdmVjdG9yPGludD4gdmVjID0gYVtpXTsNCgkJYVtpXS5jbGVhcigpOw0KCQl3aGlsZSAobGVuKSB7DQoJCQlpbnQgayA9IHZlYy5iYWNrKCk7DQoJCQl2ZWMucG9wX2JhY2soKTsNCgkJCWZvciAoaW50IGogPSAobGVuICsgMSkgLyAyOyBqID4gMTsgai0tKSB7DQoJCQkJaW50IGtrID0gdmVjLmJhY2soKTsNCgkJCQl2ZWMucG9wX2JhY2soKTsNCgkJCQltZXJnZShraywgayk7DQoJCQl9DQoJCQlhWyhsZW4gKyAxKSAvIDIgKiBpXS5wYihrKTsNCgkJCWxlbiA+Pj0gMTsNCgkJfQ0KCX0NCglmb3IgKGludCBpID0gMTsgaSA8PSBuOyBpKyspIHsNCgkJd2hpbGUgKGFbaV0uc2l6ZSgpKSB7DQoJCQliW2NudF0gPSBpOw0KCQkJY1tjbnRdID0gYVtpXS5iYWNrKCk7DQoJCQljbnQrKzsNCgkJCWFbaV0ucG9wX2JhY2soKTsNCgkJfQ0KCX0NCglkcFswXSA9IHRydWU7DQoJcHJlWzBdID0gMDsNCglmb3IgKGludCBpID0gMDsgaSA8IGNudDsgaSsrKSB7DQoJCWZvciAoaW50IGogPSBxOyBqID49IGJbaV07IGotLSkgew0KCQkJaWYgKGRwW2otYltpXV0pIHsNCgkJCQlkcFtqXSA9IHRydWU7DQoJCQkJcHJlW2pdID0gai1iW2ldOw0KCQkJCW5vd1tqXSA9IGNbaV07DQoJCQl9DQoJCX0NCgl9DQoJaWYgKGRwW3FdKSB7DQoJCWNvdXQgPDwgIllFUyIgPDwgZW5kbDsNCgkJaW50IHggPSBxOw0KCQlzZXQ8aW50PiByZXM7DQoJCXdoaWxlICh4KSB7DQoJCQlyZXMuaW5zZXJ0KG5vd1t4XSk7DQoJCQl4ID0gcHJlW3hdOw0KCQl9DQoJCWZvciAoaW50IGkgPSAxOyBpIDw9IG47IGkrKykgew0KCQkJaWYgKHJlcy5jb3VudChyb290KGkpKSkgew0KCQkJCWNvdXQgPDwgaSA8PCAnICc7DQoJCQl9DQoJCX0NCgkJY291dCA8PCBlbmRsOw0KCX0gZWxzZSB7DQoJCWNvdXQgPDwgIk5PIiA8PCBlbmRsOw0KCX0NCn0NCg0KaW50MzJfdCBtYWluKCkgew0KCWNpbi50aWUoMCk7DQoJY291dC50aWUoMCk7DQoJaW9zOjpzeW5jX3dpdGhfc3RkaW8oZmFsc2UpOw0KCXNvbHZlKCk7DQoJcmV0dXJuIDA7DQp9DQoNCg0KDQoNCg0KDQoNCg=="}]