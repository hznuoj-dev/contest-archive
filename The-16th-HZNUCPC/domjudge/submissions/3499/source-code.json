[{"id":"3499","submission_id":"3499","filename":"G.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+DQoNCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQojZGVmaW5lIGxuICdcbicNCg0KY29uc3QgaW50IE4gPSAyZTUgKyA1Ow0KDQppbnQgZltOXSwgc2l6W05dLCBjb2xbTl0sIHdbTl0sIGlkW05dOw0KDQppbnQgZmluZChpbnQgeCkgew0KCWlmKGZbeF0gPT0geCkgcmV0dXJuIHg7DQoJaW50IHBhciA9IGZpbmQoZlt4XSk7DQoJY29sW3hdID0gY29sW2ZbeF1dIF4gd1t4XTsNCglyZXR1cm4gcGFyOw0KfQ0KDQpib29sIGFucyA9IHRydWU7DQoNCnZvaWQgbWVyZ2UoaW50IHgsIGludCB5LCBpbnQgVykgew0KCWludCBmeCA9IGZpbmQoeCksIGZ5ID0gZmluZCh5KTsNCglpZihmeCA9PSBmeSkgew0KCQlpZihjb2xbeF0gXiBjb2xbeV0gIT0gVykgYW5zID0gZmFsc2U7DQoJCXJldHVybjsNCgl9DQoJaWYoc2l6W2Z4XSA8IHNpeltmeV0pIA0KCQlzd2FwKHgsIHkpLCBzd2FwKGZ4LCBmeSk7DQoJDQoJc2l6W2Z4XSArPSBzaXpbZnldOw0KCWZbZnldID0gZng7DQoJd1tmeV0gPSBjb2xbeF0gXiBjb2xbeV0gXiBXOw0KCQ0KfQ0KDQppbmxpbmUgdm9pZCBzb2x2ZSgpIHsNCglpbnQgbiwgcSwgbTsNCgljaW4gPj4gbiA+PiBxID4+IG07DQoJZm9yKGludCBpID0gMTsgaSA8PSBuOyBpKyspIA0KCQlmW2ldID0gaSwgY29sW2ldID0gMCwgc2l6W2ldID0gMSwgd1tpXSA9IDA7DQoJZm9yKGludCBpID0gMTsgaSA8PSBtOyBpKyspIHsNCgkJaW50IHgsIHksIHc7DQoJCWNpbiA+PiB3ID4+IHggPj4geTsNCgkJbWVyZ2UoeCwgeSwgdyk7DQoJfQ0KCWlmKGFucyA9PSBmYWxzZSkgDQoJCXJldHVybiBjb3V0IDw8ICJOT1xuIiwgdm9pZCgpOw0KLy8JZWxzZSANCi8vCQljb3V0IDw8ICJZRVNcbiI7DQoJDQoJaW50IHRvdCA9IDA7DQoJZm9yKGludCBpID0gMTsgaSA8PSBuOyBpKyspIA0KCQlpZihmaW5kKGkpID09IGkpIGlkW2ldID0gKyt0b3Q7CQ0KCWZvcihpbnQgaSA9IDE7IGkgPD0gbjsgaSsrKSANCgkJaWRbaV0gPSBpZFtmaW5kKGkpXTsNCgkJDQoJdmVjdG9yPHZlY3RvcjxpbnQ+PiBnb29kKHRvdCArIDEpLCBiYWQodG90ICsgMSk7DQoJZm9yKGludCBpID0gMTsgaSA8PSBuOyBpKyspIHsNCgkJaWYoY29sW2ldID09IDApDQoJCQlnb29kW2lkW2ldXS5wdXNoX2JhY2soaSk7DQoJCWVsc2UNCgkJCWJhZFtpZFtpXV0ucHVzaF9iYWNrKGkpOw0KCX0NCgkNCglpbnQgbW4gPSBtaW4ocSwgbiAtIHEpOw0KCQ0KLy8JY291dCA8PCBtbiA8PCBsbjsNCgkNCgl2ZWN0b3I8Yml0c2V0PDEwMDAwNT4+IHAodG90ICsgMSk7DQoJcFswXVswXSA9IDE7DQoJZm9yKGludCBpID0gMTsgaSA8PSB0b3Q7IGkrKykgew0KLy8JCWNvdXQgPDwgZ29vZFtpXS5zaXplKCkgPDwgIiAiIDw8IGJhZFtpXS5zaXplKCkgPDwgbG47DQoJCXBbaV0gPSBwW2kgLSAxXSA8PCBnb29kW2ldLnNpemUoKTsNCgkJcFtpXSA9IHBbaV0gfCAocFtpIC0gMV0gPDwgYmFkW2ldLnNpemUoKSk7DQovLwkJY291dCA8PCBwW2ldIDw8IGxuOw0KCQkNCgl9DQoNCglpZihxID4gMTAwMDAwIHx8IHBbdG90XVtxXSA9PSAwKSByZXR1cm4gY291dCA8PCAiTk9cbiIsIHZvaWQoKTsNCgljb3V0IDw8ICJZRVNcbiI7DQoNCgl2ZWN0b3I8aW50PiBhbnNfZ29vZCwgYW5zX2JhZDsNCgkNCglmb3IoaW50IGkgPSB0b3Q7IGk7IGktLSkNCgkJaWYocSA+PSBnb29kW2ldLnNpemUoKSAmJiBwW2kgLSAxXVtxIC0gZ29vZFtpXS5zaXplKCldKSAgew0KCQkJcSAtPSBnb29kW2ldLnNpemUoKTsgDQoJCQlmb3IoYXV0byB4OiBnb29kW2ldKSBhbnNfZ29vZC5wdXNoX2JhY2soeCk7DQovLwkJCWZvcihhdXRvIHg6IGJhZFtpXSkgYW5zX2JhZC5wdXNoX2JhY2soeCk7DQoJCX0gZWxzZSBpZihxID49IGJhZFtpXS5zaXplKCkgJiYgcFtpIC0gMV1bcSAtIGJhZFtpXS5zaXplKCldKXsNCgkJCXEgLT0gYmFkW2ldLnNpemUoKTsNCgkJCWZvcihhdXRvIHg6IGJhZFtpXSkgYW5zX2dvb2QucHVzaF9iYWNrKHgpOw0KLy8JCQlmb3IoYXV0byB4OiBnb29kW2ldKSBhbnNfYmFkLnB1c2hfYmFjayh4KTsJDQoJCX0gZWxzZSB7DQoJCQlyZXR1cm4gY291dCA8PCAiTk9cbiIsIHZvaWQoKTsNCgkJfQ0KCQ0KLy8JZm9yKGludCBpID0gdG90OyBpOyBpLS0pDQovLwkJaWYobW4gPj0gZ29vZFtpXS5zaXplKCkgJiYgcFtpIC0gMV1bbW4gLSBnb29kW2ldLnNpemUoKV0pICB7DQovLwkJCW1uIC09IGdvb2RbaV0uc2l6ZSgpOw0KLy8JCQlmb3IoYXV0byB4OiBnb29kW2ldKSBhbnNfZ29vZC5wdXNoX2JhY2soeCk7DQovLwkJCWZvcihhdXRvIHg6IGJhZFtpXSkgYW5zX2JhZC5wdXNoX2JhY2soeCk7DQovLwkJfSBlbHNlIHsNCi8vCQkJbW4gLT0gYmFkW2ldLnNpemUoKTsNCi8vCQkJZm9yKGF1dG8geDogYmFkW2ldKSBhbnNfZ29vZC5wdXNoX2JhY2soeCk7DQovLwkJCWZvcihhdXRvIHg6IGdvb2RbaV0pIGFuc19iYWQucHVzaF9iYWNrKHgpOwkNCi8vCQl9DQoJDQoJc29ydChhbnNfZ29vZC5iZWdpbigpLCBhbnNfZ29vZC5lbmQoKSk7DQoJc29ydChhbnNfYmFkLmJlZ2luKCksIGFuc19iYWQuZW5kKCkpOw0KLy8JaWYoYW5zX2dvb2Quc2l6ZSgpID09IHEpIHsNCgkJZm9yKGF1dG8geDogYW5zX2dvb2QpIGNvdXQgPDwgeCA8PCAiICI7DQoJCWNvdXQgPDwgbG47DQovLwl9IGVsc2Ugew0KLy8JCWZvcihhdXRvIHg6IGFuc19iYWQpIGNvdXQgPDwgeCA8PCAiICI7DQovLwkJY291dCA8PCBsbjsNCi8vCX0NCn0NCg0KaW50IG1haW4oKSB7DQoJDQovLwlmcmVvcGVuKCIxLnR4dCIsICJyIiwgc3RkaW4pOw0KCQ0KCWlvczo6c3luY193aXRoX3N0ZGlvKGZhbHNlKTsNCgljaW4udGllKG51bGxwdHIpOw0KCQ0KCXNvbHZlKCk7DQp9DQoNCi8qDQoyIDEgMg0KMSAxIDINCjAgMiAxDQoNCjAgMCAxDQoxIDAgMA0KKi8NCg=="}]