[{"id":"2466","submission_id":"2466","filename":"111.cpp","source":"I2luY2x1ZGU8Yml0cy9zdGRjKysuaD4NCg0KI2RlZmluZSBsbCBsb25nIGxvbmcNCg0KdXNpbmcgbmFtZXNwYWNlIHN0ZDsNCg0KaW50IGRpcls0XVsyXT17ezEsMH0sey0xLDB9LHswLDF9LHswLC0xfX07DQppbnQgc1syNV1bMjVdOw0KYm9vbCB2aXNbMjVdWzI1XTsNCmJvb2wgdmlzc1syNV1bMjVdOw0KDQppbnQgZGZzMShpbnQgeCxpbnQgeSl7DQoJaW50IGFucz0wOw0KCXZpc1t4XVt5XT0xOw0KCWZvcihpbnQgaT0wO2k8NDtpKyspDQoJew0KCQlpbnQgdHg9ZGlyW2ldWzBdK3g7DQoJCWludCB0eT1kaXJbaV1bMV0reTsNCgkJaWYodHg+PTEmJnR4PD0xOSYmdHk+PTEmJnR5PD0xOSkNCgkJew0KCQkJaWYoc1t0eF1bdHldPT0wJiZ2aXNzW3R4XVt0eV09PTApDQoJCQl7DQoJCQkJYW5zKys7DQoJCQkJdmlzc1t0eF1bdHldPTE7DQoJCQl9DQoJCQllbHNlIGlmKHNbdHhdW3R5XT09MSYmdmlzW3R4XVt0eV09PTApDQoJCQl7DQoJCQkJYW5zKz1kZnMxKHR4LHR5KTsNCgkJCX0NCgkJfQ0KCX0NCglyZXR1cm4gYW5zOw0KfQ0KDQppbnQgZGZzMihpbnQgeCxpbnQgeSl7DQoJaW50IGFucz0wOw0KCXZpc1t4XVt5XT0xOw0KCWZvcihpbnQgaT0wO2k8NDtpKyspDQoJew0KCQlpbnQgdHg9ZGlyW2ldWzBdK3g7DQoJCWludCB0eT1kaXJbaV1bMV0reTsNCgkJaWYodHg+PTEmJnR4PD0xOSYmdHk+PTEmJnR5PD0xOSkNCgkJew0KCQkJaWYoc1t0eF1bdHldPT0wJiZ2aXNzW3R4XVt0eV09PTApDQoJCQl7DQoJCQkJYW5zKys7DQoJCQkJdmlzc1t0eF1bdHldPTE7DQoJCQl9DQoJCQllbHNlIGlmKHNbdHhdW3R5XT09MiYmdmlzW3R4XVt0eV09PTApDQoJCQl7DQoJCQkJYW5zKz1kZnMyKHR4LHR5KTsNCgkJCX0NCgkJfQ0KCX0NCglyZXR1cm4gYW5zOw0KfQ0KDQp2b2lkIGdvbmUxKGludCB4LGludCB5KXsNCglzW3hdW3ldPTA7DQoJZm9yKGludCBpPTA7aTw0O2krKykNCgl7DQoJCWludCB0eD1kaXJbaV1bMF0reDsNCgkJaW50IHR5PWRpcltpXVsxXSt5Ow0KCQlpZih0eD49MSYmdHg8PTE5JiZ0eT49MSYmdHk8PTE5KQ0KCQl7DQoJCQlpZihzW3R4XVt0eV09PTEpDQoJCQl7DQoJCQkJZ29uZTEodHgsdHkpOw0KCQkJfQ0KCQl9DQoJfQ0KCXJldHVybiA7DQp9DQoNCnZvaWQgZ29uZTIoaW50IHgsaW50IHkpew0KCXNbeF1beV09MDsNCglmb3IoaW50IGk9MDtpPDQ7aSsrKQ0KCXsNCgkJaW50IHR4PWRpcltpXVswXSt4Ow0KCQlpbnQgdHk9ZGlyW2ldWzFdK3k7DQoJCWlmKHR4Pj0xJiZ0eDw9MTkmJnR5Pj0xJiZ0eTw9MTkpDQoJCXsNCgkJCWlmKHNbdHhdW3R5XT09MikNCgkJCXsNCgkJCQlnb25lMih0eCx0eSk7DQoJCQl9DQoJCX0NCgl9DQoJcmV0dXJuIDsNCn0NCg0KaW50IG1haW4oKQ0Kew0KCWludCBUOw0KCXdoaWxlKH5zY2FuZigiJWQiLCZUKSkNCgl7DQoJCXdoaWxlKFQtLSkNCgkJew0KCQkJbWVtc2V0KHZpcywwLHNpemVvZih2aXMpKTsNCgkJCW1lbXNldChzLDAsc2l6ZW9mKHMpKTsNCgkJCWludCBuOw0KCQkJc2NhbmYoIiVkIiwmbik7DQoJCQlmb3IoaW50IGk9MDtpPG47aSsrKQ0KCQkJew0KCQkJCWludCB4LHksejsNCgkJCQlzY2FuZigiJWQgJWQgJWQiLCZ4LCZ5LCZ6KTsNCgkJCQlpZih4PDF8fHg+MTl8fHk8MXx8eT4xOXx8c1t4XVt5XSE9MCkNCgkJCQl7DQoJCQkJCWNvbnRpbnVlOw0KCQkJCSB9IA0KCQkJCXNbeF1beV09ejsNCgkJCQlpZih6PT0xKQ0KCQkJCXsNCgkJCQkJbWVtc2V0KHZpcywwLHNpemVvZih2aXMpKTsNCgkJCQkJbWVtc2V0KHZpc3MsMCxzaXplb2YodmlzcykpOw0KCQkJCQlpbnQgc3VtPWRmczEoeCx5KTsNCgkJCQkJaWYoc3VtPT0wKQ0KCQkJCQl7DQoJCQkJCQlzW3hdW3ldPTA7DQoJCQkJCX0NCgkJCQl9DQoJCQkJZWxzZSBpZih6PT0yKQ0KCQkJCXsNCgkJCQkJbWVtc2V0KHZpcywwLHNpemVvZih2aXMpKTsNCgkJCQkJbWVtc2V0KHZpc3MsMCxzaXplb2YodmlzcykpOw0KCQkJCQlpbnQgc3VtPWRmczIoeCx5KTsNCgkJCQkJaWYoc3VtPT0wKQ0KCQkJCQl7DQoJCQkJCQlzW3hdW3ldPTA7DQoJCQkJCX0NCgkJCQl9DQovLwkJCQkNCi8vCQkJCWZvcihpbnQgaT0xO2k8PTE5O2krKykNCi8vCQkJCXsNCi8vCQkJCQlmb3IoaW50IGo9MTtqPD0xOTtqKyspDQovLwkJCQkJew0KLy8JCQkJCQljb3V0PDxzW2ldW2pdPDwiICI7DQovLwkJCQkJfQ0KLy8JCQkJCWNvdXQ8PGVuZGw7DQovLwkJCQl9DQoJCQl9DQoJCQlpbnQgcmVzPTA7DQoJCQltZW1zZXQodmlzLDAsc2l6ZW9mKHZpcykpOw0KCQkJZm9yKGludCBpPTE7aTw9MTk7aSsrKQ0KCQkJew0KCQkJCWZvcihpbnQgaj0xO2o8PTE5O2orKykNCgkJCQl7DQoJCQkJCWlmKHNbaV1bal09PTEmJnZpc1tpXVtqXT09MCkNCgkJCQkJew0KCQkJCQkJbWVtc2V0KHZpc3MsMCxzaXplb2YodmlzcykpOw0KCQkJCQkJcmVzKz1kZnMxKGksaik7DQoJCQkJCX0NCgkJCQl9DQoJCQl9DQoJCQlwcmludGYoIiVkXG4iLHJlcyk7DQoJCX0NCgl9DQoJcmV0dXJuIDA7DQp9DQo="}]