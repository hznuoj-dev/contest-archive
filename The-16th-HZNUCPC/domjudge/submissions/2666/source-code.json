[{"id":"2666","submission_id":"2666","filename":"E.cpp","source":"I2luY2x1ZGU8Yml0cy9zdGRjKysuaD4NCiNkZWZpbmUgZW5kbCAnXG4nDQojZGVmaW5lIHBsbCBwYWlyPGxsLCBsbD4NCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQoNCnR5cGVkZWYgbG9uZyBsb25nIGxsOw0KY29uc3QgbGwgTiA9IDFlOSArIDc7DQpsbCBuOw0KcGxsIHBbMTA1XTsNCg0KbGwgZ2NkKGxsIHgsIGxsIHkpew0KCXJldHVybiB5ID09IDAgPyB4IDogZ2NkKHksIHggJSB5KTsNCn0NCg0KaW50IG1haW4oKSB7DQoJY2luID4+IG47DQoJZm9yIChpbnQgaSA9IDEsIHUsIHY7IGkgPD0gbjsgaSsrKXsNCgkJY2luID4+IHUgPj4gdjsNCgkJcFtpXSA9IHt1LCB2fTsNCgl9DQoJbGwgYW5zID0gMDsNCglmb3IgKGludCBpID0gMTsgaSA8PSBuIC0gMjsgKytpKSB7DQoJCWZvciAoaW50IGogPSBpICsgMTsgaiA8PSBuIC0gMTsgKytqKSB7DQoJCQlmb3IgKGludCBrID0gaiArIDE7IGsgPD0gbjsgKytrKSB7DQoJCQkJZG91YmxlIGExID0gc3FydCgoKHBbaV0uZmlyc3QgLSBwW2pdLmZpcnN0KSAqIChwW2ldLmZpcnN0IC0gcFtqXS5maXJzdCkpICsgKChwW2ldLnNlY29uZCAtIHBbal0uc2Vjb25kKSAqIChwW2ldLnNlY29uZCAtIHBbal0uc2Vjb25kKSkpOw0KCQkJCWRvdWJsZSBhMiA9IHNxcnQoKChwW2ldLmZpcnN0IC0gcFtrXS5maXJzdCkgKiAocFtpXS5maXJzdCAtIHBba10uZmlyc3QpKSArICgocFtpXS5zZWNvbmQgLSBwW2tdLnNlY29uZCkgKiAocFtpXS5zZWNvbmQgLSBwW2tdLnNlY29uZCkpKTsNCgkJCQlkb3VibGUgYTMgPSBzcXJ0KCgocFtrXS5maXJzdCAtIHBbal0uZmlyc3QpICogKHBba10uZmlyc3QgLSBwW2pdLmZpcnN0KSkgKyAoKHBba10uc2Vjb25kIC0gcFtqXS5zZWNvbmQpICogKHBba10uc2Vjb25kIC0gcFtqXS5zZWNvbmQpKSk7DQoJCQkJaWYgKGExICsgYTIgPiBhMyAmJiBmYWJzKGExIC0gYTIpIDwgYTMpew0KCQkJCQkvL2NvdXQgPDwgaSA8PCAiICIgPDwgaiA8PCAiICIgPDwgayA8PCBlbmRsOw0KCQkJCQlsbCBudW0gPSAwOw0KCQkJCQlsbCBpamYgPSBhYnMocFtpXS5maXJzdCAtIHBbal0uZmlyc3QpLCBpanMgPSBhYnMocFtpXS5zZWNvbmQgLSBwW2pdLnNlY29uZCk7DQoJCQkJCWxsIGlrZiA9IGFicyhwW2ldLmZpcnN0IC0gcFtrXS5maXJzdCksIGlrcyA9IGFicyhwW2ldLnNlY29uZCAtIHBba10uc2Vjb25kKTsNCgkJCQkJbGwga2pmID0gYWJzKHBba10uZmlyc3QgLSBwW2pdLmZpcnN0KSwga2pzID0gYWJzKHBba10uc2Vjb25kIC0gcFtqXS5zZWNvbmQpOw0KCQkJCQkvL2NvdXQgPDwgaWpmIDw8ICIgIiA8PCBpanMgPDwgZW5kbDsNCgkJCQkJLy9jb3V0IDw8IGlrZiA8PCAiICIgPDwgaWtzIDw8IGVuZGw7DQoJCQkJCS8vY291dCA8PCBramYgPDwgIiAiIDw8IGtqcyA8PCBlbmRsOw0KCQkJCQlpZiAobWluKGlqcywgaWpmKSA9PSAwKW51bSArPSBtYXgoaWpzLCBpamYpOw0KCQkJCQllbHNlIG51bSArPSBtYXgoaWpmLCBpanMpIC8gKG1heChpamYsIGlqcykgLyBnY2QoaWpmLCBpanMpKTsNCgkJCQkJaWYgKG1pbihpa3MsIGlrZikgPT0gMCludW0gKz0gbWF4KGlrcywgaWtmKTsNCgkJCQkJZWxzZSBudW0gKz0gbWF4KGlrZiwgaWtzKSAvIChtYXgoaWtmLCBpa3MpIC8gZ2NkKGlrZiwgaWtzKSk7DQoJCQkJCWlmIChtaW4oa2pzLCBramYpID09IDApbnVtICs9IG1heChranMsIGtqZik7DQoJCQkJCWVsc2UgbnVtICs9IG1heChramYsIGtqcykgLyAobWF4KGtqZiwga2pzKSAvIGdjZChramYsIGtqcykpOw0KCQkJCQkvL2NvdXQgPDwgbnVtIDw8IGVuZGw7DQoJCQkJCWFucyA9IG1heChhbnMsIG51bSk7DQoJCQkJfQ0KCQkJfQ0KCQl9DQoJfQ0KCWNvdXQgPDwgYW5zIDw8IGVuZGw7DQoJcmV0dXJuIDA7DQp9"}]