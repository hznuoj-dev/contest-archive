[{"id":"3408","submission_id":"3408","filename":"D.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+DQojZGVmaW5lIGxsIGludA0KI2RlZmluZSBNYSAxMDAwMDA1DQojZGVmaW5lIG1vZCAxMDAwMDAwMDA3DQojZGVmaW5lIE4gMjYNCiNkZWZpbmUgUExMIHBhaXI8bGwsbGw+DQojZGVmaW5lIGxzIHA8PDENCiNkZWZpbmUgcnMgcDw8MXwxDQojZGVmaW5lIGluZiAxZTkNCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQoNCmxsIG4sbSx4Ow0KbGwgcHBbTWFdOw0KDQoNCnN0cnVjdCBub2Rlew0KCWxsIHRpLGwscixudW07DQoJYm9vbCBvcGVyYXRvciA8KGNvbnN0IG5vZGUgJkEpY29uc3R7DQoJCWlmICh0aT09QS50aSkNCgkJCXJldHVybiBudW08QS5udW07DQoJCXJldHVybiB0aTxBLnRpOw0KCX0NCn1hW01hXTsNCmxsIHRvdD0wLGNudD0wOw0KDQpzdHJ1Y3Qgc2VndHJlZQ0Kew0KCWxsIGwscixtYSxtaSxhZGQ7DQp9dFtNYTw8Ml07DQoNCnZvaWQgYnVpbGQobGwgcCxsbCBsLGxsIHIpDQp7DQoJdFtwXS5sPWwsdFtwXS5yPXIsdFtwXS5tYT10W3BdLm1pPXRbcF0uYWRkPWluZjsNCglpZiAobD09cikNCgkJcmV0dXJuOw0KCWxsIG1pZD0obCtyKT4+MTsNCglidWlsZChscyxsLG1pZCksYnVpbGQocnMsbWlkKzEscik7DQoJcmV0dXJuOw0KfQ0KDQp2b2lkIHVwKGxsIHApDQp7DQoJLy9pZiAodFtwXS5hZGQ9PWluZikNCgl0W3BdLm1hPW1pbih0W3BdLm1hLG1heCh0W2xzXS5tYSx0W3JzXS5tYSkpOw0KCXRbcF0ubWk9bWluKHRbbHNdLm1pLHRbcnNdLm1pKTsNCglyZXR1cm47DQp9DQoNCnZvaWQgc3ByZWFkKGxsIHApDQp7DQoJaWYgKHRbcF0uYWRkIT1pbmYpDQoJew0KCQl0W2xzXS5tYT1taW4odFtsc10ubWEsdFtwXS5hZGQpOw0KCQl0W3JzXS5tYT1taW4odFtyc10ubWEsdFtwXS5hZGQpOw0KCQl0W2xzXS5taT1taW4odFtsc10ubWksdFtwXS5hZGQpOw0KCQl0W3JzXS5taT1taW4odFtyc10ubWksdFtwXS5hZGQpOw0KCQl0W2xzXS5hZGQ9bWluKHRbbHNdLmFkZCx0W3BdLmFkZCk7DQoJCXRbcnNdLmFkZD1taW4odFtyc10uYWRkLHRbcF0uYWRkKTsNCgkJdFtwXS5hZGQ9aW5mOw0KCX0NCglyZXR1cm47DQp9DQoNCnZvaWQgY2hhbmdlKGxsIHAsbGwgbCxsbCByLGxsIGQpDQp7DQoJaWYgKGw8PXRbcF0ubCYmdFtwXS5yPD1yKQ0KCXsNCgkJdFtwXS5tYT1taW4odFtwXS5tYSxkKTsNCgkJdFtwXS5taT1taW4odFtwXS5taSxkKTsNCgkJdFtwXS5hZGQ9bWluKHRbcF0uYWRkLGQpOw0KCQlyZXR1cm47DQoJfQ0KCXNwcmVhZChwKTsNCglsbCBtaWQ9KHRbcF0ubCt0W3BdLnIpPj4xOw0KCWlmIChsPD1taWQmJnRbbHNdLm1hPmQpIGNoYW5nZShscyxsLHIsZCk7DQoJaWYgKHI+bWlkJiZ0W3JzXS5tYT5kKSBjaGFuZ2UocnMsbCxyLGQpOw0KCXVwKHApOw0KCXJldHVybjsNCn0NCg0KbGwgYXNrKGxsIHAsbGwgbCxsbCByKQ0Kew0KCWlmIChsPD10W3BdLmwmJnRbcF0ucjw9cikgcmV0dXJuIHRbcF0ubWk7DQoJc3ByZWFkKHApOw0KCWxsIG1pZD0odFtwXS5sK3RbcF0ucik+PjE7DQoJbGwgdmFsPWluZjsNCglpZiAobDw9bWlkKSB2YWw9bWluKHZhbCxhc2sobHMsbCxyKSk7DQoJaWYgKHI+bWlkKSB2YWw9bWluKHZhbCxhc2socnMsbCxyKSk7DQoJcmV0dXJuIHZhbDsNCn0NCg0KbGwgYW5zW01hXTsNCg0Kdm9pZCBzb2woKQ0Kew0KCXNjYW5mKCIlZCVkJWQiLCZuLCZtLCZ4KTsNCglmb3IgKGxsIGk9MTtpPD1uO2krKykNCgkJdG90Kyssc2NhbmYoIiVkJWQlZCIsJmFbdG90XS50aSwmYVt0b3RdLmwsJmFbdG90XS5yKSxwcFsrK2NudF09YVt0b3RdLmwscHBbKytjbnRdPWFbdG90XS5yOw0KCWZvciAobGwgaT0xO2k8PW07aSsrKQ0KCQl0b3QrKyxzY2FuZigiJWQlZCIsJmFbdG90XS50aSwmYVt0b3RdLmwpLHBwWysrY250XT1hW3RvdF0ubCxhW3RvdF0ucj1hW3RvdF0ubCxhW3RvdF0ubnVtPWk7DQoJcHBbKytjbnRdPXg7DQoJDQoJc29ydChwcCsxLHBwK2NudCsxKTsNCglzb3J0KGErMSxhK3RvdCsxKTsNCgljbnQ9dW5pcXVlKHBwKzEscHArY250KzEpLShwcCsxKTsNCglidWlsZCgxLDEsY250KTsNCgkvL3ByaW50ZigiY250PSVkIHBtYT0lZFxuIixjbnQscHBbY250XSk7DQoJY2hhbmdlKDEsY250LGNudCwwKTsNCgkvL3ByaW50ZigiT0s6JWRcbiIsYXNrKDEsY250LGNudCkpOw0KCWZvciAobGwgaT0xO2k8PXRvdDtpKyspDQoJew0KCQlpZiAoYVtpXS5udW0pDQoJCXsNCgkJCWxsIGw9bG93ZXJfYm91bmQocHArMSxwcCtjbnQrMSxhW2ldLmwpLXBwLHI9bG93ZXJfYm91bmQocHArMSxwcCtjbnQrMSxhW2ldLnIpLXBwOw0KCQkJLy9wcmludGYoImdvIGw9JWQgcj0lZFxuIixwcFtsXSxwcFtyXSk7DQoJCQlsbCB3PWFzaygxLGwscik7DQoJCQlpZiAodz09aW5mKQ0KCQkJCWFuc1thW2ldLm51bV09LTE7DQoJCQllbHNlDQoJCQkJYW5zW2FbaV0ubnVtXT13Ow0KCQl9DQoJCWVsc2UNCgkJew0KCQkJbGwgbD1sb3dlcl9ib3VuZChwcCsxLHBwK2NudCsxLGFbaV0ubCktcHAscj1sb3dlcl9ib3VuZChwcCsxLHBwK2NudCsxLGFbaV0uciktcHA7DQoJCQkvL3ByaW50ZigiY2hhbmdlIGw9JWQgcj0lZFxuIixwcFtsXSxwcFtyXSk7DQoJCQlsbCB3PWFzaygxLGwscikrMTsNCgkJCS8vcHJpbnRmKCJ3PSVkXG4iLHcpOw0KCQkJY2hhbmdlKDEsbCxyLHcpOw0KCQl9DQoJfQ0KCWZvciAobGwgaT0xO2k8PW07aSsrKQ0KCQlwcmludGYoIiVkXG4iLGFuc1tpXSk7DQoJcmV0dXJuOw0KfQ0KDQppbnQgbWFpbiAoKQ0Kew0KCXNvbCgpOw0KCXJldHVybiAwOw0KfQ=="}]