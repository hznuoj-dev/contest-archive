[{"id":"2737","submission_id":"2737","filename":"D.cpp","source":"I2luY2x1ZGU8Yml0cy9zdGRjKysuaD4NCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQp0eXBlZGVmIGxvbmcgbG9uZyBsbDsNCnR5cGVkZWYgcGFpcjxpbnQsaW50PiBwaWk7DQpjb25zdCBpbnQgaW5mID0gMHgzZjNmM2YzZiwgTiA9IDVlNSArIDEwOw0KDQppbnQgc3VtW04gPDwgMl0sIGx6W04gPDwgMl0sIGx6MVtOIDw8IDJdOw0KDQp2b2lkIGFwcGx5KGludCBrLCBpbnQgbGF6eSwgaW50IGxhenkxKXsNCglzdW1ba10gKz0gbGF6eTsNCglseltrXSArPSBsYXp5Ow0KCXN1bVtrXSA9IG1pbihzdW1ba10sIGxhenkxKTsNCglsejFba10gPSBtaW4obHoxW2tdLCBsYXp5MSk7DQp9DQoNCnZvaWQgcGQoaW50IGspew0KCWFwcGx5KGsgPDwgMSwgbHpba10sIGx6MVtrXSk7DQoJYXBwbHkoayA8PCAxIHwgMSwgbHpba10sIGx6MVtrXSk7DQoJbHpba10gPSAwOw0KCWx6MVtrXSA9IGluZjsNCn0NCg0Kdm9pZCBidWlsZChpbnQgaywgaW50IGwsIGludCByLCBpbnQgeCl7DQoJbHpba10gPSAwOw0KCWx6MVtrXSA9IGluZjsNCglpZihsID09IHIpew0KCQlpZihsID09IHgpew0KCQkJc3VtW2tdID0gMDsNCgkJfWVsc2V7DQoJCQlzdW1ba10gPSBpbmY7DQoJCX0NCgkJcmV0dXJuOw0KCX0NCglpbnQgbWlkID0gKGwgKyByKSA+PiAxOw0KCWJ1aWxkKGsgPDwgMSwgbCwgbWlkLCB4KTsNCglidWlsZChrIDw8IDEgfCAxLCBtaWQgKyAxLCByLCB4KTsNCglzdW1ba10gPSBtaW4oc3VtW2sgPDwgMV0sIHN1bVtrIDw8IDEgfCAxXSk7DQp9DQoNCnZvaWQgdXBkKGludCBrLCBpbnQgbCwgaW50IHIsIGludCBxbCwgaW50IHFyLCBpbnQgeCl7DQoJaWYobCA+IHFyIHx8IHIgPCBxbCkgcmV0dXJuOw0KCWlmKGwgPj0gcWwgJiYgciA8PSBxcil7DQoJCXN1bVtrXSArPSB4Ow0KCQlseltrXSArPSB4Ow0KCQlsejFba10gKz0geDsNCgkJcmV0dXJuOw0KCX0NCglwZChrKTsNCglpbnQgbWlkID0gKGwgKyByKSA+PiAxOw0KCXVwZChrIDw8IDEsIGwsIG1pZCwgcWwsIHFyLCB4KTsNCgl1cGQoayA8PCAxIHwgMSwgbWlkICsgMSwgciwgcWwsIHFyLCB4KTsNCglzdW1ba10gPSBtaW4oc3VtW2sgPDwgMV0sIHN1bVtrIDw8IDEgfCAxXSk7DQp9DQoNCnZvaWQgdXBkMShpbnQgaywgaW50IGwsIGludCByLCBpbnQgcWwsIGludCBxciwgaW50IHgpew0KCWlmKGwgPiBxciB8fCByIDwgcWwpIHJldHVybjsNCglpZihsID49IHFsICYmIHIgPD0gcXIpew0KCQlzdW1ba10gPSBtaW4oc3VtW2tdLCB4KTsNCgkJbHoxW2tdID0gbWluKGx6MVtrXSwgeCk7DQoJCXJldHVybjsNCgl9DQoJcGQoayk7DQoJaW50IG1pZCA9IChsICsgcikgPj4gMTsNCgl1cGQxKGsgPDwgMSwgbCwgbWlkLCBxbCwgcXIsIHgpOw0KCXVwZDEoayA8PCAxIHwgMSwgbWlkICsgMSwgciwgcWwsIHFyLCB4KTsNCglzdW1ba10gPSBtaW4oc3VtW2sgPDwgMV0sIHN1bVtrIDw8IDEgfCAxXSk7DQp9DQoNCmludCBxcnkoaW50IGssIGludCBsLCBpbnQgciwgaW50IHB4KXsNCglpZihsID09IHIpew0KCQlyZXR1cm4gc3VtW2tdOw0KCX0NCglwZChrKTsNCglpbnQgbWlkID0gKGwgKyByKSA+PiAxOw0KCWlmKHB4IDw9IG1pZCl7DQoJCXJldHVybiBxcnkoayA8PCAxLCBsLCBtaWQsIHB4KTsNCgl9ZWxzZXsNCgkJcmV0dXJuIHFyeShrIDw8IDEgfCAxLCBtaWQgKyAxLCByLCBweCk7DQoJfQ0KfQ0KDQp2ZWN0b3I8aW50PiBudW07DQoNCmludCBnZXQoaW50IHgpew0KCXJldHVybiBsb3dlcl9ib3VuZChudW0uYmVnaW4oKSwgbnVtLmVuZCgpLCB4KSAtIG51bS5iZWdpbigpICsgMTsNCn0NCg0Kc3RydWN0IFFyeXsNCglpbnQgYywgcCwgaWQ7DQoJDQoJYm9vbCBvcGVyYXRvciA8IChjb25zdCBRcnkgJnBpKSBjb25zdHsNCgkJcmV0dXJuIGMgPiBwaS5jOw0KCX0NCn1hW05dOw0KDQpzdHJ1Y3Qgbm9kZXsNCglpbnQgdCwgbCwgcjsNCgkNCglib29sIG9wZXJhdG9yIDwgKGNvbnN0IG5vZGUgJnBpKSBjb25zdHsNCgkJcmV0dXJuIHQgPiBwaS50Ow0KCX0NCn1iW05dOw0KDQppbnQgYW5zW05dOw0KDQp2b2lkIGthaWJhaSgpew0KCWludCBuLCBtLCB4Ow0KCWNpbiA+PiBuID4+IG0gPj4geDsNCgludW0ucHVzaF9iYWNrKHgpOw0KCWZvcihpbnQgaSA9IDEsIHQsIGwsIHI7IGkgPD0gbjsgaSsrKXsNCgkJY2luID4+IHQgPj4gbCA+PiByOw0KCQliW2ldID0ge3QsIGwsIHJ9Ow0KCQludW0ucHVzaF9iYWNrKGwpOw0KCQludW0ucHVzaF9iYWNrKHIpOw0KCX0NCglmb3IoaW50IGkgPSAxLCBjLCBwOyBpIDw9IG07IGkrKyl7DQoJCWNpbiA+PiBjID4+IHA7DQoJCWFbaV0gPSB7YywgcCwgaX07DQoJCW51bS5wdXNoX2JhY2socCk7DQoJfQ0KCXNvcnQobnVtLmJlZ2luKCksIG51bS5lbmQoKSk7DQoJbnVtLmVyYXNlKHVuaXF1ZShudW0uYmVnaW4oKSwgbnVtLmVuZCgpKSwgbnVtLmVuZCgpKTsNCglzb3J0KGEgKyAxLCBhICsgMSArIG0pOw0KCXNvcnQoYiArIDEsIGIgKyAxICsgbik7DQoJaW50IGxlbiA9IG51bS5zaXplKCksIGx0ID0gMTsNCglmb3IoaW50IGkgPSAxOyBpIDw9IG47IGkrKyl7DQoJCWJbaV0ubCA9IGdldChiW2ldLmwpOw0KCQliW2ldLnIgPSBnZXQoYltpXS5yKTsNCgl9DQoJZm9yKGludCBpID0gMTsgaSA8PSBtOyBpKyspew0KCQlhW2ldLnAgPSBnZXQoYVtpXS5wKTsNCgl9DQoJYnVpbGQoMSwgMSwgbGVuLCBnZXQoeCkpOw0KCXByaW9yaXR5X3F1ZXVlPHBpaT4gcTsNCglpbnQgbGVmdCA9IGdldCh4KTsNCglmb3IoaW50IGkgPSAxOyBpIDw9IG07IGkrKyl7DQoJCXdoaWxlKGx0IDw9IG4gJiYgYltsdF0udCA+PSBhW2ldLmMpew0KCQkJcS5wdXNoKHtiW2x0XS5yLCBiW2x0XS5sfSk7DQoJCQlsdCsrOw0KCQl9DQoJCXdoaWxlKCFxLmVtcHR5KCkpew0KCQkJaW50IHIgPSBxLnRvcCgpLmZpcnN0LCBsID0gcS50b3AoKS5zZWNvbmQ7DQoJCQlpZihyIDwgbGVmdCl7DQoJCQkJYnJlYWs7DQoJCQl9DQoJCQlxLnBvcCgpOw0KCQkJaW50IHBpID0gcXJ5KDEsIDEsIGxlbiwgcik7DQoJCQlpbnQgcWkgPSBxcnkoMSwgMSwgbGVuLCBsKTsNCgkJCXVwZDEoMSwgMSwgbGVuLCBsLCByLCBwaSArIDEpOw0KCQkJaWYobGVmdCA8PSBsIC0gMSAmJiBwaSArIDIgLSBxaSA8IDApew0KCQkJCXVwZCgxLCAxLCBsZW4sIGxlZnQsIGwgLSAxLCBwaSArIDIgLSBxaSk7DQoJCQl9DQoJCQlsZWZ0ID0gbWluKGxlZnQsIGwpOw0KCQl9DQoJCWFuc1thW2ldLmlkXSA9IHFyeSgxLCAxLCBsZW4sIGFbaV0ucCk7DQoJfQ0KCWZvcihpbnQgaSA9IDE7IGkgPD0gbTsgaSsrKXsNCgkJaWYoYW5zW2ldID09IGluZikgYW5zW2ldID0gLTE7DQoJCWNvdXQgPDwgYW5zW2ldIDw8ICdcbic7DQoJfQ0KfQ0KLyoNCjYgMyAxMA0KMSAxIDEwDQoyIDMgNg0KMyA1IDkNCjQgNyAxMA0KNSAzIDgNCjYgNyAxMA0KMSAxDQoyIDQNCjYgNQ0KDQozIDMgMTANCjEgMyA4DQoyIDEgMg0KMyA3IDEwDQoxIDcNCjEgMSANCjEgOQ0KDQo1IDMgOQ0KMSAyIDgNCjIgMSAzDQozIDMgNQ0KNCA1IDcNCjUgNyA5DQoxIDENCjIgMQ0KMSAyDQoNCiovDQoNCmludCBtYWluKHZvaWQpew0KCWludCBUPTE7DQoJaW9zOjpzeW5jX3dpdGhfc3RkaW8oZmFsc2UpOw0KCWNpbi50aWUobnVsbHB0cik7DQovLwljaW4gPj4gVDsNCgl3aGlsZShULS0pew0KCQlrYWliYWkoKTsNCgl9DQp9"}]