[{"id":"3989","submission_id":"3989","filename":"G.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+DQoNCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQojZGVmaW5lIGxuICdcbicNCg0KY29uc3QgaW50IE49MWU1KzU7DQoNCmludCBmW05dLHNpeltOXSxjb2xbTl0sd1tOXSxpZFtOXTsNCg0KaW50IGZpbmQoaW50IHgpIHsNCglpZihmW3hdID09IHgpIHJldHVybiB4Ow0KCWludCBwYXIgPSBmaW5kKGZbeF0pOw0KCWNvbFt4XSA9IGNvbFtmW3hdXSBeIHdbeF07DQoJcmV0dXJuIHBhcjsNCn0NCg0KYm9vbCBhbnMgPSB0cnVlOw0KDQp2b2lkIG1lcmdlKGludCB4LCBpbnQgeSwgaW50IFcpIHsNCglpbnQgZnggPSBmaW5kKHgpLCBmeSA9IGZpbmQoeSk7DQoJaWYoZnggPT0gZnkpIHsNCgkJaWYoKGNvbFt4XSBeIGNvbFt5XSkgIT0gVykgYW5zID0gZmFsc2U7DQoJCXJldHVybjsNCgl9DQoJaWYoc2l6W2Z4XSA8IHNpeltmeV0pIA0KCQlzd2FwKHgsIHkpLCBzd2FwKGZ4LCBmeSk7DQoJDQoJc2l6W2Z4XSArPSBzaXpbZnldOw0KCWZbZnldID0gZng7DQoJd1tmeV0gPSBjb2xbeF0gXiBjb2xbeV0gXiBXOw0KCQ0KfQ0KDQp2ZWN0b3I8aW50PiBhbnNfZ29vZDsNCnZlY3RvcjxpbnQ+IGdvb2RbTl0sIGJhZFtOXTsNCmJpdHNldDwxMDAwMDU+IHBbTl07DQoNCmlubGluZSB2b2lkIHNvbHZlKCkgew0KCWludCBuLHEsbTsNCglzY2FuZigiJWQlZCVkIiwgJm4sICZxLCAmbSk7DQoJZm9yKGludCBpID0gMTsgaSA8PSBuOyBpKyspIA0KCQlmW2ldID0gaSwgY29sW2ldID0gMCwgc2l6W2ldID0gMSwgd1tpXSA9IDA7DQoJZm9yKGludCBpID0gMTsgaSA8PSBtOyBpKyspIHsNCgkJaW50IHgsIHksIHc7DQoJCXNjYW5mKCIlZCVkJWQiLCAmdywgJngsICZ5KTsNCgkJaWYgKHg9PXkpew0KCQkJaWYgKHcpew0KCQkJCXB1dHMoIk5PIik7DQoJCQkJcmV0dXJuOw0KCQkJfQ0KCQkJY29udGludWU7DQoJCX0NCgkJbWVyZ2UoeCwgeSwgdyk7DQoJfQ0KCQ0KCWlmIChhbnMgPT0gZmFsc2Upew0KCQlwdXRzKCJOTyIpOw0KCQlyZXR1cm47DQoJfQ0KDQoJaW50IHRvdCA9IDA7DQoJZm9yKGludCBpID0gMTsgaSA8PSBuOyBpKyspIA0KCQlpZihmaW5kKGkpID09IGkpIGlkW2ldID0gKyt0b3Q7CQ0KCWZvcihpbnQgaSA9IDE7IGkgPD0gbjsgaSsrKSANCgkJaWRbaV0gPSBpZFtmaW5kKGkpXTsNCgkJDQoNCglmb3IoaW50IGkgPSAxOyBpIDw9IG47IGkrKykgew0KCQlpZihjb2xbaV0gPT0gMCkNCgkJCWdvb2RbaWRbaV1dLnB1c2hfYmFjayhpKTsNCgkJZWxzZQ0KCQkJYmFkW2lkW2ldXS5wdXNoX2JhY2soaSk7DQoJfQ0KCQ0KCXBbMF1bMF0gPSAxOw0KCWZvcihpbnQgaSA9IDE7IGkgPD0gdG90OyBpKyspDQoJCXBbaV0gPSAoIChwW2kgLSAxXSA8PCBnb29kW2ldLnNpemUoKSkgfCAocFtpIC0gMV0gPDwgYmFkW2ldLnNpemUoKSkgKTsNCg0KCWlmKHEgPiAxMDAwMDAgfHwgcFt0b3RdW3FdID09IDApew0KCQlwdXRzKCJOTyIpOw0KCQlyZXR1cm47DQoJfQ0KCQ0KCQ0KCWZvcihpbnQgaSA9IHRvdDsgaTsgaS0tKQ0KCQlpZihxID49IChpbnQpZ29vZFtpXS5zaXplKCkgJiYgcFtpIC0gMV1bcSAtIGdvb2RbaV0uc2l6ZSgpXSkgIHsNCgkJCXEgLT0gZ29vZFtpXS5zaXplKCk7IA0KCQkJZm9yKGF1dG8geDogZ29vZFtpXSkgYW5zX2dvb2QucHVzaF9iYWNrKHgpOw0KCQl9IGVsc2UgaWYgKHEgPj0gKGludCliYWRbaV0uc2l6ZSgpICYmIHBbaSAtIDFdW3EgLSBiYWRbaV0uc2l6ZSgpXSl7DQoJCQlxIC09IGJhZFtpXS5zaXplKCk7DQoJCQlmb3IoYXV0byB4OiBiYWRbaV0pIGFuc19nb29kLnB1c2hfYmFjayh4KTsNCgkJfSBlbHNlIHsNCgkJCXB1dHMoIk5PIik7DQoJCQlyZXR1cm47DQoJCX0NCglwdXRzKCJZRVMiKTsNCglzb3J0KGFuc19nb29kLmJlZ2luKCksIGFuc19nb29kLmVuZCgpKTsNCglmb3IoYXV0byB4OiBhbnNfZ29vZCkgDQoJCXByaW50ZigiJWQgIiwgeCk7DQp9DQoNCmludCBtYWluKCkgew0KCXNvbHZlKCk7DQoJcmV0dXJuIDA7DQp9"}]