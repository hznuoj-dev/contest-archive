[{"id":"3881","submission_id":"3881","filename":"D.cpp","source":"I2luY2x1ZGU8Yml0cy9zdGRjKysuaD4NCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQoNCnR5cGVkZWYgbG9uZyBsb25nIGxsOw0KY29uc3QgaW50IE4gPSA1ZTUgKyA1Ow0KaW50IG4sIG0sIFg7DQpzdHJ1Y3QgcXVlIHsNCglpbnQgdCwgbCwgciwgeCwgb3AsIGlkLCBhbnM7DQoJYm9vbCBvcGVyYXRvciA8IChjb25zdCBxdWUgJmEpY29uc3Qgew0KCQlpZih0ID09IGEudCkgew0KCQkJaWYob3AgIT0gYS5vcCkgcmV0dXJuIG9wIDwgYS5vcDsNCgkJCWVsc2UgcmV0dXJuIG1pbihhYnMoWCAtIGwpLCBhYnMoWCAtIHIpKSA8IG1pbihhYnMoWCAtIGwpLCBhYnMoWCAtIHIpKTsNCgkJfQ0KCQllbHNlIHJldHVybiAodCA+IGEudCk7DQoJfQ0KfWFbTl07DQppbnQgaGFoW05dLCB0b3Q7DQpzdHJ1Y3QgdHJlZSB7DQoJaW50IG1uLCB0YWc7DQp9dFtOIDw8IDJdOw0Kdm9pZCBwdXNodXAoaW50IGspIHsNCgl0W2tdLm1uID0gbWluKHRbayA8PCAxXS5tbiwgdFtrIDw8IDEgfCAxXS5tbik7DQp9DQp2b2lkIGJ1aWxkKGludCBrLCBpbnQgbCwgaW50IHIpIHsNCglpZihsID09IHIpIHsNCgkJdFtrXS5tbiA9IDExNDUxNDsNCgkJcmV0dXJuOw0KCX0NCglpbnQgbWlkID0gbCArIHIgPj4gMTsNCglidWlsZChrIDw8IDEsIGwsIG1pZCk7DQoJYnVpbGQoayA8PCAxIHwgMSwgbWlkICsgMSwgcik7DQoJcHVzaHVwKGspOw0KfQ0Kdm9pZCBwdXNoZG93bihpbnQgaywgaW50IGwsIGludCByKSB7DQoJaW50IHRhZyA9IHRba10udGFnOyB0W2tdLnRhZyA9IDA7DQoJaWYoIXRhZyB8fCBsID09IHIpIHJldHVybjsNCgl0W2sgPDwgMV0ubW4gPSBtaW4odFtrIDw8IDFdLm1uLCB0YWcpOw0KCXRbayA8PCAxIHwgMV0ubW4gPSBtaW4odFtrIDw8IDEgfCAxXS5tbiwgdGFnKTsNCglpZih0W2sgPDwgMV0udGFnICE9IDApIHRbayA8PCAxXS50YWcgPSBtaW4odFtrIDw8IDFdLnRhZywgdGFnKTsNCgllbHNlIHRbayA8PCAxXS50YWcgPSB0YWc7DQoJaWYodFtrIDw8IDEgfCAxXS50YWcgIT0gMCkgdFtrIDw8IDEgfCAxXS50YWcgPSBtaW4odFtrIDw8IDEgfCAxXS50YWcsIHRhZyk7DQoJZWxzZSB0W2sgPDwgMSB8IDFdLnRhZyA9IHRhZzsNCn0NCnZvaWQgdXBkYXRlKGludCBrLCBpbnQgbCwgaW50IHIsIGludCB4LCBpbnQgeSwgaW50IHZhbCkgew0KCXB1c2hkb3duKGssIGwsIHIpOw0KCWlmKGwgPT0geCAmJiByID09IHkpIHsNCgkJdFtrXS5tbiA9IG1pbih0W2tdLm1uLCB2YWwpOw0KCQl0W2tdLnRhZyA9IHZhbDsNCgkJcmV0dXJuOw0KCX0NCglpbnQgbWlkID0gbCArIHIgPj4gMTsNCglpZih5IDw9IG1pZCkgdXBkYXRlKGsgPDwgMSwgbCwgbWlkLCB4LCB5LCB2YWwpOw0KCWVsc2UgaWYoeCA+IG1pZCkgdXBkYXRlKGsgPDwgMSB8IDEsIG1pZCArIDEsIHIsIHgsIHksIHZhbCk7DQoJZWxzZSB7DQoJCXVwZGF0ZShrIDw8IDEsIGwsIG1pZCwgeCwgbWlkLCB2YWwpOw0KCQl1cGRhdGUoayA8PCAxIHwgMSwgbWlkICsgMSwgciwgbWlkICsgMSwgeSwgdmFsKTsNCgl9DQoJcHVzaHVwKGspOw0KfQ0KaW50IHF1ZXJ5KGludCBrLCBpbnQgbCwgaW50IHIsIGludCB4LCBpbnQgeSkgew0KCWlmKGwgPT0geCAmJiByID09IHkpIHJldHVybiB0W2tdLm1uOw0KCXB1c2hkb3duKGssIGwsIHIpOw0KCWludCBtaWQgPSBsICsgciA+PiAxOw0KCWlmKHkgPD0gbWlkKSByZXR1cm4gcXVlcnkoayA8PCAxLCBsLCBtaWQsIHgsIHkpOw0KCWVsc2UgaWYoeCA+IG1pZCkgcmV0dXJuIHF1ZXJ5KGsgPDwgMSB8IDEsIG1pZCArIDEsIHIgLCB4LCB5KTsNCgllbHNlIHJldHVybiBtaW4ocXVlcnkoayA8PCAxLCBsLCBtaWQsIHgsIG1pZCksIHF1ZXJ5KGsgPDwgMSB8IDEsIG1pZCArIDEsIHIsIG1pZCArIDEsIHkpKTsNCn0NCmludCBjbXAocXVlIHgsIHF1ZSB5KSB7DQoJcmV0dXJuIHguaWQgPCB5LmlkOw0KfQ0KaW50IG1haW4oKSB7DQoJaW9zIDo6IHN5bmNfd2l0aF9zdGRpbyhmYWxzZSk7DQoJY2luID4+IG4gPj4gbSA+PiBYOw0KCWhhaFt0b3QgPSAxXSA9IFg7DQoJZm9yKGludCBpID0gMTsgaSA8PSBuOyBpKyspIHsNCgkJY2luID4+IGFbaV0udCA+PiBhW2ldLmwgPj4gYVtpXS5yOw0KCQlhW2ldLmlkID0gbSArIDE7DQoJCWFbaV0ub3AgPSAwOw0KCQloYWhbKyt0b3RdID0gYVtpXS5sOw0KCQloYWhbKyt0b3RdID0gYVtpXS5yOw0KCX0NCglpbnQgY250ID0gbjsNCglmb3IoaW50IGkgPSAxOyBpIDw9IG07IGkrKykgew0KCQkrK2NudDsNCgkJY2luID4+IGFbY250XS50ID4+IGFbY250XS54Ow0KCQlhW2NudF0ub3AgPSAxOw0KCQlhW2NudF0uaWQgPSBpOw0KCQloYWhbKyt0b3RdID0gYVtjbnRdLng7DQoJfQ0KCXNvcnQoYSArIDEsIGEgKyAxICsgY250KTsNCglzb3J0KGhhaCArIDEsIGhhaCArIDEgKyB0b3QpOw0KCXRvdCA9IHVuaXF1ZShoYWggKyAxLCBoYWggKyAxICsgdG90KSAtIGhhaCAtIDE7DQoNCi8qCWNvdXQgPDwgdG90IDw8ICJcbiI7DQoJZm9yKGludCBpID0gMTsgaSA8PSB0b3Q7IGkrKykNCgkJY291dCA8PCBoYWhbaV0gPDwgIiAiOw0KCWNvdXQgPDwgIlxuIjsqLw0KCQ0KCVggPSBsb3dlcl9ib3VuZChoYWggKyAxLCBoYWggKyAxICsgdG90LCBYKSAtIGhhaDsNCglmb3IoaW50IGkgPSAxOyBpIDw9IGNudDsgaSsrKSB7DQoJLy8JY291dCA8PCBhW2ldLm9wIDw8ICIgIiA8PCBhW2ldLnQgPDwgIiAiIDw8IGFbaV0ubCA8PCAiICIgPDwgYVtpXS5yIDw8ICIgIiA8PCBhW2ldLng7DQoJLy8JY291dCA8PCAiXG4iOw0KCQlpZihhW2ldLm9wKSB7DQoJCQlhW2ldLnggPSBsb3dlcl9ib3VuZChoYWggKyAxLCBoYWggKyAxICsgdG90LCBhW2ldLngpIC0gaGFoOw0KCQl9ZWxzZSB7DQoJCQlhW2ldLmwgPSBsb3dlcl9ib3VuZChoYWggKyAxLCBoYWggKyAxICsgdG90LCBhW2ldLmwpIC0gaGFoOw0KCQkJYVtpXS5yID0gbG93ZXJfYm91bmQoaGFoICsgMSwgaGFoICsgMSArIHRvdCwgYVtpXS5yKSAtIGhhaDsNCgkJfQ0KCX0NCglidWlsZCgxLCAxLCB0b3QpOw0KCXVwZGF0ZSgxLCAxLCB0b3QsIFgsIFgsIDApOw0KLy8JY291dCA8PCBxdWVyeSgxLCAxLCB0b3QsIDEsIHRvdCkgPDwgIlxuIjsNCglmb3IoaW50IGkgPSAxOyBpIDw9IGNudDsgaSsrKSB7DQoJCWlmKGFbaV0ub3AgPT0gMCkgew0KCQkJaW50IG1uID0gcXVlcnkoMSwgMSwgdG90LCBhW2ldLmwsIGFbaV0ucikgKyAxOw0KCQkJdXBkYXRlKDEsIDEsIHRvdCwgYVtpXS5sLCBhW2ldLnIsIG1uKTsNCgkJfWVsc2Ugew0KCQkJYVtpXS5hbnMgPSBxdWVyeSgxLCAxLCB0b3QsIGFbaV0ueCwgYVtpXS54KTsNCgkJfQ0KCX0NCglzb3J0KGEgKyAxLCBhICsgMSArIGNudCwgY21wKTsNCglmb3IoaW50IGkgPSAxOyBpIDw9IG07IGkrKykgew0KCQlpZihhW2ldLmFucyA+IG4pIGNvdXQgPDwgIi0xXG4iOw0KCQllbHNlIGNvdXQgPDwgYVtpXS5hbnMgPDwgIlxuIjsNCgl9DQoJcmV0dXJuIDA7DQp9DQovKg0KNiAzIDEwDQoxIDEgMTANCjIgMyA2DQozIDUgOQ0KNCA3IDEwDQo1IDMgOA0KNiA3IDEwDQoxIDENCjIgNA0KNiA1DQoqLw=="}]