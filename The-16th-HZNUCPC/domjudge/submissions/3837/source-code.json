[{"id":"3837","submission_id":"3837","filename":"G.cpp","source":"I2luY2x1ZGU8Yml0cy9zdGRjKysuaD4NCiNkZWZpbmUgbGwgbG9uZyBsb25nDQp1c2luZyBuYW1lc3BhY2Ugc3RkOw0KY29uc3QgaW50IE4gPSAyZTUgKyA1Ow0Kc3RydWN0IFR3b1NhdCB7DQoJaW50IG4sIGNvbG9yOw0KCXZlY3Rvcjx2ZWN0b3I8aW50PiA+IEc7DQoJdmVjdG9yPGJvb2w+IGFuczsNCgl2ZWN0b3I8aW50PiBjb2w7DQoJVHdvU2F0KGludCBuKSA6IG4obiksIGNvbG9yKDEpLCBHKDIgKiBuKSwgYW5zKG4pLCBjb2wobikge30NCgl2b2lkIE9yKGludCB1LCBib29sIGYsIGludCB2LCBib29sIGcpIHsgLy/oh7PlsJHkuIDkuKrkuLrnnJ8NCgkJR1syICogdSArICFmXS5wdXNoX2JhY2soMiAqIHYgKyBnKTsNCgkJR1syICogdiArICFnXS5wdXNoX2JhY2soMiAqIHUgKyBmKTsNCgl9DQoJdm9pZCBJbXBsaWVzKGludCB1LCBib29sIGYsIGludCB2LCBib29sIGcpew0KCQlPcih1LCAhZiwgdiwgZyk7DQoJfQ0KCXZvaWQgWG9yKGludCB1LCBib29sIGYsIGludCB2LCBib29sIGcpew0KCQlPcih1LCBmLCB2LCBnKTsgT3IodSwgIWYsIHYsICFnKTsNCgl9DQoJdm9pZCBTYW1lKGludCB1LCBib29sIGYsIGludCB2LCBib29sIGcpIHsNCgkJWG9yKHUsICFmLCB2LCBnKTsNCgl9DQoJdm9pZCBNdXN0KGludCB1LCBib29sIGYpIHsNCgkJT3IodSwgZiwgdSwgZik7DQoJfQ0KCWJvb2wgd29yaygpIHsNCgkJdmVjdG9yPGludD4gaWQoMiAqIG4sIC0xKSwgZGZuKDIgKiBuLCAtMSksIGxvdygyICogbiwgLTEpLCBzdGs7DQoJCW1hcDxwYWlyPGludCwgaW50PiwgaW50PiBtcDsNCgkJaW50IG5vdyA9IDAsIGNudCA9IDA7DQoJCWZ1bmN0aW9uPHZvaWQoaW50KT4gdGFyamFuID0gWyZdKGludCB1KSB7DQoJCQlzdGsucHVzaF9iYWNrKHUpOw0KCQkJZGZuW3VdID0gbG93W3VdID0gbm93Kys7DQoJCQlmb3IoYXV0byB2IDogR1t1XSkgew0KCQkJCWlmKGRmblt2XSA9PSAtMSkgew0KCQkJCQl0YXJqYW4odik7DQoJCQkJCWxvd1t1XSA9IG1pbihsb3dbdV0sIGxvd1t2XSk7DQoJCQkJfQ0KCQkJCWVsc2UgaWYoaWRbdl0gPT0gLTEpIHsNCgkJCQkJbG93W3VdID0gbWluKGxvd1t1XSwgZGZuW3ZdKTsNCgkJCQl9DQoJCQl9DQoJCQlpZihkZm5bdV0gPSBsb3dbdV0pIHsNCgkJCQlpbnQgdjsNCgkJCQlkbyB7DQoJCQkJCXYgPSBzdGsuYmFjaygpOw0KCQkJCQlzdGsucG9wX2JhY2soKTsNCgkJCQkJaWRbdl0gPSBjbnQ7DQoJCQkJfSB3aGlsZSh2ICE9IHUpOw0KCQkJCSsrY250Ow0KCQkJfQ0KCQl9Ow0KCQlmb3IoaW50IGkgPSAwOyBpIDwgMiAqIG47IGkrKykgew0KCQkJaWYoZGZuW2ldID09IC0xKSB0YXJqYW4oaSk7DQoJCX0NCgkJZm9yKGludCBpID0gMDsgaSA8IG47IGkrKykgew0KCQkJaWYoaWRbMiAqIGldID09IGlkWzIgKiBpICsgMV0pIHJldHVybiBmYWxzZTsNCgkJCWFuc1tpXSA9IGlkWzIgKiBpXSA+IGlkWzIgKiBpICsgMV07DQoJCQkNCi8vCQkJbXBbe2RmblsyICogaV0sIGRmblsyICogaSArIDFdfV0rKzsNCgkJCWludCBpZF9hID0gZGZuWzIgKiBpXSwgaWRfYiA9IGRmblsyICogaSArIDFdOw0KCQkJaWYoaWRfYSA+IGlkX2IpIHN3YXAoaWRfYSwgaWRfYik7DQoJCQlpZihtcC5jb3VudCh7aWRfYSwgaWRfYn0pKSB7DQoJCQkJY29sW2ldID0gbXBbe2lkX2EsIGlkX2J9XTsNCgkJCX0NCgkJCWVsc2Ugew0KCQkJCW1wW3tpZF9hLCBpZF9ifV0gPSBjb2xvcjsNCgkJCQljb2xbaV0gPSBjb2xvcjsNCgkJCQljb2xvcisrOw0KCQkJfQ0KCQl9ICAgDQoJCXJldHVybiB0cnVlOw0KCX0NCn07DQppbnQgbiwgcSwgbTsgICAgICAgICAgICAgICAgICAgICAgICAgIA0Kdm9pZCBzb2x2ZSgpIHsNCgljaW4gPj4gbiA+PiBxID4+IG07DQoJVHdvU2F0IHRzKG4pOw0KCWZvcihpbnQgaSA9IDE7IGkgPD0gbTsgaSsrKSB7DQoJCWludCBrLCBhLCBiOw0KCQljaW4gPj4gayA+PiBhID4+IGI7DQoJCWEtLTsgYi0tOw0KCQlpZihrID09IDApIHsNCgkJCXRzLkltcGxpZXMoYSwgMSwgYiwgMSk7DQoJCQl0cy5JbXBsaWVzKGEsIDAsIGIsIDApOw0KCQl9DQoJCWVsc2Ugew0KCQkJdHMuSW1wbGllcyhhLCAxLCBiLCAwKTsNCgkJCXRzLkltcGxpZXMoYSwgMCwgYiwgMSk7DQoJCX0NCgl9DQoJaWYodHMud29yaygpKSB7DQoJCXZlY3Rvcjx2ZWN0b3I8aW50PiA+IGNvbF90b19pZCh0cy5jb2xvciArIDEpOw0KCQl2ZWN0b3I8aW50PiBjb2xfdmFsKHRzLmNvbG9yICsgMSksIGRwKHRzLmNvbG9yICsgMSksIGZyb20odHMuY29sb3IgKyAxKSwgdXNlKHRzLmNvbG9yICsgMSk7DQoJCXZlY3RvcjxwYWlyPGludCwgaW50PiA+IGNvbF8yKHRzLmNvbG9yICsgMSk7DQoJCWZvcihpbnQgaSA9IDA7IGkgPCBuOyBpKyspIHsNCgkJCWNvbF90b19pZFt0cy5jb2xbaV1dLnB1c2hfYmFjayhpKTsNCgkJCWlmKHRzLmFuc1tpXSA9PSAwKSBjb2xfMlt0cy5jb2xbaV1dLmZpcnN0Kys7DQoJCQllbHNlIGNvbF8yW3RzLmNvbFtpXV0uc2Vjb25kKys7DQovLwkJCWNvdXQgPDwgaSA8PCAiICIgPDwgdHMuY29sW2ldIDw8ICIgIiA8PCB0cy5hbnNbaV0gPDwgIlxuIjsNCgkJfQ0KCQlmb3IoaW50IGkgPSAxOyBpIDw9IHRzLmNvbG9yOyBpKyspIHsNCgkJCWlmKGNvbF8yW2ldLnNlY29uZCA+IGNvbF8yW2ldLmZpcnN0KSB7DQoJCQkJc3dhcChjb2xfMltpXS5maXJzdCwgY29sXzJbaV0uc2Vjb25kKTsNCgkJCQlmb3IoYXV0byBpdCA6IGNvbF90b19pZFtpXSkgew0KCQkJCQl0cy5hbnNbaXRdID0gMSAtIHRzLmFuc1tpdF07DQoJCQkJfQ0KCQkJfQ0KCQl9DQoJCWZvcihpbnQgaSA9IDE7IGkgPD0gdHMuY29sb3I7IGkrKykgew0KCQkJcSAtPSBjb2xfMltpXS5zZWNvbmQ7DQoJCQljb2xfdmFsW2ldID0gY29sXzJbaV0uZmlyc3QgLSBjb2xfMltpXS5zZWNvbmQ7DQoJCX0NCgkJaWYocSA8IDApIHsNCgkJCWNvdXQgPDwgIk5PXG4iOw0KCQkJcmV0dXJuOw0KCQl9DQoJCWlmKHEgPT0gMCkgew0KCQkJY291dCA8PCAiWUVTXG4iOw0KCQkJZm9yKGludCBpID0gMTsgaSA8PSBuOyBpKyspIHsNCgkJCQlpZih0cy5hbnNbaV0pIGNvdXQgPDwgaSArIDEgPDwgIiAiOw0KCQkJfQ0KCQkJcmV0dXJuOw0KCQl9DQoJCWRwWzBdID0gMTsNCgkJZm9yKGludCBjID0gMTsgYyA8PSB0cy5jb2xvcjsgYysrKSB7DQoJCQlpZihjb2xfdmFsW2NdID09IDApIGNvbnRpbnVlOw0KCQkJZm9yKGludCBqID0gcTsgaiA+PSBjb2xfdmFsW2NdOyBqLS0pIHsNCgkJCQlkcFtqXSA9IGRwW2pdIHwgZHBbaiAtIGNvbF92YWxbY11dOw0KCQkJCWlmKGRwW2ogLSBjb2xfdmFsW2NdXSkgew0KCQkJCQl1c2Vbal0gPSBjOw0KCQkJCQlmcm9tW2pdID0gaiAtIGNvbF92YWxbY107DQoJCQkJfQ0KCQkJfQ0KCQl9DQoJCWlmKCFkcFt0cy5jb2xvcl0pIHsNCgkJCWNvdXQgPDwgIk5PXG4iOw0KCQkJcmV0dXJuOw0KCQl9DQovLwkJZm9yKGludCBjID0gMTsgYyA8PSB0cy5jb2xvcjsgYysrKSB7DQovLwkJCWNvdXQgPDwgYyA8PCAiOiAiOw0KLy8JCQlmb3IoYXV0byBpdCA6IGNvbF90b19pZFtjXSkgew0KLy8JCQkJY291dCA8PCBpdCA8PCAiICI7DQovLwkJCX0NCi8vCQkJY291dCA8PCAidmFsOiIgPDwgY29sX3ZhbFtjXTsgDQovLwkJCWNvdXQgPDwgZW5kbDsNCi8vCQl9DQoJCWludCBpZHggPSB0cy5jb2xvcjsNCgkJd2hpbGUoaWR4KSB7DQoJCQlpbnQgYyA9IHVzZVtpZHhdOw0KLy8JCQljb3V0IDw8IGlkeCA8PCAiICIgPDwgYyA8PCBlbmRsOw0KCQkJZm9yKGF1dG8gaXQgOiBjb2xfdG9faWRbY10pIHsNCgkJCQl0cy5hbnNbaXRdID0gMSAtIHRzLmFuc1tpdF07DQoJCQl9DQoJCQlpZHggPSBmcm9tW2lkeF07DQoJCX0NCgkJY291dCA8PCAiWUVTXG4iOw0KCQlmb3IoaW50IGkgPSAxOyBpIDw9IG47IGkrKykgew0KCQkJaWYodHMuYW5zW2ldKSBjb3V0IDw8IGkgKyAxIDw8ICIgIjsNCgkJfQ0KCQlyZXR1cm47DQoJfQ0KCWVsc2Ugew0KCQljb3V0IDw8ICJOT1xuIjsNCgl9DQp9DQppbnQgbWFpbigpIHsNCglpb3M6OnN5bmNfd2l0aF9zdGRpbyhmYWxzZSk7DQoJaW50IFQgPSAxOw0KCXdoaWxlKFQtLSkgew0KCQlzb2x2ZSgpOw0KCX0NCglyZXR1cm4gMDsNCn0NCi8qDQo0IDIgNA0KMSAxIDMNCjEgMiA0DQowIDMgNA0KMCAxIDINCg0KMCAwIDEgMQ0KDQoxMyA3IDExDQowIDEgMg0KMCAxIDMNCjAgMSA0DQowIDEgNQ0KMSAxIDYNCjEgMSA3DQowIDggOQ0KMCA4IDEwDQowIDggMTENCjEgMTMgMTINCjEgMTIgMTMNCg0KMiAxIDINCjEgMSAyDQowIDIgMQ0KKi8="}]