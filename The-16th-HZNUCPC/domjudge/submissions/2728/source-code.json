[{"id":"2728","submission_id":"2728","filename":"Gv3.cpp","source":"I2luY2x1ZGU8Yml0cy9zdGRjKysuaD4NCiNkZWZpbmUgTSAxMDAwMDUNCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQp0ZW1wbGF0ZTxjbGFzcyBULGNsYXNzLi4uIEE+IHZvaWQgb2RuKFQmJiB4LCBBJiYuLi4gYSkge2NvdXQ8PHg7IChpbnRbXSl7KGNvdXQ8PCcgJzw8YSwwKS4uLn07IGNvdXQ8PCdcbic7fQ0KaW50IGZsYWcsY250LG4scSxtLGNvbFtNXSxiZWxvbmdbTV07DQpzdHJ1Y3QgaHpsew0KICAgIGludCBhLGI7DQp9Ow0KdmVjdG9yPGh6bD5FW01dOw0Kc3RydWN0IGh6bDJ7DQogICAgdmVjdG9yPGludD5hLGI7DQp9YmxvY2tbTV07DQp2b2lkIGRmcyhpbnQgeCxpbnQgYyl7DQogICAgY29sW3hdPWM7DQogICAgaWYoZmxhZylyZXR1cm4gOw0KICAgIGZvcihpbnQgaT0wO2k8RVt4XS5zaXplKCk7aSsrKXsNCiAgICAgICAgaW50IHY9RVt4XVtpXS5hOw0KICAgICAgICBpZihjb2xbdl09PS0xKWRmcyh2LGNeRVt4XVtpXS5iKTsNCiAgICAgICAgZWxzZSBpZihjb2xbdl0hPWNeRVt4XVtpXS5iKWZsYWc9MTsNCiAgICB9DQogICAgcmV0dXJuIDsNCn0NCnZvaWQgZmluZChpbnQgeCl7DQogICAgaWYoY29sW3hdPT0xKWJsb2NrW2NudF0uYS5wdXNoX2JhY2soeCk7DQogICAgZWxzZSBibG9ja1tjbnRdLmIucHVzaF9iYWNrKHgpOw0KICAgIGNvbFt4XT0zOw0KICAgIGZvcihpbnQgaT0wO2k8RVt4XS5zaXplKCk7aSsrKXsNCiAgICAgICAgaW50IHY9RVt4XVtpXS5hOw0KICAgICAgICBpZihjb2xbdl09PTMpY29udGludWU7DQogICAgICAgIGZpbmQodik7DQogICAgfQ0KICAgIHJldHVybiA7DQp9DQp2ZWN0b3I8aW50PiBnb29kbltNXTsNCmludCB1c2VudW1bTV07DQppbnQgbHN0WzUwMF1bTSoyXTsNCmludCBtYWluKCl7DQogICAgbWVtc2V0KGNvbCwtMSxzaXplb2YoY29sKSk7DQogICAgc2NhbmYoIiVkJWQlZCIsJm4sJnEsJm0pOw0KICAgIGZvcihpbnQgaT0xO2k8PW07aSsrKXsNCiAgICAgICAgaW50IGYsYSxiOw0KICAgICAgICBzY2FuZigiJWQlZCVkIiwmZiwmYSwmYik7DQogICAgICAgIEVbYV0ucHVzaF9iYWNrKChoemwpe2IsZn0pOw0KICAgICAgICBFW2JdLnB1c2hfYmFjaygoaHpsKXthLGZ9KTsNCiAgICB9DQogICAgZm9yKGludCBpPTE7aTw9bjtpKyspew0KICAgICAgICBpZihjb2xbaV09PS0xKXsNCiAgICAgICAgICAgIGRmcyhpLDEpOw0KICAgICAgICAgICAgY250Kys7DQogICAgICAgICAgICBmaW5kKGkpOw0KICAgICAgICB9DQogICAgfQ0KICAgIGlmKGZsYWcpew0KICAgICAgICBwdXRzKCJOTyIpOw0KICAgICAgICByZXR1cm4gMDsNCiAgICB9DQogICAgLy8gb2RuKGNudCk7DQogICAgZm9yIChpbnQgaSA9IDE7IGkgPD0gY250OyBpKyspIHsNCiAgICAgICAgaWYgKGJsb2NrW2ldLmEuc2l6ZSgpIDwgYmxvY2tbaV0uYi5zaXplKCkpIHN3YXAoYmxvY2tbaV0uYiwgYmxvY2tbaV0uYSk7DQogICAgICAgIC8vIG9kbihpLCBibG9ja1tpXS5hLnNpemUoKSwgYmxvY2tbaV0uYi5zaXplKCkpOw0KICAgICAgICBnb29kbltibG9ja1tpXS5hLnNpemUoKSAtIGJsb2NrW2ldLmIuc2l6ZSgpXS5wdXNoX2JhY2soaSk7DQogICAgfQ0KICAgIGludCBtb3YgPSBNOw0KICAgIGludCBjY250ID0gMDsgDQogICAgLy8gbHN0WzBdWzArbW92XSA9IC0xOw0KICAgIGxzdFswXVttb3ZdID0gMTsNCiAgICB2ZWN0b3I8cGFpcjxpbnQsaW50Pj4gbjBwe3swLDB9fTsgDQogICAgZm9yIChpbnQgaSA9IDA7IGkgPCBNOyBpKyspIGlmIChnb29kbltpXS5zaXplKCkpIHsNCiAgICAgICAgLy8gb2RuKGksIGdvb2RuW2ldLnNpemUoKSk7DQogICAgICAgIC8vIGZvciAoaW50IGsgPSAwOyBrIDw9IDIqTTsgaysrKSBsc3RbY2NudF1ba10gPSBsc3RbY2NudC0xXVtrXTsNCiAgICAgICAgdmVjdG9yPGludD4gc3A7DQogICAgICAgIGludCByZW0gPSBnb29kbltpXS5zaXplKCk7DQogICAgICAgIGZvciAoaW50IGogPSAxOyBqIDw9IHJlbTsgaiA9IGogKiAyKSB7DQogICAgICAgICAgICByZW0gLT0gajsNCiAgICAgICAgICAgIHNwLnB1c2hfYmFjayhqKTsNCiAgICAgICAgfQ0KICAgICAgICBpZiAocmVtKSBzcC5wdXNoX2JhY2socmVtKTsNCiAgICAgICAgZm9yIChpbnQgaiA6IHNwKSB7DQogICAgICAgICAgICBjY250Kys7DQogICAgICAgICAgICBuMHAucHVzaF9iYWNrKHtpLCBqfSk7DQogICAgICAgICAgICBpbnQgYSA9IGogKiBpOw0KICAgICAgICAgICAgZm9yIChpbnQgayA9IDA7IGsgPCAyKk07IGsrKykgaWYgKGxzdFtjY250LTFdW2tdICE9IDApIHsNCiAgICAgICAgICAgICAgICBpZiAoaythIDwgMipNKSBsc3RbY2NudF1baythXSA9IGo7DQogICAgICAgICAgICAgICAgaWYgKGstYSA+PSAwKSBsc3RbY2NudF1bay1hXSA9IC1qOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KICAgIGludCBuZWVkcSA9IHEgLSAobiAtIHEpOw0KICAgIGlmICghbHN0W2NjbnRdW25lZWRxICsgTV0pew0KICAgICAgICBwdXRzKCJOTyIpOw0KICAgICAgICByZXR1cm4gMDsNCiAgICB9DQogICAgcHV0cygiWUVTIik7DQogICAgaW50IHAgPSBuZWVkcSArIE07DQogICAgLy8gb2RuKHApOw0KICAgIGZvciAoaW50IGkgPSBjY250OyBpID49IDE7IGktLSkgew0KICAgICAgICBpbnQgZWxlaWQgPSBpOw0KICAgICAgICB1c2VudW1bbjBwW2VsZWlkXS5maXJzdF0gKz0gbHN0W2ldW3BdOw0KICAgICAgICBwIC09IG4wcFtlbGVpZF0uZmlyc3QgKiBsc3RbaV1bcF07DQogICAgfQ0KICAgIC8vIG9kbihwKTsNCiAgICBhc3NlcnQocCA9PSBNKTsNCg0KICAgIC8vIGZvciAoYXV0byBpIDogYmxvY2tbMV0uYSkgb2RuKGkpOyANCiAgICAvLyBmb3IgKGF1dG8gaSA6IGJsb2NrWzFdLmIpIG9kbihpKTsgDQogICAgdmVjdG9yPGludD4gYW5zOw0KICAgIGZvciAoaW50IGkgPSAwOyBpIDwgTTsgaSsrKSB7DQogICAgICAgIC8vIGlmKHVzZW51bVtpXSkgb2RuKHVzZW51bVtpXSk7DQogICAgICAgIC8vIG9kbih1c2VudW1baV0pOw0KICAgICAgICBpbnQgc3QgPSAwOw0KICAgICAgICBmb3IgKGludCBqID0gMDsgaiA8IHVzZW51bVtpXTsgaisrKSB7DQogICAgICAgICAgICBmb3IgKGludCBrIDogYmxvY2tbZ29vZG5baV1bc3QrK11dLmEpDQogICAgICAgICAgICAgICAgYW5zLnB1c2hfYmFjayhrKTsNCiAgICAgICAgICAgICAgICAvLyBwcmludGYoIiVkICIsIGspOw0KICAgICAgICB9DQogICAgICAgIGZvciAoaW50IGogPSAwOyBqIDwgLXVzZW51bVtpXTsgaisrKSB7DQogICAgICAgICAgICBmb3IgKGludCBrIDogYmxvY2tbZ29vZG5baV1bc3QrK11dLmIpDQogICAgICAgICAgICAgICAgYW5zLnB1c2hfYmFjayhrKTsNCiAgICAgICAgICAgICAgICAvLyBwcmludGYoIiVkICIsIGspOw0KICAgICAgICB9DQogICAgfQ0KICAgIHNvcnQoYmVnaW4oYW5zKSwgZW5kKGFucykpOw0KICAgIGZvcihhdXRvIGk6IGFucykgcHJpbnRmKCIlZCAiLCBpKTsNCiAgICBwdXRzKCIiKTsNCiAgICByZXR1cm4gMDsNCn0="}]