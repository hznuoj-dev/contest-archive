[{"id":"2084","submission_id":"2084","filename":"E.cpp","source":"I2luY2x1ZGU8Yml0cy9zdGRjKysuaD4NCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQoNCiNkZWZpbmUgaW50IGxvbmcgbG9uZw0KY29uc3QgaW50IE4gPSAxMTA7DQp0eXBlZGVmIGxvbmcgbG9uZyBsbDsNCnR5cGVkZWYgcGFpcjxpbnQsIGludD4gcDsNCnBhaXI8aW50LCBpbnQ+IG5vZGVzW05dOw0KI2RlZmluZSB4IGZpcnN0DQojZGVmaW5lIHkgc2Vjb25kDQoNCmludCBnY2QoaW50IGEsIGludCBiKSB7DQoJaWYgKCFiKSByZXR1cm4gYTsNCglyZXR1cm4gZ2NkKGIsIGEgJSBiKTsNCn0NCg0KbG9uZyBsb25nIGdldF9wb2ludF9udW1zKHAgcDEsIHAgcDIsIHAgcDMsIHAgcDQpIHsNCglpZiAocDMueCA8PSBwMS54IHx8IHAzLnkgPD0gcDQueSkgcmV0dXJuIDA7DQoJcmV0dXJuIDFsbCAqIChwMy54IC0gcDEueCArIDEpICogKHAzLnkgLSBwNC55ICsgMSk7DQp9DQoNCmxvbmcgbG9uZyBnZXRfaW5uZXJfcG9pbnRfbnVtcyhwIHAxLCBwIHAyLCBwIHAzLCBwIHA0KSB7DQoJcDEueCsrLCBwMS55LS07DQoJcDIueCsrLCBwMi55Kys7DQoJcDMueC0tLCBwMy55LS07DQoJcDQueC0tLCBwNC55Kys7DQoJcmV0dXJuIGdldF9wb2ludF9udW1zKHAxLCBwMiwgcDMsIHA0KTsNCn0NCg0KbG9uZyBsb25nIGdldF9saW5lX3BvaW50X251bXMocCBwMSwgcCBwMiwgcCBwMywgcCBwNCkgew0KCWlmIChwMy54IDw9IHAxLnggfHwgcDMueSA8PSBwNC55KSByZXR1cm4gMDsNCglpbnQgeCA9IHAzLnggLSBwMS54LCB5ID0gcDMueSAtIHA0Lnk7DQoJaW50IGdjZF9udW0gPSBnY2QoeCwgeSk7DQoJcmV0dXJuIG1heChnY2RfbnVtIC0gMSwgMGxsKTsNCn0NCg0KbG9uZyBsb25nIGdldF90cmluZ2xlX3BvaW50X251bXMocCBwMSwgcCBwMiwgcCBwMywgcCBwNCkgew0KCWxvbmcgbG9uZyBjbnQgPSBnZXRfbGluZV9wb2ludF9udW1zKHAxLCBwMiwgcDMsIHA0KTsNCglsb25nIGxvbmcgbnVtcyA9IG1heChnZXRfaW5uZXJfcG9pbnRfbnVtcyhwMSwgcDIsIHAzLCBwNCkgLSBjbnQsIDBsbCkgLyAyOw0KCW51bXMgKz0gKHAzLnggLSBwMS54KSArIChwMS55IC0gcDIueSkgKyAxOw0KCXJldHVybiBtYXgobnVtcywgMGxsKTsNCn0NCg0KaW50IGNhbGNfdHJpbmdsZShwIHBhLCBwIHBiKSB7DQoJaW50IG1pbnggPSBtaW4ocGEueCwgcGIueCk7DQoJaW50IG1heHggPSBtYXgocGEueCwgcGIueCk7DQoJaW50IG1pbnkgPSBtaW4ocGEueSwgcGIueSk7DQoJaW50IG1heHkgPSBtYXgocGEueSwgcGIueSk7DQoJcCBwMSA9IHttaW54LCBtYXh5fSwgcDIgPSB7bWlueCwgbWlueX0sIHAzID0ge21heHgsIG1heHl9LCBwNCA9IHttYXh4LCBtaW55fTsNCglyZXR1cm4gZ2V0X3RyaW5nbGVfcG9pbnRfbnVtcyhwMSwgcDIsIHAzLCBwNCk7DQp9DQoNCmxvbmcgbG9uZyBjYWxjKHAgcGEsIHAgcGIpIHsNCglsb25nIGxvbmcgeCA9IG1heChwYS54LCBwYi54KSAtIG1pbihwYS54LCBwYi54KTsNCglsb25nIGxvbmcgeSA9IG1heChwYS55LCBwYi55KSAtIG1pbihwYS55LCBwYi55KTsNCglsb25nIGxvbmcgbnVtID0gZ2NkKHgsIHkpOw0KCXJldHVybiBudW0gLSAxOw0KfQ0KDQpsb25nIGxvbmcgY2FsYyhwIHBhLCBwIHBiLCBwIHBjKSB7CQ0KCXJldHVybiBjYWxjKHBhLCBwYikgKyBjYWxjKHBhLCBwYykgKyBjYWxjKHBiLCBwYykgKyAzOw0KfQ0KDQpib29sIGNoZWNrKHAgcGEsIHAgcGIsIHAgcGMpIHsNCglpZiAoKHBhLnggLSBwYi54KSAqIChwYS55IC0gcGMueSkgPT0gKHBhLnggLSBwYy54KSAqIChwYS55IC0gcGIueSkpIHJldHVybiB0cnVlOw0KCXJldHVybiBmYWxzZTsNCn0NCg0Kdm9pZCBzb2x2ZSgpIHsNCglpbnQgbjsNCglzY2FuZigiJWxsZCIsICZuKTsNCglmb3IgKGludCBpID0gMTsgaSA8PSBuOyBpKyspIHsNCgkJc2NhbmYoIiVsbGQlbGxkIiwgJm5vZGVzW2ldLngsICZub2Rlc1tpXS55KTsNCgl9DQoJbG9uZyBsb25nIHJlcyA9IDA7DQoJZm9yIChpbnQgaSA9IDE7IGkgPD0gbjsgaSsrKSB7DQoJCWZvciAoaW50IGogPSBpICsgMTsgaiA8PSBuOyBqKyspIHsNCgkJCWZvciAoaW50IGsgPSBqICsgMTsgayA8PSBuOyBrKyspIHsNCgkJCQlpZiAoY2hlY2sobm9kZXNbaV0sIG5vZGVzW2pdLCBub2Rlc1trXSkpIGNvbnRpbnVlOw0KCQkJCXJlcyA9IG1heChyZXMsIGNhbGMobm9kZXNbaV0sIG5vZGVzW2pdLCBub2Rlc1trXSkpOw0KCQkJfQ0KCQl9DQoJfQ0KCXByaW50ZigiJWxsZFxuIiwgcmVzKTsNCn0NCiANCnNpZ25lZCBtYWluKCkgew0KCXNvbHZlKCk7DQoJcmV0dXJuIDA7DQp9"}]