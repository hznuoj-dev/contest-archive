[{"id":"2902","submission_id":"2902","filename":"d.cpp","source":"I2luY2x1ZGU8Yml0cy9zdGRjKysuaD4NCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQpzdHJ1Y3QgQlVTew0KCWludCB0LGwscjsNCn1hWzEwMDA1MF07DQpzdHJ1Y3QgVEFOR3sNCglpbnQgdCxwLGlkOw0KfWNbMTAwMDUwXTsNCnN0cnVjdCBUew0KCWludCBtaSxhZCxsLHI7DQp9dFsyMDAwMDUwXTsNCmludCBuLG0seCxiWzEwMDAwNTBdLGFuc1sxMDAwNTBdOw0KYm9vbCBjbXAxKEJVUyBhLEJVUyBiKQ0Kew0KCWlmKGEudCE9Yi50KXJldHVybiBhLnQ+Yi50Ow0KCXJldHVybiBhLnI+Yi5yOw0KLy8JcmV0dXJuIGEudD5iLnQ7DQp9DQpib29sIGNtcDIoVEFORyBhLFRBTkcgYikNCnsNCglyZXR1cm4gYS50PmIudDsNCn0NCnZvaWQgYnVpbGQoaW50IGwsaW50IHIsaW50IHApDQp7DQoJdFtwXS5sPWw7DQoJdFtwXS5yPXI7DQoJdFtwXS5taT0xMDAwMDAwOw0KCWlmKGw8cikNCgl7DQoJCWludCBtaWQ9KGwrcikvMjsNCgkJYnVpbGQobCxtaWQsMipwKTsNCgkJYnVpbGQobWlkKzEsciwyKnArMSk7DQoJfQ0KfQ0Kdm9pZCBkb3duKGludCBwKQ0Kew0KCWlmKHRbcF0uYWQ9PTApcmV0dXJuOw0KCXRbMipwXS5hZD10W3BdLmFkOw0KCXRbMipwXS5taT10W3BdLmFkOw0KCXRbMipwKzFdLmFkPXRbcF0uYWQ7DQoJdFsyKnArMV0ubWk9dFtwXS5hZDsNCgl0W3BdLmFkPTA7DQp9DQppbnQgcXVlcnkoaW50IHgsaW50IHApDQp7DQoJZG93bihwKTsNCglpZih0W3BdLmw9PXRbcF0ucikNCgl7DQoJCXJldHVybiB0W3BdLm1pOw0KCX0NCglpbnQgbWlkPSh0W3BdLmwrdFtwXS5yKS8yOw0KCWlmKHg8PW1pZClyZXR1cm4gcXVlcnkoeCwyKnApOw0KCXJldHVybiBxdWVyeSh4LDIqcCsxKTsNCn0NCmludCBnZXRQb3MoaW50IHgsaW50IHApDQp7DQoJZG93bihwKTsNCglpZih0W3BdLmw9PXRbcF0ucilyZXR1cm4gdFtwXS5sOw0KCWlmKHRbMipwXS5taTw9eClyZXR1cm4gZ2V0UG9zKHgsMipwKTsNCglyZXR1cm4gZ2V0UG9zKHgsMipwKzEpOw0KfQ0Kdm9pZCB1cGRhdGUoaW50IGwsaW50IHIsaW50IHgsaW50IHApDQp7DQoJaWYobD5yKXJldHVybjsNCglkb3duKHApOw0KCWlmKGw9PXRbcF0ubCYmcj09dFtwXS5yKQ0KCXsNCgkJdFtwXS5taT10W3BdLmFkPXg7DQoJCXJldHVybjsNCgl9DQoJaW50IG1pZD0odFtwXS5sK3RbcF0ucikvMjsNCglpZihyPD1taWQpdXBkYXRlKGwscix4LDIqcCk7DQoJZWxzZSBpZihsPm1pZCl1cGRhdGUobCxyLHgsMipwKzEpOw0KCWVsc2UgdXBkYXRlKGwsbWlkLHgsMipwKSx1cGRhdGUobWlkKzEscix4LDIqcCsxKTsNCgl0W3BdLm1pPW1pbih0WzIqcF0ubWksdFsyKnArMV0ubWkpOw0KfQ0KaW50IG1haW4oKXsNCglzcmFuZCh0aW1lKE5VTEwpKTsNCglpbnQgYWxiPXJhbmQoKSU3Ow0KCWFzc2VydChhbGIhPTApOw0KCWNpbj4+bj4+bT4+eDsNCgliWysrYlswXV09eDsNCglmb3IoaW50IGk9MTtpPD1uO2krKykNCgl7DQoJCXNjYW5mKCIlZCVkJWQiLCZhW2ldLnQsJmFbaV0ubCwmYVtpXS5yKTsNCgkJYlsrK2JbMF1dPWFbaV0ubDsNCgkJYlsrK2JbMF1dPWFbaV0ucjsNCgl9DQoJZm9yKGludCBpPTE7aTw9bTtpKyspDQoJew0KCQlzY2FuZigiJWQlZCIsJmNbaV0udCwmY1tpXS5wKTsNCgkJYlsrK2JbMF1dPWNbaV0ucDsNCgkJY1tpXS5pZD1pOw0KCX0NCglzb3J0KGIrMSxiK2JbMF0rMSk7DQoJYlswXT11bmlxdWUoYisxLGIrYlswXSsxKS1iLTE7DQoJeD1sb3dlcl9ib3VuZChiKzEsYitiWzBdKzEseCktYjsNCglmb3IoaW50IGk9MTtpPD1uO2krKykNCgl7DQoJCWFbaV0ubD1sb3dlcl9ib3VuZChiKzEsYitiWzBdKzEsYVtpXS5sKS1iOw0KCQlhW2ldLnI9bG93ZXJfYm91bmQoYisxLGIrYlswXSsxLGFbaV0uciktYjsNCgl9DQoJZm9yKGludCBpPTE7aTw9bTtpKyspDQoJew0KCQljW2ldLnA9bG93ZXJfYm91bmQoYisxLGIrYlswXSsxLGNbaV0ucCktYjsNCgl9DQoJYnVpbGQoMSxiWzBdLDEpOw0KLy8JZm9yKGludCBpPTE7aTw9YlswXTtpKyspcHJpbnRmKCIlZCAiLHF1ZXJ5KGksMSkpOw0KLy8JcHV0cygiIik7DQoJdXBkYXRlKGJbMF0sYlswXSwwLDEpOw0KLy8JZm9yKGludCBpPTE7aTw9YlswXTtpKyspcHJpbnRmKCIlZCAiLHF1ZXJ5KGksMSkpOw0KLy8JcHV0cygiIik7DQoJaW50IGJwPTE7DQoJaW50IHRwPTE7DQoJc29ydChhKzEsYStuKzEsY21wMSk7DQoJc29ydChjKzEsYyttKzEsY21wMik7DQoJZm9yKGludCBpPTEwMDAwMDtpO2ktLSkNCgl7DQoJCXdoaWxlKGJwPD1uJiZhW2JwXS50Pj1pKQ0KCQl7DQoJCQlpbnQgbWk9cXVlcnkoYVticF0uciwxKTsNCgkJCWlmKG1pPm4pDQoJCQl7DQoJCQkJYnArKzsNCgkJCQljb250aW51ZTsNCgkJCX0NCgkJCWludCBwb3M9Z2V0UG9zKG1pLDEpOw0KCQkJdXBkYXRlKGFbYnBdLmwscG9zLTEsbWkrMSwxKTsNCi8vCQkJcHJpbnRmKCJVUEQ6ICVkICVkICVkXG4iLGFbYnBdLmwscG9zLTEsbWkrMSk7DQoJCQlicCsrOw0KCQl9DQoJCXdoaWxlKHRwPD1tJiZjW3RwXS50Pj1pKQ0KCQl7DQoJCQlhbnNbY1t0cF0uaWRdPXF1ZXJ5KGNbdHBdLnAsMSk7DQoJCQl0cCsrOw0KLy8JCQlmb3IoaW50IGk9MTtpPD1iWzBdO2krKylwcmludGYoIiVkICIscXVlcnkoaSwxKSk7DQovLwkJCXB1dHMoIiIpOw0KCQl9DQoJfQ0KCWZvcihpbnQgaT0xO2k8PW07aSsrKWlmKGFuc1tpXT5uKWFuc1tpXT0tMTsNCglmb3IoaW50IGk9MTtpPD1tO2krKylwcmludGYoIiVkXG4iLGFuc1tpXSk7DQoJcmV0dXJuIDA7DQp9DQo="}]