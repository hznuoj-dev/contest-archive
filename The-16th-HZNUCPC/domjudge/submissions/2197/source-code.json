[{"id":"2197","submission_id":"2197","filename":"main.cpp","source":"LyojaW5jbHVkZSA8Yml0cy9zdGRjKysuaD4NCg0KdXNpbmcgbmFtZXNwYWNlIHN0ZDsNCnR5cGVkZWYgbG9uZyBsb25nIGxsOw0KY29uc3QgbGwgbW9kID0gMWU5Kzc7DQoNCg0KbGwgcXBvdyhsbCBhLGxsIGIpew0KICAgIGxsIGFucyA9IDE7DQogICAgd2hpbGUoYil7DQogICAgICAgIGlmKGImMSkgYW5zID0gYW5zKmElbW9kOw0KICAgICAgICBhPWEqYSVtb2Q7DQogICAgICAgIGI+Pj0xOw0KICAgIH0NCiAgICByZXR1cm4gYW5zOw0KfQ0KDQpiaXRzZXQ8MTA+IGJzOw0KDQppbnQgcGFbTl07DQppbnQgZmluZChpbnQgYSl7DQogICAgcmV0dXJuIHBhW2FdPT1hP2E6cGFbYV0gPSBmaW5kKHBhW2FdKTsNCn0NCg0Kdm9pZCBtZXJnZShpbnQgYSxpbnQgYil7DQogICAgYSA9IGZpbmQoYSksYiA9IGZpbmQoYik7DQogICAgaWYoYT09YikgcmV0dXJuOw0KICAgIHBhW2FdID0gYjsNCn0NCmludCBvcFtOXSx4W05dLHlbTl07DQpzaWduZWQgbWFpbigpDQp7DQogICAgaW9zOjpzeW5jX3dpdGhfc3RkaW8oMCk7DQogICAgY2luLnRpZSgwKTsNCiAgICBjb3V0LnRpZSgwKTsNCiAgICBicy5zZXQoMSk7DQogICAgYnMuc2V0KDUpOw0KICAgIGZvcihpbnQgaSA9IGJzLl9GaW5kX2ZpcnN0KCk7aSE9YnMuc2l6ZSgpO2k9YnMuX0ZpbmRfbmV4dChpKSl7DQogICAgICAgIGNvdXQ8PGk8PGVuZGw7DQogICAgfQ0KDQogICAgaW50IG4scSxtOw0KICAgIGNpbj4+bj4+cT4+bTsNCiAgICBmb3IoaW50IGk9MTtpPD1uO2krKykgcGFbaV0gPSBpOw0KICAgIGZvcihpbnQgaT0xO2k8PW07aSsrKXsNCg0KICAgIH0NCn0NCiovDQoNCiNpbmNsdWRlIDxiaXRzL3N0ZGMrKy5oPg0KDQp1c2luZyBuYW1lc3BhY2Ugc3RkOw0KdHlwZWRlZiBsb25nIGxvbmcgbGw7DQpjb25zdCBsbCBtb2QgPSAxZTkrNzsNCmNvbnN0IGxsIE4gPSAxZTYrMTA7DQpzdHJ1Y3QgYnVzew0KICAgIGludCB0LGwscjsNCn07DQpzdHJ1Y3QgcGVvew0KICAgIGludCBpZDsNCiAgICBpbnQgdCxwb3M7DQp9Ow0Kc3RydWN0IHJhbmdlew0KICAgIGludCBsLHIsZGlzOw0KICAgIGJvb2wgb3BlcmF0b3I8KGNvbnN0IHJhbmdlIGEpY29uc3R7DQogICAgICAgIHJldHVybiByPGEucjsNCiAgICB9DQp9Ow0KaW50IGFuc1tOXTsNCmludCBtYWluKCl7DQogICAgaW9zOjpzeW5jX3dpdGhfc3RkaW8oMCk7DQogICAgY2luLnRpZSgwKTsNCiAgICBjb3V0LnRpZSgwKTsNCg0KICAgIGludCBuLG0seDsNCiAgICBjaW4+Pm4+Pm0+Png7DQogICAgdmVjdG9yPGJ1cz4gdmIobik7DQogICAgdmVjdG9yPHBlbz4gdnAobSk7DQogICAgZm9yKGludCBpPTA7aTxuO2krKyl7DQogICAgICAgIGNpbj4+dmJbaV0udD4+dmJbaV0ubD4+dmJbaV0ucjsNCiAgICB9DQogICAgZm9yKGludCBpPTA7aTxtO2krKyl7DQogICAgICAgIGNpbj4+dnBbaV0udD4+dnBbaV0ucG9zOw0KICAgICAgICB2cFtpXS5pZCA9IGk7DQogICAgfQ0KICAgIHNvcnQodmIuYmVnaW4oKSx2Yi5lbmQoKSxbXShidXMgYSxidXMgYil7DQogICAgICAgICAgICBpZihhLnQhPWIudCkgcmV0dXJuIGEudD5iLnQ7DQogICAgICAgICAgICByZXR1cm4gYS5yPmIucjsNCiAgICAgICAgIH0pOw0KICAgIHNvcnQodnAuYmVnaW4oKSx2cC5lbmQoKSxbXShwZW8gYSxwZW8gYil7DQogICAgICAgICAgICByZXR1cm4gYS50PmIudDsNCiAgICAgICAgIH0pOw0KDQogICAgc2V0PHJhbmdlPiBzdDsNCiAgICByYW5nZSByMSA9IHsxLHgtMSwweDNmM2YzZjNmfTsNCiAgICByYW5nZSByMiA9IHt4LHgsMH07DQogICAgc3QuaW5zZXJ0KHIxKTsNCiAgICBzdC5pbnNlcnQocjIpOw0KICAgIGludCBwb3NwID0gMDsNCiAgICBpbnQgcG9zYiA9IDA7DQogICAgZm9yKGludCBpPTEwMDAwMDtpPj0xO2ktLSl7DQogICAgICAgIHdoaWxlKHBvc2I8dmIuc2l6ZSgpJiZ2Yltwb3NiXS50Pj1pKXsNCiAgICAgICAgICAgIGludCBsID0gdmJbcG9zYl0ubCxyID0gdmJbcG9zYl0ucjsNCiAgICAgICAgICAgIGF1dG8gaXQgPSAqc3QubG93ZXJfYm91bmQoe3IsciwwfSk7DQogICAgICAgICAgICBpbnQgZCA9IGl0LmRpcysxOw0KICAgICAgICAgICAgciA9IGl0LmwtMTsNCiAgICAgICAgICAgIGlmKGw+cil7DQogICAgICAgICAgICAgICAgcG9zYisrOw0KICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpdCA9ICpzdC5sb3dlcl9ib3VuZChyYW5nZSh7bCxsLDB9KSk7DQogICAgICAgICAgICBpZihpdC5sIT1sKXsNCiAgICAgICAgICAgICAgICBzdC5lcmFzZShpdCk7DQogICAgICAgICAgICAgICAgc3QuaW5zZXJ0KHJhbmdlKHtpdC5sLGwtMSxpdC5kaXN9KSk7DQogICAgICAgICAgICAgICAgc3QuaW5zZXJ0KHtsLGl0LnIsaXQuZGlzfSk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpdCA9ICpzdC5sb3dlcl9ib3VuZCh7cixyLDB9KTsNCiAgICAgICAgICAgIGlmKGl0LnIhPXIpew0KICAgICAgICAgICAgICAgIHN0LmVyYXNlKGl0KTsNCiAgICAgICAgICAgICAgICBzdC5pbnNlcnQoe3IrMSxpdC5yLGl0LmRpc30pOw0KICAgICAgICAgICAgICAgIHN0Lmluc2VydCh7aXQubCxyLGl0LmRpc30pOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgd2hpbGUoMSl7DQogICAgICAgICAgICAgICAgYXV0byBpdGVyID0gc3QubG93ZXJfYm91bmQoe2wsbCwwfSk7DQogICAgICAgICAgICAgICAgaWYoaXRlcj09c3QuZW5kKCl8fGl0ZXItPmw+cikgYnJlYWs7DQogICAgICAgICAgICAgICAgc3QuZXJhc2UoaXRlcik7DQogICAgICAgICAgICB9DQogICAgICAgICAgICB3aGlsZSgxKXsNCiAgICAgICAgICAgICAgICBpZihsPT0xKSBicmVhazsNCiAgICAgICAgICAgICAgICBhdXRvIGl0ZXIgPSBzdC5sb3dlcl9ib3VuZCh7bC0xLGwtMSwwfSk7DQogICAgICAgICAgICAgICAgaWYoaXRlci0+ZGlzPT1kKXsNCiAgICAgICAgICAgICAgICAgICAgbCA9IGl0ZXItPmw7DQogICAgICAgICAgICAgICAgICAgIHN0LmVyYXNlKGl0ZXIpOw0KICAgICAgICAgICAgICAgIH1lbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgc3QuaW5zZXJ0KHtsLHIsZH0pOw0KICAgICAgICAgICAgLy9jb3V0PDxwb3NiPDwnICc7DQogICAgICAgICAgICAvL2ZvcihhdXRvIHg6c3Qpew0KICAgICAgICAgICAgLy8gICAgY291dDw8eC5sPDwnICc8PHgucjw8JyAnPDx4LmRpczw8J3wnOw0KICAgICAgICAgICAgLy99DQogICAgICAgICAgICAvL2NvdXQ8PGVuZGw7DQogICAgICAgICAgICBwb3NiKys7DQogICAgICAgIH0NCiAgICAgICAgd2hpbGUocG9zcDx2cC5zaXplKCkmJnZwW3Bvc3BdLnQ+PWkpew0KICAgICAgICAgICAgYXV0byBpdCA9ICpzdC5sb3dlcl9ib3VuZCh7dnBbcG9zcF0ucG9zLHZwW3Bvc3BdLnBvcywwfSk7DQogICAgICAgICAgICBhbnNbdnBbcG9zcF0uaWRdID0gaXQuZGlzOw0KICAgICAgICAgICAgcG9zcCsrOw0KICAgICAgICB9DQogICAgfQ0KICAgIGZvcihpbnQgaT0wO2k8bTtpKyspew0KICAgICAgICAgICAgaWYoYW5zW2ldPT0weDNmM2YzZjNmKSBjb3V0PDwtMTw8ZW5kbDsNCiAgICAgICAgICAgIGVsc2UgY291dDw8YW5zW2ldPDxlbmRsOw0KICAgIH0NCn0NCg=="}]