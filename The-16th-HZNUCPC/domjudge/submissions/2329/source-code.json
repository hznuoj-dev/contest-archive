[{"id":"2329","submission_id":"2329","filename":"a.cpp","source":"Ly8gI2RlZmluZSBERUJVRw0KI2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+DQoNCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQpjb25zdCBpbnQgTU9EID0gMTAwMDAwMDAwNzsNCmNvbnN0IGludCBJTlYyID0gNTAwMDAwMDA0Ow0KY29uc3QgaW50IE1BWE4gPSAxZTUgKyA1Ow0KI2RlZmluZSBpbnQgbG9uZyBsb25nDQojZGVmaW5lIGVuZGwgJ1xuJw0KDQppbnQgcV9wb3coaW50IGEsIGludCBiKSB7DQogICAgaW50IHJlcyA9IDE7DQogICAgZm9yICg7IGI7IGIgPj49IDEpIHsNCiAgICAgICAgaWYgKGIgJiAxKSByZXMgPSByZXMgKiBhICUgTU9EOw0KICAgICAgICBhID0gYSAqIGEgJSBNT0Q7DQogICAgfQ0KICAgIHJldHVybiByZXM7DQp9DQoNCmludCB0eXBlTnVtWzI2XVsyNl0gPSB7MH07DQoNCnZvaWQgc29sdmUoKSB7DQogICAgaW50IHJlcyA9IDA7DQogICAgc3RyaW5nIGEsIGI7IGNpbiA+PiBhID4+IGI7DQogICAgaW50IG4gPSAoaW50KWEuc2l6ZSgpOw0KICAgIHZlY3RvcjxpbnQ+IGNudEEoMjYpOw0KICAgIHZlY3RvcjxpbnQ+IGNudEIoMjYpOw0KICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbjsgaSArKyApIHsNCiAgICAgICAgY250QVthW2ldIC0gJ2EnXSArKzsNCiAgICAgICAgY250QltiW2ldIC0gJ2EnXSArKzsNCiAgICB9DQogICAgZm9yIChpbnQgaSA9IDA7IGkgPCBuOyArK2kpIHsNCiAgICAgICAgdHlwZU51bVthW2ldIC0gJ2EnXVtiW2ldIC0gJ2EnXSsrOw0KICAgIH0NCiAgICBhdXRvIGV4Y2hhbmdlID0gWyZdKGludCBpLCBpbnQgaikgew0KICAgICAgICBjbnRCW2ldKyssIGNudEFbaV0tLSwgY250QltqXS0tLCBjbnRBW2pdKys7DQogICAgfTsNCiAgICBmb3IgKGludCBpID0gMDsgaSA8IDI2OyArK2kpIHsNCiAgICAgICAgZm9yIChpbnQgaiA9IDA7IGogPCAyNjsgKytqKSB7DQogICAgICAgICAgICBpZiAodHlwZU51bVtpXVtqXSA9PSAwKSBjb250aW51ZTsNCiAgICAgICAgICAgIGZvciAoaW50IGsgPSAwOyBrIDwgMjY7ICsraykgew0KICAgICAgICAgICAgICAgIGZvciAoaW50IGwgPSAwOyBsIDwgMjY7ICsrbCkgew0KICAgICAgICAgICAgICAgICAgICBpZiAodHlwZU51bVtrXVtsXSA9PSAwKSBjb250aW51ZTsNCiAgICAgICAgICAgICAgICAgICAgZXhjaGFuZ2UoaSwgaiksIGV4Y2hhbmdlKGssIGwpOw0KICAgICAgICAgICAgICAgICAgICBpbnQgc3pBID0gMCwgc3pCID0gMDsNCiAgICAgICAgICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCAyNjsgaSArKyApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjbnRBW2ldID4gMCkgc3pBICsrOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNudEJbaV0gPiAwKSBzekIgKys7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgaWYgKHN6QSA9PSBzekIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpID09IGsgJiYgaiA9PSBsKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzID0gKHJlcyArIHR5cGVOdW1baV1bal0gKiAodHlwZU51bVtrXVtsXSAtIDEpICUgTU9EKSAlIE1PRDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXMgPSAocmVzICsgdHlwZU51bVtpXVtqXSAqIHR5cGVOdW1ba11bbF0gJSBNT0QpICUgTU9EOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGV4Y2hhbmdlKGosIGkpLCBleGNoYW5nZShsLCBrKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQogICAgY291dCA8PCByZXMgKiBJTlYyICUgTU9EIDw8IGVuZGw7DQp9DQoNCnNpZ25lZCBtYWluKHZvaWQpIHsNCiNpZmRlZiBERUJVRw0KICAgIGZyZW9wZW4oImEuaW4iLCAiciIsIHN0ZGluKTsNCiAgICBmcmVvcGVuKCJhLm91dCIsICJ3Iiwgc3Rkb3V0KTsNCiAgICBhdXRvIG5vdyA9IGNsb2NrKCk7DQojZW5kaWYNCiAgICBpb3M6OnN5bmNfd2l0aF9zdGRpbyhmYWxzZSk7IGNpbi50aWUoMCk7IGNvdXQudGllKDApOw0KICAgIGNvdXQgPDwgZml4ZWQgPDwgc2V0cHJlY2lzaW9uKDYpOw0KICAgIC8vIGNpbiA+PiBUOw0KICAgIC8vIHdoaWxlIChULS0pDQogICAge3NvbHZlKCk7IH0NCiNpZmRlZiBERUJVRw0KICAgIGNlcnIgPDwgZG91YmxlKGNsb2NrKCkgLSBub3cpIC8gKGRvdWJsZSlDTE9DS1NfUEVSX1NFQyAqIDEwMDAgPDwgIiBtcy4iIDw8IGVuZGw7DQojZW5kaWYNCiAgICByZXR1cm4gMDsNCn0="}]