[{"id":"3975","submission_id":"3975","filename":"G.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+DQp1c2luZyBuYW1lc3BhY2Ugc3RkOw0KDQpjb25zdCBpbnQgTiA9IDZlNSArIDEwOw0KDQppbnQgbiwgcSwgbTsNCmludCBwW05dOw0KaW50IHNpeltOXTsNCmludCBjW05dOw0KaW50IGdbTl07DQppbnQgcmU7DQpib29sIGYgPSB0cnVlOw0KaW50IGZpbmQoaW50IHgpDQp7DQogICAgaWYoeCA9PSBwW3hdKSByZXR1cm4geDsNCiAgICByZXR1cm4gcFt4XSA9IGZpbmQocFt4XSk7DQp9DQoNCnZvaWQgZ2V0KGludCBvcCwgaW50IGEsIGludCBiKXsNCiAgICBpZihvcCA9PSAwKQ0KICAgIHsNCiAgICAgICAgaW50IHggPSBmaW5kKGEpOw0KICAgICAgICBpbnQgeSA9IGZpbmQoYik7DQogICAgICAgIGlmKHggIT0geSl7DQogICAgICAgIHBbeF0gPSB5Ow0KICAgICAgICBzaXpbeV0gKz0gc2l6W3hdOw0KICAgICAgICB9DQogICAgICAgIHggPSBmaW5kKGEgKyBuKTsNCiAgICAgICAgeSA9IGZpbmQoYiArIG4pOw0KICAgICAgICAgaWYoeCAhPSB5KXsNCiAgICAgICAgcFt4XSA9IHk7DQogICAgICAgIHNpelt5XSArPSBzaXpbeF07DQogICAgICAgIH0NCiAgICB9DQogICAgZWxzZXsNCiAgICAgICAgIGludCB4ID0gZmluZChhICsgbik7DQogICAgICAgIGludCB5ID0gZmluZChiKTsNCiAgICAgICAgaWYoeCAhPSB5KXsNCiAgICAgICAgcFt4XSA9IHk7DQogICAgICAgIHNpelt5XSArPSBzaXpbeF07DQogICAgICAgIH0NCiAgICAgICAgeCA9IGZpbmQoYSk7DQogICAgICAgIHkgPSBmaW5kKGIgKyBuKTsNCiAgICAgICAgIGlmKHggIT0geSl7DQogICAgICAgIHBbeF0gPSB5Ow0KICAgICAgICBzaXpbeV0gKz0gc2l6W3hdOw0KICAgICAgICB9DQogICAgfQ0KfQ0KDQppbnQgZHBbTl07DQppbnQgcHJlW05dOw0KaW50IGZmW05dOw0KaW50IG1haW4oKXsNCg0KICAgIHNjYW5mKCIlZCVkJWQiLCAmbiwgJnEsICZtKTsNCiAgICBmb3IgKGludCBpID0gMTsgaSA8PSBuICsgbjsgaSArKykgcFtpXSA9IGk7DQogICAgZm9yIChpbnQgaSA9IDE7IGkgPD0gbjsgaSArKykgc2l6W2ldID0gMTsNCg0KICAgIHdoaWxlKG0gLS0pDQogICAgew0KICAgICAgICBpbnQgb3AsIGEsIGI7DQogICAgICAgIHNjYW5mKCIlZCVkJWQiLCAmb3AsICZhLCAmYik7DQogICAgICAgIGdldChvcCwgYSwgYik7DQogICAgfQ0KICAgIGZvciAoaW50IGkgPSAxOyBpIDw9IG47IGkgKyspDQogICAgew0KICAgICAgICBpZihmaW5kKGkpID09IGZpbmQoaSArIG4pKQ0KICAgICAgICB7DQogICAgICAgICAgICBmID0gZmFsc2U7DQogICAgICAgIH0NCiAgICB9DQogICAgaWYoZiA9PSBmYWxzZSkNCiAgICB7DQogICAgICAgIHB1dHMoIk5PIik7DQogICAgfQ0KICAgIGVsc2V7DQoNCiAgICAgICAgdmVjdG9yPHBhaXI8aW50LGludD4+cG9zOw0KICAgICAgICBmb3IgKGludCBpID0gMTsgaSA8PSBuOyBpICsrKXsNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBpZihmaW5kKGkpICE9IGkpIGNvbnRpbnVlOw0KICAgICAgICAgICAgICAgIGlmKGNbc2l6W2ldXSA9PSAwKQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgZ1srK3JlXSA9IHNpeltpXTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgY1tzaXpbaV1dKys7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICBmb3IgKGludCBpID0gMTsgaSA8PSByZTsgaSArKykNCiAgICAgICAgew0KICAgICAgICAgICAgaW50IG51bSA9IGNbZ1tpXV07DQogICAgICAgICAgICBpbnQgdmFsID0gZ1tpXTsNCiAgICAgICAgICAgIGludCB0bXAgPSAxOw0KICAgICAgICAgICAgd2hpbGUodG1wIDw9IG51bSkNCiAgICAgICAgICAgIHsNCiAgICAgICAgIC8vICAgICAgY291dCA8PCB0bXAgPDwiICIgPDwgbnVtIDw8IiAiPDx2YWwgKiB0bXAgPDwiICIgPDwgdmFsIDw8J1xuJzsNCiAgICAgICAgICAgICAgICBwb3MucHVzaF9iYWNrKHt2YWwgKiB0bXAsIHZhbH0pOw0KICAgICAgICAgICAgICAgIG51bSAtPSB0bXA7DQogICAgICAgICAgICAgICAgdG1wICo9IDI7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZihudW0pDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgcG9zLnB1c2hfYmFjayh7dmFsICogbnVtLCB2YWx9KTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICBkcFswXSA9IDE7DQogICAgICAgIGZvciAoaW50IGkgPSBwb3Muc2l6ZSgpIC0gMTsgaSA+PSAwOyBpIC0tKQ0KICAgICAgICB7DQogICAgICAgICAvLyAgIGNvdXQgPDwgcG9zW2ldLmZpcnN0IDw8IiAiIDw8IHBvc1tpXS5zZWNvbmQgPDwgJ1xuJzsNCiAgICAgICAgICAgIGZvciAoaW50IGogPSBxOyBqID49IHBvc1tpXS5maXJzdDsgaiAtLSkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBpZighZHBbaiAtIHBvc1tpXS5maXJzdF0pIGNvbnRpbnVlOw0KICAgICAgICAgICAgICAgIHByZVtqXSA9IGk7DQogICAgICAgICAgICAgICAgZHBbal0gfD0gZHBbaiAtIHBvc1tpXS5maXJzdF07DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICBpZighZHBbcV0pDQogICAgICAgIHsNCiAgICAgICAgICAgIHB1dHMoIk5PIik7DQoNCiAgICAgICAgfQ0KICAgICAgICBlbHNlew0KICAgICAgICAgICAgIGludCBxcSA9IHE7DQogICAgICAgICAgICB2ZWN0b3I8aW50PnJldDsNCiAgICAgICAgICAgIHdoaWxlKHFxKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGludCB0dCA9IHByZVtxcV07DQogICAgICAgICAgICAgICAgZmZbcG9zW3R0XS5zZWNvbmRdICs9IHBvc1t0dF0uZmlyc3Q7DQogICAgICAgICAgICAgICAgcXEgLT0gcG9zW3R0XS5maXJzdDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAvLyAgY291dCA8PCIhIjw8ICIgIjw8IHFxIDw8ICdcbic7DQogICAgICAgICAgICBmb3IgKGludCBpID0gMTsgaSA8PSBuOyBpICsrKQ0KICAgICAgICAgICAgew0KDQoNCiAgICAgICAgIC8vICAgICAgIGNvdXQgPDwgaSA8PCIgIiA8PCBmaW5kKGkpIDw8IiAgIiA8PCBmZltzaXpbZmluZChpKV1dIDw8ICdcbic7DQogICAgICAgICAgICAgICAgaWYoZmZbc2l6W2ZpbmQoaSldXSA+PSAxKQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgZmZbc2l6W2ZpbmQoaSldXS0tOw0KICAgICAgICAgICAgICAgICAgICByZXQucHVzaF9iYWNrKGkpOw0KDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcHV0cygiWUVTIik7DQogICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHJldC5zaXplKCk7IGkgKyspDQogICAgICAgICAgICB7DQoNCiAgICAgICAgICAgICAgICBwcmludGYoIiVkJWMiLCByZXRbaV0sICIgXG4iW2kgPT0gcmV0LnNpemUoKSAtIDFdKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgfQ0KfQ0K"}]