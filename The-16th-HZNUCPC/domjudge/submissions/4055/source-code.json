[{"id":"4055","submission_id":"4055","filename":"main.cpp","source":"I2luY2x1ZGU8Yml0cy9zdGRjKysuaD4NCiNkZWZpbmUgZnQgZmlyc3QNCiNkZWZpbmUgc2Qgc2Vjb25kDQojZGVmaW5lIGxsIGxvbmcgbG9uZw0KI2RlZmluZSBwYiBwdXNoX2JhY2sNCiNkZWZpbmUgcGxsIHBhaXI8bGwsbGw+DQojZGVmaW5lIHJlcChpLGEsYikgZm9yKGxsIGk9YTtpPD1iOysraSkNCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQpsbCBuLG0sayx0dCx0cCxzdW0sYW5zLHJlczsNCmNvbnN0IGxsIE49MWU2KzU7DQpsbCB4Ow0Kc3RydWN0IGNhcg0Kew0KICAgIGxsIHQsbCxyOw0KICAgIGJvb2wgb3BlcmF0b3IgPCAoY29uc3QgY2FyJmEpY29uc3R7DQogICAgICAgIHJldHVybiB0PmEudDsNCiAgICB9DQp9Ow0Kc3RydWN0IGFzaw0Kew0KICAgIGxsIGMscCxpZDsNCiAgICBib29sIG9wZXJhdG9yIDwgKGNvbnN0IGFzayZhKWNvbnN0ew0KICAgICAgICByZXR1cm4gYz5hLmM7DQogICAgfQ0KfTsNCnN0cnVjdCBTZWcNCnsNCiAgICAjZGVmaW5lIGxzKHgpICh4PDwxKQ0KICAgICNkZWZpbmUgcnMoeCkgKHg8PDF8MSkNCiAgICAjZGVmaW5lIG1pZCAoKGwrcik+PjEpDQogICAgbGwgdHJbTjw8Ml0sbHpbTjw8Ml0sbHp6W048PDJdOw0KICAgIHZvaWQgcHVzaHVwKGxsIHApDQogICAgew0KICAgICAgICB0cltwXT10cltscyhwKV0rdHJbcnMocCldOw0KICAgICAgICByZXR1cm4gOw0KICAgIH0NCiAgICB2b2lkIGJ1aWxkKGxsIHAsbGwgbCxsbCByKQ0KICAgIHsNCiAgICAgICAgaWYobD09cikNCiAgICAgICAgew0KICAgICAgICAgICAgdHJbcF09bHpbcF09MDsNCiAgICAgICAgICAgIHJldHVybiA7DQogICAgICAgIH0NCiAgICAgICAgYnVpbGQobHMocCksbCxtaWQpOw0KICAgICAgICBidWlsZChycyhwKSxtaWQrMSxyKTsNCiAgICAgICAgcHVzaHVwKHApOw0KICAgIH0NCiAgICB2b2lkIHB1c2hkb3duKGxsIHAsbGwgbCxsbCByKQ0KICAgIHsNCiAgICAgICAgaWYobHp6W3BdKQ0KICAgICAgICB7DQogICAgICAgICAgICBseg0KICAgICAgICB9DQogICAgICAgIGx6W2xzKHApXSs9bHpbcF07DQogICAgICAgIGx6W3JzKHApXSs9bHpbcF07DQogICAgICAgIHRyW2xzKHApXSs9bHpbcF0qKG1pZC1sKzEpOw0KICAgICAgICB0cltycyhwKV0rPWx6W3BdKihyLW1pZCk7DQogICAgICAgIGx6W3BdPTA7DQogICAgICAgIHJldHVybiA7DQogICAgfQ0KICAgIHZvaWQgdXBkYXRlKGxsIHAsbGwgbCxsbCByLGxsIHFsLGxsIHFyLGxsIHgpDQogICAgew0KICAgICAgICBpZihsPnFyfHxyPHFsKXJldHVybiA7DQogICAgICAgIGlmKHFsPj1sJiZxcjw9cikNCiAgICAgICAgew0KICAgICAgICAgICAgdHJbcF0rPShyLWwrMSkqeDsNCiAgICAgICAgICAgIGx6W3BdKz14Ow0KICAgICAgICAgICAgcmV0dXJuIDsNCiAgICAgICAgfQ0KICAgICAgICBwdXNoZG93bihwLGwscik7DQogICAgICAgIHVwZGF0ZShscyhwKSxsLG1pZCxxbCxxcix4KTsNCiAgICAgICAgdWRwYXRlKHJzKHApLG1pZCsxLHIscWwscXIseCk7DQogICAgICAgIHB1c2h1cChwKTsNCiAgICB9DQogICAgdm9pZCB1cGRhdGV2YWwobGwgcCxsbCBsLGxsIHIsbGwgcWwsbGwgcXIsbGwgeCkNCiAgICB7DQogICAgICAgIGlmKGw+cXJ8fHI8cWwpcmV0dXJuIDsNCiAgICAgICAgaWYocWw+PWwmJnFyPD1yKQ0KICAgICAgICB7DQogICAgICAgICAgICB0cltwXT14KihyLWwrMSk7DQogICAgICAgICAgICBsenpbcF09MTsNCiAgICAgICAgICAgIHJldHVybiA7DQogICAgICAgIH0NCiAgICAgICAgcHVzaGRvd24ocCxsLHIpOw0KICAgICAgICB1cGRhdGUobHMocCksbCxtaWQscWwscXIseCk7DQogICAgICAgIHVkcGF0ZShycyhwKSxtaWQrMSxyLHFsLHFyLHgpOw0KICAgICAgICBwdXNodXAocCk7DQogICAgfQ0KICAgIGxsIHF1ZXJ5KGxsIHAsbGwgbCxsbCByLGxsIGYpDQogICAgew0KICAgICAgICBpZihsPmZ8fHI8ZilyZXR1cm4gMDsNCiAgICAgICAgaWYobD09ciYmbD09ZikNCiAgICAgICAgew0KICAgICAgICAgICAgaWYodHJbcF09PTApcmV0dXJuIC0xOw0KICAgICAgICAgICAgcmV0dXJuIHRyW3BdOw0KICAgICAgICB9DQogICAgICAgIHB1c2hkb3duKHAsbCxyKTsNCiAgICAgICAgcmV0dXJuIHF1ZXJ5KGxzKHApLGwsbWlkLGYpK3F1ZXJ5KHJzKHApLG1pZCsxLHIsZik7DQogICAgfQ0KICAgICN1bmRlZiBscw0KICAgICN1bmRlZiBycw0KICAgICN1bmRlZiBtaWQNCn1UOw0Kc2V0PHBsbD5zOw0KbGwgU1o7DQp2b2lkIEFkZChjYXIgJmEpDQp7DQogICAgbGwgTD1hLmwsUj1hLnI7DQogICAgYXV0byBrcj1zLmxvd2VyX2JvdW5kKChwbGwpe2EuciwwTEx9KTsNCiAgICBhdXRvIGtsbj1zLmxvd2VyX2JvdW5kKChwbGwpe2EubCwwTEx9KTsNCiAgICBpZihSPj14KQ0KICAgIHsNCiAgICAgICAgVC51cGRhdGV2YWwoMSwxLFNaLEwseCwxKTsNCiAgICAgICAgaWYoa2xuIT1zLmJlZ2luKCkpDQogICAgICAgIHsNCiAgICAgICAgICAgIGF1dG8ga2w9cHJldihrbG4pOw0KICAgICAgICAgICAgaWYoVC5xdWVyeSgxLDEsU1osTC0xKTw9MCkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBsbCBwcmU9TCxyZXM9MjsNCiAgICAgICAgICAgICAgICB3aGlsZSgoa2wtPnI+PXByZSkpDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICBpZigoa2wtPnIpPj1MJiYoazEtPmwpPEwpVC51cGRhdGV2YWwoMSwxLFNaLHJlcyk7DQogICAgICAgICAgICAgICAgICAgIGlmKGtsPT1zLmJlZ2luKCkpYnJlYWs7DQogICAgICAgICAgICAgICAgICAgICsrcmVzOw0KICAgICAgICAgICAgICAgICAgICBwcmU9azEtPkw7DQogICAgICAgICAgICAgICAgICAgIGtsPXByZXYoa2wpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGVsc2UgVC51cGRhdGUoMSwxLFNaLChrbC0+bCksTC0xLDEpOw0KICAgICAgICB9DQogICAgfQ0KICAgIGVsc2UgaWYoa3IhPXMuZW5kKCkpDQogICAgew0KICAgICAgICBpZihULnF1ZXJ5KDEsMSxTWixrci0+cik+MCkNCiAgICAgICAgew0KICAgICAgICAgICAgVC51cGRhdGV2YWwoMSwxLFNaLEwsKGtyLT5sKS0xLFQucXVlcnkoMSwxLFNaLGtyLT5yKSsxKTsNCiAgICAgICAgICAgIGtyPW5leHQoa3IpOw0KICAgICAgICAgICAga2xuPW5leHQoa2xuKTsNCiAgICAgICAgICAgIGlmKGtsbiE9cy5iZWdpbigpKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIFQudXBkYXRldmFsKCkNCiAgICAgICAgICAgICAgICBhdXRvIGtsPXByZXYoa2xuKTsNCiAgICAgICAgICAgICAgICBpZihULnF1ZXJ5KDEsMSxTWixMLTEpPD0wKQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgbGwgcHJlPUwscmVzPTI7DQogICAgICAgICAgICAgICAgICAgIHdoaWxlKChrbC0+cj49cHJlKSkNCiAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYoKGtsLT5yKT49TCYmKGsxLT5sKTxMKVQudXBkYXRldmFsKDEsMSxTWixyZXMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYoa2w9PXMuYmVnaW4oKSlicmVhazsNCiAgICAgICAgICAgICAgICAgICAgICAgICsrcmVzOw0KICAgICAgICAgICAgICAgICAgICAgICAgcHJlPWsxLT5MOw0KICAgICAgICAgICAgICAgICAgICAgICAga2w9cHJldihrbCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZWxzZSBULnVwZGF0ZSgxLDEsU1osKGtsLT5sKSxMLTEsMSk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQogICAgZWxzZSBzLmluc2VydCh7bCxyfSk7DQp9DQppbnQgbWFpbigpDQp7DQogICAgaW9zOjpzeW5jX3dpdGhfc3RkaW8oMCk7DQogICAgY2luLnRpZSgwKTsNCiAgICAvL0lPDQogICAgY2luPj5uPj5tPj54Ow0KICAgIHZlY3RvcjxjYXI+dihuKTsNCiAgICB2ZWN0b3I8YXNrPnZ2KG0pOw0KICAgIHZlY3RvcjxsbD5vcDsNCiAgICByZXAoaSwwLG4tMSkNCiAgICB7DQogICAgICAgIGNpbj4+dltpXS50Pj52W2ldLmw+PnZbaV0ucjsNCiAgICAgICAgb3AucGIodltpXS5sKTsNCiAgICAgICAgb3AucGIodltpXS5yKTsNCiAgICB9DQogICAgcmVwKGksMCxtLTEpDQogICAgew0KICAgICAgICBjaW4+PnZ2W2ldLmM+PnZ2W2ldLnA7DQogICAgICAgIHZ2W2ldLmlkPWk7DQogICAgICAgIG9wLnBiKHZ2W2ldLnApOw0KICAgIH0NCiAgICBvcC5wYih4KTsNCiAgICBzb3J0KGFsbChvcCkpOw0KICAgIG9wLmVyYXNlKHVuaXF1ZShhbGwob3ApKSxvcC5lbmQoKSk7DQogICAgU1o9b3Auc2l6ZSgpOw0KICAgIFQuYnVpbGQoMSwxLFNaKTsNCiAgICByZXAoaSwwLG4tMSkNCiAgICB7DQogICAgICAgIHZbaV0ubD1sb3dlcl9ib3VuZChhbGwob3AsdltpXS5sKSktb3AuYmVnaW4oKSsxOw0KICAgICAgICB2W2ldLnI9bG93ZXJfYm91bmQoYWxsKG9wLHZbaV0ucikpLW9wLmJlZ2luKCkrMTsNCiAgICB9DQogICAgcmVwKGksMCxtLTEpdnZbaV0ucD1sb3dlcl9ib3VuZChhbGwob3AsdnZbaV0ucCkpLW9wLmJlZ2luKCkrMTsNCiAgICB4PWxvd2VyX2JvdW5kKGFsbChvcCx4KSktb3AuYmVnaW4oKSsxOw0KICAgIHNvcnQoYWxsKHYpKTsNCiAgICBzb3J0KGFsbCh2dikpOw0KICAgIGxsIG5vdz0wOw0KICAgIHZlY3RvcjxsbD5hbnMobSk7DQogICAgcmVwKGksMCxtLTEpDQogICAgew0KICAgICAgICBsbCB0bT12dltpXS5jOw0KICAgICAgICB3aGlsZShub3chPW4mJnZbbm93XS50Pj10bSkNCiAgICAgICAgew0KICAgICAgICAgICAgQWRkKHZbbm93XSk7DQogICAgICAgICAgICArK25vdzsNCiAgICAgICAgfQ0KICAgICAgICBhbnNbdnZbaV0uaWRdPVQucXVlcnkoMSwxLFNaLHZ2W2ldLnApOw0KICAgIH0NCiAgICBmb3IoYXV0byB4OmFucyljb3V0PDx4PDwiXG4iOw0KfQ0K"}]