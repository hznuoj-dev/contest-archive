[{"id":"3136","submission_id":"3136","filename":"G.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+DQoNCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQojZGVmaW5lIGxuICdcbicNCg0KY29uc3QgaW50IE4gPSAyZTUgKyA1Ow0KDQppbnQgZltOXSwgc2l6W05dLCBjb2xbTl0sIHdbTl0sIGlkW05dOw0KDQppbnQgZmluZChpbnQgeCkgew0KCWlmKGZbeF0gPT0geCkgcmV0dXJuIHg7DQoJaW50IHBhciA9IGZpbmQoZlt4XSk7DQoJY29sW3hdID0gY29sW2ZbeF1dIF4gd1t4XTsNCglyZXR1cm4gcGFyOw0KfQ0KDQpib29sIGFucyA9IHRydWU7DQoNCnZvaWQgbWVyZ2UoaW50IHgsIGludCB5LCBpbnQgVykgew0KLy8JY291dCA8PCB4IDw8ICIgIiA8PCB5IDw8IGxuOw0KCWludCBmeCA9IGZpbmQoeCksIGZ5ID0gZmluZCh5KTsNCi8vCWNvdXQgPDwgeCA8PCAiICIgPDwgeSA8PCAiICIgPDwgY29sW3hdIDw8ICIgIiA8PCBjb2xbeV0gPDwgIiAiIDw8IFcgPDwgbG47DQoJaWYoZnggPT0gZnkpIHsNCgkJaWYoY29sW3hdIF4gY29sW3ldICE9IFcpIGFucyA9IGZhbHNlOw0KCQlyZXR1cm47DQoJfQ0KCWlmKHNpeltmeF0gPCBzaXpbZnldKSANCgkJc3dhcCh4LCB5KSwgc3dhcChmeCwgZnkpOw0KCQ0KCXNpeltmeF0gKz0gc2l6W2Z5XTsNCglmW2Z5XSA9IGZ4Ow0KCXdbZnldID0gY29sW3hdIF4gY29sW3ldIF4gVzsNCgkNCn0NCg0KaW5saW5lIHZvaWQgc29sdmUoKSB7DQoJaW50IG4sIHEsIG07DQoJY2luID4+IG4gPj4gcSA+PiBtOw0KCWZvcihpbnQgaSA9IDE7IGkgPD0gbjsgaSsrKSANCgkJZltpXSA9IGksIGNvbFtpXSA9IDAsIHNpeltpXSA9IDEsIHdbaV0gPSAwOw0KCWZvcihpbnQgaSA9IDE7IGkgPD0gbTsgaSsrKSB7DQoJCWludCB4LCB5LCB3Ow0KCQljaW4gPj4gdyA+PiB4ID4+IHk7DQoJCW1lcmdlKHgsIHksIHcpOw0KCQlmaW5kKHgpOyBmaW5kKHkpOw0KCX0NCglpZihhbnMgPT0gZmFsc2UpIA0KCQlyZXR1cm4gY291dCA8PCAiTk9cbiIsIHZvaWQoKTsNCi8vCWVsc2UgDQovLwkJY291dCA8PCAiWUVTXG4iOw0KCQ0KCWludCB0b3QgPSAwOw0KCWZvcihpbnQgaSA9IDE7IGkgPD0gbjsgaSsrKSANCgkJaWYoZmluZChpKSA9PSBpKSBpZFtpXSA9ICsrdG90OwkNCglmb3IoaW50IGkgPSAxOyBpIDw9IG47IGkrKykgDQoJCWlkW2ldID0gaWRbZmluZChpKV07DQoJCQ0KCXZlY3Rvcjx2ZWN0b3I8aW50Pj4gZ29vZCh0b3QgKyAxKSwgYmFkKHRvdCArIDEpOw0KCWZvcihpbnQgaSA9IDE7IGkgPD0gbjsgaSsrKSB7DQoJCWlmKGNvbFtpXSA9PSAwKSBnb29kW2lkW2ldXS5wdXNoX2JhY2soaSk7DQoJCWVsc2UgYmFkW2lkW2ldXS5wdXNoX2JhY2soaSk7DQoJfQ0KCQ0KCWludCBtbiA9IG1pbihxLCBuIC0gcSk7DQoJDQovLwljb3V0IDw8IG1uIDw8IGxuOw0KCQ0KCXZlY3RvcjxiaXRzZXQ8MTAwMDA1Pj4gcCh0b3QgKyAxKTsNCglwWzBdWzBdID0gMTsNCglmb3IoaW50IGkgPSAxOyBpIDw9IHRvdDsgaSsrKSANCgkJcFtpXSA9IChwW2kgLSAxXSA8PCBnb29kW2ldLnNpemUoKSkgfCAocFtpIC0gMV0gPDwgYmFkW2ldLnNpemUoKSk7DQovLwkJY291dCA8PCBwW2ldIDw8IGxuOw0KDQoJaWYocFt0b3RdW21uXSA9PSAwKSByZXR1cm4gY291dCA8PCAiTk9cbiIsIHZvaWQoKTsNCgljb3V0IDw8ICJZRVNcbiI7DQoNCgl2ZWN0b3I8aW50PiBhbnNfZ29vZCwgYW5zX2JhZDsNCglmb3IoaW50IGkgPSB0b3Q7IGk7IGktLSkNCgkJaWYobW4gPj0gZ29vZFtpXS5zaXplKCkgJiYgcFtpIC0gMV1bbW4gLSBnb29kW2ldLnNpemUoKV0pICB7DQoJCQltbiAtPSBnb29kW2ldLnNpemUoKTsNCgkJCWZvcihhdXRvIHg6IGdvb2RbaV0pIGFuc19nb29kLnB1c2hfYmFjayh4KTsNCgkJCWZvcihhdXRvIHg6IGJhZFtpXSkgYW5zX2JhZC5wdXNoX2JhY2soeCk7DQoJCX0gZWxzZSB7DQoJCQltbiAtPSBiYWRbaV0uc2l6ZSgpOw0KCQkJZm9yKGF1dG8geDogYmFkW2ldKSBhbnNfZ29vZC5wdXNoX2JhY2soeCk7DQoJCQlmb3IoYXV0byB4OiBnb29kW2ldKSBhbnNfYmFkLnB1c2hfYmFjayh4KTsJDQoJCX0NCgkNCglzb3J0KGFuc19nb29kLmJlZ2luKCksIGFuc19nb29kLmVuZCgpKTsNCglzb3J0KGFuc19iYWQuYmVnaW4oKSwgYW5zX2JhZC5lbmQoKSk7DQoJaWYoYW5zX2dvb2Quc2l6ZSgpID09IHEpIHsNCgkJZm9yKGF1dG8geDogYW5zX2dvb2QpIGNvdXQgPDwgeCA8PCAiICI7DQoJCWNvdXQgPDwgbG47DQoJfSBlbHNlIHsNCgkJZm9yKGF1dG8geDogYW5zX2JhZCkgY291dCA8PCB4IDw8ICIgIjsNCgkJY291dCA8PCBsbjsNCgl9DQp9DQoNCmludCBtYWluKCkgew0KCQ0KLy8JZnJlb3BlbigiMS50eHQiLCAiciIsIHN0ZGluKTsNCgkNCglpb3M6OnN5bmNfd2l0aF9zdGRpbyhmYWxzZSk7DQoJY2luLnRpZShudWxscHRyKTsNCgkNCglzb2x2ZSgpOw0KfQ0KDQovKg0KMiAxIDINCjEgMSAyDQowIDIgMQ0KDQowIDAgMQ0KMSAwIDANCiovDQo="}]