[{"id":"3547","submission_id":"3547","filename":"D.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+DQp1c2luZyBuYW1lc3BhY2Ugc3RkOw0KDQpjb25zdCBpbnQga01heE4gPSA0ZTUgKyA1LCBrSW5mID0gMHgzZjNmM2YzZjsNCmludCBuLCBtLCB4LCBhbnNba01heE5dLCBpbmZ0ID0gMHgzZjNmM2YzZiwgaW5meCA9IDB4M2YzZjNmM2Y7DQpzdHJ1Y3QgTm9kZSB7DQoJaW50IHFpZCwgdCwgbCwgciwgZHA7DQp9IGFba01heE5dOw0KdmVjdG9yPGludD4gYiwgYzsNCmludCBjYVtrTWF4Tl0sIGNiW2tNYXhOXTsNCg0KaW5saW5lIGludCBsb3diaXQoaW50IHgpIHsNCglyZXR1cm4geCAmIC14Ow0KfQ0KDQp2b2lkIGNkcShpbnQgbCwgaW50IHIpIHsNCglpZiAobCA9PSByKSByZXR1cm47DQoJDQoJaW50IG1pZCA9IChsICsgcikgPj4gMTsNCgljZHEobWlkICsgMSwgcik7DQoJDQoJY2FbMF0gPSBjYlswXSA9IDA7DQoJZm9yIChpbnQgaSA9IG1pZCArIDE7IGkgPD0gcjsgKytpKSB7DQoJCWlmIChhW2ldLnFpZCA+IDApIGNvbnRpbnVlOw0KCQljYlsrK2NiWzBdXSA9IGk7DQoJfQ0KCWZvciAoaW50IGkgPSBsOyBpIDw9IG1pZDsgKytpKSB7DQoJCWNhWysrY2FbMF1dID0gaTsNCgl9DQoJc29ydChjYSArIDEsIGNhICsgY2FbMF0gKyAxLCBbJl0oaW50IHgsIGludCB5KSB7DQoJCXJldHVybiBhW3hdLnQgPiBhW3ldLnQgfHwgKGFbeF0udCA9PSBhW3ldLnQgJiYgYVt4XS5yIDwgYVt5XS5yKTsNCgl9KTsNCglzb3J0KGNiICsgMSwgY2IgKyBjYlswXSArIDEsIFsmXShpbnQgeCwgaW50IHkpIHsNCgkJcmV0dXJuIGFbeF0udCA+IGFbeV0udCB8fCAoYVt4XS50ID09IGFbeV0udCAmJiBhW3hdLmwgPCBhW3ldLmwpOw0KCX0pOw0KCXZlY3RvcjxpbnQ+IHRtcDsNCglmb3IgKGludCBpID0gMTsgaSA8PSBjYlswXTsgKytpKSB7DQoJCXRtcC5wdXNoX2JhY2soYVtjYltpXV0ubCk7DQoJfQ0KCWZvciAoaW50IGkgPSAxOyBpIDw9IGNhWzBdOyArK2kpIHsNCgkJdG1wLnB1c2hfYmFjayhhW2NhW2ldXS5yKTsNCgl9DQoJc29ydCh0bXAuYmVnaW4oKSwgdG1wLmVuZCgpKTsNCgl0bXAucmVzaXplKHVuaXF1ZSh0bXAuYmVnaW4oKSwgdG1wLmVuZCgpKSAtIHRtcC5iZWdpbigpKTsNCgkNCglhdXRvIGlkeCA9IFsmXShpbnQgdmFsKSB7DQoJCXJldHVybiBsb3dlcl9ib3VuZCh0bXAuYmVnaW4oKSwgdG1wLmVuZCgpLCB2YWwpIC0gdG1wLmJlZ2luKCkgKyAxOw0KCX07DQoJDQoJaW50IGxpbSA9IChpbnQpdG1wLnNpemUoKSArIDE7DQoJdmVjdG9yPGludD4gYml0KGxpbSArIDEsIGtJbmYpOw0KCWF1dG8gcXVlcnkgPSBbJl0oaW50IHgpIHsNCgkJeCA9IGlkeCh4KTsNCgkJaW50IGFucyA9IGtJbmY7DQoJCXdoaWxlICh4ID4gMCkgew0KCQkJYW5zID0gbWluKGFucywgYml0W3hdKTsNCgkJCXggLT0gbG93Yml0KHgpOw0KCQl9DQoJCXJldHVybiBhbnM7DQoJfTsNCgkNCglhdXRvIGFkZCA9IFsmXShpbnQgeCwgaW50IHZhbCkgew0KCQl4ID0gaWR4KHgpOw0KCQl3aGlsZSAoeCA8PSBsaW0pIHsNCgkJCWJpdFt4XSA9IG1pbihiaXRbeF0sIHZhbCk7DQoJCQl4ICs9IGxvd2JpdCh4KTsNCgkJfQ0KCX07DQoJDQoJLy8gZGVjcmVhc2luZ2x5IGVudW1lcmF0ZSB0DQoJZm9yIChpbnQgaSA9IDEsIGogPSAwOyBpIDw9IGNhWzBdOyArK2kpIHsNCgkJd2hpbGUgKGogKyAxIDw9IGNiWzBdICYmIChhW2NhW2ldXS50IDwgYVtjYltqICsgMV1dLnQgfHwgKGFbY2FbaV1dLnQgPT0gYVtjYltqICsgMV1dLnQgJiYgYVtjYVtpXV0uciA+PSBhW2NiW2ogKyAxXV0ubCkpKSB7DQoJCQlhZGQoYVtjYltqICsgMV1dLmwsIGFbY2JbaiArIDFdXS5kcCk7DQoJCQkrK2o7DQoJCX0NCgkJDQoJCWFbY2FbaV1dLmRwID0gbWluKGFbY2FbaV1dLmRwLCBxdWVyeShhW2NhW2ldXS5yKSArIDEpOw0KCX0NCgkNCgljZHEobCwgbWlkKTsNCn0NCg0KaW50IG1haW4oKSB7DQoJaW9zOjpzeW5jX3dpdGhfc3RkaW8oZmFsc2UpOw0KCWNpbiA+PiBuID4+IG0gPj4geDsNCglmb3IgKGludCBpID0gMTsgaSA8PSBuOyArK2kpIHsNCgkJYVtpXS5xaWQgPSAwOw0KCQljaW4gPj4gYVtpXS50ID4+IGFbaV0ubCA+PiBhW2ldLnI7DQoJCWIucHVzaF9iYWNrKGFbaV0udCk7DQoJCWMucHVzaF9iYWNrKGFbaV0ubCk7DQoJCWMucHVzaF9iYWNrKGFbaV0ucik7DQoJfQ0KCQ0KCWZvciAoaW50IGkgPSAxOyBpIDw9IG07ICsraSkgew0KCQlpbnQgdGEsIHRiOw0KCQljaW4gPj4gdGEgPj4gdGI7DQoJCWFbaSArIG5dLnFpZCA9IGk7DQoJCWFbaSArIG5dLnQgPSB0YTsNCgkJYVtpICsgbl0ubCA9IGFbaSArIG5dLnIgPSB0YjsNCgkJYi5wdXNoX2JhY2sodGEpOw0KCQljLnB1c2hfYmFjayh0Yik7DQoJfQ0KCQ0KCWIucHVzaF9iYWNrKGluZnQpOw0KCWMucHVzaF9iYWNrKHgpOw0KCXNvcnQoYi5iZWdpbigpLCBiLmVuZCgpKTsNCgliLnJlc2l6ZSh1bmlxdWUoYi5iZWdpbigpLCBiLmVuZCgpKSAtIGIuYmVnaW4oKSk7DQoJc29ydChjLmJlZ2luKCksIGMuZW5kKCkpOw0KCWMucmVzaXplKHVuaXF1ZShjLmJlZ2luKCksIGMuZW5kKCkpIC0gYy5iZWdpbigpKTsNCgkNCglpbmZ0ID0gbG93ZXJfYm91bmQoYi5iZWdpbigpLCBiLmVuZCgpLCBpbmZ0KSAtIGIuYmVnaW4oKSArIDE7DQoJeCA9IGxvd2VyX2JvdW5kKGMuYmVnaW4oKSwgYy5lbmQoKSwgeCkgLSBjLmJlZ2luKCkgKyAxOw0KCWZvciAoaW50IGkgPSAxOyBpIDw9IG4gKyBtOyArK2kpIHsNCgkJYVtpXS50ID0gbG93ZXJfYm91bmQoYi5iZWdpbigpLCBiLmVuZCgpLCBhW2ldLnQpIC0gYi5iZWdpbigpICsgMTsNCgkJYVtpXS5sID0gbG93ZXJfYm91bmQoYy5iZWdpbigpLCBjLmVuZCgpLCBhW2ldLmwpIC0gYy5iZWdpbigpICsgMTsNCgkJYVtpXS5yID0gbG93ZXJfYm91bmQoYy5iZWdpbigpLCBjLmVuZCgpLCBhW2ldLnIpIC0gYy5iZWdpbigpICsgMTsNCgkJYVtpXS5kcCA9IGtJbmY7DQoJfQ0KCWFbbiArIG0gKyAxXS50ID0gaW5mdDsNCglhW24gKyBtICsgMV0ubCA9IHg7DQoJYVtuICsgbSArIDFdLnIgPSB4ICsgMTsNCglhW24gKyBtICsgMV0ucWlkID0gLTE7DQoJYVtuICsgbSArIDFdLmRwID0gMDsNCgkNCglzb3J0KGEgKyAxLCBhICsgKG4gKyBtICsgMSkgKyAxLCBbJl0oY29uc3QgTm9kZSAmbGhzLCBjb25zdCBOb2RlICZyaHMpIHsNCgkJcmV0dXJuIGxocy5yIDwgcmhzLnI7CQ0KCX0pOw0KCWNkcSgxLCBuICsgbSArIDEpOw0KCQ0KCWZvciAoaW50IGkgPSAxOyBpIDw9IG4gKyBtICsgMTsgKytpKSB7DQoJCWlmIChhW2ldLnFpZCA+IDApIGFuc1thW2ldLnFpZF0gPSBhW2ldLmRwOw0KCX0NCgkNCi8vCWZvciAoaW50IGkgPSAxOyBpIDw9IG4gKyBtICsgMTsgKytpKSB7DQovLwkJY291dCA8PCBhW2ldLnQgPDwgIiAiIDw8IGFbaV0ubCA8PCAiICIgPDwgYVtpXS5yIDw8ICIgIiA8PCBhW2ldLmRwIDw8ICJcbiI7DQovLwl9DQoJDQoJZm9yIChpbnQgaSA9IDE7IGkgPD0gbTsgKytpKSB7DQoJCWlmIChhbnNbaV0gPCBrSW5mKSB7DQoJCQljb3V0IDw8IGFuc1tpXSAtIDEgPDwgIlxuIjsNCgkJfSBlbHNlIHsNCgkJCWNvdXQgPDwgLTEgPDwgIlxuIjsNCgkJfQ0KCX0NCgkNCglyZXR1cm4gMDsNCn0="}]