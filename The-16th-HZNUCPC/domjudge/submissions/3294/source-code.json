[{"id":"3294","submission_id":"3294","filename":"I.cpp","source":"I2luY2x1ZGU8Yml0cy9zdGRjKysuaD4NCiNkZWZpbmUgbGwgbG9uZyBsb25nDQojZGVmaW5lIGFsbChhKSAoYSkuYmVnaW4oKSwoYSkuZW5kOw0KdXNpbmcgbmFtZXNwYWNlIHN0ZDsNCmNvbnN0IGludCBOID0gNWUzICsgMTA7DQoNCmxsIHAgPSAyMzMzLCBtb2QgPSAxZTkgKyA3LCBoMVtOXSwgaDJbTl07DQpsbCBwcFtOXTsNCg0KbGwgZ2V0MShpbnQgbCwgaW50IHIpDQp7DQoJcmV0dXJuIChoMVtyXSAtIGgxW2wgLSAxXSAqIHBwW3IgLSBsICsgMV0gJSBtb2QgKyBtb2QpICUgbW9kOw0KfQ0KDQpsbCBnZXQyKGludCBsLCBpbnQgcikNCnsNCglyZXR1cm4gKGgyW2xdIC0gaDJbciArIDFdICogcHBbciAtIGwgKyAxXSAlIG1vZCArIG1vZCkgJSBtb2Q7DQp9DQoNCmludCBjYWwoaW50IGksIGludCBqKQ0Kew0KCWlmKGogPD0gaSkgcmV0dXJuIC0xOw0KCQ0KCWludCBsID0gMSwgciA9IChqIC0gaSArIDEpIC8gMiwgcmVzID0gLTE7DQoJd2hpbGUobCA8PSByKQ0KCXsNCgkJaW50IG1pZCA9IChsICsgcikgLyAyOw0KCQkNCgkJbGwgczEgPSBnZXQxKGksIGkgKyBtaWQgLSAxKTsNCgkJbGwgczIgPSBnZXQyKGogLSBtaWQgKyAxLCBqKTsNCgkJDQovLwkJaWYoaSA9PSAzICYmIGogPT0gNSkgY291dCA8PCBpIDw8ICcgJyA8PCBpICsgbWlkIC0gMSA8PCAnICcgPDwgaiAtIG1pZCArIDE8PCcgJyA8PCBqIDw8ICdcbic7DQovLwkJaWYoaSA9PSAzICYmIGogPT0gNSkgY291dCA8PCAiczEgczIgOiAiIDw8IHMxIDw8ICcgJyA8PCBzMiA8PCAnXG4nOw0KCQkNCgkJaWYoczEgIT0gczIpIA0KCQl7DQoJCQlyZXMgPSBtaWQ7DQoJCQlyID0gbWlkIC0gMTsNCgkJfQ0KCQllbHNlDQoJCQlsID0gbWlkICsgMTsNCgl9DQoJcmV0dXJuIHJlczsNCn0NCg0Kdm9pZCBzb2x2ZSgpDQp7DQoJc3RyaW5nIHM7DQoJY2luID4+IHM7DQoJaW50IG4gPSBzLnNpemUoKTsNCglzID0gJz8nICsgczsNCgkNCglmb3IoaW50IGkgPSAxOyBpIDw9IG47IGkrKykgaDFbaV0gPSAoaDFbaSAtIDFdICogcCAlIG1vZCArIHNbaV0pICUgbW9kOw0KCWgyW24gKyAxXSA9IDA7DQoJZm9yKGludCBpID0gbjsgaSA+PSAxOyBpLS0pIGgyW2ldID0gKGgyW2kgKyAxXSAqIHAgJSBtb2QgKyBzW2ldKSAlIG1vZDsNCgkNCi8vCWZvciAoaW50IGkgPSAxOyBpIDw9IG47IGkrKykNCi8vCQljb3V0IDw8IGgxW2ldIDw8ICcgJzsNCi8vCWNvdXQgPDwgJ1xuJzsNCi8vCWZvciAoaW50IGkgPSBuOyBpID49IDE7IGktLSkNCi8vCQljb3V0IDw8IGgyW2ldIDw8ICcgJzsNCi8vCWNvdXQgPDwgJ1xuJzsNCgkNCglpbnQgYW5zID0gMDsNCglmb3IoaW50IGkgPSAxOyBpIDw9IG47IGkrKykNCgl7DQoJCWZvcihpbnQgaiA9IGkgKyAxOyBqIDw9IG47IGorKykNCgkJew0KCQkJaW50IHJlcyA9IGNhbChpLCBqKTsNCgkJCQ0KLy8JCQlpZihpID09IDMgJiYgaiA9PSA1KSBjb3V0IDw8InJlcyAiIDw8ICByZXMgPDwgJ1xuJzsNCgkJCQ0KCQkJaWYocmVzID09IC0xKQ0KCQkJew0KLy8JCQkJY291dCA8PCAiPz8/MSIgPDwgJyAnIDw8IGkgPDwgJyAnIDw8IGogPDwgJ1xuJzsNCgkJCQlhbnMgPSBtYXgoaiAtIGkgKyAxLCBhbnMpOw0KCQkJCWNvbnRpbnVlOw0KCQkJfQ0KCQkJDQoJCQlpbnQgTDEgPSBpICsgcmVzIC0gMTsNCgkJCWludCBSMSA9IGogLSByZXMgKyAxOw0KCQkJDQoJCQlyZXMgPSBjYWwoTDEgKyAxLCBSMSAtIDEpOw0KCQkJDQovLwkJCWlmKGogLSBpICsgMSA9PSA2KSBjb3V0IDw8InJlcyAiIDw8ICByZXMgPDwgJ1xuJzsNCgkJCQ0KCQkJaWYocmVzID09IC0xKQ0KCQkJew0KCQkJCWludCBsZW4gPSBqIC0gaSArIDE7DQoJCQkJaWYobGVuICUgMikNCgkJCQl7DQoJCQkJCWlmKHNbTDFdID09IHNbaSArIChqIC0gaSkgLyAyXSB8fCBzW1IxXSA9PSBzW2kgKyAoaiAtIGkpIC8gMl0pDQoJCQkJCXsNCi8vCQkJCQkJY291dCA8PCAiPz8/MiIgPDwgJ1xuJzsNCgkJCQkJCWFucyA9IG1heChhbnMsIGogLSBpICsgMSk7DQoJCQkJCX0NCgkJCQl9DQoJCQkJY29udGludWU7DQoJCQl9DQoJCQkNCgkJCWludCBMMiA9IEwxICsgcmVzOw0KCQkJaW50IFIyID0gUjEgLSByZXM7DQoJCQkNCgkJCXJlcyA9IGNhbChMMiArIDEsIFIyIC0gMSk7DQoJCQkNCi8vCQkJaWYoaiAtIGkgKyAxID09IDYpIGNvdXQgPDwgTDEgPDwgJyAnIDw8IEwyIDw8ICcgJyA8PCBSMiA8PCAnICcgPDwgUjEgPDwgJ1xuJzsNCgkJCQ0KCQkJaWYocmVzICE9IC0xKSBjb250aW51ZTsNCgkJCQ0KCQkJaWYoc1tMMV0gPT0gc1tMMl0gJiYgc1tSMV0gPT0gc1tSMl0gfHwgc1tMMV0gPT0gc1tSMl0gJiYgc1tSMV0gPT0gc1tMMl0pDQoJCQkJYW5zID0gbWF4KGFucywgaiAtIGkgKyAxKTsNCgkJfQ0KCX0NCgkNCgljb3V0IDw8IGFucyA8PCAnXG4nOw0KfQ0KDQpzaWduZWQgbWFpbigpDQp7DQoJaW9zOjpzeW5jX3dpdGhfc3RkaW8oZmFsc2UpOw0KCWNpbi50aWUoMCk7Y291dC50aWUoMCk7DQoJaW50IHQgPSAxOw0KCXBwWzBdID0gMTsNCglmb3IoaW50IGkgPSAxOyBpIDwgTjsgaSsrKSBwcFtpXSA9IHBwW2kgLSAxXSAqIHAgJSBtb2Q7DQoJY2luID4+IHQ7DQoJd2hpbGUodC0tKSBzb2x2ZSgpOw0KCXJldHVybiAwOw0KfQ0KLyoNCjQNCmFiY2NhYg0KaWhpDQpzdGZnZml1dA0KcGFsaW5kcm9tZQ0KKi8="}]