[{"id":"3734","submission_id":"3734","filename":"A02.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+DQoNCnR5cGVkZWYgbG9uZyBsb25nIGludCBsbDsNCg0KaW50IG47DQoNCmludCBib2FyZFs1MF1bNTBdOw0KDQpib29sIHZpc1s1MF1bNTBdOw0KDQpib29sIGF2YWlbNTBdWzUwXTsNCg0Kdm9pZCBkZnMoaW50IHgsIGludCB5LCBpbnQgY29sKXsNCgl2aXNbeF1beV0gPSB0cnVlOw0KCWlmKHggPiAxKXsNCgkJaWYoMCA9PSBib2FyZFt4IC0gMV1beV0pew0KCQkJYXZhaVt4IC0gMV1beV0gPSB0cnVlOw0KCQl9ZWxzZSBpZihjb2wgPT0gYm9hcmRbeCAtIDFdW3ldICYmICF2aXNbeCAtIDFdW3ldKXsNCgkJCWRmcyh4IC0gMSwgeSwgY29sKTsNCgkJfQ0KCX0NCglpZih4IDwgMTkpew0KCQlpZigwID09IGJvYXJkW3ggKyAxXVt5XSl7DQoJCQlhdmFpW3ggKyAxXVt5XSA9IHRydWU7DQoJCX1lbHNlIGlmKGNvbCA9PSBib2FyZFt4ICsgMV1beV0gJiYgIXZpc1t4ICsgMV1beV0pew0KCQkJZGZzKHggKyAxLCB5LCBjb2wpOw0KCQl9DQoJfQ0KCWlmKHkgPiAxKXsNCgkJaWYoMCA9PSBib2FyZFt4XVt5IC0gMV0pew0KCQkJYXZhaVt4XVt5IC0gMV0gPSB0cnVlOw0KCQl9ZWxzZSBpZihjb2wgPT0gYm9hcmRbeF1beSAtIDFdICYmICF2aXNbeF1beSAtIDFdKXsNCgkJCWRmcyh4LCB5IC0gMSwgY29sKTsNCgkJfQ0KCX0NCglpZih5IDwgMTkpew0KCQlpZigwID09IGJvYXJkW3hdW3kgKyAxXSl7DQoJCQlhdmFpW3hdW3kgKyAxXSA9IHRydWU7DQoJCX1lbHNlIGlmKGNvbCA9PSBib2FyZFt4XVt5ICsgMV0gJiYgIXZpc1t4XVt5ICsgMV0pew0KCQkJZGZzKHgsIHkgKyAxLCBjb2wpOw0KCQl9DQoJfQ0KfQ0KDQp2b2lkIGVyYXNlKGludCB4LCBpbnQgeSl7DQoJYm9hcmRbeF1beV0gPSAwOw0KCWlmKHggPiAxKXsNCgkJaWYoMiA9PSBib2FyZFt4IC0gMV1beV0pew0KCQkJZXJhc2UoeCAtIDEsIHkpOw0KCQl9DQoJfQ0KCWlmKHggPCAxOSl7DQoJCWlmKDIgPT0gYm9hcmRbeCArIDFdW3ldKXsNCgkJCWVyYXNlKHggKyAxLCB5KTsNCgkJfQ0KCX0NCglpZih5ID4gMSl7DQoJCWlmKDIgPT0gYm9hcmRbeF1beSAtIDFdKXsNCgkJCWVyYXNlKHgsIHkgLSAxKTsNCgkJfQ0KCX0NCglpZih5IDwgMTkpew0KCQlpZigyID09IGJvYXJkW3hdW3kgKyAxXSl7DQoJCQllcmFzZSh4LCB5ICsgMSk7DQoJCX0NCgl9DQp9DQoNCmludCBtYWluKCl7DQoJaW50IFQ7DQoJZm9yKHNjYW5mKCIlZCIsICZUKTsgVCA+IDA7IFQtLSl7DQoJCXNjYW5mKCIlZCIsICZuKTsNCgkJaW50IGksIGosIGs7DQoJCWZvcihpID0gMTsgaSA8PSAxOTsgaSsrKXsNCgkJCWZvcihqID0gMTsgaiA8PSAxOTsgaisrKXsNCgkJCQlib2FyZFtpXVtqXSA9IDA7DQoJCQkJdmlzW2ldW2pdID0gZmFsc2U7DQoJCQkJYXZhaVtpXVtqXSA9IGZhbHNlOw0KCQkJfQ0KCQl9DQoJCQ0KCQlpbnQgeCwgeTsNCgkJZm9yKCA7IG4gPiAwOyBuLS0pew0KCQkJc2NhbmYoIiVkJWQiLCAmeCwgJnkpOw0KCQkJc2NhbmYoIiVkIiwgJmJvYXJkW3hdW3ldKTsNCgkJfQ0KCQkNCgkJLypmb3IoaSA9IDE7IGkgPD0gMTk7IGkrKyl7DQoJCQlmb3IoaiA9IDE7IGogPD0gMTk7IGorKyl7DQoJCQkJaWYoMiA9PSBib2FyZFtpXVtqXSAmJiAhdmlzW2ldW2pdKXsNCgkJCQkJaW50IGssIHQ7DQoJCQkJCWZvcihrID0gMTsgayA8PSAxOTsgaysrKXsNCgkJCQkJCWZvcih0ID0gMTsgdCA8PSAxOTsgdCsrKXsNCgkJCQkJCQlhdmFpW2tdW3RdID0gZmFsc2U7DQoJCQkJCQl9DQoJCQkJCX0NCgkJCQkJZGZzKGksIGosIDIpOw0KCQkJCQlib29sIGIgPSBmYWxzZTsNCgkJCQkJZm9yKGsgPSAxOyBrIDw9IDE5OyBrKyspew0KCQkJCQkJZm9yKHQgPSAxOyB0IDw9IDE5OyB0Kyspew0KCQkJCQkJCWIgPSBiIHx8IGF2YWlba11bdF07DQoJCQkJCQl9DQoJCQkJCX0NCgkJCQkJDQoJCQkJCWlmKCFiKXsNCgkJCQkJCWVyYXNlKGksIGopOw0KCQkJCQl9DQoJCQkJfQ0KCQkJfQ0KCQl9Ki8NCgkJDQoJCWludCBhbnMgPSAwOw0KCQlmb3IoaSA9IDE7IGkgPD0gMTk7IGkrKyl7DQoJCQlmb3IoaiA9IDE7IGogPD0gMTk7IGorKyl7DQoJCQkJaWYoMSA9PSBib2FyZFtpXVtqXSAmJiAhdmlzW2ldW2pdKXsNCgkJCQkJaW50IGssIHQ7DQoJCQkJCWZvcihrID0gMTsgayA8PSAxOTsgaysrKXsNCgkJCQkJCWZvcih0ID0gMTsgdCA8PSAxOTsgdCsrKXsNCgkJCQkJCQlhdmFpW2tdW3RdID0gZmFsc2U7DQoJCQkJCQl9DQoJCQkJCX0NCgkJCQkJZGZzKGksIGosIDEpOw0KCQkJCQlmb3IoayA9IDE7IGsgPD0gMTk7IGsrKyl7DQoJCQkJCQlmb3IodCA9IDE7IHQgPD0gMTk7IHQrKyl7DQoJCQkJCQkJaWYoYXZhaVtrXVt0XSl7DQoJCQkJCQkJCWFucysrOw0KCQkJCQkJCX0NCgkJCQkJCX0NCgkJCQkJfQ0KCQkJCX0NCgkJCX0NCgkJfQ0KCQkNCgkJcHJpbnRmKCIlZFxuIiwgYW5zKTsNCgl9DQoJcmV0dXJuIDA7DQp9DQo="}]