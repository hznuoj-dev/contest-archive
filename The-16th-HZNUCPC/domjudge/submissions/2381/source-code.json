[{"id":"2381","submission_id":"2381","filename":"G.cpp","source":"I2luY2x1ZGU8Yml0cy9zdGRjKysuaD4NCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQojZGVmaW5lIE4gMTAwMDEwDQojZGVmaW5lIHJlcChpLGwscikgZm9yKGludCBpPShsKTtpPD0ocik7aSsrKQ0KdXNpbmcgbGwgPWxvbmcgbG9uZyA7DQoNCmludCBuLGZhW05dLG0sZ29vZHMsc3pbTl07DQppbnQgRmluZChpbnQgeCl7cmV0dXJuIGZhW3hdPT14P3g6ZmFbeF09RmluZChmYVt4XSk7fQ0KdmVjdG9yPHBhaXI8aW50LGludD4+IGU7DQp2ZWN0b3I8aW50PiBnW05dOw0Kdm9pZCBtZXJnZShpbnQgdSxpbnQgdil7DQogICAgaW50IHB4PUZpbmQodSkscHk9RmluZCh2KTsNCiAgICBpZihweD09cHkpcmV0dXJuOw0KICAgIGZhW3B4XT1weTsNCiAgICBzeltweV0rPXN6W3B4XTsNCn0NCg0KYm9vbCB2aXNbTl07dmVjdG9yPGludD4geHh4W05dOw0KaW50IGNudFsyXSxjb2xbTl0sYVtOXSxiW05dLHBwOw0Kdm9pZCBkZnMoaW50IHUsaW50IHgpew0KICAgIHh4eFtwcF0ucHVzaF9iYWNrKHUpOw0KICAgIGNvbFt1XT14Ow0KICAgIGNudFtjb2xbdV1dKz1zelt1XTsNCiAgICB2aXNbdV09MTsNCiAgICBmb3IoaW50IHY6Z1t1XSl7DQogICAgICAgIGlmKHZpc1t2XT09MClkZnModix4XjEpOw0KICAgICAgICBlbHNlew0KICAgICAgICAgICAgaWYoY29sW3ZdPT14KXsNCiAgICAgICAgICAgICAgICBwdXRzKCJOTyIpOw0KICAgICAgICAgICAgICAgIGV4aXQoMCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQp9DQoNCmJpdHNldDwxMDAwMDE+IHRtcCxkcFsxMDAwMDFdLGdnLGgsZjsNCg0KaW50IGNbTl07DQp2ZWN0b3I8aW50PiBfaW5bTl07DQp2b2lkIHNvbHZlKCl7DQogICAgc2NhbmYoIiVkJWQlZCIsJm4sJmdvb2RzLCZtKTsNCiAgICByZXAoaSwxLG4pZmFbaV09aSxzeltpXT0xOw0KICAgIHJlcChpLDEsbSl7DQogICAgICAgIGludCBvLHUsdjsNCiAgICAgICAgc2NhbmYoIiVkJWQlZCIsJm8sJnUsJnYpOw0KICAgICAgICBpZihvPT0wKXsNCiAgICAgICAgICAgIG1lcmdlKHUsdik7DQogICAgICAgIH1lbHNlew0KICAgICAgICAgICAgZS5wdXNoX2JhY2soe3Usdn0pOw0KICAgICAgICB9DQogICAgfQ0KICAgIGZvcihhdXRvIFt1LHZdOmUpew0KICAgICAgICBpZihGaW5kKHUpPT1GaW5kKHYpKXsNCiAgICAgICAgICAgIHB1dHMoIk5PIik7DQogICAgICAgICAgICByZXR1cm47DQogICAgICAgIH0NCiAgICAgICAgZ1tGaW5kKHUpXS5wdXNoX2JhY2soRmluZCh2KSk7DQogICAgICAgIC8vcHJpbnRmKCIlZCAlZFxuIixGaW5kKHUpLEZpbmQodikpOw0KICAgIH0NCiAgICByZXAoaSwxLG4pX2luW0ZpbmQoaSldLnB1c2hfYmFjayhpKTsNCiAgICBtPTA7DQogICAgcmVwKGksMSxuKXsNCiAgICAgICAgaWYoRmluZChpKSE9aSljb250aW51ZTsNCiAgICAgICAgaWYodmlzW2ldKWNvbnRpbnVlOw0KICAgICAgICBjbnRbMF09Y250WzFdPTA7DQogICAgcHA9aTsNCiAgICAgICAgZGZzKGksMCk7DQogICAgICAgIGFbKyttXT1jbnRbMF07DQogICAgICAgIGJbbV09Y250WzFdOw0KICAgICAgICBjW21dPWk7DQoNCiAgICAgICAgLy9mb3IoaW50IHU6eHh4W2ldKXByaW50ZigiJWQgIix1KTtwdXRzKCIiKTsNCiAgICB9DQogICAgLy9yZXAoaSwxLG0pcHJpbnRmKCIlZCAlZFxuIixhW2ldLGJbaV0pOw0KICAgIGZbMF09MSxkcFswXT1mOw0KICAgIHJlcChpLDEsbSl7DQogICAgICAgIGdnPShmPDxhW2ldKTsNCiAgICAgICAgaD0oZjw8YltpXSk7DQogICAgICAgIGZ8PWdnLGZ8PWg7DQogICAgICAgIGRwW2ldPWY7DQogICAgfQ0KICAgIGlmKGZbZ29vZHNdPT0wKXB1dHMoIk5PIik7DQogICAgZWxzZXsNCiAgICAgICAgcHV0cygiWUVTIik7DQogICAgICAgIC8vcmVwKGksMSxuKWlmKGZbaV09PTEpcHJpbnRmKCIlZCAiLGkpO3B1dHMoIiIpOw0KICAgICAgICBpbnQgY3VyPWdvb2RzOw0KICAgICAgICBmb3IoaW50IGk9bTtpPj0xOy0taSl7DQogICAgICAgICAgICAgICAgLy9wcmludGYoImN1cj0lZFxuIixjdXIpOw0KICAgICAgICBpZihjdXI9PTApYnJlYWs7DQogICAgICAgICAgICBpZihjdXItYVtpXT49MCYmZHBbaS0xXVtjdXItYVtpXV09PTEpew0KICAgICAgICAgICAgICAgIC8vcHJpbnRmKCIlZCAiLGFbaV0pOw0KICAgICAgICAgICAgICAgIGZvcihpbnQgdTp4eHhbY1tpXV0paWYoY29sW3VdPT0wKXsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvcihpbnQgeDpfaW5bdV0pcHJpbnRmKCIlZCAiLHgpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBjdXItPWFbaV07DQogICAgICAgICAgICB9ZWxzZSBpZihjdXItYltpXT49MCYmZHBbaS0xXVtjdXItYltpXV09PTEpew0KICAgICAgICAgICAgICAgIC8vcHJpbnRmKCIlZCAiLGJbaV0pOw0KICAgICAgICAgICAgICAgIGN1ci09YltpXTsNCiAgICAgICAgICAgICAgICBmb3IoaW50IHU6eHh4W2NbaV1dKWlmKGNvbFt1XT09MSl7DQogICAgICAgICAgICAgICAgICAgIGZvcihpbnQgeDpfaW5bdV0pcHJpbnRmKCIlZCAiLHgpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH1lbHNlew0KICAgICAgICAgICAgICAgIC8vZXhpdCgwKTsNCiAgICAgICAgICAgICAgICBhc3NlcnQoMCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KDQogICAgfQ0KfQ0KDQppbnQgbWFpbigpIHsNCiAgICAvL2ZyZW9wZW4oImluLnR4dCIsInIiLHN0ZGluKTsNCiAgICBpbnQgdD0xOw0KICAgIHdoaWxlKHQtLSlzb2x2ZSgpOw0KCXJldHVybiAwOw0KfQ0K"}]