[{"id":"2951","submission_id":"2951","filename":"I.cpp","source":"I2luY2x1ZGU8Yml0cy9zdGRjKysuaD4NCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQp1c2luZyBsbCA9IGxvbmcgbG9uZzsNCg0KdXNpbmcgaGFzaHYgPSBwYWlyPGludCxpbnQ+Ow0KDQptdDE5OTM3IG1yYW5kKHJhbmRvbV9kZXZpY2V7fSgpKTsNCg0KaW50IHJuZChpbnQgeCkgew0KCXJldHVybiBtcmFuZCgpICUgeDsNCn0NCmNvbnN0IGxsIG1vZDEgPSAxZTkrNzsNCmNvbnN0IGxsIG1vZDIgPSAxZTkrOTsNCg0KY29uc3QgaW50IG1heG4gPSA1ZTM7DQoNCmhhc2h2IG9wZXJhdG9yKyhoYXNodiBhLGhhc2h2IGIpIHsNCglpbnQgYzEgPSBhLmZpcnN0ICsgYi5maXJzdCxjMiA9IGEuc2Vjb25kICsgYi5zZWNvbmQ7DQoJaWYoYzEgPj0gbW9kMSkNCgkJYzEgLT0gbW9kMTsNCglpZihjMiA+PSBtb2QyKQ0KCQljMiAtPSBtb2QyOw0KCXJldHVybiBtYWtlX3BhaXIoYzEsYzIpOw0KfQ0KDQpoYXNodiBvcGVyYXRvci0oaGFzaHYgYSxoYXNodiBiKSB7DQoJaW50IGMxID0gYS5maXJzdCAtIGIuZmlyc3QsYzIgPSBhLnNlY29uZCAtIGIuc2Vjb25kOw0KCWlmKGMxIDwgMCkNCgkJYzEgKz0gbW9kMTsNCglpZihjMiA8IDApDQoJCWMyICs9IG1vZDI7DQoJcmV0dXJuIG1ha2VfcGFpcihjMSxjMik7DQp9DQoNCmhhc2h2IG9wZXJhdG9yKihoYXNodiBhLGhhc2h2IGIpIHsNCglyZXR1cm4gbWFrZV9wYWlyKDFMTCAqIGEuZmlyc3QgKiBiLmZpcnN0ICUgbW9kMSwxTEwgICogYS5zZWNvbmQgKiBiLnNlY29uZCAlIG1vZDIpOw0KfQ0KaW50IG47DQpzdHJpbmcgczsNCmhhc2h2IHB3W21heG4rMTBdLGJhc2U7DQpoYXNodiBoW21heG4gKyAxMF07DQpoYXNodiBoMlttYXhuKyAxMF07DQoNCmhhc2h2IGdldGgxKGludCBsLGludCByKSB7DQoJcmV0dXJuIGhbcl0gLSBoW2wgLSAxXSAqIHB3W3IgLSBsICsgMV07DQp9DQpoYXNodiBnZXRoMihpbnQgbCxpbnQgcikgew0KCXJldHVybiBoMltsXSAtIGgyW3IgKyAxXSAqIHB3W3IgLSBsICsgMV07DQp9DQoNCnZvaWQgc29sdmUoKSB7DQoJY2luID4+IHM7DQoJbiA9IHMubGVuZ3RoKCk7DQoJcyA9ICIgIiArIHMgKyAiKiI7DQoJZm9yKGludCBpID0gMTsgaTw9bjsgaSsrKSB7DQoJCWhbaV0gPSBoW2kgLSAxXSAqIGJhc2UgKyBoYXNodihzW2ldLHNbaV0pOw0KCX0NCglmb3IoaW50IGkgPSBuOyBpPj0xOyBpLS0pIHsNCgkJaDJbaV0gPSBoMltpICsgMV0gKiBiYXNlICsgaGFzaHYoc1tpXSxzW2ldKTsNCgl9DQoJaW50IGFucyA9IDA7DQoJZm9yKGludCBpID0gMTsgaTw9bjsgaSsrKSB7DQoJCQ0KCQlpbnQgbCA9IDEsciA9IG1pbihpIC0gMSxuIC0gaSk7DQoJCWludCByZXMgPSAwOw0KCQl3aGlsZShsIDw9IHIpIHsNCgkJCWludCBtaWQgPSAobCArciApIC8gMjsNCgkJCWlmKGdldGgxKGkgLSBtaWQsaSAtIDEpID09IGdldGgyKGkgKyAxLGkgKyBtaWQpKSB7DQoJCQkJbCA9IG1pZCArIDE7DQoJCQkJcmVzID0gbWlkOw0KCQkJfSBlbHNlDQoJCQkJciA9IG1pZCAtIDE7DQoJCX0NCgkJLy9jb3V0IDw8ICJyZXMxICIgPDwgcmVzPDwiXG4iOw0KCQlhbnMgPSBtYXgoYW5zLHJlcyAqIDIgKyAxKTsNCgkJY2hhciB4ID0gc1tpIC0gcmVzIC0gMV07DQoJCWNoYXIgeSA9IHNbaSArIHJlcyArIDFdOw0KCQlsID0gcmVzICsgMixyID0gbWluKGkgLSAxLG4gLSBpKTsNCgkJaW50IHJlczIgPSByZXMgKyAyOw0KCQl3aGlsZShsIDw9IHIpIHsNCgkJCWludCBtaWQgPSAobCArIHIpIC8gMjsNCgkJCWlmKGdldGgxKGkgLSBtaWQsaSAtIHJlcyAtIDIpICE9IGdldGgyKGkgKyByZXMgKyAyLGkgKyBtaWQpKSB7DQoJCQkJciA9IG1pZCAtIDE7DQoJCQkJcmVzMiA9IG1pZDsNCgkJCX0gZWxzZQ0KCQkJCWwgPSBtaWQgKyAxOw0KCQl9DQoJCWlmKHJlczIgPD0gbWluKGkgLSAxLG4gLSBpKSAmJiBzW2kgLSByZXMyXSA9PSB5ICYmIHNbaSArIHJlczJdID09IHgpDQoJCQlhbnMgPSBtYXgoYW5zLChyZXMyKSAqIDIgKyAxKTsNCg0KCQkvLzJuZCBwYXJ0DQoJCWlmKGkgPiAxICYmIHNbaV0gPT0gc1tpIC0gMV0pIHsNCgkJCWwgPSAxLHIgPSBtaW4oaSAtIDEsbiAtIGkgKyAxKTsNCgkJCXJlcyA9IDA7DQoJCQl3aGlsZShsIDw9IHIpIHsNCgkJCQlpbnQgbWlkID0gKGwgKyByKSAvIDI7DQoJCQkJaWYoZ2V0aDEoaSAtIG1pZCxpIC0gMSkgPT0gZ2V0aDIoaSxpICsgbWlkIC0gMSkpIHsNCgkJCQkJbCA9IG1pZCArIDE7DQoJCQkJCXJlcyA9IG1pZDsNCgkJCQl9IGVsc2UNCgkJCQkJciA9IG1pZCAtIDE7DQoJCQl9DQoJCQkvL2NvdXQgPDwgInJlczEgIiA8PCByZXM8PCJcbiI7DQoJCQlhbnMgPSBtYXgoYW5zLHJlcyAqIDIpOw0KCQkJY2hhciB4ID0gc1tpIC0gcmVzIC0gMV07DQoJCQljaGFyIHkgPSBzW2kgKyByZXNdOw0KCQkJbCA9IHJlcyArIDIsciA9IG1pbihpIC0gMSxuIC0gaSArIDEpOw0KCQkJcmVzMiA9IHJlcyArIDI7DQoJCQl3aGlsZShsIDw9IHIpIHsNCgkJCQlpbnQgbWlkID0gKGwgKyByKSAvIDI7DQoJCQkJaWYoZ2V0aDEoaSAtIG1pZCxpIC0gcmVzIC0gMikgIT0gZ2V0aDIoaSArIHJlcyArIDEsaSArIG1pZCkpIHsNCgkJCQkJciA9IG1pZCAtIDE7DQoJCQkJCXJlczIgPSBtaWQ7DQoJCQkJfSBlbHNlDQoJCQkJCWwgPSBtaWQgKyAxOw0KCQkJfQ0KCQkJaWYocmVzMiA8PSBtaW4oaSAtIDEsbiAtIGkgKyAxKSAmJiBzW2kgLSByZXMyXSA9PSB5ICYmIHggPT0gc1tpICsgcmVzMiAtIDFdKQ0KCQkJCWFucyA9IG1heChhbnMsKHJlczIpICogMik7DQoJCX0NCgl9DQoJaWYoYW5zID09IDEpDQoJCWFucyA9IDA7DQoJY291dCA8PCBhbnMgPDwiXG4iOw0KfQ0KDQppbnQgbWFpbigpIHsNCglpb3M6OnN5bmNfd2l0aF9zdGRpbyhmYWxzZSk7DQoJaW50IHQ7DQoJYmFzZSA9IGhhc2h2KHJuZChtb2QxKSxybmQobW9kMikpOw0KCXB3WzBdID0gbWFrZV9wYWlyKDEsMSk7DQoJZm9yKGludCBpID0gMTsgaTw9bWF4bjsgaSsrKSB7DQoJCXB3W2ldID0gcHdbaSAtIDFdICogYmFzZTsNCgl9DQoJY2luID4+IHQ7DQoJd2hpbGUodC0tKSB7DQoJCXNvbHZlKCk7DQoJfQ0KCXJldHVybiAwOw0KfQ0KDQoNCi8qDQo0DQphYmNjYWINCmloaQ0Kc3RmZ2ZpdXQNCnBhbGluZHJvbQ0KDQoqLw=="}]