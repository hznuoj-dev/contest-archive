[{"id":"2508","submission_id":"2508","filename":"A02.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+DQoNCnR5cGVkZWYgbG9uZyBsb25nIGludCBsbDsNCg0KaW50IG47DQoNCmludCBib2FyZFs1MF1bNTBdOw0KDQpib29sIHZpc1s1MF1bNTBdOw0KDQpib29sIGF2YWlbNTBdWzUwXTsNCg0Kdm9pZCBkZnMoaW50IHgsIGludCB5LCBpbnQgY29sKXsNCgl2aXNbeF1beV0gPSB0cnVlOw0KCWlmKHggPiAxKXsNCgkJaWYoMCA9PSBib2FyZFt4IC0gMV1beV0pew0KCQkJYXZhaVt4IC0gMV1beV0gPSB0cnVlOw0KCQl9ZWxzZSBpZihjb2wgPT0gYm9hcmRbeCAtIDFdW3ldICYmICF2aXNbeCAtIDFdW3ldKXsNCgkJCWRmcyh4IC0gMSwgeSwgY29sKTsNCgkJfQ0KCX0NCglpZih4IDwgMTkpew0KCQlpZigwID09IGJvYXJkW3ggKyAxXVt5XSl7DQoJCQlhdmFpW3ggKyAxXVt5XSA9IHRydWU7DQoJCX1lbHNlIGlmKGNvbCA9PSBib2FyZFt4ICsgMV1beV0gJiYgIXZpc1t4ICsgMV1beV0pew0KCQkJZGZzKHggKyAxLCB5LCBjb2wpOw0KCQl9DQoJfQ0KCWlmKHkgPiAxKXsNCgkJaWYoMCA9PSBib2FyZFt4XVt5IC0gMV0pew0KCQkJYXZhaVt4XVt5IC0gMV09IHRydWU7DQoJCX1lbHNlIGlmKGNvbCA9PSBib2FyZFt4XVt5IC0gMV0gJiYgIXZpc1t4XVt5IC0gMV0pew0KCQkJZGZzKHgsIHkgLSAxLCBjb2wpOw0KCQl9DQoJfQ0KCWlmKHkgPCAxOSl7DQoJCWlmKDAgPT0gYm9hcmRbeF1beSArIDFdKXsNCgkJCWF2YWlbeF1beSArIDFdID0gdHJ1ZTsNCgkJfWVsc2UgaWYoY29sID09IGJvYXJkW3hdW3kgKyAxXSAmJiAhdmlzW3hdW3kgKyAxXSl7DQoJCQlkZnMoeCwgeSArIDEsIGNvbCk7DQoJCX0NCgl9DQp9DQoNCnZvaWQgZXJhc2UoaW50IHgsIGludCB5KXsNCglib2FyZFt4XVt5XSA9IDA7DQoJaWYoeCA+IDEpew0KCQlpZigyID09IGJvYXJkW3ggLSAxXVt5XSl7DQoJCQllcmFzZSh4IC0gMSwgeSk7DQoJCX0NCgl9DQoJaWYoeCA8IDE5KXsNCgkJaWYoMiA9PSBib2FyZFt4ICsgMV1beV0pew0KCQkJZXJhc2UoeCArIDEsIHkpOw0KCQl9DQoJfQ0KCWlmKHkgPiAxKXsNCgkJaWYoMiA9PSBib2FyZFt4XVt5IC0gMV0pew0KCQkJZXJhc2UoeCwgeSAtIDEpOw0KCQl9DQoJfQ0KCWlmKHkgPCAxOSl7DQoJCWlmKDIgPT0gYm9hcmRbeF1beSArIDFdKXsNCgkJCWVyYXNlKHgsIHkgKyAxKTsNCgkJfQ0KCX0NCn0NCg0KaW50IG1haW4oKXsNCglpbnQgVDsNCglmb3Ioc2NhbmYoIiVkIiwgJlQpOyBUID4gMDsgVC0tKXsNCgkJc2NhbmYoIiVkIiwgJm4pOw0KCQlpbnQgaSwgaiwgazsNCgkJZm9yKGkgPSAxOyBpIDw9IDE5OyBpKyspew0KCQkJZm9yKGogPSAxOyBqIDw9IDE5OyBqKyspew0KCQkJCWJvYXJkW2ldW2pdID0gMDsNCgkJCQl2aXNbaV1bal0gPSBmYWxzZTsNCgkJCX0NCgkJfQ0KCQkNCgkJaW50IHgsIHk7DQoJCWZvciggOyBuID4gMDsgbi0tKXsNCgkJCXNjYW5mKCIlZCVkIiwgJngsICZ5KTsNCgkJCXNjYW5mKCIlZCIsICZib2FyZFt4XVt5XSk7DQoJCX0NCgkJDQoJCWZvcihpID0gMTsgaSA8PSAxOTsgaSsrKXsNCgkJCWZvcihqID0gMTsgaiA8PSAxOTsgaisrKXsNCgkJCQlpZigyID09IGJvYXJkW2ldW2pdICYmICF2aXNbaV1bal0pew0KCQkJCQlpbnQgaywgdDsNCgkJCQkJZm9yKGsgPSAxOyBrIDw9IDE5OyBrKyspew0KCQkJCQkJZm9yKHQgPSAxOyB0IDw9IDE5OyB0Kyspew0KCQkJCQkJCWF2YWlba11bdF0gPSBmYWxzZTsNCgkJCQkJCX0NCgkJCQkJfQ0KCQkJCQlkZnMoaSwgaiwgMik7DQoJCQkJCWJvb2wgYiA9IGZhbHNlOw0KCQkJCQlmb3IoayA9IDE7IGsgPD0gMTk7IGsrKyl7DQoJCQkJCQlmb3IodCA9IDE7IHQgPD0gMTk7IHQrKyl7DQoJCQkJCQkJYiA9IGIgfHwgYXZhaVtrXVt0XTsNCgkJCQkJCX0NCgkJCQkJfQ0KCQkJCQlpZighYil7DQoJCQkJCQllcmFzZShpLCBqKTsNCgkJCQkJfQ0KCQkJCX0NCgkJCX0NCgkJfQ0KCQkNCgkJaW50IGFucyA9IDA7DQoJCWZvcihpID0gMTsgaSA8PSAxOTsgaSsrKXsNCgkJCWZvcihqID0gMTsgaiA8PSAxOTsgaisrKXsNCgkJCQlpZigxID09IGJvYXJkW2ldW2pdICYmICF2aXNbaV1bal0pew0KCQkJCQlpbnQgaywgdDsNCgkJCQkJZm9yKGsgPSAxOyBrIDw9IDE5OyBrKyspew0KCQkJCQkJZm9yKHQgPSAxOyB0IDw9IDE5OyB0Kyspew0KCQkJCQkJCWF2YWlba11bdF0gPSBmYWxzZTsNCgkJCQkJCX0NCgkJCQkJfQ0KCQkJCQlkZnMoaSwgaiwgMSk7DQoJCQkJCWZvcihrID0gMTsgayA8PSAxOTsgaysrKXsNCgkJCQkJCWZvcih0ID0gMTsgdCA8PSAxOTsgdCsrKXsNCgkJCQkJCQlpZihhdmFpW2tdW3RdKXsNCgkJCQkJCQkJYW5zKys7DQoJCQkJCQkJfQ0KCQkJCQkJfQ0KCQkJCQl9DQoJCQkJfQ0KCQkJfQ0KCQl9DQoJCXByaW50ZigiJWRcbiIsIGFucyk7DQoJfQ0KCXJldHVybiAwOw0KfQ0K"}]