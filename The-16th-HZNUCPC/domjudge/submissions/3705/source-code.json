[{"id":"3705","submission_id":"3705","filename":"III.cpp","source":"I2luY2x1ZGU8Yml0cy9zdGRjKysuaD4NCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQoNCiNkZWZpbmUgY3QoeCkgY291dDw8eDw8J1xuJw0KI2RlZmluZSBkZyh4KSAgY291dDw8I3g8PCc9Jzw8eDw8J1xuJzsNCiNkZWZpbmUgcGlpICBwYWlyPGludCxpbnQ+IA0KI2RlZmluZSBOIDYwMDANCiNkZWZpbmUgZG91YmxlIGxvbmcgZG91YmxlDQojZGVmaW5lIGlvcyBpb3M6OnN5bmNfd2l0aF9zdGRpbygwKSxjaW4udGllKDApLGNvdXQudGllKDApDQojZGVmaW5lIGVuZGwgJ1xuJw0KDQoNCi8qDQo0DQphYmNjYWINCmloaQ0Kc3RmZ2ZpdXQNCnBhbGluZHJvbWUNCg0KDQoqLw0KDQppbnQgZHBbTl1bTl1bM107DQp2b2lkIHNvbHZlKCl7DQogICBzdHJpbmcgcztjaW4+PnM7DQogICBpbnQgbj1zLnNpemUoKTsNCiANCiAgIGZvcihpbnQgaT0wO2k8PW47aSsrKQ0KICAgICBmb3IoaW50IGo9MDtqPD1uO2orKykNCiAgICAgICBmb3IoaW50IGs9MDtrPD0xO2srKyl7DQogICAgICAgCSBkcFtpXVtqXVswXT0wOw0KICAgICAgIAkgIGRwW2ldW2pdWzFdPTA7DQogICAgICAgCSAgIGRwW2ldW2pdWzJdPTA7DQoJICAgfQ0KICAgICAgDQogICAgICAgbWFwPHBhaXI8aW50LGludD4scGFpcjxjaGFyLGNoYXI+PiBtcDsNCiAgIA0KDQogICANCiAgIGZvcihpbnQgaT0xO2k8PW47aSsrKXsNCiAgIAlkcFtpXVtpXVswXT0xOw0KICAgCWRwW2ldW2ldWzFdPTE7DQogICAJZHBbaV1baV1bMl09MTsNCiAgIAlpZihzW2ldPT1zW2ktMV0pDQogICAJew0KICAgCQlkcFtpLTFdW2ldWzBdPTE7DQogICAJCWRwW2ktMV1baV1bMV09MTsNCiAgIAkJZHBbaS0xXVtpXVsyXT0xOw0KCX0NCiAgIAllbHNlew0KICAgCSAgIGRwW2ktMV1baV1bMV09MTsNCiAgIAkgICBtcFt7aS0xLGl9XT17c1tpXSxzW2ktMV19Ow0KCQkgaWYobXBbe2ktMSxpfV0uZmlyc3Q+bXBbe2ktMSxpfV0uc2Vjb25kKQ0KCQkgc3dhcChtcFt7aS0xLGl9XS5maXJzdCxtcFt7aS0xLGl9XS5zZWNvbmQpOwkgIAkNCgkgICB9DQogICAJZm9yKGludCBqPTE7ajw9aS0yO2orKyl7DQogICAJCWlmKHNbaV09PXNbal0pew0KICAgCQkJCWRwW2pdW2ldWzBdPWRwW2orMV1baS0xXVswXTsNCiAgIAkJCQlkcFtqXVtpXVsxXT1kcFtqKzFdW2ktMV1bMV07DQogICAJCQkJZHBbal1baV1bMl09ZHBbaisxXVtpLTFdWzJdOw0KICAgCQkJCW1wW3tqLGl9XT1tcFt7aisxLGktMX1dOw0KCSAgICB9DQoJICAgIGVsc2V7DQoJICAgIAkgZHBbal1baV1bMV09ZHBbaisxXVtpLTFdWzBdOw0KCSAgICAJIG1wW3tqLGl9XT17c1tqXSxzW2ldfTsNCgkgICAgCSBpZihtcFt7aixpfV0uZmlyc3Q+bXBbe2osaX1dLnNlY29uZCkNCgkgICAgICAgICAgIHN3YXAobXBbe2osaX1dLmZpcnN0LG1wW3tqLGl9XS5zZWNvbmQpOwkgIAkNCgkgICAgICAgICAgICAgICAgICAgCSANCgkgICAgCSBpZihkcFtqKzFdW2ktMV1bMV0pDQoJICAgIAkgew0KCSAgICAJICAgIGlmKG1wW3tqLGl9XT09bXBbe2orMSxpLTF9XSkNCgkgICAgCSAgICB7DQoJICAgIAkgICAgCWRwW2pdW2ldWzJdPTE7DQoJCQkJfQ0KCQkJIH0NCgkJfQ0KCSAgIH0NCiAgIH0NCiAgIGludCBhbnM9MDsNCiAgIA0KICAgZm9yKGludCBpPTE7aTw9bjtpKyspDQogICAgZm9yKGludCBqPWk7ajw9bjtqKyspew0KICAgIAlpZihkcFtpXVtqXVswXXx8ZHBbaV1bal1bMl0pDQogICAgCWFucz1tYXgoYW5zLGotaSsxKTsNCgl9DQovLwlpZihhbnM9PTEpDQovLwlhbnM9MDsNCgljdChhbnMpOw0KfQ0KDQpzaWduZWQgbWFpbigpew0KCWlvczsNCglpbnQgdD0xOyANCgkgY2luPj50Ow0KCXdoaWxlKHQtLSkNCglzb2x2ZSgpOw0KCXJldHVybiAwOw0KfQ=="}]