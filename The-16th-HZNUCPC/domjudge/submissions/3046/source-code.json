[{"id":"3046","submission_id":"3046","filename":"main.cpp","source":"I2luY2x1ZGU8Yml0cy9zdGRjKysuaD4NCiNkZWZpbmUgZnQgZmlyc3QNCiNkZWZpbmUgc2Qgc2Vjb25kDQojZGVmaW5lIGxsIGxvbmcgbG9uZw0KI2RlZmluZSBwYiBwdXNoX2JhY2sNCiNkZWZpbmUgcGxsIHBhaXI8bGwsbGw+DQojZGVmaW5lIHJlcChpLGEsYikgZm9yKGxsIGk9YTtpPD1iOysraSkNCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQpsbCBjbnQxWzMwXSxjbnQyWzMwXTsNCmxsIHN1bVszMF1bMzBdOw0KY29uc3QgaW50IHAgPSAxZTkrNzsNCmxsIHFwb3cobGwgeCxsbCB5KQ0Kew0KICAgIGxsIHJlcz0xOw0KICAgIHdoaWxlKHkpDQogICAgew0KICAgICAgICBpZih5JjEpcmVzPXJlcyp4JXA7DQogICAgICAgIHg9eCp4JXA7DQogICAgICAgIHk+Pj0xOw0KICAgIH0NCiAgICByZXR1cm4gcmVzOw0KfQ0KbGwgaW52KGxsIHgpDQp7DQogICAgcmV0dXJuIHFwb3coeCxwLTIpOw0KfQ0KaW50IG1haW4oKQ0Kew0KICAgIGlvczo6c3luY193aXRoX3N0ZGlvKDApLGNpbi50aWUoMCk7DQogICAgaW50IFQ9MTsNCiAgICAvL2Npbj4+VDsNCiAgICB3aGlsZShULS0pDQogICAgew0KICAgICAgICBzdHJpbmcgYSxiOw0KICAgICAgICBjaW4+PmE+PmI7DQogICAgICAgIGxsIG4gPSBhLnNpemUoKTsNCiAgICAgICAgZm9yKGludCBpPTA7aTwyNjtpKyspDQogICAgICAgICAgICBmb3IoaW50IGo9MDtqPDI2O2orKykNCiAgICAgICAgICAgICAgICBjbnQxW2ldPWNudDJbaV09MCxzdW1baV1bal09MDs7DQoNCg0KICAgICAgICBmb3IoaW50IGk9MDtpPGEuc2l6ZSgpO2krKykNCiAgICAgICAgICAgIGNudDFbYVtpXS0nYSddKyssY250MltiW2ldLSdhJ10rKyxzdW1bYVtpXS0nYSddW2JbaV0tJ2EnXSsrOw0KDQoNCiAgICAgICAgbGwgc3oxPTAsc3oyPTA7DQogICAgICAgIGZvcihpbnQgaT0wO2k8MjY7aSsrKQ0KICAgICAgICB7DQogICAgICAgICAgICBpZihjbnQxW2ldKQ0KICAgICAgICAgICAgICAgIHN6MSsrOw0KICAgICAgICAgICAgaWYoY250MltpXSkNCiAgICAgICAgICAgICAgICBzejIrKzsNCiAgICAgICAgfQ0KICAgICAgICBhdXRvIGNoYW5nZT1bJl0obGwgeCxsbCB5KQ0KICAgICAgICB7DQogICAgICAgICAgICBjbnQxW3hdLS07DQogICAgICAgICAgICBpZihjbnQxW3hdPT0wKQ0KICAgICAgICAgICAgICAgIHN6MS0tOw0KICAgICAgICAgICAgaWYoY250MVt5XT09MCkNCiAgICAgICAgICAgICAgICBzejErKzsNCiAgICAgICAgICAgIGNudDFbeV0rKzsNCg0KICAgICAgICAgICAgY250Mlt5XS0tOw0KICAgICAgICAgICAgaWYoY250Mlt5XT09MCkNCiAgICAgICAgICAgICAgICBzejItLTsNCiAgICAgICAgICAgIGlmKGNudDJbeF09PTApDQogICAgICAgICAgICAgICAgc3oyKys7DQogICAgICAgICAgICBjbnQyW3hdKys7DQogICAgICAgIH07DQogICAgICAgIGxsIGFucz0wOw0KICAgICAgICAvL2ZvcihpbnQgaT0wO2k8MztpKyspIHtmb3IoaW50IGo9MDtqPDM7aisrKXtjb3V0PDxzdW1baV1bal08PCIgIjt9Y291dDw8ZW5kbDt9DQogICAgICAgIC8vY291dDw8c3oxPDwiICI8PHN6Mjw8ZW5kbDsNCiAgICAgICAgZm9yKGludCBpPTA7aTxuO2krKykNCiAgICAgICAgew0KICAgICAgICAgICAgaW50IHQxPWFbaV0tJ2EnLHQyPWJbaV0tJ2EnOw0KICAgICAgICAgICAgY2hhbmdlKHQxLHQyKTsNCg0KICAgICAgICAgICAgc3VtW3QxXVt0Ml0tLTsNCiAgICAgICAgICAgIGZvcihpbnQgaj0wO2o8MjY7aisrKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGZvcihpbnQgaz0wO2s8MjY7aysrKQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgaWYoc3VtW2pdW2tdKQ0KICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICBjaGFuZ2UoaixrKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHN6MT09c3oyKQ0KICAgICAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFucyA9IChhbnMgKyBzdW1bal1ba10pICUgcDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZShrLGopOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgY2hhbmdlKHQyLHQxKTsNCiAgICAgICAgICAgIHN1bVt0MV1bdDJdKys7DQogICAgICAgICAgICAvL2NvdXQ8PGFuczw8ZW5kbDsNCiAgICAgICAgfQ0KDQogICAgICAgIGNvdXQ8PGFucyppbnYoMiklcDw8IlxuIjsNCiAgICB9DQp9DQo="}]