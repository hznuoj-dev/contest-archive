[{"id":"2161","submission_id":"2161","filename":"main.cpp","source":"LyojaW5jbHVkZSA8Yml0cy9zdGRjKysuaD4NCg0KdXNpbmcgbmFtZXNwYWNlIHN0ZDsNCnR5cGVkZWYgbG9uZyBsb25nIGxsOw0KY29uc3QgbGwgbW9kID0gMWU5Kzc7DQoNCg0KbGwgcXBvdyhsbCBhLGxsIGIpew0KICAgIGxsIGFucyA9IDE7DQogICAgd2hpbGUoYil7DQogICAgICAgIGlmKGImMSkgYW5zID0gYW5zKmElbW9kOw0KICAgICAgICBhPWEqYSVtb2Q7DQogICAgICAgIGI+Pj0xOw0KICAgIH0NCiAgICByZXR1cm4gYW5zOw0KfQ0KDQpiaXRzZXQ8MTA+IGJzOw0KDQppbnQgcGFbTl07DQppbnQgZmluZChpbnQgYSl7DQogICAgcmV0dXJuIHBhW2FdPT1hP2E6cGFbYV0gPSBmaW5kKHBhW2FdKTsNCn0NCg0Kdm9pZCBtZXJnZShpbnQgYSxpbnQgYil7DQogICAgYSA9IGZpbmQoYSksYiA9IGZpbmQoYik7DQogICAgaWYoYT09YikgcmV0dXJuOw0KICAgIHBhW2FdID0gYjsNCn0NCmludCBvcFtOXSx4W05dLHlbTl07DQpzaWduZWQgbWFpbigpDQp7DQogICAgaW9zOjpzeW5jX3dpdGhfc3RkaW8oMCk7DQogICAgY2luLnRpZSgwKTsNCiAgICBjb3V0LnRpZSgwKTsNCiAgICBicy5zZXQoMSk7DQogICAgYnMuc2V0KDUpOw0KICAgIGZvcihpbnQgaSA9IGJzLl9GaW5kX2ZpcnN0KCk7aSE9YnMuc2l6ZSgpO2k9YnMuX0ZpbmRfbmV4dChpKSl7DQogICAgICAgIGNvdXQ8PGk8PGVuZGw7DQogICAgfQ0KDQogICAgaW50IG4scSxtOw0KICAgIGNpbj4+bj4+cT4+bTsNCiAgICBmb3IoaW50IGk9MTtpPD1uO2krKykgcGFbaV0gPSBpOw0KICAgIGZvcihpbnQgaT0xO2k8PW07aSsrKXsNCg0KICAgIH0NCn0NCiovDQoNCiNpbmNsdWRlIDxiaXRzL3N0ZGMrKy5oPg0KDQp1c2luZyBuYW1lc3BhY2Ugc3RkOw0KdHlwZWRlZiBsb25nIGxvbmcgbGw7DQpjb25zdCBsbCBtb2QgPSAxZTkrNzsNCmNvbnN0IGxsIE4gPSAxZTYrMTA7DQpzdHJ1Y3QgYnVzew0KICAgIGludCB0LGwscjsNCn07DQpzdHJ1Y3QgcGVvew0KICAgIGludCBpZDsNCiAgICBpbnQgdCxwb3M7DQp9Ow0Kc3RydWN0IHJhbmdlew0KICAgIGludCBsLHIsZGlzOw0KfTsNCg0Kc3RydWN0IGNtcHsNCiAgICBib29sIG9wZXJhdG9yKCkocmFuZ2UgYSxyYW5nZSBiKXsNCiAgICAgICAgcmV0dXJuIGEucjxiLnI7DQogICAgfQ0KfTsNCmludCBhbnNbTl07DQppbnQgbWFpbigpew0KICAgIGlvczo6c3luY193aXRoX3N0ZGlvKDApOw0KICAgIGNpbi50aWUoMCk7DQogICAgY291dC50aWUoMCk7DQoNCiAgICBpbnQgbixtLHg7DQogICAgY2luPj5uPj5tPj54Ow0KICAgIHZlY3RvcjxidXM+IHZiKG4pOw0KICAgIHZlY3RvcjxwZW8+IHZwKG0pOw0KICAgIGZvcihpbnQgaT0wO2k8bjtpKyspew0KICAgICAgICBjaW4+PnZiW2ldLnQ+PnZiW2ldLmw+PnZiW2ldLnI7DQogICAgfQ0KICAgIGZvcihpbnQgaT0wO2k8bTtpKyspew0KICAgICAgICBjaW4+PnZwW2ldLnQ+PnZwW2ldLnBvczsNCiAgICAgICAgdnBbaV0uaWQgPSBpOw0KICAgIH0NCiAgICBzb3J0KHZiLmJlZ2luKCksdmIuZW5kKCksW10oYnVzIGEsYnVzIGIpew0KICAgICAgICAgICAgaWYoYS50IT1iLnQpIHJldHVybiBhLnQ+Yi50Ow0KICAgICAgICAgICAgcmV0dXJuIGEucj5iLnI7DQogICAgICAgICB9KTsNCiAgICBzb3J0KHZwLmJlZ2luKCksdnAuZW5kKCksW10ocGVvIGEscGVvIGIpew0KICAgICAgICAgICAgcmV0dXJuIGEudD5iLnQ7DQogICAgICAgICB9KTsNCg0KICAgIHNldDxyYW5nZSxjbXA+IHN0Ow0KICAgIHN0Lmluc2VydCh7MSx4LTEsMHgzZjNmM2YzZn0pOw0KICAgIHN0Lmluc2VydCh7eCx4LDB9KTsNCiAgICBpbnQgcG9zcCA9IDA7DQogICAgaW50IHBvc2IgPSAwOw0KICAgIGZvcihpbnQgaT0xMDAwMDA7aT49MTtpLS0pew0KICAgICAgICB3aGlsZShwb3NiPHZiLnNpemUoKSYmdmJbcG9zYl0udD49aSl7DQogICAgICAgICAgICBpbnQgbCA9IHZiW3Bvc2JdLmwsciA9IHZiW3Bvc2JdLnI7DQogICAgICAgICAgICBhdXRvIGl0ID0gKnN0Lmxvd2VyX2JvdW5kKHtyLHIsMH0pOw0KICAgICAgICAgICAgaW50IGQgPSBpdC5kaXMrMTsNCiAgICAgICAgICAgIHIgPSBpdC5sLTE7DQogICAgICAgICAgICBpZihsPnIpew0KICAgICAgICAgICAgICAgIHBvc2IrKzsNCiAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgaXQgPSAqc3QubG93ZXJfYm91bmQoe2wsbCwwfSk7DQogICAgICAgICAgICBpZihpdC5sIT1sKXsNCiAgICAgICAgICAgICAgICBzdC5lcmFzZShpdCk7DQogICAgICAgICAgICAgICAgc3QuaW5zZXJ0KHtpdC5sLGwtMSxpdC5kaXN9KTsNCiAgICAgICAgICAgICAgICBzdC5pbnNlcnQoe2wsaXQucixpdC5kaXN9KTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGl0ID0gKnN0Lmxvd2VyX2JvdW5kKHtyLHIsMH0pOw0KICAgICAgICAgICAgaWYoaXQuciE9cil7DQogICAgICAgICAgICAgICAgc3QuZXJhc2UoaXQpOw0KICAgICAgICAgICAgICAgIHN0Lmluc2VydCh7cisxLGl0LnIsaXQuZGlzfSk7DQogICAgICAgICAgICAgICAgc3QuaW5zZXJ0KHtpdC5sLHIsaXQuZGlzfSk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICB3aGlsZSgxKXsNCiAgICAgICAgICAgICAgICBhdXRvIGl0ZXIgPSBzdC5sb3dlcl9ib3VuZCh7bCxsLDB9KTsNCiAgICAgICAgICAgICAgICBpZihpdGVyPT1zdC5lbmQoKXx8aXRlci0+bD5yKSBicmVhazsNCiAgICAgICAgICAgICAgICBzdC5lcmFzZShpdGVyKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHdoaWxlKDEpew0KICAgICAgICAgICAgICAgIGlmKGw9PTEpIGJyZWFrOw0KICAgICAgICAgICAgICAgIGF1dG8gaXRlciA9IHN0Lmxvd2VyX2JvdW5kKHtsLTEsbC0xLDB9KTsNCiAgICAgICAgICAgICAgICBpZihpdGVyLT5kaXM9PWQpew0KICAgICAgICAgICAgICAgICAgICBsID0gaXRlci0+bDsNCiAgICAgICAgICAgICAgICAgICAgc3QuZXJhc2UoaXRlcik7DQogICAgICAgICAgICAgICAgfWVsc2Ugew0KICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICBzdC5pbnNlcnQoe2wscixkfSk7DQogICAgICAgICAgICAvL2NvdXQ8PHBvc2I8PCcgJzsNCiAgICAgICAgICAgIC8vZm9yKGF1dG8geDpzdCl7DQogICAgICAgICAgICAvLyAgICBjb3V0PDx4Lmw8PCcgJzw8eC5yPDwnICc8PHguZGlzPDwnfCc7DQogICAgICAgICAgICAvL30NCiAgICAgICAgICAgIC8vY291dDw8ZW5kbDsNCiAgICAgICAgICAgIHBvc2IrKzsNCiAgICAgICAgfQ0KICAgICAgICB3aGlsZShwb3NwPHZwLnNpemUoKSYmdnBbcG9zcF0udD49aSl7DQogICAgICAgICAgICBhdXRvIGl0ID0gKnN0Lmxvd2VyX2JvdW5kKHt2cFtwb3NwXS5wb3MsdnBbcG9zcF0ucG9zLDB9KTsNCiAgICAgICAgICAgIGFuc1t2cFtwb3NwXS5pZF0gPSBpdC5kaXM7DQogICAgICAgICAgICBwb3NwKys7DQogICAgICAgIH0NCiAgICB9DQogICAgZm9yKGludCBpPTA7aTxtO2krKyl7DQogICAgICAgICAgICBpZihhbnNbaV09PTB4M2YzZjNmM2YpIGNvdXQ8PC0xPDxlbmRsOw0KICAgICAgICAgICAgZWxzZSBjb3V0PDxhbnNbaV08PGVuZGw7DQogICAgfQ0KfQ0K"}]