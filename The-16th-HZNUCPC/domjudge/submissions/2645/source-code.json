[{"id":"2645","submission_id":"2645","filename":"123.cpp","source":"I2luY2x1ZGU8Yml0cy9zdGRjKysuaD4NCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQojZGVmaW5lIGludCBsb25nIGxvbmcNCi8vI2RlZmluZSBmaXJzdCBmaQ0KLy8jZGVmaW5lIHNlY29uZCBzZQ0KY29uc3QgaW50IE49MmU1KzU7DQpjb25zdCBpbnQgbW9kPTFlOSs3Ow0KaW50IGluWzU1XVs1NV07DQppbnQgbXBbNTVdLG1wMVs1NV07DQppbnQgdmlzWzI2XVsyNl1bMjZdWzI2XTsNCmNoYXIgc1tOXTsNCmNoYXIgc3NbTl07DQppbnQgZmFjW05dLGludltOXTsNCmludCBuLG07DQppbnQgczEsczI7DQppbnQgYW5zOw0Kdm9pZCBpbml0KCkNCnsNCiAgICBmYWNbMF09MTsNCiAgICBmb3IoaW50IGk9MTtpPE47aSsrKQ0KICAgIHsNCg0KICAgICAgICBmYWNbaV09ZmFjW2ktMV0qaSVtb2Q7DQogICAgfQ0KICAgIGludlsxXT0xOw0KICAgIGZvcihpbnQgaT0yO2k8TjtpKyspaW52W2ldPW1vZC0obW9kL2kpKmludlttb2QlaV0lbW9kOw0KICAgIGludlswXT0xOw0KICAgIGZvcihpbnQgaT0xO2k8TjtpKyspDQogICAgew0KDQogICAgICAgIGludltpXT1pbnZbaV0qaW52W2ktMV0lbW9kOw0KICAgIH0NCg0KfQ0KaW50IEMoaW50IG4saW50IG0pDQp7DQogIC8vICBjb3V0PDxuPDwiICI8PG08PGVuZGw7DQoNCiAgICBpZihuPG0pcmV0dXJuIDA7DQogICAgcmV0dXJuIGZhY1tuXSVtb2QqaW52W21dJW1vZCppbnZbKG4tbSldJW1vZDsNCn0NCnNpZ25lZCBtYWluKCkNCnsNCiAgICBpbml0KCk7DQogICAgY2luPj4ocysxKT4+KHNzKzEpO249c3RybGVuKHMrMSk7DQogICAgZm9yKGludCBpPTE7aTw9bjtpKyspDQogICAgew0KICAgICAgICBpbnQgeD1zW2ldLSdhJzsNCiAgICAgICAgaW50IHk9c3NbaV0tJ2EnOw0KICAgICAgICBpblt4XVt5XSsrOw0KICAgICAgICBtcFt4XSsrOw0KICAgICAgICBtcDFbeV0rKzsNCiAgICAgICAgaWYobXBbeF09PTEpczErKzsNCiAgICAgICAgaWYobXAxW3ldPT0xKXMyKys7DQoNCiAgICB9DQogICAgZm9yKGludCBpPTA7aTw9MjU7aSsrKQ0KICAgIHsNCg0KICAgICAgICBmb3IoaW50IGo9MDtqPD0yNTtqKyspDQogICAgICAgIHsNCiAgICAgICAgICAgIGZvcihpbnQgaz0wO2s8PTI1O2srKykNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBmb3IoaW50IGw9MDtsPD0yNTtsKyspDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICBpZih2aXNbaV1bal1ba11bbF0pY29udGludWUgOw0KICAgICAgICAgICAgICAgICAgICB2aXNbaV1bal1ba11bbF0rKzsNCiAgICAgICAgICAgICAgICAgICAgdmlzW2tdW2xdW2ldW2pdKys7DQoNCiAgICAgICAgICAgICAgICAgICAgaWYoaW5baV1bal0+MClpbltpXVtqXS0tOw0KICAgICAgICAgICAgICAgICAgICBlbHNlIGNvbnRpbnVlIDsNCiAgICAgICAgICAgICAgICAgICAgaWYoaW5ba11bbF0+MClpbltrXVtsXS0tOw0KICAgICAgICAgICAgICAgICAgICBlbHNlDQogICAgICAgICAgICAgICAgICAgIHsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgaW5baV1bal0rKzsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlIDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBtcFtpXS0tO21wMVtqXS0tOw0KICAgICAgICAgICAgICAgICAgICBpZihtcFtpXT09MClzMS0tOw0KICAgICAgICAgICAgICAgICAgICBpZihtcDFbal09PTApczItLTsNCiAgICAgICAgICAgICAgICAgICAgbXBbal0rKzttcDFbaV0rKzsNCiAgICAgICAgICAgICAgICAgICAgaWYobXBbal09PTEpczErKzsNCiAgICAgICAgICAgICAgICAgICAgaWYobXAxW2ldPT0xKXMyKys7DQoNCg0KICAgICAgICAgICAgICAgICAgICAgbXBba10tLTttcDFbbF0tLTsNCiAgICAgICAgICAgICAgICAgICAgaWYobXBba109PTApczEtLTsNCiAgICAgICAgICAgICAgICAgICAgaWYobXAxW2xdPT0wKXMyLS07DQogICAgICAgICAgICAgICAgICAgIG1wW2xdKys7bXAxW2tdKys7DQogICAgICAgICAgICAgICAgICAgIGlmKG1wW2xdPT0xKXMxKys7DQogICAgICAgICAgICAgICAgICAgIGlmKG1wMVtrXT09MSlzMisrOw0KDQogLy9jb3V0PDwiU2QiPDxlbmRsOw0KICAgICAgICAgICAgICAgICAgIC8vIGNvdXQ8PGk8PCIgIjw8ajw8ZW5kbDsNCiAgICAgICAgICAgICAgICAgICAgaWYoczE9PXMyKQ0KICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgIC8vIGNvdXQ8PGk8PCIgIjw8ajw8ZW5kbDsNCiAgICAgICAgICAgICAgICAgICAgICAvLyAgY291dDw8azw8IiAiPDxsPDxlbmRsOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYoaT09ayAmJiBqPT1sKQ0KICAgICAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFucys9QyhpbltpXVtqXSsyLDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY291dDw8YW5zPDxlbmRsOw0KDQogICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgICAgICAgICAgICAgIHsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFucys9KGluW2ldW2pdKzEpKihpbltrXVtsXSsxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBhbnMlPW1vZDsNCiAgICAgICAgICAgICAgICAgICAgbXBbal0tLTttcDFbaV0tLTsNCiAgICAgICAgICAgICAgICAgICAgaWYobXBbal09PTApczEtLTsNCiAgICAgICAgICAgICAgICAgICAgaWYobXAxW2ldPT0wKXMyLS07DQogICAgICAgICAgICAgICAgICAgIG1wW2ldKys7bXAxW2pdKys7DQogICAgICAgICAgICAgICAgICAgIGlmKG1wW2ldPT0xKXMxKys7DQogICAgICAgICAgICAgICAgICAgIGlmKG1wMVtqXT09MSlzMisrOw0KDQoNCg0KICAgICAgICAgICAgICAgICAgICBtcFtsXS0tO21wMVtrXS0tOw0KICAgICAgICAgICAgICAgICAgICBpZihtcFtsXT09MClzMS0tOw0KICAgICAgICAgICAgICAgICAgICBpZihtcDFba109PTApczItLTsNCiAgICAgICAgICAgICAgICAgICAgbXBba10rKzttcDFbbF0rKzsNCiAgICAgICAgICAgICAgICAgICAgaWYobXBba109PTEpczErKzsNCiAgICAgICAgICAgICAgICAgICAgaWYobXAxW2xdPT0xKXMyKys7DQoNCg0KDQogICAgICAgICAgICAgICAgICAgIGluW2ldW2pdKys7DQogICAgICAgICAgICAgICAgICAgIGluW2tdW2xdKys7DQoNCg0KDQoNCg0KDQoNCg0KDQoNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQogICAgY291dDw8YW5zPDxlbmRsOw0KDQp9DQo="}]