[{"id":"1553","submission_id":"1553","filename":"main.cpp","source":"I2luY2x1ZGU8Yml0cy9zdGRjKysuaD4NCiNkZWZpbmUgZnQgZmlyc3QNCiNkZWZpbmUgc2Qgc2Vjb25kDQojZGVmaW5lIGxsIGxvbmcgbG9uZw0KI2RlZmluZSBwYiBwdXNoX2JhY2sNCiNkZWZpbmUgcGxsIHBhaXI8bGwsbGw+DQojZGVmaW5lIHJlcChpLGEsYikgZm9yKGxsIGk9YTtpPD1iOysraSkNCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQppbnQgbjsNCnN0cmluZyBzOw0KaW50IGNudFsyN107DQpib29sIGNoZWNrKGludCBsZW4pew0KICAgIGlmKGxlbj5uKSByZXR1cm4gMDsNCiAgICBpZihsZW48PTEpIHJldHVybiAxOw0KICAgIGludCBjYW49MDsNCiAgICByZXAoaSwxLG4tbGVuKzEpew0KICAgICAgICBpbnQgbD1pLHI9bCtsZW4tMTsNCiAgICAgICAgcmVwKGosbCxyKXsNCiAgICAgICAgICAgIGNudFtzW2pdLSdhJ10rKzsNCiAgICAgLy8gICAgICAgY291dDw8ImFkZCI8PHNbaV08PGVuZGw7DQogICAgICAgIH0NCiAgICAgICAgaWYobGVuJjEpew0KICAgICAgICAgICAgY250W3NbKGwrcikvMl0tJ2EnXS0tOw0KICAgICAgICB9DQogICAgICAgIGludCBzaGlwZWk9MDsNCiAgICAgICAgaW50IGY9MTsNCiAgICAgICAgcmVwKGosbCxyKXsNCiAgICAgICAgaWYobGVuJjEmJmo9PShsK3IpLzIpIGNvbnRpbnVlOw0KICAgICAgICAgICAgaWYoY250W3Nbal0tJ2EnXSYxKSAgZj0wOw0KICAgICAgICB9DQogICAgICAgIHJlcChqLGwsKGwrcikvMil7DQogICAgICAgICAgICBpZihsZW4mMSYmaj09KGwrcikvMikgY29udGludWU7DQogICAgICAgICAgICBpZihzW2pdIT1zW3ItKGotbCldKSBzaGlwZWkrKzsNCiAgICAgICAgfQ0KICAgICAgICByZXAoaixsLHIpew0KICAgICAgICAgICAgIGlmKGxlbiYxJiZqPT0obCtyKS8yKSBjb250aW51ZTsNCiAgICAgICAgICAgIGNudFtzW2pdLSdhJ109MDsNCiAgICAgICAgfQ0KICAgICAvLyAgIGNvdXQ8PHNoaXBlaTw8IiAiPDxmPDxlbmRsOw0KICAgICAgICBpZihzaGlwZWk8PTImJmYpIGNhbj0xOw0KICAgIH0NCiAgICBpZihjYW4pIHJldHVybiAxOw0KICAgIGVsc2UgcmV0dXJuIDA7DQp9DQoNCmJvb2wgY2hlY2trKGludCBsZW4pew0KICAgIGlmKGxlbj5uKSByZXR1cm4gMDsNCiAgICBpZihsZW48PTEpIHJldHVybiAwOw0KICAgIGludCBjYW49MDsNCiAgICByZXAoaSwxLG4tbGVuKzEpew0KICAgICAgICBpbnQgbD1pLHI9bCtsZW4tMTsNCiAgICAgICAgcmVwKGosbCxyKXsNCiAgICAgICAgICAgIGNudFtzW2pdLSdhJ10rKzsNCiAgICAgICAgfQ0KICAgICAgICBpZihsZW4mMSl7DQogICAgICAgICAgICBjbnRbc1sobCtyKS8yXS0nYSddLS07DQogICAgICAgIH0NCiAgICAgLy8gICBjb3V0PDwgY250W3NbKGwrcikvMl0tJ2EnXTw8ZW5kbDsNCiAgICAgICAgaW50IHNoaXBlaT0wOw0KICAgICAgICBpbnQgZj0xOw0KICAgICAgICBpbnQgY250amk9MDsNCiAgICAgICAgdmVjdG9yPGludD5jYW8oMjcpOw0KICAgICAgICByZXAoaixsLHIpew0KICAgICAgICBpZihsZW4mMSYmaj09KGwrcikvMikgY29udGludWU7DQogICAgICAgICAgICBpZihjbnRbc1tqXS0nYSddJjEpew0KICAgICAgICAgICAgICAgIGY9MDsNCiAgICAgICAgICAgICAgICBjYW9bc1tqXS0nYSddPTE7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgZm9yKGF1dG8gaXQ6Y2FvKSBjbnRqaSs9aXQ7DQogICAgICAgIGlmKCFmKXsNCiAgICAgICAgICAvLyAgY291dDw8Y250W3NbKGwrcikvMl0tJ2EnXSsxPDwiICI8PGNudGppPDxlbmRsOw0KICAgICAgICAgICAgIGlmKChjbnRbc1sobCtyKS8yXS0nYSddKzEpJTI9PTAmJmNudGppPD0yKSBmPTE7DQogICAgICAgIH0NCg0KICAgICAgICByZXAoaixsLChsK3IpLzIpew0KICAgICAgICAgICAgaWYobGVuJjEmJmo9PShsK3IpLzIpIGNvbnRpbnVlOw0KICAgICAgICAgICAgaWYoc1tqXSE9c1tyLShqLWwpXSkgc2hpcGVpKys7DQogICAgICAgIH0NCiAgICAgICAgcmVwKGosbCxyKXsNCiAgICAgICAgICAgICBpZihsZW4mMSYmaj09KGwrcikvMikgY29udGludWU7DQogICAgICAgICAgICBjbnRbc1tqXS0nYSddPTA7DQogICAgICAgIH0NCiAgICAgICAgaWYoc2hpcGVpPD0yJiZmKSBjYW49MTsNCiAgICB9DQogICAgaWYoY2FuKSByZXR1cm4gMTsNCiAgICBlbHNlIHJldHVybiAwOw0KfQ0KDQppbnQgbWFpbigpDQp7DQogICAgaW9zOjpzeW5jX3dpdGhfc3RkaW8oMCk7DQogICAgY2luLnRpZSgwKTsNCiAgICBpbnQgdDsNCiAgICBjaW4+PnQ7DQogICAgd2hpbGUodC0tKXsNCiAgLy8gICAgICBzdHJpbmcgczsNCiAgICAgICAgY2luPj5zOw0KICAgICAgICBuPXMubGVuZ3RoKCk7DQogICAgICAgIHM9JyAnK3M7DQogICAgICAgIGludCBsPTEscj1uOw0KICAgICAgICBpbnQgYW5zPTA7DQoNCiAgICAgICAgd2hpbGUobDw9cil7DQogICAgICAgICAgICBpbnQgbWlkOw0KICAgICAgICAgICAgbWlkPShsK3IpLzI7DQogICAgICAgICAgICBpZihjaGVjaygyKm1pZCkpIGFucz0yKm1pZCxsPW1pZCsxOw0KICAgICAgICAgICAgZWxzZSByPW1pZC0xOw0KICAgICAgICB9DQoNCiAgICAgICAgIGw9MSxyPW47DQogICAgICAgIGludCBhbnNzPTE7DQogICAgICAgIHdoaWxlKGw8PXIpew0KICAgICAgICAgICAgaW50IG1pZDsNCiAgICAgICAgICAgIG1pZD0obCtyKS8yOw0KICAgICAgICAgIC8vICBjb3V0PDwicnVuOiI8PDIqbWlkLTE8PGVuZGw7DQogICAgICAgICAgICBpZihjaGVja2soMiptaWQtMSkpIGFuc3M9MiptaWQtMSxsPW1pZCsxOw0KICAgICAgICAgICAgZWxzZSByPW1pZC0xOw0KICAgICAgICB9DQogICAgICAvLyAgY291dDw8YW5zPDwiICI8PGFuc3M8PGVuZGw7DQogICAgICAgIGludCBjYW9hPW1heChhbnMsYW5zcyk7DQogICAgICAgIGlmKGNhb2E9PTEpIGNhb2E9MDsNCiAgICAgICAgY291dDw8Y2FvYTw8IlxuIjsNCiAgICB9DQp9DQo="}]