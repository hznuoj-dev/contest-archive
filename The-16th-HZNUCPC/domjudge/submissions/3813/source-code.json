[{"id":"3813","submission_id":"3813","filename":"main.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+DQp0eXBlZGVmIGxvbmcgbG9uZyBsbDsNCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQpjb25zdCBsbCBtb2Q9MWU5Kzc7DQpjaGFyIHMxWzEwMDAxMF07DQpjaGFyIHMyWzEwMDAxMF07DQpsbCBhWzMwXTsNCmxsIGJbMzBdOw0KbGwgc1szMF1bMzBdOw0KDQpsbCBrc20obGwgeCxsbCB5LGxsIG0pDQp7DQogICAgbGwgcmVzPTE7DQogICAgd2hpbGUoeSl7DQogICAgICAgIGlmKHkmMSlyZXMqPXgscmVzJT1tOw0KICAgICAgICB4PSh4KngpJW07DQogICAgICAgIHk+Pj0xOw0KICAgIH0NCiAgICByZXR1cm4gcmVzOw0KfQ0KaW50IG1haW4oKQ0Kew0KICAgIGlvczo6c3luY193aXRoX3N0ZGlvKDApOw0KICAgIGNpbi50aWUoMCk7DQogICAgY291dC50aWUoMCk7DQogICAgbGwgYW5zPTA7DQogICAgY2luPj5zMT4+czI7DQogICAgbGwgej0wOw0KICAgIGxsIGxlbj1zdHJsZW4oczEpOw0KICAgIGZvcihsbCBpPTA7aTxsZW47aSsrKXsNCiAgICAgICAgYVtzMVtpXS0nYSddKys7DQogICAgICAgIGJbczJbaV0tJ2EnXSsrOw0KICAgICAgICBzW3MxW2ldLSdhJ11bczJbaV0tJ2EnXSsrOw0KICAgICAgICBpZihzMVtpXT09czJbaV0peisrOw0KICAgIH0NCiAgICBmb3IobGwgaT0wO2k8MjY7aSsrKXsNCiAgICAgICAgZm9yKGxsIGo9MDtqPDI2O2orKyl7DQogICAgICAgICAgICBmb3IobGwgaz1pO2s8MjY7aysrKXsNCiAgICAgICAgICAgICAgICBmb3IobGwgbD0wO2w8MjY7bCsrKXsNCiAgICAgICAgICAgICAgICAgICAgaWYoc1tpXVtqXT4wJiZzW2tdW2xdPjApew0KICAgICAgICAgICAgICAgICAgICAgICAgYVtpXS0tOw0KICAgICAgICAgICAgICAgICAgICAgICAgYltpXSsrOw0KICAgICAgICAgICAgICAgICAgICAgICAgYVtqXSsrOw0KICAgICAgICAgICAgICAgICAgICAgICAgYltqXS0tOw0KICAgICAgICAgICAgICAgICAgICAgICAgYVtrXS0tOw0KICAgICAgICAgICAgICAgICAgICAgICAgYltrXSsrOw0KICAgICAgICAgICAgICAgICAgICAgICAgYVtsXSsrOw0KICAgICAgICAgICAgICAgICAgICAgICAgYltsXS0tOw0KICAgICAgICAgICAgICAgICAgICAgICAgbGwgejEsejI7DQogICAgICAgICAgICAgICAgICAgICAgICB6MT16Mj0wOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yKGxsIGk9MDtpPDI2O2krKyl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoYVtpXSl6MSsrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGJbaV0pejIrKzsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHoxPT16Mil7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoaT09ayYmaj09bCl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFucz0oYW5zKyhzW2ldW2pdKihzW2ldW2pdLTEpKSVtb2QpJW1vZDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBhbnM9KGFucysoc1tpXVtqXSpzW2tdW2xdKSVtb2QpJW1vZDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIC8vcHJpbnRmKCIlYyAlYyAlYyAlYyAlbGxkXG4iLGkrJ2EnLGorJ2EnLGsrJ2EnLGwrJ2EnLGFucyk7DQogICAgICAgICAgICAgICAgICAgICAgICBhW2ldKys7DQogICAgICAgICAgICAgICAgICAgICAgICBiW2ldLS07DQogICAgICAgICAgICAgICAgICAgICAgICBhW2pdLS07DQogICAgICAgICAgICAgICAgICAgICAgICBiW2pdKys7DQogICAgICAgICAgICAgICAgICAgICAgICBhW2tdKys7DQogICAgICAgICAgICAgICAgICAgICAgICBiW2tdLS07DQogICAgICAgICAgICAgICAgICAgICAgICBhW2xdLS07DQogICAgICAgICAgICAgICAgICAgICAgICBiW2xdKys7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQogICAgY291dDw8YW5zJW1vZDw8ZW5kbDsNCiAgICAvKmxsIHp6MSx6ejI7DQogICAgenoxPXp6Mj0wOw0KICAgIGZvcihsbCBpPTA7aTwyNjtpKyspew0KICAgICAgICBpZihhW2ldPjApenoxKys7DQogICAgICAgIGlmKGJbaV0+MCl6ejIrKzsNCiAgICAgICAgYVtpXT0wOw0KICAgICAgICBiW2ldPTA7DQogICAgfQ0KICAgIGlmKHp6MTx6ejIpc3dhcChzMSxzMik7DQogICAgZm9yKGxsIGk9MDtpPGxlbjtpKyspew0KICAgICAgICBhW3MxW2ldLSdhJ10rKzsNCiAgICAgICAgYltzMltpXS0nYSddKys7DQogICAgICAgIHNbczFbaV0tJ2EnXVtzMltpXS0nYSddKys7DQogICAgICAgIGlmKHMxW2ldPT1zMltpXSl6Kys7DQogICAgfSovDQogICAgLypsbCBhbnMxPTA7DQogICAgbGwgYW5zMj0wOw0KICAgIGZvcihsbCBpPTA7aTwyNjtpKyspew0KICAgICAgICBpZihhW2ldPjApYW5zMSsrOw0KICAgICAgICBpZihiW2ldPjApYW5zMisrOw0KICAgIH0NCiAgICBsbCB6MSx6Mix6Myx6NDsNCiAgICB6MT16Mj16Mz16ND0wOw0KICAgIGZvcihsbCBpPTA7aTwyNjtpKyspew0KICAgICAgICBmb3IobGwgaj0wO2o8MjY7aisrKXsNCiAgICAgICAgICAgIGlmKGk9PWopY29udGludWU7DQogICAgICAgICAgICBpZihhW2ldPjAmJmJbaV0+MCYmYVtqXT09MCYmYltqXT4wKXsNCiAgICAgICAgICAgICAgICB6MSsrOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYoYVtpXT4wJiZiW2ldPjAmJmFbal0+MCYmYltqXT09MCl7DQogICAgICAgICAgICAgICAgejErKzsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICB9DQogICAgfQ0KICAgIGxsIGFucz0wOw0KICAgIGNvdXQ8PGFuczE8PCIgICI8PGFuczI8PGVuZGw7Ki8NCiAgICAvKmlmKGFuczE9PWFuczIpew0KICAgICAgICBmb3IobGwgaT0wO2k8MjY7aSsrKXsNCiAgICAgICAgICAgIGZvcihsbCBqPTA7ajwyNjtqKyspew0KICAgICAgICAgICAgICAgIGlmKGk9PWopew0KICAgICAgICAgICAgICAgICAgICBhbnM9KGFucysoc1tpXVtqXSooc1tqXVtpXS0xKS8yKSVtb2QpJW1vZDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZWxzZXsNCiAgICAgICAgICAgICAgICAgICAgYW5zPShhbnMrKHNbaV1bal0qc1tqXVtpXSVtb2QpKSVtb2Q7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KICAgIGVsc2UgaWYoYW5zMS1hbnMyPjQpew0KICAgICAgICBhbnM9MDsNCiAgICB9DQogICAgZWxzZSBpZihhbnMxPT1hbnMyKzQpew0KICAgICAgICBmb3IobGwgaT0wO2k8MjY7aSsrKXsNCiAgICAgICAgICAgIGZvcihsbCBqPTA7ajwyNjtqKyspew0KICAgICAgICAgICAgICAgIGZvcihsbCBrPTA7azwyNjtrKyspew0KICAgICAgICAgICAgICAgICAgICBmb3IobGwgbD0wO2w8MjY7bCsrKXsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGkhPWomJmkhPWsmJmkhPWwmJmohPWsmJmohPWwmJmshPWwpew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGFbaV09PTEmJmJbaV09PTAmJmFbal0+MCYmYltqXT4xJiZhW2tdPT0xJiZiW2tdPT0wJiZhW2xdPjAmJmJbbF0+MSl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFucysrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCiAgICBlbHNlIGlmKGFuczE9PWFuczIrMyl7DQogICAgICAgIGZvcihsbCBpPTA7aTwyNjtpKyspew0KICAgICAgICAgICAgZm9yKGxsIGo9MDtqPDI2O2orKyl7DQogICAgICAgICAgICAgICAgZm9yKGxsIGs9MDtrPDI2O2srKyl7DQogICAgICAgICAgICAgICAgICAgIGZvcihsbCBsPTA7bDwyNjtsKyspew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYoaSE9aiYmaSE9ayYmaSE9bCYmaiE9ayYmaiE9bCYmayE9bCl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoYVtpXT09MSYmYltpXT09MCYmYVtqXT4xJiZiW2pdPT0wJiZhW2tdPjAmJmJba10+MSYmYVtsXT4wJiZiW2xdPjEpew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbnM9KGFucysoKHNbaV1ba10rc1tpXVtsXSkqKHNbal1ba10rc1tqXVtsXSklbW9kKSklbW9kOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihhW2ldPT0xJiZhW2pdPT0xJiZiW2ldPT0wJiZiW2pdPjAmJmFba10+MCYmYltrXT4xJiZhW2xdPjAmJmJbbF0+MSl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFucz0oYW5zKygoc1tpXVtrXStzW2ldW2xdKSooc1tqXVtrXStzW2pdW2xdKSVtb2QpKSVtb2Q7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGFbaV09PTEmJmFbal09PTEmJmJbaV0+MCYmYltqXT09MCYmYVtrXT4wJiZiW2tdPjEmJmFbbF0+MCYmYltsXT4xKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5zPShhbnMrKChzW2ldW2tdK3NbaV1bbF0pKihzW2pdW2tdK3Nbal1bbF0pJW1vZCkpJW1vZDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQogICAgZWxzZSBpZihhbnMxPT1hbnMyKzIpew0KICAgICAgICBmb3IobGwgaT0wO2k8MjY7aSsrKXsNCiAgICAgICAgICAgIGZvcihsbCBqPTA7ajwyNjtqKyspew0KICAgICAgICAgICAgICAgIGZvcihsbCBrPTA7azwyNjtrKyspew0KICAgICAgICAgICAgICAgICAgICBmb3IobGwgbD0wO2w8MjY7bCsrKXsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGkhPWomJmkhPWsmJmkhPWwmJmohPWsmJmohPWwmJmshPWwpew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGFbaV0+MSYmYltpXT09MCYmYVtqXT4xJiZiW2pdPT0wJiZhW2tdPjAmJmJba10+MSYmYVtsXT4wJiZiW2xdPjEpew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbnM9KGFucysoKHNbaV1ba10rc1tpXVtsXSkqKHNbal1ba10rc1tqXVtsXSklbW9kKSklbW9kOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihhW2ldPT0xJiZiW2ldPjAmJmFbal09PTEmJmJbal0+MCYmYVtrXT4wJiZiW2tdPjEmJmFbbF0+MCYmYltsXT4xKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5zPShhbnMrKChzW2ldW2tdK3NbaV1bbF0pKihzW2pdW2tdK3Nbal1bbF0pJW1vZCkpJW1vZDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoYVtpXT09MSYmYltpXT09MCYmYVtqXT4xJiZiW2pdPjAmJmFba10+MCYmYltrXT4xJiZhW2xdPjAmJmJbbF0+MSl7ICAvLzUgMyAtPiA0IDQgsrvIt7aoDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFucz0oYW5zKygoc1tpXVtrXStzW2ldW2xdKSooc1tqXVtrXStzW2pdW2xdKSVtb2QpKSVtb2Q7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGFbaV09PTEmJmJbaV09PTAmJmFbal0+MSYmYltqXT4wJiZhW2tdPjAmJmJba10+MSYmYVtsXT4wJiZiW2xdPjEpew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbnM9KGFucysoKHNbaV1ba10rc1tpXVtsXSkqKHNbal1ba10rc1tqXVtsXSklbW9kKSklbW9kOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCiAgICBlbHNlIGlmKGFuczE9PWFuczIrMSl7DQogICAgICAgIGZvcihsbCBpPTA7aTwyNjtpKyspew0KICAgICAgICAgICAgZm9yKGxsIGo9MDtqPDI2O2orKyl7DQogICAgICAgICAgICAgICAgZm9yKGxsIGs9MDtrPDI2O2srKyl7DQogICAgICAgICAgICAgICAgICAgIGZvcihsbCBsPTA7bDwyNjtsKyspew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYoaSE9aiYmaSE9ayYmaSE9bCYmaiE9ayYmaiE9bCYmayE9bCl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoYVtpXT4xJiZiW2ldPT0wJiZhW2pdPjEmJmJbal09PTAmJmFba10+MCYmYltrXT4xJiZhW2xdPjAmJmJbbF0+MSl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFucz0oYW5zKygoc1tpXVtrXStzW2ldW2xdKSooc1tqXVtrXStzW2pdW2xdKSVtb2QpKSVtb2Q7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfSovDQoNCiAgICAvL2NvdXQ8PGFuczw8ZW5kbDsNCiAgICByZXR1cm4gMDsNCn0NCg=="}]