[{"id":"3564","submission_id":"3564","filename":"DD.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+DQojZGVmaW5lIGxsIGludA0KI2RlZmluZSBNYSAxMDAwMDA1DQojZGVmaW5lIG1vZCAxMDAwMDAwMDA3DQojZGVmaW5lIE4gMjYNCiNkZWZpbmUgUExMIHBhaXI8bGwsbGw+DQojZGVmaW5lIGxzIHA8PDENCiNkZWZpbmUgcnMgcDw8MXwxDQojZGVmaW5lIGluZiAxZTkNCg0KdXNpbmcgbmFtZXNwYWNlIHN0ZDsNCg0KbGwgbixtLHg7DQoNCnN0cnVjdCBub2Rlew0KCWxsIHRpLGwscixudW07DQoJYm9vbCBvcGVyYXRvciA8KGNvbnN0IG5vZGUgJkEpY29uc3R7DQoJCWlmICh0aT09QS50aSkNCgkJew0KCQkJaWYgKG51bT09QS5udW0pDQoJCQkJcmV0dXJuIGw8QS5sOw0KCQkJcmV0dXJuIG51bTxBLm51bTsNCgkJfQ0KCQlyZXR1cm4gdGk+QS50aTsNCgl9DQp9YVtNYV07DQpsbCB0b3Q9MCxjbnQ9MDsNCmxsIHBbTWFdOw0KDQpzdHJ1Y3Qgc2VndHJlZQ0Kew0KCWxsIGwscixtYSxhZGQ7DQp9dFtNYTw8Ml07DQoNCg0Kdm9pZCBidWlsZChsbCBwLGxsIGwsbGwgcikNCnsNCgl0W3BdLmw9bCx0W3BdLnI9cjsNCglpZiAobD09cikNCgkJcmV0dXJuOw0KCWxsIG1pZD0obCtyKT4+MTsNCglidWlsZChscyxsLG1pZCksYnVpbGQocnMsbWlkKzEscik7DQoJcmV0dXJuOw0KfQ0KDQp2b2lkIHNwcmVhZChsbCBwKQ0Kew0KCWlmICh0W3BdLmFkZCkNCgl7DQoJCXRbbHNdLm1hPW1heCh0W2xzXS5tYSx0W3BdLmFkZCk7DQoJCXRbcnNdLm1hPW1heCh0W3JzXS5tYSx0W3BdLmFkZCk7DQoJCXRbbHNdLmFkZD1tYXgodFtsc10uYWRkLHRbcF0uYWRkKTsNCgkJdFtyc10uYWRkPW1heCh0W3JzXS5hZGQsdFtwXS5hZGQpOw0KCQl0W3BdLmFkZD0wOw0KCX0NCglyZXR1cm47DQp9DQoNCnZvaWQgdXAobGwgcCkNCnsNCgl0W3BdLm1hPW1heCh0W2xzXS5tYSx0W3JzXS5tYSk7DQoJcmV0dXJuOw0KfQ0KDQp2b2lkIGNoYW5nZShsbCBwLGxsIGwsbGwgcixsbCBkKQ0Kew0KCWlmIChsPnIpDQoJCXJldHVybjsNCglpZiAobDw9dFtwXS5sJiZ0W3BdLnI8PXIpDQoJew0KCQl0W3BdLm1hPW1heCh0W3BdLm1hLGQpOw0KCQl0W3BdLmFkZD1tYXgodFtwXS5hZGQsZCk7DQoJCXJldHVybjsNCgl9DQoJc3ByZWFkKHApOw0KCWxsIG1pZD0odFtwXS5sK3RbcF0ucik+PjE7DQoJaWYgKGw8PW1pZCkgY2hhbmdlKGxzLGwscixkKTsNCglpZiAocj5taWQpIGNoYW5nZShycyxsLHIsZCk7DQoJdXAocCk7DQoJcmV0dXJuOw0KfQ0KDQpsbCBhc2sobGwgcCxsbCBsLGxsIHIpDQp7DQoJaWYgKGw8PXRbcF0ubCYmdFtwXS5yPD1yKSByZXR1cm4gdFtwXS5tYTsNCglzcHJlYWQocCk7DQoJbGwgbWlkPSh0W3BdLmwrdFtwXS5yKT4+MTsNCglsbCB2YWw9MDsNCglpZiAobDw9bWlkKSB2YWw9bWF4KHZhbCxhc2sobHMsbCxyKSk7DQoJaWYgKHI+bWlkKSB2YWw9bWF4KHZhbCxhc2socnMsbCxyKSk7DQoJcmV0dXJuIHZhbDsNCn0NCg0KbGwgYW5zW01hXTsNCg0Kdm9pZCBzb2woKQ0Kew0KCXNjYW5mKCIlZCVkJWQiLCZuLCZtLCZ4KTsNCglmb3IgKGxsIGk9MTtpPD1uO2krKykNCgl7DQoJCXRvdCsrLHNjYW5mKCIlZCVkJWQiLCZhW3RvdF0udGksJmFbdG90XS5sLCZhW3RvdF0ucik7DQoJCWFbdG90XS5sPXgtYVt0b3RdLmwsYVt0b3RdLnI9eC1hW3RvdF0ucjsNCgkJc3dhcChhW3RvdF0ubCxhW3RvdF0ucik7DQoJfQ0KCWZvciAobGwgaT0xO2k8PW07aSsrKQ0KCXsNCgkJdG90Kyssc2NhbmYoIiVkJWQiLCZhW3RvdF0udGksJmFbdG90XS5sKSxhW3RvdF0ucj1hW3RvdF0ubCxhW3RvdF0ubnVtPWk7DQoJCWFbdG90XS5sPXgtYVt0b3RdLmwsYVt0b3RdLnI9eC1hW3RvdF0ucjsNCgkJc3dhcChhW3RvdF0ubCxhW3RvdF0ucik7DQoJfQ0KCXNvcnQoYSsxLGErdG90KzEpOw0KCWJ1aWxkKDEsMCxuKTsNCglmb3IgKGxsIGk9MTtpPD10b3Q7aSsrKQ0KCXsNCgkJaWYgKCFhW2ldLm51bSkNCgkJew0KCQkJbGwgbD0wLHI9bjsNCgkJCXdoaWxlIChsPD1yKQ0KCQkJew0KCQkJCWxsIG1pZD0obCtyKT4+MTsNCgkJCQlpZiAoYXNrKDEsMCxtaWQpPGFbaV0ubCkNCgkJCQkJbD1taWQrMTsNCgkJCQllbHNlDQoJCQkJCXI9bWlkLTE7DQoJCQl9Ly8gb2stbA0KCQkJY2hhbmdlKDEsbCsxLG4sYVtpXS5yKTsNCgkJfQ0KCQllbHNlDQoJCXsNCgkJCWxsIGw9MCxyPW47DQoJCQl3aGlsZSAobDw9cikNCgkJCXsNCgkJCQlsbCBtaWQ9KGwrcik+PjE7DQoJCQkJaWYgKGFzaygxLDAsbWlkKTxhW2ldLmwpDQoJCQkJCWw9bWlkKzE7DQoJCQkJZWxzZQ0KCQkJCQlyPW1pZC0xOw0KCQkJfS8vIG9rLWwNCgkJCWlmIChsPT1uKzEpDQoJCQkJYW5zW2FbaV0ubnVtXT0tMTsNCgkJCWVsc2UNCgkJCQlhbnNbYVtpXS5udW1dPWw7DQoJCX0NCgl9DQoJZm9yIChsbCBpPTE7aTw9bTtpKyspDQoJCXByaW50ZigiJWRcbiIsYW5zW2ldKTsNCgkNCglyZXR1cm47DQp9DQoNCg0KaW50IG1haW4oKQ0Kew0KCXNvbCgpOw0KCXJldHVybiAwOw0KfQ=="}]