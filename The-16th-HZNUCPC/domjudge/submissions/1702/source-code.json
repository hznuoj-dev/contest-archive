[{"id":"1702","submission_id":"1702","filename":"I.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+CgojZGVmaW5lIGRiZyh4Li4uKSBcCiAgICBkbyB7IFwKICAgICAgICBzdGQ6OmNvdXQgPDwgI3ggPDwgIiAtPiAiOyBcCiAgICAgICAgZXJyKHgpOyBcCiAgICB9IHdoaWxlICgwKQoKdm9pZCBlcnIoKSB7CiAgICBzdGQ6OmNvdXQgPDwgc3RkOjplbmRsOwp9Cgp0ZW1wbGF0ZTxjbGFzcyBULCBjbGFzcy4uLiBUcz4Kdm9pZCBlcnIoVCBhcmcsIFRzICYuLi4gYXJncykgewogICAgc3RkOjpjb3V0IDw8IGFyZyA8PCAnICc7CiAgICBlcnIoYXJncy4uLik7Cn0KCnVzaW5nIGxsID0gbG9uZyBsb25nOwp1c2luZyBsZCA9IGxvbmcgZG91YmxlOwp1c2luZyB1bGwgPSB1bnNpZ25lZCBsb25nIGxvbmc7CnVzaW5nIGkxMjggPSBfX2ludDEyODsKCnZvaWQgcnVuKGludCB0Q2FzZSkgewogICAgc3RkOjpzdHJpbmcgczsKICAgIHN0ZDo6Y2luID4+IHM7CiAgICBpbnQgbiA9IHMubGVuZ3RoKCk7CiAgICAvL29kZAogICAgYXV0byBtYXRjaCA9IFsmXShzdGQ6OnBhaXI8aW50LCBpbnQ+IHAxLCBzdGQ6OnBhaXI8aW50LCBpbnQ+IHAyKSB7CiAgICAgICAgaWYgKHAxID09IHAyKSByZXR1cm4gdHJ1ZTsKICAgICAgICBzdGQ6OnN3YXAocDEuZmlyc3QsIHAxLnNlY29uZCk7CiAgICAgICAgcmV0dXJuIHAxID09IHAyOwogICAgfTsKICAgIGludCBhbnMgPSAwOwogICAgZm9yIChpbnQgaSA9IDA7IGkgPCBuOyArK2kpIHsKICAgICAgICBpbnQgbWlkID0gc1tpXSAtICdhJzsKICAgICAgICBzdGQ6OnZlY3RvcjxzdGQ6OnBhaXI8aW50LCBpbnQ+PiB2OwogICAgICAgIGZvciAoaW50IGogPSAxOyBpIC0gaiA+PSAwIGFuZCBpICsgaiA8IG47ICsraikgewogICAgICAgICAgICBpbnQgbCA9IGkgLSBqLCByID0gaSArIGo7CiAgICAgICAgICAgIGlmIChzW2xdICE9IHNbcl0pIHsKICAgICAgICAgICAgICAgIGlmICh2LnNpemUoKSA9PSAyKSBicmVhazsKICAgICAgICAgICAgICAgIHYuZW1wbGFjZV9iYWNrKHNbbF0gLSAnYScsIHNbcl0gLSAnYScpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICh2LnNpemUoKSA9PSAwKSB7CiAgICAgICAgICAgICAgICBhbnMgPSBzdGQ6Om1heChhbnMsIGogKiAyICsgMSk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAodi5zaXplKCkgPT0gMSkgewogICAgICAgICAgICAgICAgaWYgKHZbMF0uZmlyc3QgPT0gbWlkIG9yIHZbMF0uc2Vjb25kID09IG1pZCkgewogICAgICAgICAgICAgICAgICAgIGFucyA9IHN0ZDo6bWF4KGFucywgaiAqIDIgKyAxKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGlmIChtYXRjaCh2WzBdLCB2WzFdKSkgewogICAgICAgICAgICAgICAgICAgIGFucyA9IHN0ZDo6bWF4KGFucywgaiAqIDIgKyAxKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KICAgIGZvciAoaW50IGkgPSAwOyBpICsgMSA8IG47ICsraSkgewogICAgICAgIHN0ZDo6dmVjdG9yPHN0ZDo6cGFpcjxpbnQsIGludD4+IHY7CiAgICAgICAgZm9yIChpbnQgaiA9IDA7IGkgLSBqID49IDAgYW5kIGkgKyBqICsgMSA8IG47ICsraikgewogICAgICAgICAgICBpbnQgbCA9IGkgLSBqLCByID0gaSArIGogKyAxOwogICAgICAgICAgICBpZiAoc1tsXSAhPSBzW3JdKSB7CiAgICAgICAgICAgICAgICBpZiAodi5zaXplKCkgPT0gMikgYnJlYWs7CiAgICAgICAgICAgICAgICB2LmVtcGxhY2VfYmFjayhzW2xdIC0gJ2EnLCBzW3JdIC0gJ2EnKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAodi5zaXplKCkgPT0gMCkgewogICAgICAgICAgICAgICAgYW5zID0gc3RkOjptYXgoYW5zLCAoaiArIDEpICogMik7CiAgICAgICAgICAgIH0gZWxzZSBpZiAodi5zaXplKCkgPT0gMikgewogICAgICAgICAgICAgICAgaWYgKG1hdGNoKHZbMF0sIHZbMV0pKSB7CiAgICAgICAgICAgICAgICAgICAgYW5zID0gc3RkOjptYXgoYW5zLCAoaiArIDEpICogMik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CiAgICBzdGQ6OmNvdXQgPDwgYW5zIDw8ICdcbic7Cn0KCmludCBtYWluKCkgewogICAgc3RkOjppb3NfYmFzZTo6c3luY193aXRoX3N0ZGlvKGZhbHNlKTsKICAgIHN0ZDo6Y2luLnRpZShudWxscHRyKTsKICAgIGludCBUID0gMTsKICAgIHN0ZDo6Y2luID4+IFQ7CiAgICBmb3IgKGludCB0ID0gMTsgdCA8PSBUOyArK3QpIHsKICAgICAgICBydW4odCk7CiAgICB9CiAgICByZXR1cm4gMDsKfQ=="}]