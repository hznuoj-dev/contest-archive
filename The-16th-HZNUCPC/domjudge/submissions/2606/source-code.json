[{"id":"2606","submission_id":"2606","filename":"123.cpp","source":"I2luY2x1ZGU8Yml0cy9zdGRjKysuaD4NCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQojZGVmaW5lIGludCBsb25nIGxvbmcNCi8vI2RlZmluZSBmaXJzdCBmaQ0KLy8jZGVmaW5lIHNlY29uZCBzZQ0KY29uc3QgaW50IE49MmU1KzU7DQpjb25zdCBpbnQgbW9kPTFlOSs3Ow0KaW50IGluWzU1XVs1NV07DQppbnQgbXBbNTVdLG1wMVs1NV07DQpib29sIHZpc1syNl1bMjZdWzI2XVsyNl07DQpjaGFyIHNbTl07DQpjaGFyIHNzW05dOw0KaW50IGZhY1tOXSxpbnZbTl07DQppbnQgbixtOw0KaW50IHMxLHMyOw0KaW50IGFuczsNCnZvaWQgaW5pdCgpDQp7DQogICAgZmFjWzBdPTE7DQogICAgZm9yKGludCBpPTE7aTxOO2krKykNCiAgICB7DQoNCiAgICAgICAgZmFjW2ldPWZhY1tpLTFdKmklbW9kOw0KICAgIH0NCiAgICBpbnZbMV09MTsNCiAgICBmb3IoaW50IGk9MjtpPE47aSsrKWludltpXT1tb2QtKG1vZC9pKSppbnZbbW9kJWldJW1vZDsNCiAgICBpbnZbMF09MTsNCiAgICBmb3IoaW50IGk9MTtpPE47aSsrKQ0KICAgIHsNCg0KICAgICAgICBpbnZbaV09aW52W2ldKmludltpLTFdJW1vZDsNCiAgICB9DQoNCn0NCmludCBDKGludCBuLGludCBtKQ0Kew0KICAvLyAgY291dDw8bjw8IiAiPDxtPDxlbmRsOw0KDQogICAgaWYobjxtKXJldHVybiAwOw0KICAgIHJldHVybiBmYWNbbl0lbW9kKmludlttXSVtb2QqaW52WyhuLW0pXSVtb2Q7DQp9DQpzaWduZWQgbWFpbigpDQp7DQogICAgaW5pdCgpOw0KICAgIGNpbj4+KHMrMSk+PihzcysxKTtuPXN0cmxlbihzKzEpOw0KICAgIGZvcihpbnQgaT0xO2k8PW47aSsrKQ0KICAgIHsNCiAgICAgICAgaW50IHg9c1tpXS0nYSc7DQogICAgICAgIGludCB5PXNzW2ldLSdhJzsNCiAgICAgICAgaW5beF1beV0rKzsNCiAgICAgICAgbXBbeF0rKzsNCiAgICAgICAgbXAxW3ldKys7DQogICAgICAgIGlmKG1wW3hdPT0xKXMxKys7DQogICAgICAgIGlmKG1wMVt5XT09MSlzMisrOw0KDQogICAgfQ0KICAgIGZvcihpbnQgaT0wO2k8PTI1O2krKykNCiAgICB7DQoNCiAgICAgICAgZm9yKGludCBqPTA7ajw9MjU7aisrKQ0KICAgICAgICB7DQogICAgICAgICAgICBmb3IoaW50IGs9MDtrPD0yNTtrKyspDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgZm9yKGludCBsPTA7bDw9MjU7bCsrKQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgaWYodmlzW2ldW2pdW2tdW2xdKWNvbnRpbnVlIDsNCiAgICAgICAgICAgICAgICAgICAgdmlzW2ldW2pdW2tdW2xdKys7DQogICAgICAgICAgICAgICAgICAgIHZpc1trXVtsXVtpXVtqXSsrOw0KDQogICAgICAgICAgICAgICAgICAgIGlmKGluW2ldW2pdPjApaW5baV1bal0tLTsNCiAgICAgICAgICAgICAgICAgICAgZWxzZSBjb250aW51ZSA7DQogICAgICAgICAgICAgICAgICAgIGlmKGluW2tdW2xdPjApaW5ba11bbF0tLTsNCiAgICAgICAgICAgICAgICAgICAgZWxzZQ0KICAgICAgICAgICAgICAgICAgICB7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIGluW2ldW2pdKys7DQogICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZSA7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgbXBbaV0tLTttcDFbal0tLTsNCiAgICAgICAgICAgICAgICAgICAgaWYobXBbaV09PTApczEtLTsNCiAgICAgICAgICAgICAgICAgICAgaWYobXAxW2pdPT0wKXMyLS07DQogICAgICAgICAgICAgICAgICAgIG1wW2pdKys7bXAxW2ldKys7DQogICAgICAgICAgICAgICAgICAgIGlmKG1wW2pdPT0xKXMxKys7DQogICAgICAgICAgICAgICAgICAgIGlmKG1wMVtpXT09MSlzMisrOw0KDQoNCiAgICAgICAgICAgICAgICAgICAgIG1wW2tdLS07bXAxW2xdLS07DQogICAgICAgICAgICAgICAgICAgIGlmKG1wW2tdPT0wKXMxLS07DQogICAgICAgICAgICAgICAgICAgIGlmKG1wMVtsXT09MClzMi0tOw0KICAgICAgICAgICAgICAgICAgICBtcFtsXSsrO21wMVtrXSsrOw0KICAgICAgICAgICAgICAgICAgICBpZihtcFtsXT09MSlzMSsrOw0KICAgICAgICAgICAgICAgICAgICBpZihtcDFba109PTEpczIrKzsNCg0KIC8vY291dDw8IlNkIjw8ZW5kbDsNCiAgICAgICAgICAgICAgICAgICAvLyBjb3V0PDxpPDwiICI8PGo8PGVuZGw7DQogICAgICAgICAgICAgICAgICAgIGlmKHMxPT1zMikNCiAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAvLyBjb3V0PDxpPDwiICI8PGo8PGVuZGw7DQogICAgICAgICAgICAgICAgICAgICAgLy8gIGNvdXQ8PGs8PCIgIjw8bDw8ZW5kbDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGk9PWsgJiYgaj09bCkNCiAgICAgICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbnMrPUMoaW5baV1bal0rMiwyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvdXQ8PGFuczw8ZW5kbDsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlDQogICAgICAgICAgICAgICAgICAgICAgICB7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbnMrPShpbltpXVtqXSsxKSooaW5ba11bbF0rMSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgYW5zJT1tb2Q7DQogICAgICAgICAgICAgICAgICAgIG1wW2pdLS07bXAxW2ldLS07DQogICAgICAgICAgICAgICAgICAgIGlmKG1wW2pdPT0wKXMxLS07DQogICAgICAgICAgICAgICAgICAgIGlmKG1wMVtpXT09MClzMi0tOw0KICAgICAgICAgICAgICAgICAgICBtcFtpXSsrO21wMVtqXSsrOw0KICAgICAgICAgICAgICAgICAgICBpZihtcFtpXT09MSlzMSsrOw0KICAgICAgICAgICAgICAgICAgICBpZihtcDFbal09PTEpczIrKzsNCg0KDQoNCiAgICAgICAgICAgICAgICAgICAgbXBbbF0tLTttcDFba10tLTsNCiAgICAgICAgICAgICAgICAgICAgaWYobXBbbF09PTApczEtLTsNCiAgICAgICAgICAgICAgICAgICAgaWYobXAxW2tdPT0wKXMyLS07DQogICAgICAgICAgICAgICAgICAgIG1wW2tdKys7bXAxW2xdKys7DQogICAgICAgICAgICAgICAgICAgIGlmKG1wW2tdPT0xKXMxKys7DQogICAgICAgICAgICAgICAgICAgIGlmKG1wMVtsXT09MSlzMisrOw0KDQoNCg0KICAgICAgICAgICAgICAgICAgICBpbltpXVtqXSsrOw0KICAgICAgICAgICAgICAgICAgICBpbltrXVtsXSsrOw0KDQoNCg0KDQoNCg0KDQoNCg0KDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KICAgIGNvdXQ8PGFuczw8ZW5kbDsNCg0KfQ0K"}]