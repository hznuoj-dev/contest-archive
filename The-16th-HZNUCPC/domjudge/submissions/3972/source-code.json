[{"id":"3972","submission_id":"3972","filename":"G.cpp","source":"I2luY2x1ZGU8Yml0cy9zdGRjKysuaD4NCiNkZWZpbmUgbGwgbG9uZyBsb25nDQp1c2luZyBuYW1lc3BhY2Ugc3RkOw0KY29uc3QgaW50IE4gPSAyZTUgKyA1Ow0Kc3RydWN0IFR3b1NhdCB7DQoJaW50IG4sIGNvbG9yOw0KCXZlY3Rvcjx2ZWN0b3I8aW50PiA+IEc7DQoJdmVjdG9yPGJvb2w+IGFuczsNCgl2ZWN0b3I8aW50PiBjb2w7DQoJVHdvU2F0KGludCBuKSA6IG4obiksIGNvbG9yKDEpLCBHKDIgKiBuKSwgYW5zKG4pLCBjb2wobikge30NCgl2b2lkIE9yKGludCB1LCBib29sIGYsIGludCB2LCBib29sIGcpIHsgLy/oh7PlsJHkuIDkuKrkuLrnnJ8NCgkJR1syICogdSArICFmXS5wdXNoX2JhY2soMiAqIHYgKyBnKTsNCgkJR1syICogdiArICFnXS5wdXNoX2JhY2soMiAqIHUgKyBmKTsNCgl9DQoJdm9pZCBJbXBsaWVzKGludCB1LCBib29sIGYsIGludCB2LCBib29sIGcpew0KCQlPcih1LCAhZiwgdiwgZyk7DQoJfQ0KCXZvaWQgWG9yKGludCB1LCBib29sIGYsIGludCB2LCBib29sIGcpew0KCQlPcih1LCBmLCB2LCBnKTsgT3IodSwgIWYsIHYsICFnKTsNCgl9DQoJdm9pZCBTYW1lKGludCB1LCBib29sIGYsIGludCB2LCBib29sIGcpIHsNCgkJWG9yKHUsICFmLCB2LCBnKTsNCgl9DQoJdm9pZCBNdXN0KGludCB1LCBib29sIGYpIHsNCgkJT3IodSwgZiwgdSwgZik7DQoJfQ0KCWJvb2wgd29yaygpIHsNCgkJdmVjdG9yPGludD4gaWQoMiAqIG4sIC0xKSwgZGZuKDIgKiBuLCAtMSksIGxvdygyICogbiwgLTEpLCBzdGs7DQoJCW1hcDxwYWlyPGludCwgaW50PiwgaW50PiBtcDsNCgkJaW50IG5vdyA9IDAsIGNudCA9IDA7DQoJCWZ1bmN0aW9uPHZvaWQoaW50KT4gdGFyamFuID0gWyZdKGludCB1KSB7DQoJCQlzdGsucHVzaF9iYWNrKHUpOw0KCQkJZGZuW3VdID0gbG93W3VdID0gbm93Kys7DQoJCQlmb3IoYXV0byB2IDogR1t1XSkgew0KCQkJCWlmKGRmblt2XSA9PSAtMSkgew0KCQkJCQl0YXJqYW4odik7DQoJCQkJCWxvd1t1XSA9IG1pbihsb3dbdV0sIGxvd1t2XSk7DQoJCQkJfQ0KCQkJCWVsc2UgaWYoaWRbdl0gPT0gLTEpIHsNCgkJCQkJbG93W3VdID0gbWluKGxvd1t1XSwgZGZuW3ZdKTsNCgkJCQl9DQoJCQl9DQoJCQlpZihkZm5bdV0gPSBsb3dbdV0pIHsNCgkJCQlpbnQgdjsNCgkJCQlkbyB7DQoJCQkJCXYgPSBzdGsuYmFjaygpOw0KCQkJCQlzdGsucG9wX2JhY2soKTsNCgkJCQkJaWRbdl0gPSBjbnQ7DQoJCQkJfSB3aGlsZSh2ICE9IHUpOw0KCQkJCSsrY250Ow0KCQkJfQ0KCQl9Ow0KCQlmb3IoaW50IGkgPSAwOyBpIDwgMiAqIG47IGkrKykgew0KCQkJaWYoZGZuW2ldID09IC0xKSB0YXJqYW4oaSk7DQoJCX0NCgkJZm9yKGludCBpID0gMDsgaSA8IG47IGkrKykgew0KCQkJaWYoaWRbMiAqIGldID09IGlkWzIgKiBpICsgMV0pIHJldHVybiBmYWxzZTsNCgkJCWFuc1tpXSA9IGlkWzIgKiBpXSA+IGlkWzIgKiBpICsgMV07DQoJCQkNCi8vCQkJbXBbe2RmblsyICogaV0sIGRmblsyICogaSArIDFdfV0rKzsNCgkJCWludCBpZF9hID0gZGZuWzIgKiBpXSwgaWRfYiA9IGRmblsyICogaSArIDFdOw0KCQkJaWYoaWRfYSA+IGlkX2IpIHN3YXAoaWRfYSwgaWRfYik7DQoJCQlpZihtcC5jb3VudCh7aWRfYSwgaWRfYn0pKSB7DQoJCQkJY29sW2ldID0gbXBbe2lkX2EsIGlkX2J9XTsNCgkJCX0NCgkJCWVsc2Ugew0KCQkJCW1wW3tpZF9hLCBpZF9ifV0gPSBjb2xvcjsNCgkJCQljb2xbaV0gPSBjb2xvcjsNCgkJCQljb2xvcisrOw0KCQkJfQ0KCQl9ICAgDQoJCXJldHVybiB0cnVlOw0KCX0NCn07DQppbnQgbiwgcSwgbTsgICAgICAgICAgICAgICAgICAgICAgICAgIA0Kdm9pZCBzb2x2ZSgpIHsNCgljaW4gPj4gbiA+PiBxID4+IG07DQoJVHdvU2F0IHRzKG4pOw0KCWZvcihpbnQgaSA9IDE7IGkgPD0gbTsgaSsrKSB7DQoJCWludCBrLCBhLCBiOw0KCQljaW4gPj4gayA+PiBhID4+IGI7DQoJCWEtLTsgYi0tOw0KCQlpZihrID09IDApIHsNCgkJCXRzLkltcGxpZXMoYSwgMSwgYiwgMSk7DQoJCQl0cy5JbXBsaWVzKGEsIDAsIGIsIDApOw0KCQl9DQoJCWVsc2Ugew0KCQkJdHMuSW1wbGllcyhhLCAxLCBiLCAwKTsNCgkJCXRzLkltcGxpZXMoYSwgMCwgYiwgMSk7DQoJCX0NCgl9DQoJaWYodHMud29yaygpKSB7DQoJCXZlY3Rvcjx2ZWN0b3I8aW50PiA+IGNvbF90b19pZCh0cy5jb2xvciArIDEpOw0KCQl2ZWN0b3I8aW50PiBjb2xfdmFsKHRzLmNvbG9yICsgMSksIGRwKHRzLmNvbG9yICsgMSksIGZyb20odHMuY29sb3IgKyAxKSwgdXNlKHRzLmNvbG9yICsgMSk7DQoJCXZlY3RvcjxwYWlyPGludCwgaW50PiA+IGNvbF8yKHRzLmNvbG9yICsgMSk7DQoJCWZvcihpbnQgaSA9IDA7IGkgPCBuOyBpKyspIHsNCgkJCWNvbF90b19pZFt0cy5jb2xbaV1dLnB1c2hfYmFjayhpKTsNCgkJCWlmKHRzLmFuc1tpXSA9PSAwKSBjb2xfMlt0cy5jb2xbaV1dLmZpcnN0Kys7DQoJCQllbHNlIGNvbF8yW3RzLmNvbFtpXV0uc2Vjb25kKys7DQovLwkJCWNvdXQgPDwgaSA8PCAiICIgPDwgdHMuY29sW2ldIDw8ICIgIiA8PCB0cy5hbnNbaV0gPDwgIlxuIjsNCgkJfQ0KCQlmb3IoaW50IGkgPSAxOyBpIDw9IHRzLmNvbG9yOyBpKyspIHsNCgkJCWlmKGNvbF8yW2ldLnNlY29uZCA+IGNvbF8yW2ldLmZpcnN0KSB7DQoJCQkJc3dhcChjb2xfMltpXS5maXJzdCwgY29sXzJbaV0uc2Vjb25kKTsNCgkJCQlmb3IoYXV0byBpdCA6IGNvbF90b19pZFtpXSkgew0KCQkJCQl0cy5hbnNbaXRdID0gMSAtIHRzLmFuc1tpdF07DQoJCQkJfQ0KCQkJfQ0KCQl9DQoJCWZvcihpbnQgaSA9IDE7IGkgPD0gdHMuY29sb3I7IGkrKykgew0KCQkJcSAtPSBjb2xfMltpXS5zZWNvbmQ7DQoJCQljb2xfdmFsW2ldID0gY29sXzJbaV0uZmlyc3QgLSBjb2xfMltpXS5zZWNvbmQ7DQoJCX0NCgkJaWYocSA8IDApIHsNCgkJCWNvdXQgPDwgIk5PXG4iOw0KCQkJcmV0dXJuOw0KCQl9DQoJCWlmKHEgPT0gMCkgew0KCQkJY291dCA8PCAiWUVTXG4iOw0KCQkJZm9yKGludCBpID0gMDsgaSA8IG47IGkrKykgew0KCQkJCWlmKHRzLmFuc1tpXSkgY291dCA8PCBpICsgMSA8PCAiICI7DQoJCQl9DQoJCQlyZXR1cm47DQoJCX0NCgkJZHBbMF0gPSAxOw0KCQlmb3IoaW50IGMgPSAxOyBjIDw9IHRzLmNvbG9yOyBjKyspIHsNCgkJCWlmKGNvbF92YWxbY10gPT0gMCkgY29udGludWU7DQoJCQlmb3IoaW50IGogPSBxOyBqID49IGNvbF92YWxbY107IGotLSkgew0KCQkJCWRwW2pdID0gZHBbal0gfCBkcFtqIC0gY29sX3ZhbFtjXV07DQoJCQkJaWYoZHBbaiAtIGNvbF92YWxbY11dKSB7DQoJCQkJCXVzZVtqXSA9IGM7DQoJCQkJCWZyb21bal0gPSBqIC0gY29sX3ZhbFtjXTsNCgkJCQl9DQoJCQl9DQoJCX0NCgkJaWYoIWRwW3RzLmNvbG9yXSkgew0KCQkJY291dCA8PCAiTk9cbiI7DQoJCQlyZXR1cm47DQoJCX0NCi8vCQlmb3IoaW50IGMgPSAxOyBjIDw9IHRzLmNvbG9yOyBjKyspIHsNCi8vCQkJY291dCA8PCBjIDw8ICI6ICI7DQovLwkJCWZvcihhdXRvIGl0IDogY29sX3RvX2lkW2NdKSB7DQovLwkJCQljb3V0IDw8IGl0IDw8ICIgIjsNCi8vCQkJfQ0KLy8JCQljb3V0IDw8ICJ2YWw6IiA8PCBjb2xfdmFsW2NdOyANCi8vCQkJY291dCA8PCBlbmRsOw0KLy8JCX0NCgkJaW50IGlkeCA9IHRzLmNvbG9yOw0KCQl3aGlsZShpZHgpIHsNCgkJCWludCBjID0gdXNlW2lkeF07DQovLwkJCWNvdXQgPDwgaWR4IDw8ICIgIiA8PCBjIDw8IGVuZGw7DQoJCQlmb3IoYXV0byBpdCA6IGNvbF90b19pZFtjXSkgew0KCQkJCXRzLmFuc1tpdF0gPSAxIC0gdHMuYW5zW2l0XTsNCgkJCX0NCgkJCWlkeCA9IGZyb21baWR4XTsNCgkJfQ0KCQljb3V0IDw8ICJZRVNcbiI7DQoJCWZvcihpbnQgaSA9IDA7IGkgPCBuOyBpKyspIHsNCgkJCWlmKHRzLmFuc1tpXSkgY291dCA8PCBpICsgMSA8PCAiICI7DQoJCX0NCgkJcmV0dXJuOw0KCX0NCgllbHNlIHsNCgkJY291dCA8PCAiTk9cbiI7DQoJfQ0KfQ0KaW50IG1haW4oKSB7DQoJaW9zOjpzeW5jX3dpdGhfc3RkaW8oZmFsc2UpOw0KCWludCBUID0gMTsNCgl3aGlsZShULS0pIHsNCgkJc29sdmUoKTsNCgl9DQoJcmV0dXJuIDA7DQp9DQovKg0KNCAyIDQNCjEgMSAzDQoxIDIgNA0KMCAzIDQNCjAgMSAyDQoNCjAgMCAxIDENCg0KMTMgNyAxMQ0KMCAxIDINCjAgMSAzDQowIDEgNA0KMCAxIDUNCjEgMSA2DQoxIDEgNw0KMCA4IDkNCjAgOCAxMA0KMCA4IDExDQoxIDEzIDEyDQoxIDEyIDEzDQoNCjIgMSAyDQoxIDEgMg0KMCAyIDENCiov"}]