[{"id":"3591","submission_id":"3591","filename":"I.cpp","source":"I2luY2x1ZGU8Yml0cy9zdGRjKysuaD4NCiNkZWZpbmUgbGwgbG9uZyBsb25nDQojZGVmaW5lIGFsbChhKSAoYSkuYmVnaW4oKSwoYSkuZW5kOw0KdXNpbmcgbmFtZXNwYWNlIHN0ZDsNCmNvbnN0IGludCBOID0gNWUzICsgMTA7DQoNCmxsIHAgPSAyMzMzLCBtb2QgPSAxZTkgKyA3LCBoMVtOXSwgaDJbTl07DQpsbCBwcFtOXTsNCmludCBnW05dW05dOw0KDQppbmxpbmUgbGwgZ2V0MShpbnQgbCwgaW50IHIpDQp7DQoJcmV0dXJuIChoMVtyXSAtIGgxW2wgLSAxXSAqIHBwW3IgLSBsICsgMV0gJSBtb2QgKyBtb2QpICUgbW9kOw0KfQ0KDQppbmxpbmUgbGwgZ2V0MihpbnQgbCwgaW50IHIpDQp7DQoJcmV0dXJuIChoMltsXSAtIGgyW3IgKyAxXSAqIHBwW3IgLSBsICsgMV0gJSBtb2QgKyBtb2QpICUgbW9kOw0KfQ0KDQp2b2lkIHNvbHZlKCkNCnsNCglzdHJpbmcgczsNCgljaW4gPj4gczsNCglpbnQgbiA9IHMuc2l6ZSgpOw0KCXMgPSAnPycgKyBzOw0KCQ0KCWZvcihpbnQgaSA9IDE7IGkgPD0gbjsgaSsrKSBoMVtpXSA9IChoMVtpIC0gMV0gKiBwICUgbW9kICsgc1tpXSkgJSBtb2Q7DQoJaDJbbiArIDFdID0gMDsNCglmb3IoaW50IGkgPSBuOyBpID49IDE7IGktLSkgaDJbaV0gPSAoaDJbaSArIDFdICogcCAlIG1vZCArIHNbaV0pICUgbW9kOw0KCQ0KCWZvcihpbnQgaSA9IDA7IGkgPD0gbiArIDU7IGkrKykNCgkJZm9yKGludCBqID0gMDsgaiA8PSBuICsgNTsgaisrKQ0KCQkJZ1tpXVtqXSA9IC0xOw0KCQ0KCWZvcihpbnQgbGVuID0gMjsgbGVuIDw9IG47IGxlbisrKQ0KCXsNCgkJZm9yKGludCBsID0gMTsgbCArIGxlbiAtIDEgPD0gbjsgbCsrKQ0KCQl7DQoJCQlpbnQgciA9IGwgKyBsZW4gLSAxOw0KCQkJaWYoc1tsXSA9PSBzW3JdKSANCgkJCXsNCgkJCQlpZihnW2wgKyAxXVtyIC0gMV0gIT0gLTEpDQoJCQkJCWdbbF1bcl0gPSBnW2wgKyAxXVtyIC0gMV0gKyAxOyAgDQoJCQl9DQoJCQllbHNlIA0KCQkJCWdbbF1bcl0gPSAxOw0KCQl9DQoJfQ0KCQ0KCWludCBhbnMgPSAwOw0KCWZvcihpbnQgaSA9IDE7IGkgPD0gbjsgaSsrKQ0KCXsNCgkJZm9yKGludCBqID0gaSArIDE7IGogPD0gbjsgaisrKQ0KCQl7DQoJCQlpbnQgcmVzID0gZ1tpXVtqXTsNCgkJCQ0KCQkJaWYocmVzID09IC0xKQ0KCQkJew0KCQkJCWFucyA9IG1heChqIC0gaSArIDEsIGFucyk7DQoJCQkJY29udGludWU7DQoJCQl9DQoJCQkNCgkJCWludCBMMSA9IGkgKyByZXMgLSAxOw0KCQkJaW50IFIxID0gaiAtIHJlcyArIDE7DQoJCQkNCgkJCXJlcyA9IGdbTDEgKyAxXVtSMSAtIDFdOw0KCQkJDQoJCQlpZihyZXMgPT0gLTEpDQoJCQl7DQoJCQkJaW50IGxlbiA9IGogLSBpICsgMTsNCgkJCQlpZihsZW4gJiAxKQ0KCQkJCXsNCgkJCQkJaWYoc1tMMV0gPT0gc1tpICsgKGogLSBpKSAvIDJdIHx8IHNbUjFdID09IHNbaSArIChqIC0gaSkgLyAyXSkNCgkJCQkJCWFucyA9IG1heChhbnMsIGogLSBpICsgMSk7DQoJCQkJfQ0KCQkJCWNvbnRpbnVlOw0KCQkJfQ0KCQkJDQoJCQlpbnQgTDIgPSBMMSArIHJlczsNCgkJCWludCBSMiA9IFIxIC0gcmVzOw0KCQkJDQoJCQlpZihMMiArIDEgPj0gUjIgLSAxIHx8IGdldDEoTDIgKyAxLCBSMiAtIDEpID09IGdldDIoTDIgKyAxLCBSMiAtIDEpKSByZXMgPSAtMTsNCgkJCWVsc2UgcmVzID0gMTsNCgkJCQ0KCQkJaWYocmVzICE9IC0xKSBjb250aW51ZTsNCgkJCQ0KCQkJaWYoc1tMMV0gPT0gc1tMMl0gJiYgc1tSMV0gPT0gc1tSMl0gfHwgc1tMMV0gPT0gc1tSMl0gJiYgc1tSMV0gPT0gc1tMMl0pDQoJCQkJYW5zID0gbWF4KGFucywgaiAtIGkgKyAxKTsNCgkJfQ0KCX0NCgkNCgljb3V0IDw8IGFucyA8PCAnXG4nOw0KfQ0KDQpzaWduZWQgbWFpbigpDQp7DQoJaW9zOjpzeW5jX3dpdGhfc3RkaW8oZmFsc2UpOw0KCWNpbi50aWUoMCk7Y291dC50aWUoMCk7DQoJaW50IHQgPSAxOw0KCXBwWzBdID0gMTsNCglmb3IoaW50IGkgPSAxOyBpIDwgTjsgaSsrKSBwcFtpXSA9IHBwW2kgLSAxXSAqIHAgJSBtb2Q7DQoJY2luID4+IHQ7DQoJd2hpbGUodC0tKSBzb2x2ZSgpOw0KCXJldHVybiAwOw0KfQ0KLyoNCjQNCmFiY2NhYg0KaWhpDQpzdGZnZml1dA0KcGFsaW5kcm9tZQ0KKi8="}]