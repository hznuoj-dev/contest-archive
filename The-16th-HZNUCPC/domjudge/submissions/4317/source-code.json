[{"id":"4317","submission_id":"4317","filename":"G.cpp","source":"I2luY2x1ZGU8Yml0cy9zdGRjKysuaD4NCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQp2ZWN0b3I8cGFpcjxpbnQsYm9vbD4+IGVbMTAwMDA1XTsvLzAgZ29vZCAxIGJhZA0KYm9vbCBnb29kWzEwMDAwNV0sdmlzWzEwMDAwNV07DQppbnQgc2NjWzEwMDAwNV0sY250LG51bVsxMDAwMDVdLGZmWzEwMDAwNV0scHBbMTAwMDA1XSx0b3RbMTAwMDA1XTsNCmJvb2wgd29jYW9uaW1hOw0KdmVjdG9yPGludD4gYVsxMDAwMDVdLGJbMTAwMDA1XTsNCnN0cnVjdCBOb2Rlew0KCWludCB4LHA7DQp9Y1syMDAwMDA1XTsNCnZvaWQgZGZzKGludCB4LGludCBmYSkNCnsNCglpZih2aXNbeF0pIHJldHVybjsNCgl2aXNbeF09MTsNCglzY2NbeF09Y250Ow0KCWZvcihhdXRvJiBpOmVbeF0pew0KCQlpZihpLmZpcnN0PT14JiYoIWkuc2Vjb25kKSE9Z29vZFtpLmZpcnN0XSkgd29jYW9uaW1hPXRydWU7DQoJCWlmKGkuZmlyc3Q9PXgpIGNvbnRpbnVlOw0KCQlpZihpLmZpcnN0PT1mYSkgY29udGludWU7DQoJCWJvb2wgcD0haS5zZWNvbmQ7DQoJCWlmKCFnb29kW3hdKSBwPSFwOw0KCQlpZih2aXNbaS5maXJzdF0mJmdvb2RbaS5maXJzdF0hPXApew0KCQkJd29jYW9uaW1hPXRydWU7DQoJCX0NCgkJZ29vZFtpLmZpcnN0XT1wOw0KCQlkZnMoaS5maXJzdCx4KTsNCgl9DQp9DQp2b2lkIHNvbHZlKCkNCnsNCglpbnQgbixxLG07DQoJY2luPj5uPj5xPj5tOw0KCWZvcihpbnQgaT0xO2k8PW07aSsrKXsNCgkJaW50IG9wLHUsdjsNCgkJY2luPj5vcD4+dT4+djsNCgkJZVt1XS5wdXNoX2JhY2soe3Ysb3B9KTsNCgkJZVt2XS5wdXNoX2JhY2soe3Usb3B9KTsNCgl9DQoJZm9yKGludCBpPTE7aTw9bjtpKyspew0KCQlpZih2aXNbaV0pIGNvbnRpbnVlOw0KCQlnb29kW2ldPXRydWU7DQoJCWNudCsrOw0KCQlkZnMoaSwwKTsNCgl9DQovLwljb3V0PDwiLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuIjsNCi8vCWZvciAoaW50IGk9MTsgaTw9bjsgaSsrKSBjb3V0PDxpPDwiICI8PGdvb2RbaV08PCIgIjw8c2NjW2ldPDwiXG4iOw0KCXZlY3RvcjxwYWlyPGludCxpbnQ+PiBzaXooY250KzEpOw0KCWZvcihpbnQgaT0xO2k8PW47aSsrKXsNCgkJaWYoZ29vZFtpXSkgc2l6W3NjY1tpXV0uZmlyc3QrKzsvLzANCgkJZWxzZSBzaXpbc2NjW2ldXS5zZWNvbmQrKzsvLzENCgl9DQoNCglpZih3b2Nhb25pbWEpew0KCQljb3V0PDwiTk9cbiI7DQoJCXJldHVybjsNCgl9DQoJdmVjdG9yPGludD4gZGlzKGNudCsxLDApOw0KCW1lbXNldChudW0sMCxzaXplb2YobnVtKSk7DQoJbWVtc2V0KHRvdCwwLHNpemVvZih0b3QpKTsNCglpbnQgc3VtPTA7DQoJZm9yKGludCBpPTE7aTw9Y250O2krKykgZGlzW2ldPWFicyhzaXpbaV0uZmlyc3Qtc2l6W2ldLnNlY29uZCksbnVtW2Rpc1tpXV0rKyxzdW0rPW1pbihzaXpbaV0uZmlyc3Qsc2l6W2ldLnNlY29uZCk7DQoJZm9yKGludCBpPTE7aTw9Y250O2krKykgaWYgKGRpc1tpXT09MCkgdG90WzBdKys7DQoJdmVjdG9yPGludD4gZHAobisxLDApOw0KCWRwW3N1bV09MTsgaW50IGxsPTA7DQoJZm9yIChpbnQgaT0xOyBpPD0xMDAwMDA7IGkrKykNCgkgaWYgKG51bVtpXT4wKQ0KCSAgew0KCSAgCWludCBqPW51bVtpXSxrPTIwOw0KCSAgCXdoaWxlIChqPjAmJms+PTApDQoJICAJew0KCSAgCQlpZiAoKDE8PGspPD1qKSBjWysrbGxdPShOb2RlKXsoMTw8aykqaSxpfSxqLT0oMTw8ayk7DQoJICAJCS0tazsNCgkJfQ0KCSAgfQ0KLy8JICBwcmludGYoIiVkXG4iLGxsKTsNCgltZW1zZXQoZmYsMCxzaXplb2YoZmYpKTsNCgltZW1zZXQocHAsMCxzaXplb2YocHApKTsNCglmb3IgKGludCBpPTE7IGk8PWxsOyBpKyspDQoJIGZvciAoaW50IGo9cTsgaj49c3VtOyBqLS0pDQoJICBpZiAoaitjW2ldLng8PXEpDQoJICAgaWYgKGRwW2pdJiYhZHBbaitjW2ldLnhdKQ0KCSAgICB7DQoJICAgIAlkcFtqK2NbaV0ueF09MTsNCgkgICAgCWZmW2orY1tpXS54XT1qOw0KCSAgICAJcHBbaitjW2ldLnhdPWk7DQoJCX0NCglpZihkcFtxXT09MCl7DQoJCWNvdXQ8PCJOT1xuIjsNCgkJcmV0dXJuOw0KCX0NCglpbnQgdD1xOw0KLy8JCXByaW50ZigiJWQgJWRcbiIsc3VtLHQpOw0KCXdoaWxlICh0PnN1bSkNCgl7DQoJCWludCB4PXBwW3RdOw0KCQlpbnQgcD1jW3hdLngvY1t4XS5wOw0KLy8JCXByaW50ZigiJWQgJWQgJWQgJWRcbiIsdCx4LHAsY1t4XS5wKTsNCgkJdG90W2NbeF0ucF0rPXA7DQoJCXQ9ZmZbdF07DQoJfQ0KCXZlY3RvcjxpbnQ+IGFuczsNCglib29sIGlzdXNlWzEwMDAwNV07DQoJZm9yIChpbnQgaT0xOyBpPD1jbnQ7IGkrKykNCgkgaWYgKHRvdFtkaXNbaV1dPjApDQoJICB7DQoJICAJdG90W2Rpc1tpXV0tLTsNCgkgIAlpc3VzZVtpXT10cnVlOw0KCSAgfQ0KCWZvcihpbnQgaT0xO2k8PW47aSsrKXsNCi8vCQlwcmludGYoIiVkICVkICVkICVkXG4iLGdvb2RbaV0sc2l6W3NjY1tpXV0uZmlyc3Qsc2l6W3NjY1tpXV0uc2Vjb25kLGlzdXNlW3NjY1tpXV0pOw0KCQlpZihnb29kW2ldKXsNCgkJCWlmKHNpeltzY2NbaV1dLmZpcnN0Pj1zaXpbc2NjW2ldXS5zZWNvbmQmJmlzdXNlW3NjY1tpXV0pIGFucy5wdXNoX2JhY2soaSk7DQoJCQlpZihzaXpbc2NjW2ldXS5maXJzdDw9c2l6W3NjY1tpXV0uc2Vjb25kJiYhaXN1c2Vbc2NjW2ldXSkgYW5zLnB1c2hfYmFjayhpKTsNCgkJfQ0KCQllbHNlDQoJCXsNCgkJCWlmKHNpeltzY2NbaV1dLmZpcnN0PnNpeltzY2NbaV1dLnNlY29uZCYmIWlzdXNlW3NjY1tpXV0pIGFucy5wdXNoX2JhY2soaSk7DQoJCQlpZihzaXpbc2NjW2ldXS5maXJzdDxzaXpbc2NjW2ldXS5zZWNvbmQmJmlzdXNlW3NjY1tpXV0pIGFucy5wdXNoX2JhY2soaSk7DQoJCX0NCgl9DQoJc29ydChhbnMuYmVnaW4oKSxhbnMuZW5kKCkpOw0KCWNvdXQ8PCJZRVNcbiI7DQoJZm9yKGF1dG8mIGk6YW5zKXsNCgkJY291dDw8aTw8IiAiOw0KCX0NCgljb3V0PDwiXG4iOw0KfQ0KaW50IG1haW4oKQ0Kew0KCWlvczo6c3luY193aXRoX3N0ZGlvKDApOw0KCWNpbi50aWUoMCk7Y291dC50aWUoMCk7DQoJc29sdmUoKTsNCglyZXR1cm4gMDsJDQp9"}]