[{"id":"4137","submission_id":"4137","filename":"I.cpp","source":"I3ByYWdtYSBHQ0Mgb3B0aW1pemUoMikNCiNpbmNsdWRlPGJpdHMvc3RkYysrLmg+DQoNCiNkZWZpbmUgaW50IGxvbmcgbG9uZw0KDQp1c2luZyBuYW1lc3BhY2Ugc3RkOw0KDQppbnQgbiwgbGVuOw0Kc3RyaW5nIHM7DQppbnQgYW5zOw0KDQp2b2lkIFNvbHZlKCkgew0KDQoJZm9yKGludCBpID0gMTsgaSA8PSBsZW47IGkgKyspIHsNCgkJaW50IGwgPSBpLCByID0gaTsNCgkJd2hpbGUodHJ1ZSkgew0KCQkJaWYobCA8IDEgfHwgciA+IGxlbikgew0KLy9jb3V0PDwiMToiPDxsPDwiICI8PHI8PCJcbiI7DQoJCQkJYW5zID0gbWF4KGFucywgciAtIGwgLSAxKTsNCi8vY291dDw8Ij09PT4iPDxyLWwtMTw8IlxuIjsNCgkJCQlicmVhazsNCgkJCX0NCgkJCWlmKHNbbF0gPT0gc1tyXSkgew0KCQkJCWwgLS07DQoJCQkJciArKzsNCgkJCX0gZWxzZSB7DQoJCQkJbCAtLTsgciArKzsNCgkJCQlpZihsIDwgMSB8fCByID4gbGVuKSB7DQoJCQkJCWlmKHNbbCsxXT09c1tpXXx8c1tyLTFdPT1zW2ldKXsNCi8vY291dDw8IjI6Ijw8bDw8IiAiPDxyPDwiXG4iOw0KCQkJCQkJYW5zID0gbWF4KGFucyxyLWwtMSk7DQovL2NvdXQ8PCI9PT0+Ijw8ci1sLTE8PCJcbiI7DQoJCQkJCQlicmVhazsNCgkJCQkJfQ0KLy9jb3V0PDwiMzoiPDxsPDwiICI8PHI8PCJcbiI7DQoJCQkJCWFucyA9IG1heChhbnMsIHIgLSBsIC0gMyk7DQovL2NvdXQ8PCI9PT0+Ijw8ci1sLTM8PCJcbiI7DQoJCQkJCWJyZWFrOw0KCQkJCX0NCgkJCQlpZigoc1tsXT09c1tsKzFdJiZzW3JdPT1zW3ItMV0pIHx8IChzW2xdPT1zW3ItMV0mJnNbbCsxXT09c1tyXSkpIHsNCi8vCQkJCQlsIC0tOyByICsrOw0KCQkJCQl3aGlsZSh0cnVlKSB7DQoJCQkJCQlpZihsIDwgMSB8fCByID4gbGVuKSB7DQovL2NvdXQ8PCI0OiI8PGw8PCIgIjw8cjw8IlxuIjsNCgkJCQkJCQlhbnMgPSBtYXgoYW5zLCByIC0gbCAtIDEpOw0KLy9jb3V0PDwiPT09PiI8PHItbC0xPDwiXG4iOw0KCQkJCQkJCWJyZWFrOw0KCQkJCQkJfQ0KCQkJCQkJaWYoc1tsXSAhPSBzW3JdKSB7DQovL2NvdXQ8PCI1OiI8PGw8PCIgIjw8cjw8IlxuIjsNCgkJCQkJCQlhbnMgPSBtYXgoYW5zLCByIC0gbCAtIDEpOw0KLy9jb3V0PDwiPT09PiI8PHItbC0xPDwiXG4iOw0KCQkJCQkJCWJyZWFrOw0KCQkJCQkJfQ0KCQkJCQkJbCAtLSwgciArKzsNCgkJCQkJfQ0KCQkJCQlicmVhazsNCgkJCQl9IGVsc2Ugew0KCQkJCQlpZihzW2wrMV09PXNbaV18fHNbci0xXT09c1tpXSkgew0KLy8JCQkJCQlsIC0tOyByICsrOw0KCQkJCQkJd2hpbGUodHJ1ZSkgew0KCQkJCQkJCWlmKGwgPCAxIHx8IHIgPiBsZW4pIHsNCi8vY291dDw8IjY6Ijw8bDw8IiAiPDxyPDwiXG4iOw0KCQkJCQkJCQlhbnMgPSBtYXgoYW5zLCByIC0gbCAtIDEpOw0KLy9jb3V0PDwiPT09PiI8PHItbC0xPDwiXG4iOw0KCQkJCQkJCQlicmVhazsNCgkJCQkJCQl9DQoJCQkJCQkJaWYoc1tsXSAhPSBzW3JdKSB7DQovL2NvdXQ8PCI3OiI8PGw8PCIgIjw8cjw8IlxuIjsNCgkJCQkJCQkJYW5zID0gbWF4KGFucywgciAtIGwgLSAxKTsNCi8vY291dDw8Ij09PT4iPDxyLWwtMTw8IlxuIjsNCgkJCQkJCQkJYnJlYWs7DQoJCQkJCQkJfQ0KCQkJCQkJCWwgLS0sIHIgKys7DQoJCQkJCQl9DQoJCQkJCQlicmVhazsNCgkJCQkJfQ0KCQkJCQllbHNlew0KLy9jb3V0PDwiODoiPDxsPDwiICI8PHI8PCJcbiI7DQoJCQkJCQlhbnMgPSBtYXgoYW5zLCByIC0gbCAtIDMpOw0KLy9jb3V0PDwiPT09PiI8PHItbC0zPDwiXG4iOw0KCQkJCQl9DQoJCQkJCWJyZWFrOw0KCQkJCX0NCgkJCX0NCgkJfQ0KCX0NCglmb3IoaW50IGkgPSAxOyBpIDwgbGVuOyBpICsrKSB7DQovLwkJaWYoc1tpXSAhPSBzW2kgKyAxXSkgew0KLy8JCQljb250aW51ZTsNCi8vCQl9DQoJCWludCBsID0gaSwgciA9IGkgKyAxOw0KCQl3aGlsZSh0cnVlKSB7DQoJCQlpZihsIDwgMSB8fCByID4gbGVuKSB7DQovL2NvdXQ8PCI5OiI8PGw8PCIgIjw8cjw8IlxuIjsNCgkJCQlhbnMgPSBtYXgoYW5zLCByIC0gbCAtIDEpOw0KLy9jb3V0PDwiPT09PiI8PHItbC0xPDwiXG4iOw0KCQkJCWJyZWFrOw0KCQkJfQ0KCQkJaWYoc1tsXSA9PSBzW3JdKSB7DQoJCQkJbCAtLTsNCgkJCQlyICsrOw0KCQkJfSBlbHNlIHsNCgkJCQlsIC0tOyByICsrOw0KCQkJCWlmKGwgPCAxIHx8IHIgPiBsZW4pIHsNCi8vY291dDw8IjEwOiI8PGw8PCIgIjw8cjw8IlxuIjsNCgkJCQkJYW5zID0gbWF4KGFucywgciAtIGwgLSAzKTsNCi8vY291dDw8Ij09PT4iPDxyLWwtMzw8IlxuIjsNCgkJCQkJYnJlYWs7DQoJCQkJfQ0KCQkJCWlmKChzW2xdPT1zW2wrMV0mJnNbcl09PXNbci0xXSkgfHwgKHNbbF09PXNbci0xXSYmc1tsKzFdPT1zW3JdKSkgew0KCQkJCQlsIC0tOyByICsrOw0KCQkJCQl3aGlsZSh0cnVlKSB7DQoJCQkJCQlpZihsIDwgMSB8fCByID4gbGVuKSB7DQovL2NvdXQ8PCIxMToiPDxsPDwiICI8PHI8PCJcbiI7DQoJCQkJCQkJYW5zID0gbWF4KGFucywgciAtIGwgLSAxKTsNCi8vY291dDw8Ij09PT4iPDxyLWwtMTw8IlxuIjsNCgkJCQkJCQlicmVhazsNCgkJCQkJCX0NCgkJCQkJCWlmKHNbbF0gIT0gc1tyXSkgew0KLy9jb3V0PDwiMTI6Ijw8bDw8IiAiPDxyPDwiXG4iOw0KCQkJCQkJCWFucyA9IG1heChhbnMsIHIgLSBsIC0gMSk7DQovL2NvdXQ8PCI9PT0+Ijw8ci1sLTE8PCJcbiI7DQoJCQkJCQkJYnJlYWs7DQoJCQkJCQl9DQoJCQkJCQlsIC0tLCByICsrOw0KCQkJCQl9DQoJCQkJCWJyZWFrOw0KCQkJCX0gZWxzZSB7DQovL2NvdXQ8PCIxMzoiPDxsPDwiICI8PHI8PCJcbiI7DQoJCQkJCWFucyA9IG1heChhbnMsIHIgLSBsIC0gMyk7DQovL2NvdXQ8PCI9PT0+Ijw8ci1sLTM8PCJcbiI7DQoJCQkJCWJyZWFrOw0KCQkJCX0NCgkJCX0NCgkJfQ0KCX0NCn0NCg0Kdm9pZCBwcmludChpbnQgeCkgew0KCWlmKHggPCAwKSB7DQoJCXB1dGNoYXIoJy0nKTsNCgkJeCA9IC0geDsNCgl9IA0KCWlmKHggPiAxMCl7DQoJCXByaW50KHggLyAxMCk7DQoJfQ0KCXB1dGNoYXIoeCAlICAxMCArIDQ4KTsNCglyZXR1cm47DQp9DQoNCnNpZ25lZCBtYWluKCl7DQoJc2NhbmYoIiVkIiwgJm4pOw0KCWZvcihpbnQga2sgPSAxOyBrayA8PSBuOyBrayArKykgew0KCQljaW4gPj4gczsNCgkJbGVuID0gcy5sZW5ndGgoKTsNCgkJYW5zID0gLSAxOw0KCQlzID0gIiAiICsgczsNCgkJU29sdmUoKTsNCgkJaWYoYW5zPDIpYW5zPTA7DQoJCXByaW50KGFucyk7IHB1dGNoYXIoJ1xuJyk7DQoJfQ0KCXJldHVybiAwOw0KfQ=="}]