[{"id":"4300","submission_id":"4300","filename":"d.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+DQoNCnVzaW5nIGk2NCA9IGxvbmcgbG9uZzsNCg0KY29uc3QgaW50IGluZiA9IDEwMDAwMDAwMDsNCg0KDQpzdHJ1Y3QgTm9kZXsNCglpbnQgbCxyOw0KCWludCBtaW47DQoJTm9kZShpbnQgeCA9IGluZil7DQoJCW1pbiA9IHg7DQoJfQ0KCWZyaWVuZCBOb2RlIG1lcmdlKGNvbnN0IE5vZGUgJmxoLGNvbnN0IE5vZGUgJnJoKXsNCgkJTm9kZSBhbnM7DQoJCWFucy5sID0gbGgubDsNCgkJYW5zLnIgPSByaC5yOw0KCQlhbnMubWluID0gc3RkOjptaW4obGgubWluLHJoLm1pbik7DQoJCXJldHVybiBhbnM7DQoJfQ0KCXZvaWQgYXBwbHkoaW50IHkpew0KCQlpZiAoeSA9PSBpbmYpIHsNCgkJCXJldHVybjsNCgkJfQ0KCQltaW4gID0geTsNCgl9DQp9Ow0KDQp2b2lkIGFwcGx5KGludCAmeCwgaW50IHkpIHsNCglpZiAoeSA9PSBpbmYpIHsNCgkJcmV0dXJuOw0KCX0NCgl4ID0geTsNCn0NCg0Kc3RydWN0IHNlZyB7DQoJY29uc3QgaW50IG47DQoJc3RkOjp2ZWN0b3I8Tm9kZT4gaW5mbzsNCglzdGQ6OnZlY3RvcjxpbnQ+IHRhZzsNCglzZWcoaW50IG4pOm4obiksaW5mbyhuKjQpLHRhZyg0ICogbixpbmYpe30NCglzZWcoc3RkOjp2ZWN0b3I8aW50PiBhKSA6IHNlZyhpbnQoYS5zaXplKCkpIC0gMSkgew0KCQlhdXRvIGRmcyA9IFsmXShhdXRvIHNlbGYsIGludCBwLCBpbnQgbCwgaW50IHIpIC0+IHZvaWQgew0KCQkJaWYobCA9PSByKXsNCgkJCQlpbmZvW3BdLmwgPSBsOw0KCQkJCWluZm9bcF0uciA9IHI7DQoJCQkJaW5mb1twXS5taW4gPSBhW2xdOw0KLy8JCQkJc3RkOjpjZXJyIDw8IHAgPDwgJyAnIDw8IGwgPDwgJyAnIDw8IHIgPDwgJyAnIDw8IGluZm9bcF0ubWluPDwnXG4nOw0KLy8JCQkJc3RkOjpjZXJyICA8PCBwIDw8ICcgJzw8IGwgPDwnICcgPDwgaW5mb1twXS5taW48PCdcbic7DQoJCQkJcmV0dXJuOw0KCQkJfQ0KCQkJaW50IG0gPSAobCArIHIpID4+IDE7DQoJCQlzZWxmKHNlbGYsIDIqcCxsLG0pOw0KCQkJc2VsZihzZWxmLCAyKnArMSxtKzEscik7DQoJCQkNCgkJCXB1bGwocCk7DQovLwkJCXN0ZDo6Y2VyciA8PCBwICA8PCAnICcgPDwgbCA8PCAnICcgPDwgciA8PCAnICcgPDwgaW5mb1twXS5taW48PCdcbic7DQoJCX07DQoJCWRmcyhkZnMsIDEsIDEsIG4pOw0KCX0NCgl2b2lkIHB1bGwoaW50IHApIHsNCgkJaW5mb1twXSA9IG1lcmdlKGluZm9bMiAqIHBdLCBpbmZvWzIgKiBwICsgMV0pOw0KCX0NCgl2b2lkIHB1c2goaW50IHApIHsNCgkJYXBwbHkoMiAqIHAsIHRhZ1twXSk7DQoJCWFwcGx5KDIgKiBwICsgMSwgdGFnW3BdKTsNCgkJdGFnW3BdID0gaW5mOw0KCX0NCgl2b2lkIGFwcGx5KGludCBwLCBpbnQgdCkgew0KCQlpbmZvW3BdLmFwcGx5KHQpOw0KCQk6OmFwcGx5KHRhZ1twXSwgdCk7DQoJfQ0KCXZvaWQgcmFuZ2VNb2RpZnkoaW50IHAsaW50IGwsaW50IHIsaW50IHgsaW50IHksaW50IHYpew0KCQlpZiggeCA8PSBsICYmIHIgPD0geSl7DQoJCQlhcHBseShwLCB2KTsNCgkJCXJldHVybjsNCgkJfQ0KCQlwdXNoKHApOw0KCQlpbnQgbSA9IChsK3IpPj4xOw0KCQlpZihtID49IHgpcmFuZ2VNb2RpZnkocCoyLGwsbSx4LHksdik7DQoJCWlmKG0gPCB5KXJhbmdlTW9kaWZ5KDIqcCsxLG0rMSxyLHgseSx2KTsNCgkJcHVsbChwKTsNCgl9DQoJTm9kZSByYW5nZVFyeShpbnQgcCxpbnQgbCxpbnQgcixpbnQgeCxpbnQgeSl7DQoJCWlmKHggPiByfHwgeSA8IGwpew0KCQkJcmV0dXJuIE5vZGUoKTsNCgkJfQ0KCQlpZih4IDw9IGwgJiYgciA8PSB5KXsNCgkJCXJldHVybiBpbmZvW3BdOw0KCQl9DQoJCXB1c2gocCk7DQoJCWludCBtID0gKGwgKyByKSA+PiAxOw0KCQlyZXR1cm4gbWVyZ2UocmFuZ2VRcnkoMipwLGwsbSx4LHkpLHJhbmdlUXJ5KDIqcCsxLG0rMSxyLHgseSkpOw0KCX0NCglpbnQgZmluZChpbnQgcCxpbnQgbCxpbnQgcixpbnQgeCl7DQoJCWlmIChsID09IHIpIHsNCgkJCXJldHVybiBsOw0KCQl9DQoJCWlmIChpbmZvW3BdLm1pbiA+IHgpIHsNCgkJCXJldHVybiByOw0KCQl9DQoJCWludCBtID0gKGwgKyByKSA+PiAxOw0KCQlpZihpbmZvW3AqMl0ubWluIDw9IHgpcmV0dXJuIGZpbmQocCoyLGwsbSx4KTsNCgkJZWxzZSByZXR1cm4gZmluZChwKjIsbSsxLHIseCk7DQoJfQ0KDQoNCn07DQoNCnN0cnVjdCBidXN7DQoJaW50IHQsbCxyOw0KCWJ1cyhpbnQgdCxpbnQgbCxpbnQgcik6dCh0KSxsKGwpLHIocil7fQ0KCWJ1cygpewl9DQoJYm9vbCBvcGVyYXRvciA8IChjb25zdCBidXMmcmhzKWNvbnN0ew0KCQlyZXR1cm4gdCA9PSByaHMudCA/ICByID4gcmhzLnIgOiB0ID4gcmhzLnQ7DQoJfQ0KfTsNCnN0cnVjdCBwZXJzb257DQoJaW50IHQscCxpZDsNCglwZXJzb24oaW50IHQsaW50IHAsaW50IGlkKTpwKHApLHQodCksaWQoaWQpe30NCglwZXJzb24oKXsJfQ0KCWJvb2wgb3BlcmF0b3IgPCAoY29uc3QgcGVyc29uJnJocyljb25zdHsNCgkJcmV0dXJuIHQgPiByaHMudDsNCgl9DQp9Ow0KDQp2b2lkIHNvbHZlKCkgew0KCWludCBuLCBtICx4Ow0KCXN0ZDo6Y2luID4+IG4gPj4gbSA+PiB4Ow0KCXN0ZDo6dmVjdG9yPGJ1cz5idXNlcyhuKTsNCglzdGQ6OnZlY3RvcjxwZXJzb24+cGVyc29ucyhtKTsNCglzdGQ6OnZlY3RvcjxpbnQ+Y250Ow0KCWNudC5wdXNoX2JhY2soeCk7DQoJY250LnB1c2hfYmFjaygwKTsNCglmb3IoYXV0byAmW3QsbCxyXTogYnVzZXMpew0KCQlzdGQ6OmNpbiA+PiB0ID4+IGwgPj4gcjsNCgkJY250LnB1c2hfYmFjayhsKTsNCgkJY250LnB1c2hfYmFjayhyKTsNCgl9DQoJDQoJDQoJZm9yKGludCB0b3QgPSAwO2F1dG8gJlt0LHAsaWRdOnBlcnNvbnMpew0KCQlzdGQ6OmNpbiA+PiB0ID4+IHA7DQoJCWlkID0gdG90Kys7DQoJCWNudC5wdXNoX2JhY2socCk7DQoJfQ0KDQoNCglzdGQ6OnNvcnQoY250LmJlZ2luKCksY250LmVuZCgpKTsNCgljbnQuZXJhc2Uoc3RkOjp1bmlxdWUoY250LmJlZ2luKCksY250LmVuZCgpKSxjbnQuZW5kKCkpOw0KDQoNCglmb3IoYXV0byAmW3QsbCxyXTpidXNlcyl7DQoJCWwgPSBzdGQ6Omxvd2VyX2JvdW5kKGNudC5iZWdpbigpLGNudC5lbmQoKSxsKSAtIGNudC5iZWdpbigpOw0KCQlyID0gc3RkOjpsb3dlcl9ib3VuZChjbnQuYmVnaW4oKSxjbnQuZW5kKCkscikgLSBjbnQuYmVnaW4oKTsNCgl9DQoJZm9yKGF1dG8gJlt0LHAsaWRdOnBlcnNvbnMpew0KCQlwID0gc3RkOjpsb3dlcl9ib3VuZChjbnQuYmVnaW4oKSxjbnQuZW5kKCkscCkgLSBjbnQuYmVnaW4oKTsNCgl9DQoJeCA9IHN0ZDo6bG93ZXJfYm91bmQoY250LmJlZ2luKCksY250LmVuZCgpLHgpIC0gY250LmJlZ2luKCk7DQoJDQoJc3RkOjpzb3J0KGJ1c2VzLmJlZ2luKCksYnVzZXMuZW5kKCkpOw0KCXN0ZDo6c29ydChwZXJzb25zLmJlZ2luKCkscGVyc29ucy5lbmQoKSk7DQoJDQoJc3RkOjp2ZWN0b3I8aW50PmEoY250LnNpemUoKSxpbmYpOw0KCWFbeF0gPSAwOw0KCWludCBsZW4gPSBjbnQuc2l6ZSgpIC0gMTsNCi8vCXN0ZDo6Y291dDw8Y250LnNpemUoKSA8PCAnICc7DQovLwlzdGQ6OmNvdXQgPDwgeCA8PCAnXG4nOw0KCQ0KCWludCBwdHIgPSAwOw0KCXNlZyBUcmVlKGEpOw0KLy8Jc3RkOjpjZXJyIDw8IGxlbiA8PCAiIVxuIjsNCi8vCWZvciAoaW50IGkgPSAxOyBpIDw9IGxlbjsgaSsrKSB7DQovLwkJc3RkOjpjb3V0IDw8IFRyZWUucmFuZ2VRcnkoMSwgMSwgbGVuLCBpLCBpKS5taW4gPDwgIiBcbiJbaSA9PSBsZW5dOw0KLy8JfQ0KLy8Jc3RkOjpjZXJyIDw8IE5vZGUoKS5taW48PCdcbic7DQoJYXV0byBhZGQ9WyZdKGludCB4KXsNCgkJYXV0byBbdCxsLHJdID0gYnVzZXNbeF07DQoJCWF1dG8gbm93ID0gVHJlZS5yYW5nZVFyeSgxLDEsbGVuLGwscik7DQogCQlpbnQgbWludCA9IG5vdy5taW4gOw0KCQlpbnQgcG9zID0gVHJlZS5maW5kKDEsMSxsZW4sbWludCk7DQoJCXBvcyAtLSA7DQoJCWlmKHBvcyA+PSBsKVRyZWUucmFuZ2VNb2RpZnkoMSwxLGxlbixsLHBvcyxtaW50ICsgMSk7DQoJfTsNCglzdGQ6OnZlY3RvcjxpbnQ+cmVzKG0pOw0KCWZvcihpbnQgaSA9IDA7IGkgPCBtOyArK2kpew0KCQlhdXRvIFt0aW0scG9zLGlkXSA9IHBlcnNvbnNbaV07DQovLwkJc3RkOjpjb3V0PDx0aW0gPDwnICcgPDwgcG9zIDw8IlJSUlxuIjsNCgkJd2hpbGUocHRyIDwgbiAmJiBidXNlc1twdHJdLnQgPj0gdGltKXsNCi8vCQkJc3RkOjpjZXJyICA8PCBidXNlc1twdHJdLmwgPDwnICcgPDwgYnVzZXNbcHRyXS5yIDw8J1xuJzsNCgkJCWFkZChwdHIpOw0KCQkJcHRyKys7DQoJCX0NCi8vCQlzdGQ6OmNlcnIgPDwgbGVuIDw8ICIhXG4iOw0KLy8JCWZvciAoaW50IGkgPSAxOyBpIDw9IGxlbjsgaSsrKSB7DQovLwkJCXN0ZDo6Y291dCA8PCBUcmVlLnJhbmdlUXJ5KDEsIDEsIGxlbiwgaSwgaSkubWluIDw8ICIgXG4iW2kgPT0gbGVuXTsNCi8vCQl9DQovLwkJc3RkOjpjb3V0IDw8IHBvcyA8PCAiQUFBIjsNCgkJYXV0byBhbnMgPSBUcmVlLnJhbmdlUXJ5KDEsMSxsZW4scG9zLHBvcyk7DQoJCWlmKGFucy5taW4gPT0gaW5mKXJlc1tpZF09LTEgOw0KCQllbHNlIHJlc1tpZF09YW5zLm1pbjsNCgl9DQoJZm9yKGF1dG8geCA6cmVzKXN0ZDo6Y291dDw8eCA8PCdcbic7DQovLwlzdGQ6OmNvdXQ8PFRyZWUuaW5mb1sxXS5taW47DQovLwlzdGQ6OnZlY3RvcjxpbnQ+YShuKzEpDQp9DQoNCmludCBtYWluKCkgew0KCWZyZW9wZW4oImluLnR4dCIsICJyIiwgc3RkaW4pOw0KCQ0KCXN0ZDo6aW9zOjpzeW5jX3dpdGhfc3RkaW8oZmFsc2UpOw0KCXN0ZDo6Y2luLnRpZShudWxscHRyKTsNCgkNCglpbnQgdDsNCi8vCXN0ZDo6Y2luID4+IHQ7DQoJdCA9IDE7DQoJd2hpbGUgKHQtLSkgew0KCQlzb2x2ZSgpOw0KCX0NCg0KCXJldHVybiAwOw0KfQ0KDQovKg0KNiAzIDEwDQoxIDEgMTANCjIgMyA2DQozIDUgOQ0KNCA3IDEwDQo1IDMgOA0KNiA3IDEwDQoxIDENCjIgNA0KNiA1DQoqLw0K"}]