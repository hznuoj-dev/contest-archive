[{"id":"3073","submission_id":"3073","filename":"G.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+DQoNCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQojZGVmaW5lIGxuICdcbicNCg0KY29uc3QgaW50IE4gPSAxZTUgKyA1Ow0KDQppbnQgZltOXSwgc2l6W05dLCBjb2xbTl0sIHdbTl0sIGlkW05dOw0KDQovL2JpdHNldDw1MDAwMD4NCmludCBmaW5kKGludCB4KSB7DQoJaWYoZlt4XSA9PSB4KSByZXR1cm4geDsNCglpbnQgcGFyID0gZmluZChmW3hdKTsNCgljb2xbeF0gPSBjb2xbZlt4XV0gXiB3W3hdOw0KCXJldHVybiBwYXI7DQp9DQoNCmJvb2wgYW5zID0gdHJ1ZTsNCg0Kdm9pZCBtZXJnZShpbnQgeCwgaW50IHksIGludCBXKSB7DQovLwljb3V0IDw8IHggPDwgIiAiIDw8IHkgPDwgbG47DQoJaW50IGZ4ID0gZmluZCh4KSwgZnkgPSBmaW5kKHkpOw0KLy8JY291dCA8PCB4IDw8ICIgIiA8PCB5IDw8ICIgIiA8PCBjb2xbeF0gPDwgIiAiIDw8IGNvbFt5XSA8PCAiICIgPDwgVyA8PCBsbjsNCglpZihmeCA9PSBmeSkgew0KCQlpZihjb2xbeF0gXiBjb2xbeV0gIT0gVykgYW5zID0gZmFsc2U7DQoJCXJldHVybjsNCgl9DQoJaWYoc2l6W2Z4XSA8IHNpeltmeV0pIA0KCQlzd2FwKHgsIHkpLCBzd2FwKGZ4LCBmeSk7DQoJDQoJc2l6W2Z4XSArPSBzaXpbZnldOw0KCWZbZnldID0gZng7DQoJd1tmeV0gPSBjb2xbeF0gXiBjb2xbeV0gXiBXOw0KCQ0KfQ0KDQppbmxpbmUgdm9pZCBzb2x2ZSgpIHsNCglpbnQgbiwgcSwgbTsNCgljaW4gPj4gbiA+PiBxID4+IG07DQoJZm9yKGludCBpID0gMTsgaSA8PSBuOyBpKyspIA0KCQlmW2ldID0gaSwgY29sW2ldID0gMCwgc2l6W2ldID0gMSwgd1tpXSA9IDA7DQoJZm9yKGludCBpID0gMTsgaSA8PSBtOyBpKyspIHsNCgkJaW50IHgsIHksIHc7DQoJCWNpbiA+PiB3ID4+IHggPj4geTsNCgkJbWVyZ2UoeCwgeSwgdyk7DQoJCWZpbmQoeCk7IGZpbmQoeSk7DQoJfQ0KCWlmKGFucyA9PSBmYWxzZSkgDQoJCXJldHVybiBjb3V0IDw8ICJOT1xuIiwgdm9pZCgpOw0KCWVsc2UgDQoJCWNvdXQgPDwgIllFU1xuIjsNCgkNCglpbnQgdG90ID0gMDsNCglmb3IoaW50IGkgPSAxOyBpIDw9IG47IGkrKykgDQoJCWlmKGZpbmQoaSkgPT0gaSkgaWRbaV0gPSArK3RvdDsJDQoJZm9yKGludCBpID0gMTsgaSA8PSBuOyBpKyspIA0KCQlpZFtpXSA9IGlkW2ZpbmQoaSldOw0KCQkNCgl2ZWN0b3I8dmVjdG9yPGludD4+IGdvb2QodG90ICsgMSksIGJhZCh0b3QgKyAxKTsNCglmb3IoaW50IGkgPSAxOyBpIDw9IG47IGkrKykgew0KCQlpZihjb2xbaV0gPT0gMCkgZ29vZFtpZFtpXV0ucHVzaF9iYWNrKGkpOw0KCQllbHNlIGJhZFtpZFtpXV0ucHVzaF9iYWNrKGkpOw0KCX0NCgkNCglpbnQgbW4gPSBtaW4ocSwgbiAtIHEpOw0KCXZlY3RvcjxiaXRzZXQ8NTAwMDU+PiBwKHRvdCArIDEpOw0KCXBbMF1bMF0gPSAxOw0KCWZvcihpbnQgaSA9IDE7IGkgPD0gdG90OyBpKyspIA0KCQlwW2ldID0gKHBbaSAtIDFdIDw8IGdvb2RbaV0uc2l6ZSgpKSB8IChwW2kgLSAxXSA8PCBiYWRbaV0uc2l6ZSgpKTsNCi8vCQljb3V0IDw8IHBbaV0gPDwgbG47DQoNCgl2ZWN0b3I8aW50PiBhbnNfZ29vZCwgYW5zX2JhZDsNCglmb3IoaW50IGkgPSB0b3Q7IGk7IGktLSkNCgkJaWYobW4gPj0gZ29vZFtpXS5zaXplKCkgJiYgcFtpIC0gMV1bbW4gLSBnb29kW2ldLnNpemUoKV0pICB7DQoJCQltbiAtPSBnb29kW2ldLnNpemUoKTsNCgkJCWZvcihhdXRvIHg6IGdvb2RbaV0pIGFuc19nb29kLnB1c2hfYmFjayh4KTsNCgkJCWZvcihhdXRvIHg6IGJhZFtpXSkgYW5zX2JhZC5wdXNoX2JhY2soeCk7DQoJCX0gZWxzZSB7DQoJCQltbiAtPSBiYWRbaV0uc2l6ZSgpOw0KCQkJZm9yKGF1dG8geDogYmFkW2ldKSBhbnNfZ29vZC5wdXNoX2JhY2soeCk7DQoJCQlmb3IoYXV0byB4OiBnb29kW2ldKSBhbnNfYmFkLnB1c2hfYmFjayh4KTsJDQoJCX0NCgkNCglzb3J0KGFuc19nb29kLmJlZ2luKCksIGFuc19nb29kLmVuZCgpKTsNCglzb3J0KGFuc19iYWQuYmVnaW4oKSwgYW5zX2JhZC5lbmQoKSk7DQoJaWYoYW5zX2dvb2Quc2l6ZSgpID09IHEpIHsNCgkJZm9yKGF1dG8geDogYW5zX2dvb2QpIGNvdXQgPDwgeCA8PCAiICI7DQoJCWNvdXQgPDwgbG47DQoJfSBlbHNlIHsNCgkJZm9yKGF1dG8geDogYW5zX2JhZCkgY291dCA8PCB4IDw8ICIgIjsNCgkJY291dCA8PCBsbjsNCgl9DQp9DQoNCmludCBtYWluKCkgew0KCQ0KLy8JZnJlb3BlbigiMS50eHQiLCAiciIsIHN0ZGluKTsNCgkNCglpb3M6OnN5bmNfd2l0aF9zdGRpbyhmYWxzZSk7DQoJY2luLnRpZShudWxscHRyKTsNCgkNCglzb2x2ZSgpOw0KfQ0KDQovKg0KMiAxIDINCjEgMSAyDQowIDIgMQ0KDQowIDAgMQ0KMSAwIDANCiovDQo="}]