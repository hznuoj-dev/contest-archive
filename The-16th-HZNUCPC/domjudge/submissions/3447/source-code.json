[{"id":"3447","submission_id":"3447","filename":"E.cpp","source":"I2luY2x1ZGU8Yml0cy9zdGRjKysuaD4NCiNpbmNsdWRlPGlvc3RyZWFtPg0KI2luY2x1ZGU8YWxnb3JpdGhtPg0KI2luY2x1ZGU8Y3N0cmluZz4NCiNpbmNsdWRlPGNtYXRoPg0KdXNpbmcgbmFtZXNwYWNlIHN0ZDsNCg0KaW50IG1haW4oKQ0Kew0KICAgIGxvbmcgbG9uZyBzdW0gPSAwOw0KICAgIGxvbmcgbG9uZyByZXMgPSAwOw0KICAgIGludCBuOw0KICAgIGNpbiA+PiBuOw0KICAgIGxvbmcgbG9uZyBhWzExMF0sYlsxMTBdOw0KICAgIGZvcihpbnQgaSA9IDE7aSA8PSBuOyBpKyspDQogICAgew0KICAgICAgICBjaW4gPj4gYVtpXSA+PiBiW2ldOw0KICAgIH0NCiAgICBmb3IoaW50IGkgPSAxO2kgPD0gbi0yOyBpKyspDQogICAgICAgIGZvcihpbnQgaiA9IGkrMTtqIDw9IG4tMTsgaisrKQ0KICAgICAgICAgICAgZm9yKGludCB6ID0gaisxO3ogPD0gbjsgeisrKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIGRvdWJsZSBrMSA9IChiW2pdLWJbaV0pLyhkb3VibGUpKGFbal0gLSBhW2ldKTsNCiAgICAgICAgICAgICAgICBkb3VibGUgazIgPSAoYlt6XS1iW2pdKS8oZG91YmxlKShhW3pdIC0gYVtqXSk7DQogICAgICAgICAgICAgICAgZG91YmxlIGszID0gKGJbaV0tYlt6XSkvKGRvdWJsZSkoYVtpXSAtIGFbel0pOw0KICAgICAgICAgICAgICAgIGRvdWJsZSBiMSA9IGJbaV0gLSAoZG91YmxlKWsxICogYVtpXTsNCiAgICAgICAgICAgICAgICBkb3VibGUgYjIgPSBiW2pdIC0gKGRvdWJsZSlrMiAqIGFbal07DQogICAgICAgICAgICAgICAgZG91YmxlIGIzID0gYlt6XSAtIChkb3VibGUpazMgKiBhW3pdOw0KICAgICAgICAgICAgICAgIGlmKGsxID09IGsyIHx8IGsyID09IGszIHx8IGsxID09IGszKQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICAgICAgfWVsc2UNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIC8vbG9uZyBsb25nIG1pbnggPSBtaW4oYVtpXSxtaW4oYVtqXSxhW3pdKSk7DQogICAgICAgICAgICAgICAgICAgIC8vbG9uZyBsb25nIG1heHggPSBtYXgoYVtpXSxtYXgoYVtqXSxhW3pdKSk7DQogICAgICAgICAgICAgICAgICAgIC8vbG9uZyBsb25nIG1pbnkgPSBtaW4oYltpXSxtaW4oYltqXSxiW3pdKSk7DQogICAgICAgICAgICAgICAgICAgIC8vbG9uZyBsb25nIG1heHkgPSBtYXgoYltpXSxtYXgoYltqXSxiW3pdKSk7DQogICAgICAgICAgICAgICAgICAgIC8vZm9yKGludCB4ID0gbWlueDt4IDw9IG1heHg7IHgrKykNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vZm9yKGludCB5ID0gbWlueTsgeSA8PSBtYXh5OyB5KyspDQogICAgICAgICAgICAgICAgICAgICAgICAvL3sNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2lmKCh5ID09IGsxICogeCArIGIxKSB8fCAoeSA9PSBrMiAqIHggKyBiMikgfHwgKHkgPT0gazMgKiB4ICsgYjMpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3JlcyArKzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL30NCiAgICAgICAgICAgICAgICAgICAgICAgIC8vfQ0KICAgICAgICAgICAgICAgICAgICBpZihhYnMoazEpIDwgMSkNCiAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgbG9uZyBsb25nIG1pbnggPSBtaW4oYVtpXSxhW2pdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGxvbmcgbG9uZyBtYXh4ID0gbWF4KGFbaV0sYVtqXSk7DQogICAgICAgICAgICAgICAgICAgICAgICByZXMgKz0gKG1heHggLSBtaW54KzEpICogYWJzKGsxKTsNCiAgICAgICAgICAgICAgICAgICAgfWVsc2UgaWYoYWJzKGsxKSA9PSAxKQ0KICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICBsb25nIGxvbmcgbWlueCA9IG1pbihhW2ldLGFbal0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgbG9uZyBsb25nIG1heHggPSBtYXgoYVtpXSxhW2pdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJlcyArPSAobWF4eCAtIG1pbngrMSkgKiBhYnMoazEpOw0KICAgICAgICAgICAgICAgICAgICB9ZWxzZXsNCiAgICAgICAgICAgICAgICAgICAgICAgIGxvbmcgbG9uZyBtaW54ID0gbWluKGFbaV0sYVtqXSk7DQogICAgICAgICAgICAgICAgICAgICAgICBsb25nIGxvbmcgbWF4eCA9IG1heChhW2ldLGFbal0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmVzICs9IChtYXh4IC0gbWlueCsxKSAvIGFicyhrMSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgaWYoYWJzKGsyKSA8IDEpDQogICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGxvbmcgbG9uZyBtaW54ID0gbWluKGFbal0sYVt6XSk7DQogICAgICAgICAgICAgICAgICAgICAgICBsb25nIGxvbmcgbWF4eCA9IG1heChhW2pdLGFbel0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmVzICs9IChtYXh4IC0gbWlueCsxKSAqIGFicyhrMik7DQogICAgICAgICAgICAgICAgICAgIH1lbHNlIGlmKGFicyhrMikgPT0gMSkNCiAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgbG9uZyBsb25nIG1pbnggPSBtaW4oYVtqXSxhW3pdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGxvbmcgbG9uZyBtYXh4ID0gbWF4KGFbal0sYVt6XSk7DQogICAgICAgICAgICAgICAgICAgICAgICByZXMgKz0gKG1heHggLSBtaW54KzEpICogYWJzKGsyKTsNCiAgICAgICAgICAgICAgICAgICAgfWVsc2V7DQogICAgICAgICAgICAgICAgICAgICAgICBsb25nIGxvbmcgbWlueCA9IG1pbihhW2pdLGFbel0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgbG9uZyBsb25nIG1heHggPSBtYXgoYVtqXSxhW3pdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJlcyArPSAobWF4eCAtIG1pbngrMSkgLyBhYnMoazIpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGlmKGFicyhrMykgPCAxKQ0KICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICBsb25nIGxvbmcgbWlueCA9IG1pbihhW2ldLGFbel0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgbG9uZyBsb25nIG1heHggPSBtYXgoYVtpXSxhW3pdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJlcyArPSAoaW50KShtYXh4IC0gbWlueCsxKSAqIGFicyhrMyk7DQogICAgICAgICAgICAgICAgICAgIH1lbHNlIGlmKGFicyhrMykgPT0gMSkNCiAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgbG9uZyBsb25nIG1pbnggPSBtaW4oYVtpXSxhW3pdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGxvbmcgbG9uZyBtYXh4ID0gbWF4KGFbaV0sYVt6XSk7DQogICAgICAgICAgICAgICAgICAgICAgICByZXMgKz0gKGludCkobWF4eCAtIG1pbngrMSkgKiBhYnMoazMpOw0KICAgICAgICAgICAgICAgICAgICB9ZWxzZXsNCiAgICAgICAgICAgICAgICAgICAgICAgIGxvbmcgbG9uZyBtaW54ID0gbWluKGFbaV0sYVt6XSk7DQogICAgICAgICAgICAgICAgICAgICAgICBsb25nIGxvbmcgbWF4eCA9IG1heChhW2ldLGFbel0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmVzICs9IChpbnQpKG1heHggLSBtaW54KzEpIC8gYWJzKGszKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICByZXMgKz0gMzsNCiAgICAgICAgICAgICAgICAgICAgc3VtID0gbWF4KHN1bSxyZXMpOw0KICAgICAgICAgICAgICAgICAgICByZXMgPSAwOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICBjb3V0IDw8IHN1bSA8PCBlbmRsOw0KfQ0K"}]