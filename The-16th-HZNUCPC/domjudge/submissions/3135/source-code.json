[{"id":"3135","submission_id":"3135","filename":"D2.cpp","source":"I2luY2x1ZGU8Yml0cy9zdGRjKysuaD4NCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQojZGVmaW5lIE0gMzAwMDA1DQppbnQgbixtLGNudCxjbnQyLHgsYW5zW01dLHdoZXJlW01dLHdoZXJlMltNXTsNCnN0cnVjdCBoemx7DQogICAgaW50IHQsbCxyOw0KfUFbMTAwMDA1XSxhc2tbMTAwMDA1XTsNCmJvb2wgY21wKGh6bCBhLGh6bCBiKXsNCiAgICByZXR1cm4gYS50PGIudDsNCn0NCnN0cnVjdCBUcmVlDQp7DQogICAgaW50IG1pbmE7DQogICAgaW50IGxhenk7DQp9U2VnVHJlZVsxMjAwMDA1XTsNCnZvaWQgcHVzaGRvd24oaW50IHJ0KXsNCiAgICBTZWdUcmVlW3J0KjJdLmxhenk9bWluKFNlZ1RyZWVbcnRdLmxhenksU2VnVHJlZVtydCoyXS5sYXp5KTsNCiAgICBTZWdUcmVlW3J0KjJdLm1pbmE9bWluKFNlZ1RyZWVbcnQqMl0ubWluYSxTZWdUcmVlW3J0XS5sYXp5KTsNCiAgICBTZWdUcmVlW3J0KjIrMV0ubGF6eT1taW4oU2VnVHJlZVtydF0ubGF6eSxTZWdUcmVlW3J0KjIrMV0ubGF6eSk7DQogICAgU2VnVHJlZVtydCoyKzFdLm1pbmE9bWluKFNlZ1RyZWVbcnQqMisxXS5taW5hLFNlZ1RyZWVbcnRdLmxhenkpOw0KICAgIFNlZ1RyZWVbcnRdLmxhenk9MWU2Ow0KICAgIHJldHVybiA7DQp9DQp2b2lkIHB1c2h1cChpbnQgcnQpDQp7DQogICAgU2VnVHJlZVtydF0ubWluYT1taW4oU2VnVHJlZVtydCoyXS5taW5hLFNlZ1RyZWVbcnQqMisxXS5taW5hKTsNCiAgICBTZWdUcmVlW3J0XS5taW5hPW1pbihTZWdUcmVlW3J0XS5taW5hLFNlZ1RyZWVbcnRdLmxhenkpOw0KICAgIHJldHVybjsNCn0NCnZvaWQgYnVpbGQoaW50IGwsaW50IHIsaW50IHJ0KQ0Kew0KICAgIFNlZ1RyZWVbcnRdLmxhenk9MWU2Ow0KICAgIGlmKGw9PXIpDQogICAgew0KICAgICAgICBTZWdUcmVlW3J0XS5taW5hPVNlZ1RyZWVbcnRdLmxhenk9MWU2Ow0KICAgICAgICByZXR1cm47DQogICAgfQ0KICAgIGludCBtaWQ9KGwrcikvMjsNCiAgICBidWlsZChsLG1pZCxydCoyKTsNCiAgICBidWlsZChtaWQrMSxyLHJ0KjIrMSk7DQogICAgcHVzaHVwKHJ0KTsNCn0NCnZvaWQgVXBkYXRlKGludCBsLGludCByLGludCBMLGludCBSLGludCBDLGludCBydCkNCnsNCiAgICBpZihsIT1yKSBwdXNoZG93bihydCk7DQogICAgaWYoTD5yKSByZXR1cm47DQogICAgaWYoUjxsKSByZXR1cm47DQogICAgaWYoTDw9bCYmUj49cikNCiAgICB7DQogICAgICAgIFNlZ1RyZWVbcnRdLmxhenk9bWluKFNlZ1RyZWVbcnRdLmxhenksQyk7DQogICAgICAgIFNlZ1RyZWVbcnRdLm1pbmE9bWluKFNlZ1RyZWVbcnRdLm1pbmEsU2VnVHJlZVtydF0ubGF6eSk7DQogICAgICAgIHJldHVybjsNCiAgICB9DQogICAgaW50IG1pZD0obCtyKS8yOw0KICAgIGlmKEw8PW1pZCkgVXBkYXRlKGwsbWlkLEwsUixDLHJ0KjIpOw0KICAgIGlmKG1pZDxSKSBVcGRhdGUobWlkKzEscixMLFIsQyxydCoyKzEpOw0KICAgIHB1c2h1cChydCk7DQp9DQppbnQgcXVlcnkoaW50IGwsaW50IHIsaW50IEwsaW50IHJ0KQ0Kew0KICAgIGlmKGwhPXIpcHVzaGRvd24ocnQpOw0KICAgIGlmKGw9PXIpDQogICAgew0KICAgICAgICByZXR1cm4gbWluKFNlZ1RyZWVbcnRdLm1pbmEsU2VnVHJlZVtydF0ubGF6eSk7DQogICAgfQ0KICAgIGludCBtaWQ9KGwrcikvMjsNCiAgICBpZihtaWQ+PUwpIHJldHVybiBxdWVyeShsLG1pZCxMLHJ0KjIpOw0KICAgIGVsc2UgcmV0dXJuIHF1ZXJ5KG1pZCsxLHIsTCxydCoyKzEpOw0KfQ0Kdm9pZCBQcmludCgpew0KICAgIGZvcihpbnQgaT0xO2k8PWNudDI7aSsrKXByaW50ZigiJWQgIixxdWVyeSgxLGNudDIsaSwxKSk7DQogICAgcHV0cygiIik7DQp9DQppbnQgbWFpbigpew0KICAgIHNjYW5mKCIlZCVkJWQiLCZuLCZtLCZ4KTsNCiAgICB3aGVyZVsrK2NudF09eDsNCiAgICBmb3IoaW50IGk9MTtpPD1uO2krKyl7DQogICAgICAgIHNjYW5mKCIlZCVkJWQiLCZBW2ldLnQsJkFbaV0ubCwmQVtpXS5yKTsNCiAgICAgICAgd2hlcmVbKytjbnRdPUFbaV0ubDsNCiAgICAgICAgd2hlcmVbKytjbnRdPUFbaV0ucjsNCiAgICB9DQogICAgDQogICAgZm9yKGludCBpPTE7aTw9bTtpKyspew0KICAgICAgICBzY2FuZigiJWQlZCIsJmFza1tpXS50LCZhc2tbaV0ubCk7DQogICAgICAgIHdoZXJlWysrY250XT1hc2tbaV0ubDsNCiAgICAgICAgYXNrW2ldLnI9aTsNCiAgICB9DQogICAgc29ydCh3aGVyZSsxLHdoZXJlK2NudCsxKTsNCiAgICBmb3IoaW50IGk9MTtpPD1jbnQ7aSsrKQ0KICAgICAgICBpZih3aGVyZVtpXSE9d2hlcmVbaS0xXSl3aGVyZTJbKytjbnQyXT13aGVyZVtpXTsNCiAgICB4PWxvd2VyX2JvdW5kKHdoZXJlMisxLHdoZXJlMitjbnQyKzEseCktd2hlcmUyOw0KICAgIGZvcihpbnQgaT0xO2k8PW07aSsrKWFza1tpXS5sPWxvd2VyX2JvdW5kKHdoZXJlMisxLHdoZXJlMitjbnQyKzEsYXNrW2ldLmwpLXdoZXJlMjsNCiAgICBidWlsZCgxLGNudDIsMSk7DQogICAgVXBkYXRlKDEsY250Mix4LHgsMCwxKTsNCiAgICAvL3B1dHMoIiEhISIpOw0KICAgIC8vUHJpbnQoKTsNCiAgICBzb3J0KGFzaysxLGFzayttKzEsY21wKTsNCiAgICBpbnQgbm93PW47DQogICAgZm9yKGludCBpPW07aT49MTtpLS0peyANCiAgICAgICAgd2hpbGUoQVtub3ddLnQ+PWFza1tpXS50JiZub3c+PTEpew0KICAgICAgICAgICAgaW50IHM9cXVlcnkoMSxjbnQyLEFbbm93XS5yLDEpOw0KICAgICAgICAgICAgVXBkYXRlKDEsY250MixBW25vd10ubCxBW25vd10ucixzKzEsMSk7DQogICAgICAgICAgICBwcmludGYoIiVkICVkICVkXG4iLEFbbm93XS5sLEFbbm93XS5yLHMpOw0KICAgICAgICAgICAgLy9QcmludCgpOw0KICAgICAgICAgICAgbm93LS07DQogICAgICAgIH0NCiAgICAgICAgYW5zW2Fza1tpXS5yXT1xdWVyeSgxLGNudDIsYXNrW2ldLmwsMSk7DQogICAgICAgIGlmKGFuc1thc2tbaV0ucl09PTFlNilhbnNbYXNrW2ldLnJdPS0xOw0KICAgIH0NCiAgICBmb3IoaW50IGk9MTtpPD1tO2krKylwcmludGYoIiVkXG4iLGFuc1tpXSk7DQogICAgcmV0dXJuIDA7DQp9"}]