[{"id":"2021","submission_id":"2021","filename":"d.cpp","source":"I2luY2x1ZGU8Yml0cy9zdGRjKysuaD4NCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQpzdHJ1Y3QgQlVTew0KCWludCB0LGwscjsNCn1hWzEwMDA1MF07DQpzdHJ1Y3QgVEFOR3sNCglpbnQgdCxwLGlkOw0KfWNbMTAwMDUwXTsNCnN0cnVjdCBUew0KCWludCBtaSxhZCxsLHI7DQp9dFsyMDAwMDUwXTsNCmludCBuLG0seCxiWzEwMDAwNTBdLGFuc1sxMDAwNTBdOw0KYm9vbCBjbXAxKEJVUyBhLEJVUyBiKQ0Kew0KCXJldHVybiBhLnQ+Yi50Ow0KfQ0KYm9vbCBjbXAyKFRBTkcgYSxUQU5HIGIpDQp7DQoJcmV0dXJuIGEudD5iLnQ7DQp9DQp2b2lkIGJ1aWxkKGludCBsLGludCByLGludCBwKQ0Kew0KCXRbcF0ubD1sOw0KCXRbcF0ucj1yOw0KCXRbcF0ubWk9MTAwMDAwMDsNCglpZihsPHIpDQoJew0KCQlpbnQgbWlkPShsK3IpLzI7DQoJCWJ1aWxkKGwsbWlkLDIqcCk7DQoJCWJ1aWxkKG1pZCsxLHIsMipwKzEpOw0KCX0NCn0NCnZvaWQgZG93bihpbnQgcCkNCnsNCglpZih0W3BdLmFkPT0wKXJldHVybjsNCgl0WzIqcF0uYWQ9dFtwXS5hZDsNCgl0WzIqcF0ubWk9dFtwXS5hZDsNCgl0WzIqcCsxXS5hZD10W3BdLmFkOw0KCXRbMipwKzFdLm1pPXRbcF0uYWQ7DQoJdFtwXS5hZD0wOw0KfQ0KaW50IHF1ZXJ5KGludCB4LGludCBwKQ0Kew0KCWRvd24ocCk7DQoJaWYodFtwXS5sPT10W3BdLnIpDQoJew0KCQlyZXR1cm4gdFtwXS5taTsNCgl9DQoJaW50IG1pZD0odFtwXS5sK3RbcF0ucikvMjsNCglpZih4PD1taWQpcmV0dXJuIHF1ZXJ5KHgsMipwKTsNCglyZXR1cm4gcXVlcnkoeCwyKnArMSk7DQp9DQppbnQgZ2V0UG9zKGludCB4LGludCBwKQ0Kew0KCWRvd24ocCk7DQoJaWYodFtwXS5sPT10W3BdLnIpcmV0dXJuIHRbcF0ubDsNCglpZih0WzIqcF0ubWk8PXgpcmV0dXJuIGdldFBvcyh4LDIqcCk7DQoJcmV0dXJuIGdldFBvcyh4LDIqcCsxKTsNCn0NCnZvaWQgdXBkYXRlKGludCBsLGludCByLGludCB4LGludCBwKQ0Kew0KCWlmKGw+cilyZXR1cm47DQoJZG93bihwKTsNCglpZihsPT10W3BdLmwmJnI9PXRbcF0ucikNCgl7DQoJCXRbcF0ubWk9dFtwXS5hZD14Ow0KCQlyZXR1cm47DQoJfQ0KCWludCBtaWQ9KHRbcF0ubCt0W3BdLnIpLzI7DQoJaWYocjw9bWlkKXVwZGF0ZShsLHIseCwyKnApOw0KCWVsc2UgaWYobD5taWQpdXBkYXRlKGwscix4LDIqcCsxKTsNCgllbHNlIHVwZGF0ZShsLG1pZCx4LDIqcCksdXBkYXRlKG1pZCsxLHIseCwyKnArMSk7DQoJdFtwXS5taT1taW4odFsyKnBdLm1pLHRbMipwKzFdLm1pKTsNCn0NCmludCBtYWluKCl7DQoJY2luPj5uPj5tPj54Ow0KCWJbKytiWzBdXT14Ow0KCWZvcihpbnQgaT0xO2k8PW47aSsrKQ0KCXsNCgkJc2NhbmYoIiVkJWQlZCIsJmFbaV0udCwmYVtpXS5sLCZhW2ldLnIpOw0KCQliWysrYlswXV09YVtpXS5sOw0KCQliWysrYlswXV09YVtpXS5yOw0KCX0NCglmb3IoaW50IGk9MTtpPD1tO2krKykNCgl7DQoJCXNjYW5mKCIlZCVkIiwmY1tpXS50LCZjW2ldLnApOw0KCQliWysrYlswXV09Y1tpXS5wOw0KCQljW2ldLmlkPWk7DQoJfQ0KCXNvcnQoYisxLGIrYlswXSsxKTsNCgliWzBdPXVuaXF1ZShiKzEsYitiWzBdKzEpLWItMTsNCgl4PWxvd2VyX2JvdW5kKGIrMSxiK2JbMF0rMSx4KS1iOw0KCWZvcihpbnQgaT0xO2k8PW47aSsrKQ0KCXsNCgkJYVtpXS5sPWxvd2VyX2JvdW5kKGIrMSxiK2JbMF0rMSxhW2ldLmwpLWI7DQoJCWFbaV0ucj1sb3dlcl9ib3VuZChiKzEsYitiWzBdKzEsYVtpXS5yKS1iOw0KCX0NCglmb3IoaW50IGk9MTtpPD1tO2krKykNCgl7DQoJCWNbaV0ucD1sb3dlcl9ib3VuZChiKzEsYitiWzBdKzEsY1tpXS5wKS1iOw0KCX0NCglidWlsZCgxLGJbMF0sMSk7DQovLwlmb3IoaW50IGk9MTtpPD1iWzBdO2krKylwcmludGYoIiVkICIscXVlcnkoaSwxKSk7DQovLwlwdXRzKCIiKTsNCgl1cGRhdGUoYlswXSxiWzBdLDAsMSk7DQovLwlmb3IoaW50IGk9MTtpPD1iWzBdO2krKylwcmludGYoIiVkICIscXVlcnkoaSwxKSk7DQovLwlwdXRzKCIiKTsNCglpbnQgYnA9MTsNCglpbnQgdHA9MTsNCglzb3J0KGErMSxhK24rMSxjbXAxKTsNCglzb3J0KGMrMSxjK20rMSxjbXAyKTsNCglmb3IoaW50IGk9MTAwMDAwO2k7aS0tKQ0KCXsNCgkJd2hpbGUoYnA8PW4mJmFbYnBdLnQ+PWkpDQoJCXsNCgkJCWludCBtaT1xdWVyeShhW2JwXS5yLDEpOw0KCQkJaWYobWk+bikNCgkJCXsNCgkJCQlicCsrOw0KCQkJCWNvbnRpbnVlOw0KCQkJfQ0KCQkJaW50IHBvcz1nZXRQb3MobWksMSk7DQoJCQl1cGRhdGUoYVticF0ubCxwb3MtMSxtaSsxLDEpOw0KLy8JCQlwcmludGYoIlVQRDogJWQgJWQgJWRcbiIsYVticF0ubCxwb3MtMSxtaSsxKTsNCgkJCWJwKys7DQoJCX0NCgkJd2hpbGUodHA8PW0mJmNbdHBdLnQ+PWkpDQoJCXsNCgkJCWFuc1tjW3RwXS5pZF09cXVlcnkoY1t0cF0ucCwxKTsNCgkJCXRwKys7DQovLwkJCWZvcihpbnQgaT0xO2k8PWJbMF07aSsrKXByaW50ZigiJWQgIixxdWVyeShpLDEpKTsNCi8vCQkJcHV0cygiIik7DQoJCX0NCgl9DQoJZm9yKGludCBpPTE7aTw9bTtpKyspaWYoYW5zW2ldPm4pYW5zW2ldPS0xOw0KCWZvcihpbnQgaT0xO2k8PW07aSsrKXByaW50ZigiJWRcbiIsYW5zW2ldKTsNCglyZXR1cm4gMDsNCn0NCg=="}]