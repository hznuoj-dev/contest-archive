[{"id":"3818","submission_id":"3818","filename":"G.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+DQoNCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQojZGVmaW5lIGxuICdcbicNCg0KY29uc3QgaW50IE49MmU1KzU7DQoNCmludCBmW05dLHNpeltOXSxjb2xbTl0sd1tOXSxpZFtOXTsNCg0KaW50IGZpbmQoaW50IHgpIHsNCglpZihmW3hdID09IHgpIHJldHVybiB4Ow0KCWludCBwYXIgPSBmaW5kKGZbeF0pOw0KCWNvbFt4XSA9IGNvbFtmW3hdXSBeIHdbeF07DQoJcmV0dXJuIHBhcjsNCn0NCg0KYm9vbCBhbnMgPSB0cnVlOw0KDQp2b2lkIG1lcmdlKGludCB4LCBpbnQgeSwgaW50IFcpIHsNCglpbnQgZnggPSBmaW5kKHgpLCBmeSA9IGZpbmQoeSk7DQoJaWYoZnggPT0gZnkpIHsNCgkJaWYoY29sW3hdIF4gY29sW3ldICE9IFcpIGFucyA9IGZhbHNlOw0KCQlyZXR1cm47DQoJfQ0KCWlmKHNpeltmeF0gPCBzaXpbZnldKSANCgkJc3dhcCh4LCB5KSwgc3dhcChmeCwgZnkpOw0KCQ0KCXNpeltmeF0gKz0gc2l6W2Z5XTsNCglmW2Z5XSA9IGZ4Ow0KCXdbZnldID0gY29sW3hdIF4gY29sW3ldIF4gVzsNCgkNCn0NCg0KdmVjdG9yPGludD4gYW5zX2dvb2Q7DQp2ZWN0b3I8aW50PiBnb29kW05dLCBiYWRbTl07DQoNCmlubGluZSB2b2lkIHNvbHZlKCkgew0KCWludCBuLHEsbTsNCglzY2FuZigiJWQlZCVkIiwgJm4sICZxLCAmbSk7DQoJZm9yKGludCBpID0gMTsgaSA8PSBuOyBpKyspIA0KCQlmW2ldID0gaSwgY29sW2ldID0gMCwgc2l6W2ldID0gMSwgd1tpXSA9IDA7DQoJZm9yKGludCBpID0gMTsgaSA8PSBtOyBpKyspIHsNCgkJaW50IHgsIHksIHc7DQoJCXNjYW5mKCIlZCVkJWQiLCAmdywgJngsICZ5KTsNCgkJbWVyZ2UoeCwgeSwgdyk7DQoJfQ0KCQ0KCWlmIChhbnMgPT0gZmFsc2Upew0KCQlwdXRzKCJOTyIpOw0KCQlyZXR1cm47DQoJfQ0KDQoJaW50IHRvdCA9IDA7DQoJZm9yKGludCBpID0gMTsgaSA8PSBuOyBpKyspIA0KCQlpZihmaW5kKGkpID09IGkpIGlkW2ldID0gKyt0b3Q7CQ0KCWZvcihpbnQgaSA9IDE7IGkgPD0gbjsgaSsrKSANCgkJaWRbaV0gPSBpZFtmaW5kKGkpXTsNCgkJDQoNCglmb3IoaW50IGkgPSAxOyBpIDw9IG47IGkrKykgew0KCQlpZihjb2xbaV0gPT0gMCkNCgkJCWdvb2RbaWRbaV1dLnB1c2hfYmFjayhpKTsNCgkJZWxzZQ0KCQkJYmFkW2lkW2ldXS5wdXNoX2JhY2soaSk7DQoJfQ0KCQ0KCXZlY3RvcjxiaXRzZXQ8MTAwMDA1Pj4gcCh0b3QgKyAxKTsNCglwWzBdWzBdID0gMTsNCglmb3IoaW50IGkgPSAxOyBpIDw9IHRvdDsgaSsrKQ0KCQlwW2ldID0gKCAocFtpIC0gMV0gPDwgZ29vZFtpXS5zaXplKCkpIHwgKHBbaSAtIDFdIDw8IGJhZFtpXS5zaXplKCkpICk7DQoNCglpZihxID4gMTAwMDAwIHx8IHBbdG90XVtxXSA9PSAwKXsNCgkJcHV0cygiTk8iKTsNCgkJcmV0dXJuOw0KCX0NCgkNCgkNCglmb3IoaW50IGkgPSB0b3Q7IGk7IGktLSkNCgkJaWYocSA+PSBnb29kW2ldLnNpemUoKSAmJiBwW2kgLSAxXVtxIC0gZ29vZFtpXS5zaXplKCldKSAgew0KCQkJcSAtPSBnb29kW2ldLnNpemUoKTsgDQoJCQlmb3IoYXV0byB4OiBnb29kW2ldKSBhbnNfZ29vZC5wdXNoX2JhY2soeCk7DQoJCX0gZWxzZSBpZiAocSA+PSBiYWRbaV0uc2l6ZSgpICYmIHBbaSAtIDFdW3EgLSBiYWRbaV0uc2l6ZSgpXSl7DQoJCQlxIC09IGJhZFtpXS5zaXplKCk7DQoJCQlmb3IoYXV0byB4OiBiYWRbaV0pIGFuc19nb29kLnB1c2hfYmFjayh4KTsNCgkJfSBlbHNlIHsNCgkJCXdoaWxlICgxKTsNCgkJCXB1dHMoIk5PIik7DQoJCQlyZXR1cm47DQoJCX0NCglwdXRzKCJZRVMiKTsNCglzb3J0KGFuc19nb29kLmJlZ2luKCksIGFuc19nb29kLmVuZCgpKTsNCglmb3IoYXV0byB4OiBhbnNfZ29vZCkgDQoJCXByaW50ZigiJWQgIiwgeCk7DQp9DQoNCmludCBtYWluKCkgew0KCXNvbHZlKCk7DQoJcmV0dXJuIDA7DQp9"}]