[{"id":"3248","submission_id":"3248","filename":"D.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+DQp1c2luZyBuYW1lc3BhY2Ugc3RkOw0KDQpjb25zdCBpbnQga01heE4gPSA0ZTUgKyA1LCBrSW5mID0gMHgzZjNmM2YzZjsNCmludCBuLCBtLCB4LCBhbnNba01heE5dLCBpbmZ0ID0gMHgzZjNmM2YzZjsNCnN0cnVjdCBOb2RlIHsNCglpbnQgcWlkLCB0LCBsLCByLCBkcDsNCn0gYVtrTWF4Tl07DQp2ZWN0b3I8aW50PiBiLCBjOw0KaW50IGNhW2tNYXhOXSwgY2Jba01heE5dOw0KDQppbmxpbmUgaW50IGxvd2JpdChpbnQgeCkgew0KCXJldHVybiB4ICYgLXg7DQp9DQoNCnZvaWQgY2RxKGludCBsLCBpbnQgcikgew0KCWlmIChsID09IHIpIHJldHVybjsNCgkNCglpbnQgbWlkID0gKGwgKyByKSA+PiAxOw0KCWNkcShtaWQgKyAxLCByKTsNCgkNCgljYVswXSA9IGNiWzBdID0gMDsNCglmb3IgKGludCBpID0gbWlkICsgMTsgaSA8PSByOyArK2kpIHsNCgkJaWYgKGFbaV0ucWlkID4gMCkgY29udGludWU7DQoJCWNiWysrY2JbMF1dID0gaTsNCgl9DQoJZm9yIChpbnQgaSA9IGw7IGkgPD0gbWlkOyArK2kpIHsNCgkJY2FbKytjYVswXV0gPSBpOw0KCX0NCglzb3J0KGNhICsgMSwgY2EgKyBjYVswXSArIDEsIFsmXShpbnQgeCwgaW50IHkpIHsNCgkJcmV0dXJuIGFbeF0udCA+IGFbeV0udCB8fCAoYVt4XS50ID09IGFbeV0udCAmJiBhW3hdLnIgPCBhW3ldLnIpOw0KCX0pOw0KCXNvcnQoY2IgKyAxLCBjYiArIGNiWzBdICsgMSwgWyZdKGludCB4LCBpbnQgeSkgew0KCQlyZXR1cm4gYVt4XS50ID4gYVt5XS50IHx8IChhW3hdLnQgPT0gYVt5XS50ICYmIGFbeF0ubCA8IGFbeV0ubCk7DQoJfSk7DQoJdmVjdG9yPGludD4gdG1wOw0KCWZvciAoaW50IGkgPSAxOyBpIDw9IGNiWzBdOyArK2kpIHsNCgkJdG1wLnB1c2hfYmFjayhhW2NiW2ldXS5sKTsNCgl9DQoJZm9yIChpbnQgaSA9IDE7IGkgPD0gY2FbMF07ICsraSkgew0KCQl0bXAucHVzaF9iYWNrKGFbY2FbaV1dLnIpOw0KCX0NCglzb3J0KHRtcC5iZWdpbigpLCB0bXAuZW5kKCkpOw0KCXRtcC5yZXNpemUodW5pcXVlKHRtcC5iZWdpbigpLCB0bXAuZW5kKCkpIC0gdG1wLmJlZ2luKCkpOw0KCQ0KCWF1dG8gaWR4ID0gWyZdKGludCB2YWwpIHsNCgkJcmV0dXJuIGxvd2VyX2JvdW5kKHRtcC5iZWdpbigpLCB0bXAuZW5kKCksIHZhbCkgLSB0bXAuYmVnaW4oKSArIDE7DQoJfTsNCgkNCglpbnQgbGltID0gKGludCl0bXAuc2l6ZSgpICsgMTsNCgl2ZWN0b3I8aW50PiBiaXQobGltICsgMSwga0luZik7DQoJYXV0byBxdWVyeSA9IFsmXShpbnQgeCkgew0KCQl4ID0gaWR4KHgpOw0KCQlpbnQgYW5zID0ga0luZjsNCgkJd2hpbGUgKHggPiAwKSB7DQoJCQlhbnMgPSBtaW4oYW5zLCBiaXRbeF0pOw0KCQkJeCAtPSBsb3diaXQoeCk7DQoJCX0NCgkJcmV0dXJuIGFuczsNCgl9Ow0KCQ0KCWF1dG8gYWRkID0gWyZdKGludCB4LCBpbnQgdmFsKSB7DQoJCXggPSBpZHgoeCk7DQoJCXdoaWxlICh4IDw9IGxpbSkgew0KCQkJYml0W3hdID0gbWluKGJpdFt4XSwgdmFsKTsNCgkJCXggKz0gbG93Yml0KHgpOw0KCQl9DQoJfTsNCgkNCgkvLyBkZWNyZWFzaW5nbHkgZW51bWVyYXRlIHQNCglmb3IgKGludCBpID0gMSwgaiA9IDA7IGkgPD0gY2FbMF07ICsraSkgew0KCQl3aGlsZSAoaiArIDEgPD0gY2JbMF0gJiYgKGFbY2FbaV1dLnQgPCBhW2NiW2ogKyAxXV0udCB8fCAoYVtjYVtpXV0udCA9PSBhW2NiW2ogKyAxXV0udCAmJiBhW2NhW2ldXS5yID49IGFbY2JbaiArIDFdXS5sKSkpIHsNCgkJCWFkZChhW2NiW2ogKyAxXV0ubCwgYVtjYltqICsgMV1dLmRwKTsNCgkJCSsrajsNCgkJfQ0KCQkNCgkJYVtjYVtpXV0uZHAgPSBtaW4oYVtjYVtpXV0uZHAsIHF1ZXJ5KGFbY2FbaV1dLnIpICsgMSk7DQoJfQ0KCQ0KCWNkcShsLCBtaWQpOw0KfQ0KDQppbnQgbWFpbigpIHsNCglpb3M6OnN5bmNfd2l0aF9zdGRpbyhmYWxzZSk7DQoJY2luID4+IG4gPj4gbSA+PiB4Ow0KCWZvciAoaW50IGkgPSAxOyBpIDw9IG47ICsraSkgew0KCQlhW2ldLnFpZCA9IDA7DQoJCWNpbiA+PiBhW2ldLnQgPj4gYVtpXS5sID4+IGFbaV0ucjsNCgkJYi5wdXNoX2JhY2soYVtpXS50KTsNCgkJYy5wdXNoX2JhY2soYVtpXS5sKTsNCgkJYy5wdXNoX2JhY2soYVtpXS5yKTsNCgl9DQoJDQoJZm9yIChpbnQgaSA9IDE7IGkgPD0gbTsgKytpKSB7DQoJCWludCB0YSwgdGI7DQoJCWNpbiA+PiB0YSA+PiB0YjsNCgkJYVtpICsgbl0ucWlkID0gaTsNCgkJYVtpICsgbl0udCA9IHRhOw0KCQlhW2kgKyBuXS5sID0gYVtpICsgbl0uciA9IHRiOw0KCQliLnB1c2hfYmFjayh0YSk7DQoJCWMucHVzaF9iYWNrKHRiKTsNCgl9DQoJDQoJYi5wdXNoX2JhY2soaW5mdCk7DQoJYy5wdXNoX2JhY2soeCk7DQoJc29ydChiLmJlZ2luKCksIGIuZW5kKCkpOw0KCWIucmVzaXplKHVuaXF1ZShiLmJlZ2luKCksIGIuZW5kKCkpIC0gYi5iZWdpbigpKTsNCglzb3J0KGMuYmVnaW4oKSwgYy5lbmQoKSk7DQoJYy5yZXNpemUodW5pcXVlKGMuYmVnaW4oKSwgYy5lbmQoKSkgLSBjLmJlZ2luKCkpOw0KCQ0KCWluZnQgPSBsb3dlcl9ib3VuZChiLmJlZ2luKCksIGIuZW5kKCksIGluZnQpIC0gYi5iZWdpbigpICsgMTsNCgl4ID0gbG93ZXJfYm91bmQoYy5iZWdpbigpLCBjLmVuZCgpLCB4KSAtIGMuYmVnaW4oKSArIDE7DQoJZm9yIChpbnQgaSA9IDE7IGkgPD0gbiArIG07ICsraSkgew0KCQlhW2ldLnQgPSBsb3dlcl9ib3VuZChiLmJlZ2luKCksIGIuZW5kKCksIGFbaV0udCkgLSBiLmJlZ2luKCkgKyAxOw0KCQlhW2ldLmwgPSBsb3dlcl9ib3VuZChjLmJlZ2luKCksIGMuZW5kKCksIGFbaV0ubCkgLSBjLmJlZ2luKCkgKyAxOw0KCQlhW2ldLnIgPSBsb3dlcl9ib3VuZChjLmJlZ2luKCksIGMuZW5kKCksIGFbaV0ucikgLSBjLmJlZ2luKCkgKyAxOw0KCQlhW2ldLmRwID0ga0luZjsNCgl9DQoJYVtuICsgbSArIDFdLnQgPSBpbmZ0Ow0KCWFbbiArIG0gKyAxXS5sID0geDsNCglhW24gKyBtICsgMV0uciA9IHg7DQoJYVtuICsgbSArIDFdLnFpZCA9IC0xOw0KCWFbbiArIG0gKyAxXS5kcCA9IDA7DQoJDQoJc29ydChhICsgMSwgYSArIChuICsgbSArIDEpICsgMSwgWyZdKGNvbnN0IE5vZGUgJmxocywgY29uc3QgTm9kZSAmcmhzKSB7DQoJCXJldHVybiBsaHMuciA8IHJocy5yOwkNCgl9KTsNCglpbnQgQiA9IChpbnQpYi5zaXplKCksIEMgPSAoaW50KWMuc2l6ZSgpOw0KCWNkcSgxLCBuICsgbSArIDEpOw0KCQ0KCWZvciAoaW50IGkgPSAxOyBpIDw9IG4gKyBtICsgMTsgKytpKSB7DQoJCWlmIChhW2ldLnFpZCA+IDApIGFuc1thW2ldLnFpZF0gPSBhW2ldLmRwOw0KCX0NCgkNCglmb3IgKGludCBpID0gMTsgaSA8PSBtOyArK2kpIHsNCgkJaWYgKGFuc1tpXSA8IGtJbmYpIHsNCgkJCWNvdXQgPDwgYW5zW2ldIC0gMSA8PCAiXG4iOw0KCQl9IGVsc2Ugew0KCQkJY291dCA8PCAtMSA8PCAiXG4iOw0KCQl9DQoJfQ0KCQ0KCXJldHVybiAwOw0KfQ=="}]