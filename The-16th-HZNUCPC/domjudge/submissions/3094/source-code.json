[{"id":"3094","submission_id":"3094","filename":"G.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+DQoNCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQojZGVmaW5lIGxuICdcbicNCg0KY29uc3QgaW50IE4gPSAxZTUgKyA1Ow0KDQppbnQgZltOXSwgc2l6W05dLCBjb2xbTl0sIHdbTl0sIGlkW05dOw0KDQovL2JpdHNldDw1MDAwMD4NCmludCBmaW5kKGludCB4KSB7DQoJaWYoZlt4XSA9PSB4KSByZXR1cm4geDsNCglpbnQgcGFyID0gZmluZChmW3hdKTsNCgljb2xbeF0gPSBjb2xbZlt4XV0gXiB3W3hdOw0KCXJldHVybiBwYXI7DQp9DQoNCmJvb2wgYW5zID0gdHJ1ZTsNCg0Kdm9pZCBtZXJnZShpbnQgeCwgaW50IHksIGludCBXKSB7DQovLwljb3V0IDw8IHggPDwgIiAiIDw8IHkgPDwgbG47DQoJaW50IGZ4ID0gZmluZCh4KSwgZnkgPSBmaW5kKHkpOw0KLy8JY291dCA8PCB4IDw8ICIgIiA8PCB5IDw8ICIgIiA8PCBjb2xbeF0gPDwgIiAiIDw8IGNvbFt5XSA8PCAiICIgPDwgVyA8PCBsbjsNCglpZihmeCA9PSBmeSkgew0KCQlpZihjb2xbeF0gXiBjb2xbeV0gIT0gVykgYW5zID0gZmFsc2U7DQoJCXJldHVybjsNCgl9DQoJaWYoc2l6W2Z4XSA8IHNpeltmeV0pIA0KCQlzd2FwKHgsIHkpLCBzd2FwKGZ4LCBmeSk7DQoJDQoJc2l6W2Z4XSArPSBzaXpbZnldOw0KCWZbZnldID0gZng7DQoJd1tmeV0gPSBjb2xbeF0gXiBjb2xbeV0gXiBXOw0KCQ0KfQ0KDQppbmxpbmUgdm9pZCBzb2x2ZSgpIHsNCglpbnQgbiwgcSwgbTsNCgljaW4gPj4gbiA+PiBxID4+IG07DQoJZm9yKGludCBpID0gMTsgaSA8PSBuOyBpKyspIA0KCQlmW2ldID0gaSwgY29sW2ldID0gMCwgc2l6W2ldID0gMSwgd1tpXSA9IDA7DQoJZm9yKGludCBpID0gMTsgaSA8PSBtOyBpKyspIHsNCgkJaW50IHgsIHksIHc7DQoJCWNpbiA+PiB3ID4+IHggPj4geTsNCgkJbWVyZ2UoeCwgeSwgdyk7DQoJCWZpbmQoeCk7IGZpbmQoeSk7DQoJfQ0KCWlmKGFucyA9PSBmYWxzZSkgDQoJCXJldHVybiBjb3V0IDw8ICJOT1xuIiwgdm9pZCgpOw0KCWVsc2UgDQoJCWNvdXQgPDwgIllFU1xuIjsNCgkNCglpbnQgdG90ID0gMDsNCglmb3IoaW50IGkgPSAxOyBpIDw9IG47IGkrKykgDQoJCWlmKGZpbmQoaSkgPT0gaSkgaWRbaV0gPSArK3RvdDsJDQoJZm9yKGludCBpID0gMTsgaSA8PSBuOyBpKyspIA0KCQlpZFtpXSA9IGlkW2ZpbmQoaSldOw0KCQkNCgl2ZWN0b3I8dmVjdG9yPGludD4+IGdvb2QodG90ICsgMSksIGJhZCh0b3QgKyAxKTsNCglmb3IoaW50IGkgPSAxOyBpIDw9IG47IGkrKykgew0KCQlpZihjb2xbaV0gPT0gMCkgZ29vZFtpZFtpXV0ucHVzaF9iYWNrKGkpOw0KCQllbHNlIGJhZFtpZFtpXV0ucHVzaF9iYWNrKGkpOw0KCX0NCgkNCglpbnQgbW4gPSBtaW4ocSwgbiAtIHEpOw0KCXZlY3RvcjxiaXRzZXQ8MTAwMDA1Pj4gcCh0b3QgKyAxKTsNCglwWzBdWzBdID0gMTsNCglmb3IoaW50IGkgPSAxOyBpIDw9IHRvdDsgaSsrKSANCgkJcFtpXSA9IChwW2kgLSAxXSA8PCBnb29kW2ldLnNpemUoKSkgfCAocFtpIC0gMV0gPDwgYmFkW2ldLnNpemUoKSk7DQovLwkJY291dCA8PCBwW2ldIDw8IGxuOw0KDQoJdmVjdG9yPGludD4gYW5zX2dvb2QsIGFuc19iYWQ7DQoJZm9yKGludCBpID0gdG90OyBpOyBpLS0pDQoJCWlmKG1uID49IGdvb2RbaV0uc2l6ZSgpICYmIHBbaSAtIDFdW21uIC0gZ29vZFtpXS5zaXplKCldKSAgew0KCQkJbW4gLT0gZ29vZFtpXS5zaXplKCk7DQoJCQlmb3IoYXV0byB4OiBnb29kW2ldKSBhbnNfZ29vZC5wdXNoX2JhY2soeCk7DQoJCQlmb3IoYXV0byB4OiBiYWRbaV0pIGFuc19iYWQucHVzaF9iYWNrKHgpOw0KCQl9IGVsc2Ugew0KCQkJbW4gLT0gYmFkW2ldLnNpemUoKTsNCgkJCWZvcihhdXRvIHg6IGJhZFtpXSkgYW5zX2dvb2QucHVzaF9iYWNrKHgpOw0KCQkJZm9yKGF1dG8geDogZ29vZFtpXSkgYW5zX2JhZC5wdXNoX2JhY2soeCk7CQ0KCQl9DQoJDQoJc29ydChhbnNfZ29vZC5iZWdpbigpLCBhbnNfZ29vZC5lbmQoKSk7DQoJc29ydChhbnNfYmFkLmJlZ2luKCksIGFuc19iYWQuZW5kKCkpOw0KCWlmKGFuc19nb29kLnNpemUoKSA9PSBxKSB7DQoJCWZvcihhdXRvIHg6IGFuc19nb29kKSBjb3V0IDw8IHggPDwgIiAiOw0KCQljb3V0IDw8IGxuOw0KCX0gZWxzZSB7DQoJCWZvcihhdXRvIHg6IGFuc19iYWQpIGNvdXQgPDwgeCA8PCAiICI7DQoJCWNvdXQgPDwgbG47DQoJfQ0KfQ0KDQppbnQgbWFpbigpIHsNCgkNCi8vCWZyZW9wZW4oIjEudHh0IiwgInIiLCBzdGRpbik7DQoJDQoJaW9zOjpzeW5jX3dpdGhfc3RkaW8oZmFsc2UpOw0KCWNpbi50aWUobnVsbHB0cik7DQoJDQoJc29sdmUoKTsNCn0NCg0KLyoNCjIgMSAyDQoxIDEgMg0KMCAyIDENCg0KMCAwIDENCjEgMCAwDQoqLw0K"}]