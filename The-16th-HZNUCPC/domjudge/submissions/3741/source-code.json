[{"id":"3741","submission_id":"3741","filename":"main.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+DQp0eXBlZGVmIGxvbmcgbG9uZyBsbDsNCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQpjb25zdCBsbCBtb2Q9MWU5Kzc7DQpjaGFyIHMxWzEwMDAxMF07DQpjaGFyIHMyWzEwMDAxMF07DQpsbCBhWzMwXTsNCmxsIGJbMzBdOw0KbGwgc1szMF1bMzBdOw0KDQpsbCBrc20obGwgeCxsbCB5LGxsIG0pDQp7DQogICAgbGwgcmVzPTE7DQogICAgd2hpbGUoeSl7DQogICAgICAgIGlmKHkmMSlyZXMqPXgscmVzJT1tOw0KICAgICAgICB4PSh4KngpJW07DQogICAgICAgIHk+Pj0xOw0KICAgIH0NCiAgICByZXR1cm4gcmVzOw0KfQ0KaW50IG1haW4oKQ0Kew0KICAgIGlvczo6c3luY193aXRoX3N0ZGlvKDApOw0KICAgIGNpbi50aWUoMCk7DQogICAgY291dC50aWUoMCk7DQogICAgbGwgYW5zPTA7DQogICAgY2luPj5zMT4+czI7DQogICAgbGwgej0wOw0KICAgIGxsIGxlbj1zdHJsZW4oczEpOw0KICAgIGZvcihsbCBpPTA7aTxsZW47aSsrKXsNCiAgICAgICAgYVtzMVtpXS0nYSddKys7DQogICAgICAgIGJbczJbaV0tJ2EnXSsrOw0KICAgICAgICBzW3MxW2ldLSdhJ11bczJbaV0tJ2EnXSsrOw0KICAgICAgICBpZihzMVtpXT09czJbaV0peisrOw0KICAgIH0NCiAgICBmb3IobGwgaT0wO2k8MjY7aSsrKXsNCiAgICAgICAgZm9yKGxsIGo9MDtqPDI2O2orKyl7DQogICAgICAgICAgICBmb3IobGwgaz0wO2s8MjY7aysrKXsNCiAgICAgICAgICAgICAgICBmb3IobGwgbD0wO2w8MjY7bCsrKXsNCiAgICAgICAgICAgICAgICAgICAgaWYoc1tpXVtqXT4wJiZzW2tdW2xdPjApew0KICAgICAgICAgICAgICAgICAgICAgICAgYVtpXS0tOw0KICAgICAgICAgICAgICAgICAgICAgICAgYltpXSsrOw0KICAgICAgICAgICAgICAgICAgICAgICAgYVtqXSsrOw0KICAgICAgICAgICAgICAgICAgICAgICAgYltqXS0tOw0KICAgICAgICAgICAgICAgICAgICAgICAgYVtrXS0tOw0KICAgICAgICAgICAgICAgICAgICAgICAgYltrXSsrOw0KICAgICAgICAgICAgICAgICAgICAgICAgYVtsXSsrOw0KICAgICAgICAgICAgICAgICAgICAgICAgYltsXS0tOw0KICAgICAgICAgICAgICAgICAgICAgICAgbGwgejEsejI7DQogICAgICAgICAgICAgICAgICAgICAgICB6MT16Mj0wOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yKGxsIGk9MDtpPDI2O2krKyl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoYVtpXSl6MSsrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGJbaV0pejIrKzsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHoxPT16Mil7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoaT09ayYmaj09bCl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFucz0oYW5zKyhzW2ldW2pdKihzW2ldW2pdLTEpKSVtb2QpJW1vZDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBhbnM9KGFucysoc1tpXVtqXSpzW2tdW2xdKSVtb2QpJW1vZDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIC8vcHJpbnRmKCIlYyAlYyAlYyAlYyAlbGxkXG4iLGkrJ2EnLGorJ2EnLGsrJ2EnLGwrJ2EnLGFucyk7DQogICAgICAgICAgICAgICAgICAgICAgICBhW2ldKys7DQogICAgICAgICAgICAgICAgICAgICAgICBiW2ldLS07DQogICAgICAgICAgICAgICAgICAgICAgICBhW2pdLS07DQogICAgICAgICAgICAgICAgICAgICAgICBiW2pdKys7DQogICAgICAgICAgICAgICAgICAgICAgICBhW2tdKys7DQogICAgICAgICAgICAgICAgICAgICAgICBiW2tdLS07DQogICAgICAgICAgICAgICAgICAgICAgICBhW2xdLS07DQogICAgICAgICAgICAgICAgICAgICAgICBiW2xdKys7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQogICAgY291dDw8YW5zKmtzbSgyLG1vZC0yLG1vZCklbW9kPDxlbmRsOw0KICAgIC8qbGwgenoxLHp6MjsNCiAgICB6ejE9enoyPTA7DQogICAgZm9yKGxsIGk9MDtpPDI2O2krKyl7DQogICAgICAgIGlmKGFbaV0+MCl6ejErKzsNCiAgICAgICAgaWYoYltpXT4wKXp6MisrOw0KICAgICAgICBhW2ldPTA7DQogICAgICAgIGJbaV09MDsNCiAgICB9DQogICAgaWYoenoxPHp6Milzd2FwKHMxLHMyKTsNCiAgICBmb3IobGwgaT0wO2k8bGVuO2krKyl7DQogICAgICAgIGFbczFbaV0tJ2EnXSsrOw0KICAgICAgICBiW3MyW2ldLSdhJ10rKzsNCiAgICAgICAgc1tzMVtpXS0nYSddW3MyW2ldLSdhJ10rKzsNCiAgICAgICAgaWYoczFbaV09PXMyW2ldKXorKzsNCiAgICB9Ki8NCiAgICAvKmxsIGFuczE9MDsNCiAgICBsbCBhbnMyPTA7DQogICAgZm9yKGxsIGk9MDtpPDI2O2krKyl7DQogICAgICAgIGlmKGFbaV0+MClhbnMxKys7DQogICAgICAgIGlmKGJbaV0+MClhbnMyKys7DQogICAgfQ0KICAgIGxsIHoxLHoyLHozLHo0Ow0KICAgIHoxPXoyPXozPXo0PTA7DQogICAgZm9yKGxsIGk9MDtpPDI2O2krKyl7DQogICAgICAgIGZvcihsbCBqPTA7ajwyNjtqKyspew0KICAgICAgICAgICAgaWYoaT09ailjb250aW51ZTsNCiAgICAgICAgICAgIGlmKGFbaV0+MCYmYltpXT4wJiZhW2pdPT0wJiZiW2pdPjApew0KICAgICAgICAgICAgICAgIHoxKys7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZihhW2ldPjAmJmJbaV0+MCYmYVtqXT4wJiZiW2pdPT0wKXsNCiAgICAgICAgICAgICAgICB6MSsrOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgIH0NCiAgICB9DQogICAgbGwgYW5zPTA7DQogICAgY291dDw8YW5zMTw8IiAgIjw8YW5zMjw8ZW5kbDsqLw0KICAgIC8qaWYoYW5zMT09YW5zMil7DQogICAgICAgIGZvcihsbCBpPTA7aTwyNjtpKyspew0KICAgICAgICAgICAgZm9yKGxsIGo9MDtqPDI2O2orKyl7DQogICAgICAgICAgICAgICAgaWYoaT09ail7DQogICAgICAgICAgICAgICAgICAgIGFucz0oYW5zKyhzW2ldW2pdKihzW2pdW2ldLTEpLzIpJW1vZCklbW9kOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBlbHNlew0KICAgICAgICAgICAgICAgICAgICBhbnM9KGFucysoc1tpXVtqXSpzW2pdW2ldJW1vZCkpJW1vZDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQogICAgZWxzZSBpZihhbnMxLWFuczI+NCl7DQogICAgICAgIGFucz0wOw0KICAgIH0NCiAgICBlbHNlIGlmKGFuczE9PWFuczIrNCl7DQogICAgICAgIGZvcihsbCBpPTA7aTwyNjtpKyspew0KICAgICAgICAgICAgZm9yKGxsIGo9MDtqPDI2O2orKyl7DQogICAgICAgICAgICAgICAgZm9yKGxsIGs9MDtrPDI2O2srKyl7DQogICAgICAgICAgICAgICAgICAgIGZvcihsbCBsPTA7bDwyNjtsKyspew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYoaSE9aiYmaSE9ayYmaSE9bCYmaiE9ayYmaiE9bCYmayE9bCl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoYVtpXT09MSYmYltpXT09MCYmYVtqXT4wJiZiW2pdPjEmJmFba109PTEmJmJba109PTAmJmFbbF0+MCYmYltsXT4xKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5zKys7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KICAgIGVsc2UgaWYoYW5zMT09YW5zMiszKXsNCiAgICAgICAgZm9yKGxsIGk9MDtpPDI2O2krKyl7DQogICAgICAgICAgICBmb3IobGwgaj0wO2o8MjY7aisrKXsNCiAgICAgICAgICAgICAgICBmb3IobGwgaz0wO2s8MjY7aysrKXsNCiAgICAgICAgICAgICAgICAgICAgZm9yKGxsIGw9MDtsPDI2O2wrKyl7DQogICAgICAgICAgICAgICAgICAgICAgICBpZihpIT1qJiZpIT1rJiZpIT1sJiZqIT1rJiZqIT1sJiZrIT1sKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihhW2ldPT0xJiZiW2ldPT0wJiZhW2pdPjEmJmJbal09PTAmJmFba10+MCYmYltrXT4xJiZhW2xdPjAmJmJbbF0+MSl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFucz0oYW5zKygoc1tpXVtrXStzW2ldW2xdKSooc1tqXVtrXStzW2pdW2xdKSVtb2QpKSVtb2Q7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGFbaV09PTEmJmFbal09PTEmJmJbaV09PTAmJmJbal0+MCYmYVtrXT4wJiZiW2tdPjEmJmFbbF0+MCYmYltsXT4xKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5zPShhbnMrKChzW2ldW2tdK3NbaV1bbF0pKihzW2pdW2tdK3Nbal1bbF0pJW1vZCkpJW1vZDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoYVtpXT09MSYmYVtqXT09MSYmYltpXT4wJiZiW2pdPT0wJiZhW2tdPjAmJmJba10+MSYmYVtsXT4wJiZiW2xdPjEpew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbnM9KGFucysoKHNbaV1ba10rc1tpXVtsXSkqKHNbal1ba10rc1tqXVtsXSklbW9kKSklbW9kOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCiAgICBlbHNlIGlmKGFuczE9PWFuczIrMil7DQogICAgICAgIGZvcihsbCBpPTA7aTwyNjtpKyspew0KICAgICAgICAgICAgZm9yKGxsIGo9MDtqPDI2O2orKyl7DQogICAgICAgICAgICAgICAgZm9yKGxsIGs9MDtrPDI2O2srKyl7DQogICAgICAgICAgICAgICAgICAgIGZvcihsbCBsPTA7bDwyNjtsKyspew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYoaSE9aiYmaSE9ayYmaSE9bCYmaiE9ayYmaiE9bCYmayE9bCl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoYVtpXT4xJiZiW2ldPT0wJiZhW2pdPjEmJmJbal09PTAmJmFba10+MCYmYltrXT4xJiZhW2xdPjAmJmJbbF0+MSl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFucz0oYW5zKygoc1tpXVtrXStzW2ldW2xdKSooc1tqXVtrXStzW2pdW2xdKSVtb2QpKSVtb2Q7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGFbaV09PTEmJmJbaV0+MCYmYVtqXT09MSYmYltqXT4wJiZhW2tdPjAmJmJba10+MSYmYVtsXT4wJiZiW2xdPjEpew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbnM9KGFucysoKHNbaV1ba10rc1tpXVtsXSkqKHNbal1ba10rc1tqXVtsXSklbW9kKSklbW9kOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihhW2ldPT0xJiZiW2ldPT0wJiZhW2pdPjEmJmJbal0+MCYmYVtrXT4wJiZiW2tdPjEmJmFbbF0+MCYmYltsXT4xKXsgIC8vNSAzIC0+IDQgNCCyu8i3tqgNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5zPShhbnMrKChzW2ldW2tdK3NbaV1bbF0pKihzW2pdW2tdK3Nbal1bbF0pJW1vZCkpJW1vZDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoYVtpXT09MSYmYltpXT09MCYmYVtqXT4xJiZiW2pdPjAmJmFba10+MCYmYltrXT4xJiZhW2xdPjAmJmJbbF0+MSl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFucz0oYW5zKygoc1tpXVtrXStzW2ldW2xdKSooc1tqXVtrXStzW2pdW2xdKSVtb2QpKSVtb2Q7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KICAgIGVsc2UgaWYoYW5zMT09YW5zMisxKXsNCiAgICAgICAgZm9yKGxsIGk9MDtpPDI2O2krKyl7DQogICAgICAgICAgICBmb3IobGwgaj0wO2o8MjY7aisrKXsNCiAgICAgICAgICAgICAgICBmb3IobGwgaz0wO2s8MjY7aysrKXsNCiAgICAgICAgICAgICAgICAgICAgZm9yKGxsIGw9MDtsPDI2O2wrKyl7DQogICAgICAgICAgICAgICAgICAgICAgICBpZihpIT1qJiZpIT1rJiZpIT1sJiZqIT1rJiZqIT1sJiZrIT1sKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihhW2ldPjEmJmJbaV09PTAmJmFbal0+MSYmYltqXT09MCYmYVtrXT4wJiZiW2tdPjEmJmFbbF0+MCYmYltsXT4xKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5zPShhbnMrKChzW2ldW2tdK3NbaV1bbF0pKihzW2pdW2tdK3Nbal1bbF0pJW1vZCkpJW1vZDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9Ki8NCg0KICAgIC8vY291dDw8YW5zPDxlbmRsOw0KICAgIHJldHVybiAwOw0KfQ0K"}]