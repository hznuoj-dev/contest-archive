[{"id":"2647","submission_id":"2647","filename":"I.cpp","source":"I2luY2x1ZGU8Yml0cy9zdGRjKysuaD4NCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQppbnQgbjsNCnN0cmluZyBzOw0KaW50IG1haW4oKSB7DQoJaW50IFQ7DQoJc2NhbmYoIiVkIiwgJlQpOw0KCXdoaWxlKFQtLSkgew0KCQljaW4+PnM7DQoJCW4gPSBzLnNpemUoKTsNCgkJaW50IGFucyA9IDA7DQoJCWZvciAoaW50IGkgPSAwOyBpIDwgbjsgaSsrKSB7DQovLwkJY291dDw8aTw8IiAiPDxhbnM8PGVuZGw7DQoJCQlpbnQgbDEgPSBpIC0gMSwgcjEgPSBpICsgMSwgbGVuMSA9IDE7DQoJCQl3aGlsZShsMSA+PSAwICYmIHIxIDwgbiAmJiBzW2wxXSA9PSBzW3IxXSlsMS0tLCByMSsrLCBsZW4xICs9IDI7Ly9maW5kIGZpcnN0IHdyb25nDQoJCQlpZihsMSA8IDAgfHwgcjEgPj0gbikgeyAvL25vIHdyb25nICAgICBhYmENCgkJCQlhbnMgPSBtYXgoYW5zLCBsZW4xKTsNCi8vCQkJCWNvdXQ8PGxlbjE8PGVuZGw7DQoJCQkJY29udGludWU7DQoJCQl9DQoNCgkJCWludCBsMiA9IGwxIC0gMSwgcjIgPSByMSArIDEsIGxlbjIgPSAwOw0KCQkJd2hpbGUobDIgPj0gMCAmJiByMiA8IG4gJiYgc1tsMl0gPT0gc1tyMl0pbDItLSwgcjIrKywgbGVuMiArPSAyOy8vZmluZCBzZWNvbmQgd3JvbmcNCg0KCQkJaWYobDIgPCAwIHx8IHIyID49IG4pIHsgLy9ubyBzZWNvbmQgd3JvbmcgICAgIGFkIGFiYmJjIGRhDQoJCQkJYW5zID0gbWF4KGFucywgbGVuMSk7DQoJCQkJaWYoc1tsMV0gPT0gc1tpXSB8fCBzW3IxXSA9PSBzW2ldKQ0KCQkJCQlhbnMgPSBtYXgoYW5zLCBsZW4xICsgMiArIGxlbjIpOw0KCQkJCWZvciAoaW50IGogPSByMiAtIDE7IGogPiByMTsgai0tKSB7DQoJCQkJCWludCBSID0gaiwgTCA9IGwyICsgKHIyIC0gaik7DQoJCQkJCWlmKHNbUl0gPT0gc1tsMV0gfHwgc1tMXSA9PSBzW2wxXSB8fCBzW1JdID09IHNbcjFdIHx8IHNbTF0gPT0gc1tyMV0pIHsNCgkJCQkJCWFucyA9IG1heChhbnMsIGxlbjEgKyAyICsgMiAqIChqIC0gcjEgLSAxKSk7DQoJCQkJCQlicmVhazsNCgkJCQkJfQ0KCQkJCX0NCgkJCQljb250aW51ZTsNCgkJCX0NCgkJCS8vbDIgIGwxICByMSAgcjINCgkJCWlmKChzW2wxXSA9PSBzW3IyXSAmJiBzW2wyXSA9PSBzW3IxXSkgfHwgKHNbbDFdID09IHNbbDJdICYmIHNbcjJdID09IHNbcjFdKSkgew0KCQkJCWludCBsMyA9IGwyIC0gMSwgcjMgPSByMiArIDEsIGxlbjMgPSAwOw0KCQkJCXdoaWxlKGwzID49IDAgJiYgcjMgPCBuICYmIHNbbDNdID09IHNbcjNdKWwzLS0sIHIzKyssIGxlbjMgKz0gMjsvL2ZpbmQgdGhpcmQgd3JvbmcNCgkJCQlhbnMgPSBtYXgoYW5zLCBsZW4xICsgMiArIGxlbjIgKyAyICsgbGVuMyk7DQoJCQkJY29udGludWU7DQoJCQl9DQovL3B1dHMoIiEhISIpOw0KLy9jb3V0PDxsMjw8IiAiPDxsMTw8IiAiPDxyMTw8IiAiPDxyMjw8ZW5kbDsNCgkJCWFucyA9IG1heChhbnMsIGxlbjEpOw0KCQkJaWYoc1tsMV0gPT0gc1tpXSB8fCBzW3IxXSA9PSBzW2ldKQ0KCQkJCWFucyA9IG1heChhbnMsIGxlbjEgKyAyICsgbGVuMik7DQoJCQlmb3IgKGludCBqID0gcjIgLSAxOyBqID4gcjE7IGotLSkgew0KCQkJCWludCBSID0gaiwgTCA9IGwyICsgKHIyIC0gaik7DQoJCQkJaWYoc1tSXSA9PSBzW2wxXSB8fCBzW0xdID09IHNbbDFdIHx8IHNbUl0gPT0gc1tyMV0gfHwgc1tMXSA9PSBzW3IxXSkgew0KCQkJCQlhbnMgPSBtYXgoYW5zLCBsZW4xICsgMiArIDIgKiAoaiAtIHIxIC0gMSkpOw0KCQkJCQlicmVhazsNCgkJCQl9DQoJCQl9DQoJCX0NCgkJDQoJCQ0KCQlmb3IgKGludCBpID0gMDsgaSA8IG4gLSAxOyBpKyspIHsNCgkJCWludCBsMSA9IGksIHIxID0gaSArIDEsIGxlbjEgPSAwOw0KCQkJd2hpbGUobDEgPj0gMCAmJiByMSA8IG4gJiYgc1tsMV0gPT0gc1tyMV0pbDEtLSwgcjErKywgbGVuMSArPSAyOy8vZmluZCBmaXJzdCB3cm9uZw0KCQkJaWYobDEgPCAwIHx8IHIxID49IG4pIHsgLy9ubyB3cm9uZyAgICAgYWJhDQoJCQkJYW5zID0gbWF4KGFucywgbGVuMSk7DQovLwkJCQljb3V0PDxsZW4xPDxlbmRsOw0KCQkJCWNvbnRpbnVlOw0KCQkJfQ0KDQoJCQlpbnQgbDIgPSBsMSAtIDEsIHIyID0gcjEgKyAxLCBsZW4yID0gMDsNCgkJCXdoaWxlKGwyID49IDAgJiYgcjIgPCBuICYmIHNbbDJdID09IHNbcjJdKWwyLS0sIHIyKyssIGxlbjIgKz0gMjsvL2ZpbmQgc2Vjb25kIHdyb25nDQoNCgkJCWlmKGwyIDwgMCB8fCByMiA+PSBuKSB7IC8vbm8gc2Vjb25kIHdyb25nICAgICBhZCBhYmJiYyBkYQ0KCQkJCWFucyA9IG1heChhbnMsIGxlbjEpOw0KCQkJCWZvciAoaW50IGogPSByMiAtIDE7IGogPiByMTsgai0tKSB7DQoJCQkJCWludCBSID0gaiwgTCA9IGwyICsgKHIyIC0gaik7DQoJCQkJCWlmKHNbUl0gPT0gc1tsMV0gfHwgc1tMXSA9PSBzW2wxXSB8fCBzW1JdID09IHNbcjFdIHx8IHNbTF0gPT0gc1tyMV0pIHsNCgkJCQkJCWFucyA9IG1heChhbnMsIGxlbjEgKyAyICsgMiAqIChqIC0gcjEgLSAxKSk7DQoJCQkJCQlicmVhazsNCgkJCQkJfQ0KCQkJCX0NCgkJCQljb250aW51ZTsNCgkJCX0NCg0KCQkJLy9sMiAgbDEgIHIxICByMg0KCQkJaWYoKHNbbDFdID09IHNbcjJdICYmIHNbbDJdID09IHNbcjFdKSB8fCAoc1tsMV0gPT0gc1tsMl0gJiYgc1tyMl0gPT0gc1tyMV0pKSB7DQoJCQkJaW50IGwzID0gbDIgLSAxLCByMyA9IHIyICsgMSwgbGVuMyA9IDA7DQoJCQkJd2hpbGUobDMgPj0gMCAmJiByMyA8IG4gJiYgc1tsM10gPT0gc1tyM10pbDMtLSwgcjMrKywgbGVuMyArPSAyOy8vZmluZCB0aGlyZCB3cm9uZw0KCQkJCWFucyA9IG1heChhbnMsIGxlbjEgKyAyICsgbGVuMiArIDIgKyBsZW4zKTsNCgkJCQljb250aW51ZTsNCgkJCX0NCgkJCWFucyA9IG1heChhbnMsIGxlbjEpOw0KCQkJZm9yIChpbnQgaiA9IHIyIC0gMTsgaiA+IHIxOyBqLS0pIHsNCgkJCQlpbnQgUiA9IGosIEwgPSBsMiArIChyMiAtIGopOw0KCQkJCWlmKHNbUl0gPT0gc1tsMV0gfHwgc1tMXSA9PSBzW2wxXSB8fCBzW1JdID09IHNbcjFdIHx8IHNbTF0gPT0gc1tyMV0pIHsNCgkJCQkJYW5zID0gbWF4KGFucywgbGVuMSArIDIgKyAyICogKGogLSByMSAtIDEpKTsNCgkJCQkJYnJlYWs7DQoJCQkJfQ0KCQkJfQ0KCQl9DQoJCWlmKGFucyA+IDEpDQoJCWNvdXQ8PGFuczw8ZW5kbDsNCgkJZWxzZSBjb3V0PDwiMCI8PGVuZGw7DQoJfQ0KfQ=="}]