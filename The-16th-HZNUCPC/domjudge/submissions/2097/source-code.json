[{"id":"2097","submission_id":"2097","filename":"E.cpp","source":"I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+DQp1c2luZyBuYW1lc3BhY2Ugc3RkOw0KDQpjb25zdCBpbnQgTiA9IDFlMiArIDU7DQpwYWlyPGludCwgaW50PiBQW05dOw0KDQppbnQgZ2NkKGludCwgaW50KTsNCmludCBXKGludCwgaW50KTsNCi8vYm9vbCBjaGVjaygpOw0KDQppbnQgYW5zOw0KaW50IG47DQppbnQgbWFpbigpIHsNCgljaW4gPj4gbjsNCglmb3IgKGludCBpID0gMTsgaSA8PSBuOyBpKyspIHsNCgkJc2NhbmYoIiVkJWQiLCAmUFtpXS5maXJzdCwgJlBbaV0uc2Vjb25kKTsNCgkJDQoJfQ0KCQ0KCWZvciAoaW50IGkgPSAxOyBpIDw9IG47IGkrKykgew0KCQlmb3IgKGludCBqID0gaSArIDE7IGogPD0gbjsgaisrKSB7DQoJCQlmb3IgKGludCBrID0gaiArIDE7IGsgPD0gbjsgaysrKSB7DQoJCQkJaW50IHhkaWYxID0gYWJzKFBba10uZmlyc3QgLSBQW2pdLmZpcnN0KTsNCgkJCQlpbnQgeGRpZjIgPSBhYnMoUFtqXS5maXJzdCAtIFBbaV0uZmlyc3QpOw0KCQkJCQ0KCQkJCWludCB5ZGlmMSA9IGFicyhQW2tdLnNlY29uZCAtIFBbal0uc2Vjb25kKTsNCgkJCQlpbnQgeWRpZjIgPSBhYnMoUFtqXS5zZWNvbmQgLSBQW2ldLnNlY29uZCk7DQoJCQkJDQoJCQkJaWYgKChsb25nIGxvbmcpIHhkaWYxICogeWRpZjIgKiAxbGwgIT0gKGxvbmcgbG9uZykgeWRpZjEgKiB4ZGlmMiAqIDFsbCkgew0KCQkJCQlhbnMgPSBtYXgoYW5zLCBXKGksIGopICsgVyhqLCBrKSArIFcoaSwgaykpOw0KLy8JCQkJCXByaW50ZigiJWQgJWQgJWQgJWRcbiIsIGksIGosIFcoaSwgaiksIFcoaiwgaykpOw0KCQkJCX0NCgkJCQlpZiAoeGRpZjEgKyB4ZGlmMiAhPSAwICYmIHhkaWYxICogeGRpZjIgPT0gMCAmJiAhKHlkaWYxID09IDAgJiYgeWRpZjIgPT0gMCkpIHsNCgkJCQkJYW5zID0gbWF4KGFucywgVyhpLCBqKSArIFcoaiwgaykgKyBXKGksIGspKTsNCgkJCQl9DQoJCQkJaWYgKHlkaWYxICsgeWRpZjIgIT0gMCAmJiB5ZGlmMSAqIHlkaWYyID09IDAgJiYgISh4ZGlmMSA9PSAwICYmIHhkaWYyID09IDApKSB7DQoJCQkJCWFucyA9IG1heChhbnMsIFcoaSwgaikgKyBXKGosIGspICsgVyhpLCBrKSk7DQoJCQkJfQ0KLy8JCQkJCQ0KLy8gNA0KLy8gMiA1DQovLyA0IDkNCi8vIDcgMjkNCi8vIDEzIDM3DQovLyAzIDMwIDMxIDMyDQovLwkJCQlpZiAoUFtqXS5maXJzdCAhPSBQW2ldLmZpcnN0ICYmIFBba10uZmlyc3QgIT0gUFtqXS5maXJzdCkgew0KLy8vLwkJCQkJbG9uZyBkb3VibGUgcmF0MSA9IDEuMCAqIChQW2pdLnNlY29uZCAtIFBbaV0uc2Vjb25kKSAvIChQW2pdLmZpcnN0IC0gUFtpXS5maXJzdCk7DQovLy8vCQkJCQlsb25nIGRvdWJsZSByYXQyID0gMS4wICogKFBba10uc2Vjb25kIC0gUFtqXS5zZWNvbmQpIC8gKFBba10uZmlyc3QgLSBQW2pdLmZpcnN0KTsNCi8vLy8JCQkJCWlmIChyYXQxID09IHJhdDIpIHsNCi8vLy8JCQkJCQljb250aW51ZTsNCi8vLy8JCQkJCX0NCi8vCQkJCQlhbnMgPSBtYXgoYW5zLCBXKGksIGopICsgVyhqLCBrKSArIFcoaSwgaykpOw0KLy8JCQkJfSBlbHNlIHsNCi8vCQkJCQlpZihQW2pdLmZpcnN0ID09IFBbaV0uZmlyc3QgJiYgUFtpXS5maXJzdCA9PSBQW2tdLmZpcnN0IHx8DQovLwkJCQkJICAgUFtqXS5zZWNvbmQgPT0gUFtpXS5zZWNvbmQgJiYgUFtpXS5zZWNvbmQgPT0gUFtrXS5zZWNvbmQpIHsNCi8vCQkJCQkJY29udGludWU7DQovLwkJCQkJfWVsc2V7DQovLwkJCQkJCWFucyA9IG1heChhbnMsIFcoaSwgaikgKyBXKGosIGspICsgVyhpLCBrKSk7DQovLwkJCQkJfQ0KLy8JCQkJfQ0KCQkJfQ0KCQl9DQoJfQ0KCWNvdXQgPDwgbWF4KGFucyAtIDMsIDApOw0KCXJldHVybiAwOw0KfQ0KDQppbnQgZ2NkKGludCBhLCBpbnQgYikgew0KCWlmIChiID09IDApIHsNCgkJcmV0dXJuIGE7DQoJfQ0KCXJldHVybiBnY2QoYiwgYSAlIGIpOw0KfQ0KDQppbnQgVyhpbnQgaW5kLCBpbnQgam5kKSB7DQoJaW50IHhkaWYgPSBhYnMoUFtpbmRdLmZpcnN0IC0gUFtqbmRdLmZpcnN0KTsNCglpbnQgeWRpZiA9IGFicyhQW2luZF0uc2Vjb25kIC0gUFtqbmRdLnNlY29uZCk7DQoJcmV0dXJuIGdjZCh4ZGlmLCB5ZGlmKSArIDE7DQp9DQo="}]