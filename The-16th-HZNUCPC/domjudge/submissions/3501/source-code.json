[{"id":"3501","submission_id":"3501","filename":"E.cpp","source":"I2luY2x1ZGU8Yml0cy9zdGRjKysuaD4NCg0KdXNpbmcgbmFtZXNwYWNlIHN0ZDsNCg0KI2RlZmluZSBpb3MgaW9zOjpzeW5jX3dpdGhfc3RkaW8oZmFsc2UpO2Npbi50aWUoMCk7Y291dC50aWUoMCkNCiNkZWZpbmUgaW50IGxvbmcgbG9uZw0KDQppbnQgZ2NkKGludCBhLCBpbnQgYikNCnsNCgl3aGlsZShiXj1hXj1iXj1hJT1iKTsNCglyZXR1cm4gYTsNCn0NCg0Kc3RydWN0IFN0dXsNCglpbnQgeCwgeTsNCn1mWzMwMF07DQoNCmJvb2wgaXNvayhTdHUgYSwgU3R1IGIsIFN0dSBjKQ0Kew0KCXNldDxkb3VibGU+IHNlOw0KCWludCBjbnQgPSAwOw0KCWlmKGEueCA9PSBiLngpIGNudCArKzsNCgllbHNlew0KCQlkb3VibGUgZnogPSBhLnkgLSBiLnksIGZtID0gYS54IC0gYi54Ow0KCQlzZS5pbnNlcnQoZnovZm0pOw0KCX0NCgkNCglpZihhLnggPT0gYy54KSBjbnQrKzsNCgllbHNlew0KCQlkb3VibGUgZnogPSBhLnkgLSBjLnksIGZtID0gYS54IC0gYy54Ow0KCQlzZS5pbnNlcnQoZnovZm0pOw0KCX0NCgkNCglpZihjLnggPT0gYi54KSBjbnQrKzsNCgllbHNlew0KCQlkb3VibGUgZnogPSBjLnkgLSBiLnksIGZtID0gYy54IC0gYi54Ow0KCQlzZS5pbnNlcnQoZnovZm0pOw0KCX0NCglpZihjbnQgPiAxKSByZXR1cm4gZmFsc2U7DQoJcmV0dXJuIHNlLnNpemUoKSArIGNudCA9PSAzOw0KCQ0KfQ0KDQoNCmludCBhZGQoU3R1IGEsIFN0dSBiKQ0Kew0KCWludCBjbnQgPSAwOw0KCQ0KCWludCBmeiA9IGEueSAtIGIueSwgZm0gPSBhLnggLSBiLng7DQoJaWYoZnogPT0gMCkgY250ICs9IGFicyhhLnggLSBiLngpICsgMTsNCgllbHNlIGlmKGZtID09IDApIGNudCArPSBhYnMoYS55IC0gYi55KSArIDE7DQoJZWxzZXsNCgkJaW50IF9nY2QgPSBhYnMoZ2NkKGZ6LCBmbSkpOw0KCQlmeiAvPSBfZ2NkLCBmbSAvPSBfZ2NkOw0KCQlmeiA9IGFicyhmeiksIGZtID0gYWJzKGZtKTsNCgkJaWYoZnogPCBmbSkNCgkJCWNudCA9IGNudCArIChtYXgoYS54LCBiLngpIC0gbWluKGEueCwgYi54KSkgKiBmeiAvIGZtICsgMTsNCgkJZWxzZQ0KCQkJY250ID0gY250ICsgKG1heChhLnksIGIueSkgLSBtaW4oYS55LCBiLnkpKSAqIGZtIC8gZnogKyAxOw0KCX0NCg0KCXJldHVybiBjbnQ7DQp9DQoNCnNpZ25lZCBtYWluKCkNCnsNCglpb3M7DQoJaW50IG47IGNpbiA+PiBuOw0KCWZvcihpbnQgaSA9IDE7IGkgPD0gbjsgaSsrKSBjaW4gPj4gZltpXS54ID4+IGZbaV0ueTsNCglpbnQgbWEgPSAwOw0KCQ0KCWZvcihpbnQgaSA9IDE7IGkgPD0gbjsgaSsrKQ0KCXsNCgkJZm9yKGludCBqID0gaSArIDE7IGogPD0gbjsgaisrKQ0KCQl7DQoJCQlmb3IoaW50IGsgPSBqICsgMTsgayA8PSBuOyBrKyspDQoJCQl7DQoJCQkJaWYoaXNvayhmW2ldLGZbal0sZltrXSkpDQoJCQkJew0KCQkJCQlpbnQgY250ID0gYWRkKGZbaV0sIGZbal0pICsgYWRkKGZbaV0sIGZba10pICsgYWRkKGZbal0sIGZba10pIC0gMzsNCgkJCQkJbWEgPSBtYXgoKGludCkwLCBtYXgobWEsIGNudCkpOw0KCQkJCX0NCgkJCX0NCgkJfQ0KCX0NCgljb3V0IDw8IG1hIDw8IGVuZGw7DQoNCglyZXR1cm4gMDsNCn0NCg0K"}]