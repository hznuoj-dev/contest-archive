[{"id":"4140","submission_id":"4140","filename":"A.cpp","source":"I2luY2x1ZGUgPGlvc3RyZWFtPg0KI2luY2x1ZGUgPGNzdHJpbmc+DQojaW5jbHVkZSA8c3RkbGliLmg+DQoNCnVzaW5nIG5hbWVzcGFjZSBzdGQ7DQp1c2luZyBsbCA9IGxvbmcgbG9uZzsNCg0KaW50IHBvc1syMF1bMjBdOw0Kdm9pZCBkZnMoaW50IHgsIGludCB5LGludCBudW0pDQp7DQoJaWYoeDw9MTkmJng+PTEmJnk+PTEmJnk8PTE5KQ0KCXsNCgkJaWYocG9zW3hdW3ldPT0xKQ0KCXsJDQoJCQ0KCQlwb3NbeF1beV09bnVtOw0KCQlkZnMoeCsxLHksbnVtKTsNCgkJZGZzKHgseS0xLG51bSk7DQoJCWRmcyh4LTEseSxudW0pOw0KCQlkZnMoeCx5KzEsbnVtKTsNCgkJcmV0dXJuOw0KCX0NCgllbHNlDQoJcmV0dXJuOw0KCX0NCglyZXR1cm47DQoJDQoJDQp9DQoNCg0KaW50IGNtcChjb25zdCB2b2lkKiBhLCBjb25zdCB2b2lkKiBiKSB7DQoJcmV0dXJuICooaW50KilhIC0gKihpbnQqKWI7DQp9DQoNCmludCBtYWluKCkNCnsNCglpbnQgaSxqLGssbDsNCglpbnQgbixtLHgseSxjLHN1bSA9IDAsY291bnQgPSAyOw0KCWNpbiA+PiBuOw0KCWZvcihpPTE7aTw9bjtpKyspDQoJew0KCQlmb3IgKGogPSAxOyBqIDwgMjA7IGorKykgew0KCQkJZm9yIChrID0gMTsgayA8IDIwOyBrKyspIHsNCgkJCQlwb3Nbal1ba10gPSAwOw0KCQkJfQ0KCQl9DQoJCXN1bSA9IDA7DQoJCWNvdW50ID0gMjsNCgkJY2luID4+IG07DQoJCWZvcihqPTE7ajw9bTtqKyspDQoJCXsNCgkJCWNpbiA+PnggPj4geSA+PiBjOw0KCQkJaWYoYz09MSkNCgkJCXsNCgkJCQlwb3NbeF1beV09MTsNCgkJCQkNCgkJCX0NCgkJCWVsc2UNCgkJCXsNCgkJCQlwb3NbeF1beV09LTE7DQoJCQl9DQoJCQkNCgkJfQkNCgkJCWZvcihqPTE7ajw9MTk7aisrKQ0KCQl7DQoJCQlmb3Ioaz0xO2s8PTE5O2srKykNCgkJCXsNCgkJCQlpZihwb3Nbal1ba109PTEpDQoJCQkJew0KCQkJCQlkZnMoaixrLGNvdW50KTsNCgkJCQkJY291bnQrKzsNCgkJCQl9DQoJCQl9DQoJCQkNCgkJfQ0KCQkNCgkJLypmb3Ioaj0xO2o8PTE5O2orKykNCgkJew0KCQkJZm9yKGs9MTtrPD0xOTtrKyspDQoJCQl7DQoJCQljb3V0IDw8IHBvc1tqXVtrXSA8PCAiICI7DQoJCQl9DQoJCQljb3V0IDw8IGVuZGw7DQoJCX0qLw0KCQ0KCQkNCgkJaW50IGNudCA9IDA7DQoJCQ0KCQlmb3IgKGogPSAxOyBqIDwgMjA7IGorKykgew0KCQkJZm9yIChrID0gMTsgayA8IDIwOyBrKyspIHsNCgkJCQlpZiAocG9zW2pdW2tdID09IDApIHsNCgkJCQkJaW50IG9wWzVdID0gezB9LCBjbnQxID0gMCxiID0gMCwgY250MiA9IDA7DQoJCQkJCWlmIChwb3NbaiArIDFdW2tdID4gMSAmJiBqICsgMSA8IDIwKSB7DQoJCQkJCQ0KCQkJCQliPTE7DQoJCQkJCXdoaWxlKGI8PWNudDEpDQoJCQkJCXsNCgkJCQkJCWlmKHBvc1tqKzFdW2tdPT1vcFtiXSkNCgkJCQkJCXsNCgkJCQkJCQkNCgkJCQkJCQlicmVhazsNCgkJCQkJCX0NCgkJCQkJCWIrKzsJDQoJCQkJCQkNCgkJCQkJfQ0KCQkJCQlpZihiPmNudDEpDQoJCQkJCXsNCgkJCQkJCW9wW2JdPXBvc1tqKzFdW2tdOw0KCQkJCQkJY250MT1iOw0KCQkJCQl9DQoJCQkJCX0NCgkJCQkJaWYgKHBvc1tqIC0gMV1ba10gPiAxICYmIGogLSAxID4gMCkgew0KCQkJCQkJDQoJCQkJCWI9MTsNCgkJCQkJd2hpbGUoYjw9Y250MSkNCgkJCQkJew0KCQkJCQkJaWYocG9zW2otMV1ba109PW9wW2JdKQ0KCQkJCQkJew0KCQkJCQkJCQ0KCQkJCQkJCWJyZWFrOw0KCQkJCQkJfQ0KCQkJCQkJYisrOwkNCgkJCQkJCQ0KCQkJCQl9DQoJCQkJCWlmKGI+Y250MSkNCgkJCQkJew0KCQkJCQkJb3BbYl09cG9zW2otMV1ba107DQoJCQkJCQljbnQxPWI7DQoJCQkJCX0NCgkJCQkJfQ0KCQkJCQlpZiAocG9zW2pdW2sgKyAxXSA+IDEgJiYgayArIDEgPCAyMCkgew0KCQkJCQkNCgkJCQkJYj0xOw0KCQkJCQl3aGlsZShiPD1jbnQxKQ0KCQkJCQl7DQoJCQkJCQlpZihwb3Nbal1baysxXT09b3BbYl0pDQoJCQkJCQl7DQoJCQkJCQkJDQoJCQkJCQkJYnJlYWs7DQoJCQkJCQl9DQoJCQkJCQliKys7CQ0KCQkJCQkJDQoJCQkJCX0NCgkJCQkJaWYoYj5jbnQxKQ0KCQkJCQl7DQoJCQkJCQlvcFtiXT1wb3Nbal1baysxXTsNCgkJCQkJCWNudDE9YjsNCgkJCQkJfQ0KCQkJCQl9DQoJCQkJCWlmIChwb3Nbal1bayAtIDFdID4gMSAmJiBrIC0gMSA+IDApIHsNCgkJCQkJDQoJCQkJCWI9MTsNCgkJCQkJd2hpbGUoYjw9Y250MSkNCgkJCQkJew0KCQkJCQkJaWYocG9zW2pdW2stMV09PW9wW2JdKQ0KCQkJCQkJew0KCQkJCQkJCQ0KCQkJCQkJCWJyZWFrOw0KCQkJCQkJfQ0KCQkJCQkJYisrOwkNCgkJCQkJCQ0KCQkJCQl9DQoJCQkJCWlmKGI+Y250MSkNCgkJCQkJew0KCQkJCQkJb3BbYl09cG9zW2pdW2stMV07DQoJCQkJCQljbnQxPWI7DQoJCQkJCX0NCgkJCQkJfQ0KCQkJCQljbnQgKz0gY250MTsNCgkJCQkvKglpZiAoY250MiA9PSAwKSB7DQoJCQkJCQljb250aW51ZTsNCgkJCQkJfQ0KCQkJCQlmb3IgKGNudDEgPSAwOyBjbnQxIDwgY250MjsgY250MSArKykgew0KCQkJCQkJY291dCA8PCBvcFtjbnQxXSA8PCAiICI7DQoJCQkJCX0NCgkJCQkJY291dCA8PCBlbmRsOw0KCQkJCQlpZiAoY250MiA9PSAxKSB7DQoJCQkJCQljbnQrKzsNCgkJCQkJCWNvbnRpbnVlOw0KCQkJCQl9DQoJCQkJCWlmIChjbnQyID09IDIpIHsNCgkJCQkJCWlmIChvcFswXSA9PSBvcFsxXSkgew0KCQkJCQkJCWNudCsrOw0KCQkJCQkJfSBlbHNlIHsNCgkJCQkJCQljbnQgKz0gMjsNCgkJCQkJCX0NCgkJCQkJCWNvbnRpbnVlOw0KCQkJCQl9DQoJCQkJCXFzb3J0KG9wLCBjbnQyLCBzaXplb2YgKGludCksIGNtcCk7DQoJCQkJCWNudCsrOw0KCQkJCQlmb3IgKGNudDEgPSAxOyBjbnQxIDwgY250MjsgY250MSsrKSB7DQoJCQkJCQlpZiAob3BbY250MV0gIT0gb3BbY250MSAtIDFdKSB7DQoJCQkJCQkJY250Kys7DQoJCQkJCQl9DQoJCQkJCX0qLw0KCQkJCQkNCgkJCQl9DQoJCQkJDQoJCQl9DQoJCX0NCgkJY291dCA8PCBjbnQgPDwgZW5kbDsNCgl9DQoJcmV0dXJuIDA7DQp9DQoNCg=="}]